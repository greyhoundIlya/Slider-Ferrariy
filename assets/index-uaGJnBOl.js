(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function T1(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var Sd={exports:{}},vl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bv;function E1(){if(bv)return vl;bv=1;var l=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,r){var o=null;if(r!==void 0&&(o=""+r),s.key!==void 0&&(o=""+s.key),"key"in s){r={};for(var u in s)u!=="key"&&(r[u]=s[u])}else r=s;return s=r.ref,{$$typeof:l,type:i,key:o,ref:s!==void 0?s:null,props:r}}return vl.Fragment=e,vl.jsx=t,vl.jsxs=t,vl}var Av;function x1(){return Av||(Av=1,Sd.exports=E1()),Sd.exports}var J=x1(),Td={exports:{}},Ae={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lv;function _1(){if(Lv)return Ae;Lv=1;var l=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;function v(k){return k===null||typeof k!="object"?null:(k=m&&k[m]||k["@@iterator"],typeof k=="function"?k:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,E={};function x(k,$,q){this.props=k,this.context=$,this.refs=E,this.updater=q||y}x.prototype.isReactComponent={},x.prototype.setState=function(k,$){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,$,"setState")},x.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function _(){}_.prototype=x.prototype;function R(k,$,q){this.props=k,this.context=$,this.refs=E,this.updater=q||y}var A=R.prototype=new _;A.constructor=R,S(A,x.prototype),A.isPureReactComponent=!0;var I=Array.isArray,D={H:null,A:null,T:null,S:null,V:null},N=Object.prototype.hasOwnProperty;function C(k,$,q,ne,fe,re){return q=re.ref,{$$typeof:l,type:k,key:$,ref:q!==void 0?q:null,props:re}}function M(k,$){return C(k.type,$,void 0,void 0,void 0,k.props)}function O(k){return typeof k=="object"&&k!==null&&k.$$typeof===l}function P(k){var $={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(q){return $[q]})}var U=/\/+/g;function H(k,$){return typeof k=="object"&&k!==null&&k.key!=null?P(""+k.key):$.toString(36)}function se(){}function ue(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(se,se):(k.status="pending",k.then(function($){k.status==="pending"&&(k.status="fulfilled",k.value=$)},function($){k.status==="pending"&&(k.status="rejected",k.reason=$)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function te(k,$,q,ne,fe){var re=typeof k;(re==="undefined"||re==="boolean")&&(k=null);var ce=!1;if(k===null)ce=!0;else switch(re){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(k.$$typeof){case l:case e:ce=!0;break;case h:return ce=k._init,te(ce(k._payload),$,q,ne,fe)}}if(ce)return fe=fe(k),ce=ne===""?"."+H(k,0):ne,I(fe)?(q="",ce!=null&&(q=ce.replace(U,"$&/")+"/"),te(fe,$,q,"",function($e){return $e})):fe!=null&&(O(fe)&&(fe=M(fe,q+(fe.key==null||k&&k.key===fe.key?"":(""+fe.key).replace(U,"$&/")+"/")+ce)),$.push(fe)),1;ce=0;var ve=ne===""?".":ne+":";if(I(k))for(var _e=0;_e<k.length;_e++)ne=k[_e],re=ve+H(ne,_e),ce+=te(ne,$,q,re,fe);else if(_e=v(k),typeof _e=="function")for(k=_e.call(k),_e=0;!(ne=k.next()).done;)ne=ne.value,re=ve+H(ne,_e++),ce+=te(ne,$,q,re,fe);else if(re==="object"){if(typeof k.then=="function")return te(ue(k),$,q,ne,fe);throw $=String(k),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return ce}function B(k,$,q){if(k==null)return k;var ne=[],fe=0;return te(k,ne,"","",function(re){return $.call(q,re,fe++)}),ne}function K(k){if(k._status===-1){var $=k._result;$=$(),$.then(function(q){(k._status===0||k._status===-1)&&(k._status=1,k._result=q)},function(q){(k._status===0||k._status===-1)&&(k._status=2,k._result=q)}),k._status===-1&&(k._status=0,k._result=$)}if(k._status===1)return k._result.default;throw k._result}var j=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)};function oe(){}return Ae.Children={map:B,forEach:function(k,$,q){B(k,function(){$.apply(this,arguments)},q)},count:function(k){var $=0;return B(k,function(){$++}),$},toArray:function(k){return B(k,function($){return $})||[]},only:function(k){if(!O(k))throw Error("React.Children.only expected to receive a single React element child.");return k}},Ae.Component=x,Ae.Fragment=t,Ae.Profiler=s,Ae.PureComponent=R,Ae.StrictMode=i,Ae.Suspense=d,Ae.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Ae.__COMPILER_RUNTIME={__proto__:null,c:function(k){return D.H.useMemoCache(k)}},Ae.cache=function(k){return function(){return k.apply(null,arguments)}},Ae.cloneElement=function(k,$,q){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var ne=S({},k.props),fe=k.key,re=void 0;if($!=null)for(ce in $.ref!==void 0&&(re=void 0),$.key!==void 0&&(fe=""+$.key),$)!N.call($,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&$.ref===void 0||(ne[ce]=$[ce]);var ce=arguments.length-2;if(ce===1)ne.children=q;else if(1<ce){for(var ve=Array(ce),_e=0;_e<ce;_e++)ve[_e]=arguments[_e+2];ne.children=ve}return C(k.type,fe,void 0,void 0,re,ne)},Ae.createContext=function(k){return k={$$typeof:o,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:r,_context:k},k},Ae.createElement=function(k,$,q){var ne,fe={},re=null;if($!=null)for(ne in $.key!==void 0&&(re=""+$.key),$)N.call($,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(fe[ne]=$[ne]);var ce=arguments.length-2;if(ce===1)fe.children=q;else if(1<ce){for(var ve=Array(ce),_e=0;_e<ce;_e++)ve[_e]=arguments[_e+2];fe.children=ve}if(k&&k.defaultProps)for(ne in ce=k.defaultProps,ce)fe[ne]===void 0&&(fe[ne]=ce[ne]);return C(k,re,void 0,void 0,null,fe)},Ae.createRef=function(){return{current:null}},Ae.forwardRef=function(k){return{$$typeof:u,render:k}},Ae.isValidElement=O,Ae.lazy=function(k){return{$$typeof:h,_payload:{_status:-1,_result:k},_init:K}},Ae.memo=function(k,$){return{$$typeof:f,type:k,compare:$===void 0?null:$}},Ae.startTransition=function(k){var $=D.T,q={};D.T=q;try{var ne=k(),fe=D.S;fe!==null&&fe(q,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(oe,j)}catch(re){j(re)}finally{D.T=$}},Ae.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Ae.use=function(k){return D.H.use(k)},Ae.useActionState=function(k,$,q){return D.H.useActionState(k,$,q)},Ae.useCallback=function(k,$){return D.H.useCallback(k,$)},Ae.useContext=function(k){return D.H.useContext(k)},Ae.useDebugValue=function(){},Ae.useDeferredValue=function(k,$){return D.H.useDeferredValue(k,$)},Ae.useEffect=function(k,$,q){var ne=D.H;if(typeof q=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ne.useEffect(k,$)},Ae.useId=function(){return D.H.useId()},Ae.useImperativeHandle=function(k,$,q){return D.H.useImperativeHandle(k,$,q)},Ae.useInsertionEffect=function(k,$){return D.H.useInsertionEffect(k,$)},Ae.useLayoutEffect=function(k,$){return D.H.useLayoutEffect(k,$)},Ae.useMemo=function(k,$){return D.H.useMemo(k,$)},Ae.useOptimistic=function(k,$){return D.H.useOptimistic(k,$)},Ae.useReducer=function(k,$,q){return D.H.useReducer(k,$,q)},Ae.useRef=function(k){return D.H.useRef(k)},Ae.useState=function(k){return D.H.useState(k)},Ae.useSyncExternalStore=function(k,$,q){return D.H.useSyncExternalStore(k,$,q)},Ae.useTransition=function(){return D.H.useTransition()},Ae.version="19.1.0",Ae}var Rv;function Kh(){return Rv||(Rv=1,Td.exports=_1()),Td.exports}var he=Kh();const St=T1(he);var Ed={exports:{}},yl={},xd={exports:{}},_d={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dv;function b1(){return Dv||(Dv=1,function(l){function e(B,K){var j=B.length;B.push(K);e:for(;0<j;){var oe=j-1>>>1,k=B[oe];if(0<s(k,K))B[oe]=K,B[j]=k,j=oe;else break e}}function t(B){return B.length===0?null:B[0]}function i(B){if(B.length===0)return null;var K=B[0],j=B.pop();if(j!==K){B[0]=j;e:for(var oe=0,k=B.length,$=k>>>1;oe<$;){var q=2*(oe+1)-1,ne=B[q],fe=q+1,re=B[fe];if(0>s(ne,j))fe<k&&0>s(re,ne)?(B[oe]=re,B[fe]=j,oe=fe):(B[oe]=ne,B[q]=j,oe=q);else if(fe<k&&0>s(re,j))B[oe]=re,B[fe]=j,oe=fe;else break e}}return K}function s(B,K){var j=B.sortIndex-K.sortIndex;return j!==0?j:B.id-K.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;l.unstable_now=function(){return r.now()}}else{var o=Date,u=o.now();l.unstable_now=function(){return o.now()-u}}var d=[],f=[],h=1,m=null,v=3,y=!1,S=!1,E=!1,x=!1,_=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function I(B){for(var K=t(f);K!==null;){if(K.callback===null)i(f);else if(K.startTime<=B)i(f),K.sortIndex=K.expirationTime,e(d,K);else break;K=t(f)}}function D(B){if(E=!1,I(B),!S)if(t(d)!==null)S=!0,N||(N=!0,H());else{var K=t(f);K!==null&&te(D,K.startTime-B)}}var N=!1,C=-1,M=5,O=-1;function P(){return x?!0:!(l.unstable_now()-O<M)}function U(){if(x=!1,N){var B=l.unstable_now();O=B;var K=!0;try{e:{S=!1,E&&(E=!1,R(C),C=-1),y=!0;var j=v;try{t:{for(I(B),m=t(d);m!==null&&!(m.expirationTime>B&&P());){var oe=m.callback;if(typeof oe=="function"){m.callback=null,v=m.priorityLevel;var k=oe(m.expirationTime<=B);if(B=l.unstable_now(),typeof k=="function"){m.callback=k,I(B),K=!0;break t}m===t(d)&&i(d),I(B)}else i(d);m=t(d)}if(m!==null)K=!0;else{var $=t(f);$!==null&&te(D,$.startTime-B),K=!1}}break e}finally{m=null,v=j,y=!1}K=void 0}}finally{K?H():N=!1}}}var H;if(typeof A=="function")H=function(){A(U)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,ue=se.port2;se.port1.onmessage=U,H=function(){ue.postMessage(null)}}else H=function(){_(U,0)};function te(B,K){C=_(function(){B(l.unstable_now())},K)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(B){B.callback=null},l.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<B?Math.floor(1e3/B):5},l.unstable_getCurrentPriorityLevel=function(){return v},l.unstable_next=function(B){switch(v){case 1:case 2:case 3:var K=3;break;default:K=v}var j=v;v=K;try{return B()}finally{v=j}},l.unstable_requestPaint=function(){x=!0},l.unstable_runWithPriority=function(B,K){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var j=v;v=B;try{return K()}finally{v=j}},l.unstable_scheduleCallback=function(B,K,j){var oe=l.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?oe+j:oe):j=oe,B){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=j+k,B={id:h++,callback:K,priorityLevel:B,startTime:j,expirationTime:k,sortIndex:-1},j>oe?(B.sortIndex=j,e(f,B),t(d)===null&&B===t(f)&&(E?(R(C),C=-1):E=!0,te(D,j-oe))):(B.sortIndex=k,e(d,B),S||y||(S=!0,N||(N=!0,H()))),B},l.unstable_shouldYield=P,l.unstable_wrapCallback=function(B){var K=v;return function(){var j=v;v=K;try{return B.apply(this,arguments)}finally{v=j}}}}(_d)),_d}var Iv;function A1(){return Iv||(Iv=1,xd.exports=b1()),xd.exports}var bd={exports:{}},Bt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wv;function L1(){if(wv)return Bt;wv=1;var l=Kh();function e(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)f+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function r(d,f,h){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:m==null?null:""+m,children:d,containerInfo:f,implementation:h}}var o=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Bt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Bt.createPortal=function(d,f){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return r(d,f,null,h)},Bt.flushSync=function(d){var f=o.T,h=i.p;try{if(o.T=null,i.p=2,d)return d()}finally{o.T=f,i.p=h,i.d.f()}},Bt.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},Bt.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},Bt.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var h=f.as,m=u(h,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,y=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;h==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:m,integrity:v,fetchPriority:y}):h==="script"&&i.d.X(d,{crossOrigin:m,integrity:v,fetchPriority:y,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Bt.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var h=u(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},Bt.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var h=f.as,m=u(h,f.crossOrigin);i.d.L(d,h,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Bt.preloadModule=function(d,f){if(typeof d=="string")if(f){var h=u(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},Bt.requestFormReset=function(d){i.d.r(d)},Bt.unstable_batchedUpdates=function(d,f){return d(f)},Bt.useFormState=function(d,f,h){return o.H.useFormState(d,f,h)},Bt.useFormStatus=function(){return o.H.useHostTransitionStatus()},Bt.version="19.1.0",Bt}var Cv;function R1(){if(Cv)return bd.exports;Cv=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(e){console.error(e)}}return l(),bd.exports=L1(),bd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ov;function D1(){if(Ov)return yl;Ov=1;var l=A1(),e=Kh(),t=R1();function i(n){var a="https://react.dev/errors/"+n;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function r(n){var a=n,c=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(c=a.return),n=a.return;while(n)}return a.tag===3?c:null}function o(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function u(n){if(r(n)!==n)throw Error(i(188))}function d(n){var a=n.alternate;if(!a){if(a=r(n),a===null)throw Error(i(188));return a!==n?null:n}for(var c=n,g=a;;){var p=c.return;if(p===null)break;var T=p.alternate;if(T===null){if(g=p.return,g!==null){c=g;continue}break}if(p.child===T.child){for(T=p.child;T;){if(T===c)return u(p),n;if(T===g)return u(p),a;T=T.sibling}throw Error(i(188))}if(c.return!==g.return)c=p,g=T;else{for(var L=!1,w=p.child;w;){if(w===c){L=!0,c=p,g=T;break}if(w===g){L=!0,g=p,c=T;break}w=w.sibling}if(!L){for(w=T.child;w;){if(w===c){L=!0,c=T,g=p;break}if(w===g){L=!0,g=T,c=p;break}w=w.sibling}if(!L)throw Error(i(189))}}if(c.alternate!==g)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?n:a}function f(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n;for(n=n.child;n!==null;){if(a=f(n),a!==null)return a;n=n.sibling}return null}var h=Object.assign,m=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),R=Symbol.for("react.consumer"),A=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function H(n){return n===null||typeof n!="object"?null:(n=U&&n[U]||n["@@iterator"],typeof n=="function"?n:null)}var se=Symbol.for("react.client.reference");function ue(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===se?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case S:return"Fragment";case x:return"Profiler";case E:return"StrictMode";case D:return"Suspense";case N:return"SuspenseList";case O:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case y:return"Portal";case A:return(n.displayName||"Context")+".Provider";case R:return(n._context.displayName||"Context")+".Consumer";case I:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case C:return a=n.displayName||null,a!==null?a:ue(n.type)||"Memo";case M:a=n._payload,n=n._init;try{return ue(n(a))}catch{}}return null}var te=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j={pending:!1,data:null,method:null,action:null},oe=[],k=-1;function $(n){return{current:n}}function q(n){0>k||(n.current=oe[k],oe[k]=null,k--)}function ne(n,a){k++,oe[k]=n.current,n.current=a}var fe=$(null),re=$(null),ce=$(null),ve=$(null);function _e(n,a){switch(ne(ce,a),ne(re,n),ne(fe,null),a.nodeType){case 9:case 11:n=(n=a.documentElement)&&(n=n.namespaceURI)?Zp(n):0;break;default:if(n=a.tagName,a=a.namespaceURI)a=Zp(a),n=Jp(a,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}q(fe),ne(fe,n)}function $e(){q(fe),q(re),q(ce)}function Dt(n){n.memoizedState!==null&&ne(ve,n);var a=fe.current,c=Jp(a,n.type);a!==c&&(ne(re,n),ne(fe,c))}function Ei(n){re.current===n&&(q(fe),q(re)),ve.current===n&&(q(ve),dl._currentValue=j)}var Sa=Object.prototype.hasOwnProperty,_n=l.unstable_scheduleCallback,bn=l.unstable_cancelCallback,Pg=l.unstable_shouldYield,Me=l.unstable_requestPaint,Ye=l.unstable_now,Vt=l.unstable_getCurrentPriorityLevel,Xi=l.unstable_ImmediatePriority,Kt=l.unstable_UserBlockingPriority,Gi=l.unstable_NormalPriority,ds=l.unstable_LowPriority,Ta=l.unstable_IdlePriority,or=l.log,Yl=l.unstable_setDisableYieldValue,$i=null,Mt=null;function Qi(n){if(typeof or=="function"&&Yl(n),Mt&&typeof Mt.setStrictMode=="function")try{Mt.setStrictMode($i,n)}catch{}}var Pt=Math.clz32?Math.clz32:ax,jl=Math.log,An=Math.LN2;function ax(n){return n>>>=0,n===0?32:31-(jl(n)/An|0)|0}var ql=256,Xl=4194304;function Ln(n){var a=n&42;if(a!==0)return a;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Ql(n,a,c){var g=n.pendingLanes;if(g===0)return 0;var p=0,T=n.suspendedLanes,L=n.pingedLanes;n=n.warmLanes;var w=g&134217727;return w!==0?(g=w&~T,g!==0?p=Ln(g):(L&=w,L!==0?p=Ln(L):c||(c=w&~n,c!==0&&(p=Ln(c))))):(w=g&~T,w!==0?p=Ln(w):L!==0?p=Ln(L):c||(c=g&~n,c!==0&&(p=Ln(c)))),p===0?0:a!==0&&a!==p&&(a&T)===0&&(T=p&-p,c=a&-a,T>=c||T===32&&(c&4194048)!==0)?a:p}function Ea(n,a){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&a)===0}function lx(n,a){switch(n){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kg(){var n=ql;return ql<<=1,(ql&4194048)===0&&(ql=256),n}function Ng(){var n=Xl;return Xl<<=1,(Xl&62914560)===0&&(Xl=4194304),n}function lc(n){for(var a=[],c=0;31>c;c++)a.push(n);return a}function xa(n,a){n.pendingLanes|=a,a!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function ox(n,a,c,g,p,T){var L=n.pendingLanes;n.pendingLanes=c,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=c,n.entangledLanes&=c,n.errorRecoveryDisabledLanes&=c,n.shellSuspendCounter=0;var w=n.entanglements,F=n.expirationTimes,Q=n.hiddenUpdates;for(c=L&~c;0<c;){var ee=31-Pt(c),le=1<<ee;w[ee]=0,F[ee]=-1;var W=Q[ee];if(W!==null)for(Q[ee]=null,ee=0;ee<W.length;ee++){var Z=W[ee];Z!==null&&(Z.lane&=-536870913)}c&=~le}g!==0&&Bg(n,g,0),T!==0&&p===0&&n.tag!==0&&(n.suspendedLanes|=T&~(L&~a))}function Bg(n,a,c){n.pendingLanes|=a,n.suspendedLanes&=~a;var g=31-Pt(a);n.entangledLanes|=a,n.entanglements[g]=n.entanglements[g]|1073741824|c&4194090}function Fg(n,a){var c=n.entangledLanes|=a;for(n=n.entanglements;c;){var g=31-Pt(c),p=1<<g;p&a|n[g]&a&&(n[g]|=a),c&=~p}}function oc(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function uc(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Ug(){var n=K.p;return n!==0?n:(n=window.event,n===void 0?32:yv(n.type))}function ux(n,a){var c=K.p;try{return K.p=n,a()}finally{K.p=c}}var Fs=Math.random().toString(36).slice(2),kt="__reactFiber$"+Fs,Yt="__reactProps$"+Fs,ur="__reactContainer$"+Fs,cc="__reactEvents$"+Fs,cx="__reactListeners$"+Fs,fx="__reactHandles$"+Fs,Gg="__reactResources$"+Fs,_a="__reactMarker$"+Fs;function fc(n){delete n[kt],delete n[Yt],delete n[cc],delete n[cx],delete n[fx]}function cr(n){var a=n[kt];if(a)return a;for(var c=n.parentNode;c;){if(a=c[ur]||c[kt]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(n=sv(n);n!==null;){if(c=n[kt])return c;n=sv(n)}return a}n=c,c=n.parentNode}return null}function fr(n){if(n=n[kt]||n[ur]){var a=n.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return n}return null}function ba(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n.stateNode;throw Error(i(33))}function dr(n){var a=n[Gg];return a||(a=n[Gg]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Et(n){n[_a]=!0}var $g=new Set,zg={};function Rn(n,a){hr(n,a),hr(n+"Capture",a)}function hr(n,a){for(zg[n]=a,n=0;n<a.length;n++)$g.add(a[n])}var dx=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Hg={},Vg={};function hx(n){return Sa.call(Vg,n)?!0:Sa.call(Hg,n)?!1:dx.test(n)?Vg[n]=!0:(Hg[n]=!0,!1)}function Wl(n,a,c){if(hx(a))if(c===null)n.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":n.removeAttribute(a);return;case"boolean":var g=a.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){n.removeAttribute(a);return}}n.setAttribute(a,""+c)}}function Zl(n,a,c){if(c===null)n.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(a);return}n.setAttribute(a,""+c)}}function hs(n,a,c,g){if(g===null)n.removeAttribute(c);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(c);return}n.setAttributeNS(a,c,""+g)}}var dc,Kg;function gr(n){if(dc===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);dc=a&&a[1]||"",Kg=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+dc+n+Kg}var hc=!1;function gc(n,a){if(!n||hc)return"";hc=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(a){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(Z){var W=Z}Reflect.construct(n,[],le)}else{try{le.call()}catch(Z){W=Z}n.call(le.prototype)}}else{try{throw Error()}catch(Z){W=Z}(le=n())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(Z){if(Z&&W&&typeof Z.stack=="string")return[Z.stack,W.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=g.DetermineComponentFrameRoot(),L=T[0],w=T[1];if(L&&w){var F=L.split(`
`),Q=w.split(`
`);for(p=g=0;g<F.length&&!F[g].includes("DetermineComponentFrameRoot");)g++;for(;p<Q.length&&!Q[p].includes("DetermineComponentFrameRoot");)p++;if(g===F.length||p===Q.length)for(g=F.length-1,p=Q.length-1;1<=g&&0<=p&&F[g]!==Q[p];)p--;for(;1<=g&&0<=p;g--,p--)if(F[g]!==Q[p]){if(g!==1||p!==1)do if(g--,p--,0>p||F[g]!==Q[p]){var ee=`
`+F[g].replace(" at new "," at ");return n.displayName&&ee.includes("<anonymous>")&&(ee=ee.replace("<anonymous>",n.displayName)),ee}while(1<=g&&0<=p);break}}}finally{hc=!1,Error.prepareStackTrace=c}return(c=n?n.displayName||n.name:"")?gr(c):""}function gx(n){switch(n.tag){case 26:case 27:case 5:return gr(n.type);case 16:return gr("Lazy");case 13:return gr("Suspense");case 19:return gr("SuspenseList");case 0:case 15:return gc(n.type,!1);case 11:return gc(n.type.render,!1);case 1:return gc(n.type,!0);case 31:return gr("Activity");default:return""}}function Yg(n){try{var a="";do a+=gx(n),n=n.return;while(n);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function xi(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function jg(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function mx(n){var a=jg(n)?"checked":"value",c=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),g=""+n[a];if(!n.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,T=c.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return p.call(this)},set:function(L){g=""+L,T.call(this,L)}}),Object.defineProperty(n,a,{enumerable:c.enumerable}),{getValue:function(){return g},setValue:function(L){g=""+L},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function Jl(n){n._valueTracker||(n._valueTracker=mx(n))}function qg(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var c=a.getValue(),g="";return n&&(g=jg(n)?n.checked?"true":"false":n.value),n=g,n!==c?(a.setValue(n),!0):!1}function eo(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var px=/[\n"\\]/g;function _i(n){return n.replace(px,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function mc(n,a,c,g,p,T,L,w){n.name="",L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?n.type=L:n.removeAttribute("type"),a!=null?L==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+xi(a)):n.value!==""+xi(a)&&(n.value=""+xi(a)):L!=="submit"&&L!=="reset"||n.removeAttribute("value"),a!=null?pc(n,L,xi(a)):c!=null?pc(n,L,xi(c)):g!=null&&n.removeAttribute("value"),p==null&&T!=null&&(n.defaultChecked=!!T),p!=null&&(n.checked=p&&typeof p!="function"&&typeof p!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?n.name=""+xi(w):n.removeAttribute("name")}function Xg(n,a,c,g,p,T,L,w){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(n.type=T),a!=null||c!=null){if(!(T!=="submit"&&T!=="reset"||a!=null))return;c=c!=null?""+xi(c):"",a=a!=null?""+xi(a):c,w||a===n.value||(n.value=a),n.defaultValue=a}g=g??p,g=typeof g!="function"&&typeof g!="symbol"&&!!g,n.checked=w?n.checked:!!g,n.defaultChecked=!!g,L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(n.name=L)}function pc(n,a,c){a==="number"&&eo(n.ownerDocument)===n||n.defaultValue===""+c||(n.defaultValue=""+c)}function mr(n,a,c,g){if(n=n.options,a){a={};for(var p=0;p<c.length;p++)a["$"+c[p]]=!0;for(c=0;c<n.length;c++)p=a.hasOwnProperty("$"+n[c].value),n[c].selected!==p&&(n[c].selected=p),p&&g&&(n[c].defaultSelected=!0)}else{for(c=""+xi(c),a=null,p=0;p<n.length;p++){if(n[p].value===c){n[p].selected=!0,g&&(n[p].defaultSelected=!0);return}a!==null||n[p].disabled||(a=n[p])}a!==null&&(a.selected=!0)}}function Qg(n,a,c){if(a!=null&&(a=""+xi(a),a!==n.value&&(n.value=a),c==null)){n.defaultValue!==a&&(n.defaultValue=a);return}n.defaultValue=c!=null?""+xi(c):""}function Wg(n,a,c,g){if(a==null){if(g!=null){if(c!=null)throw Error(i(92));if(te(g)){if(1<g.length)throw Error(i(93));g=g[0]}c=g}c==null&&(c=""),a=c}c=xi(a),n.defaultValue=c,g=n.textContent,g===c&&g!==""&&g!==null&&(n.value=g)}function pr(n,a){if(a){var c=n.firstChild;if(c&&c===n.lastChild&&c.nodeType===3){c.nodeValue=a;return}}n.textContent=a}var vx=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zg(n,a,c){var g=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?g?n.setProperty(a,""):a==="float"?n.cssFloat="":n[a]="":g?n.setProperty(a,c):typeof c!="number"||c===0||vx.has(a)?a==="float"?n.cssFloat=c:n[a]=(""+c).trim():n[a]=c+"px"}function Jg(n,a,c){if(a!=null&&typeof a!="object")throw Error(i(62));if(n=n.style,c!=null){for(var g in c)!c.hasOwnProperty(g)||a!=null&&a.hasOwnProperty(g)||(g.indexOf("--")===0?n.setProperty(g,""):g==="float"?n.cssFloat="":n[g]="");for(var p in a)g=a[p],a.hasOwnProperty(p)&&c[p]!==g&&Zg(n,p,g)}else for(var T in a)a.hasOwnProperty(T)&&Zg(n,T,a[T])}function vc(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yx=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Sx=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function to(n){return Sx.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var yc=null;function Sc(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var vr=null,yr=null;function em(n){var a=fr(n);if(a&&(n=a.stateNode)){var c=n[Yt]||null;e:switch(n=a.stateNode,a.type){case"input":if(mc(n,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=n;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+_i(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var g=c[a];if(g!==n&&g.form===n.form){var p=g[Yt]||null;if(!p)throw Error(i(90));mc(g,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(a=0;a<c.length;a++)g=c[a],g.form===n.form&&qg(g)}break e;case"textarea":Qg(n,c.value,c.defaultValue);break e;case"select":a=c.value,a!=null&&mr(n,!!c.multiple,a,!1)}}}var Tc=!1;function tm(n,a,c){if(Tc)return n(a,c);Tc=!0;try{var g=n(a);return g}finally{if(Tc=!1,(vr!==null||yr!==null)&&($o(),vr&&(a=vr,n=yr,yr=vr=null,em(a),n)))for(a=0;a<n.length;a++)em(n[a])}}function Aa(n,a){var c=n.stateNode;if(c===null)return null;var g=c[Yt]||null;if(g===null)return null;c=g[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(n=n.type,g=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!g;break e;default:n=!1}if(n)return null;if(c&&typeof c!="function")throw Error(i(231,a,typeof c));return c}var gs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ec=!1;if(gs)try{var La={};Object.defineProperty(La,"passive",{get:function(){Ec=!0}}),window.addEventListener("test",La,La),window.removeEventListener("test",La,La)}catch{Ec=!1}var Us=null,xc=null,io=null;function im(){if(io)return io;var n,a=xc,c=a.length,g,p="value"in Us?Us.value:Us.textContent,T=p.length;for(n=0;n<c&&a[n]===p[n];n++);var L=c-n;for(g=1;g<=L&&a[c-g]===p[T-g];g++);return io=p.slice(n,1<g?1-g:void 0)}function so(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function no(){return!0}function sm(){return!1}function jt(n){function a(c,g,p,T,L){this._reactName=c,this._targetInst=p,this.type=g,this.nativeEvent=T,this.target=L,this.currentTarget=null;for(var w in n)n.hasOwnProperty(w)&&(c=n[w],this[w]=c?c(T):T[w]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?no:sm,this.isPropagationStopped=sm,this}return h(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=no)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=no)},persist:function(){},isPersistent:no}),a}var Dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ro=jt(Dn),Ra=h({},Dn,{view:0,detail:0}),Tx=jt(Ra),_c,bc,Da,ao=h({},Ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Da&&(Da&&n.type==="mousemove"?(_c=n.screenX-Da.screenX,bc=n.screenY-Da.screenY):bc=_c=0,Da=n),_c)},movementY:function(n){return"movementY"in n?n.movementY:bc}}),nm=jt(ao),Ex=h({},ao,{dataTransfer:0}),xx=jt(Ex),_x=h({},Ra,{relatedTarget:0}),Ac=jt(_x),bx=h({},Dn,{animationName:0,elapsedTime:0,pseudoElement:0}),Ax=jt(bx),Lx=h({},Dn,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Rx=jt(Lx),Dx=h({},Dn,{data:0}),rm=jt(Dx),Ix={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ox(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=Cx[n])?!!a[n]:!1}function Lc(){return Ox}var Mx=h({},Ra,{key:function(n){if(n.key){var a=Ix[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=so(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?wx[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lc,charCode:function(n){return n.type==="keypress"?so(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?so(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Px=jt(Mx),kx=h({},ao,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),am=jt(kx),Nx=h({},Ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lc}),Bx=jt(Nx),Fx=h({},Dn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ux=jt(Fx),Gx=h({},ao,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),$x=jt(Gx),zx=h({},Dn,{newState:0,oldState:0}),Hx=jt(zx),Vx=[9,13,27,32],Rc=gs&&"CompositionEvent"in window,Ia=null;gs&&"documentMode"in document&&(Ia=document.documentMode);var Kx=gs&&"TextEvent"in window&&!Ia,lm=gs&&(!Rc||Ia&&8<Ia&&11>=Ia),om=" ",um=!1;function cm(n,a){switch(n){case"keyup":return Vx.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fm(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Sr=!1;function Yx(n,a){switch(n){case"compositionend":return fm(a);case"keypress":return a.which!==32?null:(um=!0,om);case"textInput":return n=a.data,n===om&&um?null:n;default:return null}}function jx(n,a){if(Sr)return n==="compositionend"||!Rc&&cm(n,a)?(n=im(),io=xc=Us=null,Sr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return lm&&a.locale!=="ko"?null:a.data;default:return null}}var qx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dm(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!qx[n.type]:a==="textarea"}function hm(n,a,c,g){vr?yr?yr.push(g):yr=[g]:vr=g,a=jo(a,"onChange"),0<a.length&&(c=new ro("onChange","change",null,c,g),n.push({event:c,listeners:a}))}var wa=null,Ca=null;function Xx(n){jp(n,0)}function lo(n){var a=ba(n);if(qg(a))return n}function gm(n,a){if(n==="change")return a}var mm=!1;if(gs){var Dc;if(gs){var Ic="oninput"in document;if(!Ic){var pm=document.createElement("div");pm.setAttribute("oninput","return;"),Ic=typeof pm.oninput=="function"}Dc=Ic}else Dc=!1;mm=Dc&&(!document.documentMode||9<document.documentMode)}function vm(){wa&&(wa.detachEvent("onpropertychange",ym),Ca=wa=null)}function ym(n){if(n.propertyName==="value"&&lo(Ca)){var a=[];hm(a,Ca,n,Sc(n)),tm(Xx,a)}}function Qx(n,a,c){n==="focusin"?(vm(),wa=a,Ca=c,wa.attachEvent("onpropertychange",ym)):n==="focusout"&&vm()}function Wx(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return lo(Ca)}function Zx(n,a){if(n==="click")return lo(a)}function Jx(n,a){if(n==="input"||n==="change")return lo(a)}function e_(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var ni=typeof Object.is=="function"?Object.is:e_;function Oa(n,a){if(ni(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var c=Object.keys(n),g=Object.keys(a);if(c.length!==g.length)return!1;for(g=0;g<c.length;g++){var p=c[g];if(!Sa.call(a,p)||!ni(n[p],a[p]))return!1}return!0}function Sm(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Tm(n,a){var c=Sm(n);n=0;for(var g;c;){if(c.nodeType===3){if(g=n+c.textContent.length,n<=a&&g>=a)return{node:c,offset:a-n};n=g}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Sm(c)}}function Em(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?Em(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function xm(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var a=eo(n.document);a instanceof n.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)n=a.contentWindow;else break;a=eo(n.document)}return a}function wc(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}var t_=gs&&"documentMode"in document&&11>=document.documentMode,Tr=null,Cc=null,Ma=null,Oc=!1;function _m(n,a,c){var g=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Oc||Tr==null||Tr!==eo(g)||(g=Tr,"selectionStart"in g&&wc(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Ma&&Oa(Ma,g)||(Ma=g,g=jo(Cc,"onSelect"),0<g.length&&(a=new ro("onSelect","select",null,a,c),n.push({event:a,listeners:g}),a.target=Tr)))}function In(n,a){var c={};return c[n.toLowerCase()]=a.toLowerCase(),c["Webkit"+n]="webkit"+a,c["Moz"+n]="moz"+a,c}var Er={animationend:In("Animation","AnimationEnd"),animationiteration:In("Animation","AnimationIteration"),animationstart:In("Animation","AnimationStart"),transitionrun:In("Transition","TransitionRun"),transitionstart:In("Transition","TransitionStart"),transitioncancel:In("Transition","TransitionCancel"),transitionend:In("Transition","TransitionEnd")},Mc={},bm={};gs&&(bm=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);function wn(n){if(Mc[n])return Mc[n];if(!Er[n])return n;var a=Er[n],c;for(c in a)if(a.hasOwnProperty(c)&&c in bm)return Mc[n]=a[c];return n}var Am=wn("animationend"),Lm=wn("animationiteration"),Rm=wn("animationstart"),i_=wn("transitionrun"),s_=wn("transitionstart"),n_=wn("transitioncancel"),Dm=wn("transitionend"),Im=new Map,Pc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pc.push("scrollEnd");function zi(n,a){Im.set(n,a),Rn(a,[n])}var wm=new WeakMap;function bi(n,a){if(typeof n=="object"&&n!==null){var c=wm.get(n);return c!==void 0?c:(a={value:n,source:a,stack:Yg(a)},wm.set(n,a),a)}return{value:n,source:a,stack:Yg(a)}}var Ai=[],xr=0,kc=0;function oo(){for(var n=xr,a=kc=xr=0;a<n;){var c=Ai[a];Ai[a++]=null;var g=Ai[a];Ai[a++]=null;var p=Ai[a];Ai[a++]=null;var T=Ai[a];if(Ai[a++]=null,g!==null&&p!==null){var L=g.pending;L===null?p.next=p:(p.next=L.next,L.next=p),g.pending=p}T!==0&&Cm(c,p,T)}}function uo(n,a,c,g){Ai[xr++]=n,Ai[xr++]=a,Ai[xr++]=c,Ai[xr++]=g,kc|=g,n.lanes|=g,n=n.alternate,n!==null&&(n.lanes|=g)}function Nc(n,a,c,g){return uo(n,a,c,g),co(n)}function _r(n,a){return uo(n,null,null,a),co(n)}function Cm(n,a,c){n.lanes|=c;var g=n.alternate;g!==null&&(g.lanes|=c);for(var p=!1,T=n.return;T!==null;)T.childLanes|=c,g=T.alternate,g!==null&&(g.childLanes|=c),T.tag===22&&(n=T.stateNode,n===null||n._visibility&1||(p=!0)),n=T,T=T.return;return n.tag===3?(T=n.stateNode,p&&a!==null&&(p=31-Pt(c),n=T.hiddenUpdates,g=n[p],g===null?n[p]=[a]:g.push(a),a.lane=c|536870912),T):null}function co(n){if(50<nl)throw nl=0,Hf=null,Error(i(185));for(var a=n.return;a!==null;)n=a,a=n.return;return n.tag===3?n.stateNode:null}var br={};function r_(n,a,c,g){this.tag=n,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ri(n,a,c,g){return new r_(n,a,c,g)}function Bc(n){return n=n.prototype,!(!n||!n.isReactComponent)}function ms(n,a){var c=n.alternate;return c===null?(c=ri(n.tag,a,n.key,n.mode),c.elementType=n.elementType,c.type=n.type,c.stateNode=n.stateNode,c.alternate=n,n.alternate=c):(c.pendingProps=a,c.type=n.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=n.flags&65011712,c.childLanes=n.childLanes,c.lanes=n.lanes,c.child=n.child,c.memoizedProps=n.memoizedProps,c.memoizedState=n.memoizedState,c.updateQueue=n.updateQueue,a=n.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=n.sibling,c.index=n.index,c.ref=n.ref,c.refCleanup=n.refCleanup,c}function Om(n,a){n.flags&=65011714;var c=n.alternate;return c===null?(n.childLanes=0,n.lanes=a,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=c.childLanes,n.lanes=c.lanes,n.child=c.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=c.memoizedProps,n.memoizedState=c.memoizedState,n.updateQueue=c.updateQueue,n.type=c.type,a=c.dependencies,n.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),n}function fo(n,a,c,g,p,T){var L=0;if(g=n,typeof n=="function")Bc(n)&&(L=1);else if(typeof n=="string")L=l1(n,c,fe.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case O:return n=ri(31,c,a,p),n.elementType=O,n.lanes=T,n;case S:return Cn(c.children,p,T,a);case E:L=8,p|=24;break;case x:return n=ri(12,c,a,p|2),n.elementType=x,n.lanes=T,n;case D:return n=ri(13,c,a,p),n.elementType=D,n.lanes=T,n;case N:return n=ri(19,c,a,p),n.elementType=N,n.lanes=T,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case _:case A:L=10;break e;case R:L=9;break e;case I:L=11;break e;case C:L=14;break e;case M:L=16,g=null;break e}L=29,c=Error(i(130,n===null?"null":typeof n,"")),g=null}return a=ri(L,c,a,p),a.elementType=n,a.type=g,a.lanes=T,a}function Cn(n,a,c,g){return n=ri(7,n,g,a),n.lanes=c,n}function Fc(n,a,c){return n=ri(6,n,null,a),n.lanes=c,n}function Uc(n,a,c){return a=ri(4,n.children!==null?n.children:[],n.key,a),a.lanes=c,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}var Ar=[],Lr=0,ho=null,go=0,Li=[],Ri=0,On=null,ps=1,vs="";function Mn(n,a){Ar[Lr++]=go,Ar[Lr++]=ho,ho=n,go=a}function Mm(n,a,c){Li[Ri++]=ps,Li[Ri++]=vs,Li[Ri++]=On,On=n;var g=ps;n=vs;var p=32-Pt(g)-1;g&=~(1<<p),c+=1;var T=32-Pt(a)+p;if(30<T){var L=p-p%5;T=(g&(1<<L)-1).toString(32),g>>=L,p-=L,ps=1<<32-Pt(a)+p|c<<p|g,vs=T+n}else ps=1<<T|c<<p|g,vs=n}function Gc(n){n.return!==null&&(Mn(n,1),Mm(n,1,0))}function $c(n){for(;n===ho;)ho=Ar[--Lr],Ar[Lr]=null,go=Ar[--Lr],Ar[Lr]=null;for(;n===On;)On=Li[--Ri],Li[Ri]=null,vs=Li[--Ri],Li[Ri]=null,ps=Li[--Ri],Li[Ri]=null}var $t=null,rt=null,Be=!1,Pn=null,Wi=!1,zc=Error(i(519));function kn(n){var a=Error(i(418,""));throw Na(bi(a,n)),zc}function Pm(n){var a=n.stateNode,c=n.type,g=n.memoizedProps;switch(a[kt]=n,a[Yt]=g,c){case"dialog":Ce("cancel",a),Ce("close",a);break;case"iframe":case"object":case"embed":Ce("load",a);break;case"video":case"audio":for(c=0;c<al.length;c++)Ce(al[c],a);break;case"source":Ce("error",a);break;case"img":case"image":case"link":Ce("error",a),Ce("load",a);break;case"details":Ce("toggle",a);break;case"input":Ce("invalid",a),Xg(a,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0),Jl(a);break;case"select":Ce("invalid",a);break;case"textarea":Ce("invalid",a),Wg(a,g.value,g.defaultValue,g.children),Jl(a)}c=g.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||g.suppressHydrationWarning===!0||Wp(a.textContent,c)?(g.popover!=null&&(Ce("beforetoggle",a),Ce("toggle",a)),g.onScroll!=null&&Ce("scroll",a),g.onScrollEnd!=null&&Ce("scrollend",a),g.onClick!=null&&(a.onclick=qo),a=!0):a=!1,a||kn(n)}function km(n){for($t=n.return;$t;)switch($t.tag){case 5:case 13:Wi=!1;return;case 27:case 3:Wi=!0;return;default:$t=$t.return}}function Pa(n){if(n!==$t)return!1;if(!Be)return km(n),Be=!0,!1;var a=n.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=n.type,c=!(c!=="form"&&c!=="button")||rd(n.type,n.memoizedProps)),c=!c),c&&rt&&kn(n),km(n),a===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8)if(c=n.data,c==="/$"){if(a===0){rt=Vi(n.nextSibling);break e}a--}else c!=="$"&&c!=="$!"&&c!=="$?"||a++;n=n.nextSibling}rt=null}}else a===27?(a=rt,tn(n.type)?(n=ud,ud=null,rt=n):rt=a):rt=$t?Vi(n.stateNode.nextSibling):null;return!0}function ka(){rt=$t=null,Be=!1}function Nm(){var n=Pn;return n!==null&&(Qt===null?Qt=n:Qt.push.apply(Qt,n),Pn=null),n}function Na(n){Pn===null?Pn=[n]:Pn.push(n)}var Hc=$(null),Nn=null,ys=null;function Gs(n,a,c){ne(Hc,a._currentValue),a._currentValue=c}function Ss(n){n._currentValue=Hc.current,q(Hc)}function Vc(n,a,c){for(;n!==null;){var g=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,g!==null&&(g.childLanes|=a)):g!==null&&(g.childLanes&a)!==a&&(g.childLanes|=a),n===c)break;n=n.return}}function Kc(n,a,c,g){var p=n.child;for(p!==null&&(p.return=n);p!==null;){var T=p.dependencies;if(T!==null){var L=p.child;T=T.firstContext;e:for(;T!==null;){var w=T;T=p;for(var F=0;F<a.length;F++)if(w.context===a[F]){T.lanes|=c,w=T.alternate,w!==null&&(w.lanes|=c),Vc(T.return,c,n),g||(L=null);break e}T=w.next}}else if(p.tag===18){if(L=p.return,L===null)throw Error(i(341));L.lanes|=c,T=L.alternate,T!==null&&(T.lanes|=c),Vc(L,c,n),L=null}else L=p.child;if(L!==null)L.return=p;else for(L=p;L!==null;){if(L===n){L=null;break}if(p=L.sibling,p!==null){p.return=L.return,L=p;break}L=L.return}p=L}}function Ba(n,a,c,g){n=null;for(var p=a,T=!1;p!==null;){if(!T){if((p.flags&524288)!==0)T=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var L=p.alternate;if(L===null)throw Error(i(387));if(L=L.memoizedProps,L!==null){var w=p.type;ni(p.pendingProps.value,L.value)||(n!==null?n.push(w):n=[w])}}else if(p===ve.current){if(L=p.alternate,L===null)throw Error(i(387));L.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(n!==null?n.push(dl):n=[dl])}p=p.return}n!==null&&Kc(a,n,c,g),a.flags|=262144}function mo(n){for(n=n.firstContext;n!==null;){if(!ni(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Bn(n){Nn=n,ys=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Nt(n){return Bm(Nn,n)}function po(n,a){return Nn===null&&Bn(n),Bm(n,a)}function Bm(n,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},ys===null){if(n===null)throw Error(i(308));ys=a,n.dependencies={lanes:0,firstContext:a},n.flags|=524288}else ys=ys.next=a;return c}var a_=typeof AbortController<"u"?AbortController:function(){var n=[],a=this.signal={aborted:!1,addEventListener:function(c,g){n.push(g)}};this.abort=function(){a.aborted=!0,n.forEach(function(c){return c()})}},l_=l.unstable_scheduleCallback,o_=l.unstable_NormalPriority,vt={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yc(){return{controller:new a_,data:new Map,refCount:0}}function Fa(n){n.refCount--,n.refCount===0&&l_(o_,function(){n.controller.abort()})}var Ua=null,jc=0,Rr=0,Dr=null;function u_(n,a){if(Ua===null){var c=Ua=[];jc=0,Rr=Qf(),Dr={status:"pending",value:void 0,then:function(g){c.push(g)}}}return jc++,a.then(Fm,Fm),a}function Fm(){if(--jc===0&&Ua!==null){Dr!==null&&(Dr.status="fulfilled");var n=Ua;Ua=null,Rr=0,Dr=null;for(var a=0;a<n.length;a++)(0,n[a])()}}function c_(n,a){var c=[],g={status:"pending",value:null,reason:null,then:function(p){c.push(p)}};return n.then(function(){g.status="fulfilled",g.value=a;for(var p=0;p<c.length;p++)(0,c[p])(a)},function(p){for(g.status="rejected",g.reason=p,p=0;p<c.length;p++)(0,c[p])(void 0)}),g}var Um=B.S;B.S=function(n,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&u_(n,a),Um!==null&&Um(n,a)};var Fn=$(null);function qc(){var n=Fn.current;return n!==null?n:We.pooledCache}function vo(n,a){a===null?ne(Fn,Fn.current):ne(Fn,a.pool)}function Gm(){var n=qc();return n===null?null:{parent:vt._currentValue,pool:n}}var Ga=Error(i(460)),$m=Error(i(474)),yo=Error(i(542)),Xc={then:function(){}};function zm(n){return n=n.status,n==="fulfilled"||n==="rejected"}function So(){}function Hm(n,a,c){switch(c=n[c],c===void 0?n.push(a):c!==a&&(a.then(So,So),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,Km(n),n;default:if(typeof a.status=="string")a.then(So,So);else{if(n=We,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=a,n.status="pending",n.then(function(g){if(a.status==="pending"){var p=a;p.status="fulfilled",p.value=g}},function(g){if(a.status==="pending"){var p=a;p.status="rejected",p.reason=g}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,Km(n),n}throw $a=a,Ga}}var $a=null;function Vm(){if($a===null)throw Error(i(459));var n=$a;return $a=null,n}function Km(n){if(n===Ga||n===yo)throw Error(i(483))}var $s=!1;function Qc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wc(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function zs(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Hs(n,a,c){var g=n.updateQueue;if(g===null)return null;if(g=g.shared,(Fe&2)!==0){var p=g.pending;return p===null?a.next=a:(a.next=p.next,p.next=a),g.pending=a,a=co(n),Cm(n,null,c),a}return uo(n,g,a,c),co(n)}function za(n,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var g=a.lanes;g&=n.pendingLanes,c|=g,a.lanes=c,Fg(n,c)}}function Zc(n,a){var c=n.updateQueue,g=n.alternate;if(g!==null&&(g=g.updateQueue,c===g)){var p=null,T=null;if(c=c.firstBaseUpdate,c!==null){do{var L={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};T===null?p=T=L:T=T.next=L,c=c.next}while(c!==null);T===null?p=T=a:T=T.next=a}else p=T=a;c={baseState:g.baseState,firstBaseUpdate:p,lastBaseUpdate:T,shared:g.shared,callbacks:g.callbacks},n.updateQueue=c;return}n=c.lastBaseUpdate,n===null?c.firstBaseUpdate=a:n.next=a,c.lastBaseUpdate=a}var Jc=!1;function Ha(){if(Jc){var n=Dr;if(n!==null)throw n}}function Va(n,a,c,g){Jc=!1;var p=n.updateQueue;$s=!1;var T=p.firstBaseUpdate,L=p.lastBaseUpdate,w=p.shared.pending;if(w!==null){p.shared.pending=null;var F=w,Q=F.next;F.next=null,L===null?T=Q:L.next=Q,L=F;var ee=n.alternate;ee!==null&&(ee=ee.updateQueue,w=ee.lastBaseUpdate,w!==L&&(w===null?ee.firstBaseUpdate=Q:w.next=Q,ee.lastBaseUpdate=F))}if(T!==null){var le=p.baseState;L=0,ee=Q=F=null,w=T;do{var W=w.lane&-536870913,Z=W!==w.lane;if(Z?(Pe&W)===W:(g&W)===W){W!==0&&W===Rr&&(Jc=!0),ee!==null&&(ee=ee.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var Ee=n,Se=w;W=a;var Ve=c;switch(Se.tag){case 1:if(Ee=Se.payload,typeof Ee=="function"){le=Ee.call(Ve,le,W);break e}le=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=Se.payload,W=typeof Ee=="function"?Ee.call(Ve,le,W):Ee,W==null)break e;le=h({},le,W);break e;case 2:$s=!0}}W=w.callback,W!==null&&(n.flags|=64,Z&&(n.flags|=8192),Z=p.callbacks,Z===null?p.callbacks=[W]:Z.push(W))}else Z={lane:W,tag:w.tag,payload:w.payload,callback:w.callback,next:null},ee===null?(Q=ee=Z,F=le):ee=ee.next=Z,L|=W;if(w=w.next,w===null){if(w=p.shared.pending,w===null)break;Z=w,w=Z.next,Z.next=null,p.lastBaseUpdate=Z,p.shared.pending=null}}while(!0);ee===null&&(F=le),p.baseState=F,p.firstBaseUpdate=Q,p.lastBaseUpdate=ee,T===null&&(p.shared.lanes=0),Ws|=L,n.lanes=L,n.memoizedState=le}}function Ym(n,a){if(typeof n!="function")throw Error(i(191,n));n.call(a)}function jm(n,a){var c=n.callbacks;if(c!==null)for(n.callbacks=null,n=0;n<c.length;n++)Ym(c[n],a)}var Ir=$(null),To=$(0);function qm(n,a){n=Ls,ne(To,n),ne(Ir,a),Ls=n|a.baseLanes}function ef(){ne(To,Ls),ne(Ir,Ir.current)}function tf(){Ls=To.current,q(Ir),q(To)}var Vs=0,Le=null,ze=null,dt=null,Eo=!1,wr=!1,Un=!1,xo=0,Ka=0,Cr=null,f_=0;function ot(){throw Error(i(321))}function sf(n,a){if(a===null)return!1;for(var c=0;c<a.length&&c<n.length;c++)if(!ni(n[c],a[c]))return!1;return!0}function nf(n,a,c,g,p,T){return Vs=T,Le=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,B.H=n===null||n.memoizedState===null?C0:O0,Un=!1,T=c(g,p),Un=!1,wr&&(T=Qm(a,c,g,p)),Xm(n),T}function Xm(n){B.H=Do;var a=ze!==null&&ze.next!==null;if(Vs=0,dt=ze=Le=null,Eo=!1,Ka=0,Cr=null,a)throw Error(i(300));n===null||xt||(n=n.dependencies,n!==null&&mo(n)&&(xt=!0))}function Qm(n,a,c,g){Le=n;var p=0;do{if(wr&&(Cr=null),Ka=0,wr=!1,25<=p)throw Error(i(301));if(p+=1,dt=ze=null,n.updateQueue!=null){var T=n.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}B.H=y_,T=a(c,g)}while(wr);return T}function d_(){var n=B.H,a=n.useState()[0];return a=typeof a.then=="function"?Ya(a):a,n=n.useState()[0],(ze!==null?ze.memoizedState:null)!==n&&(Le.flags|=1024),a}function rf(){var n=xo!==0;return xo=0,n}function af(n,a,c){a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~c}function lf(n){if(Eo){for(n=n.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Eo=!1}Vs=0,dt=ze=Le=null,wr=!1,Ka=xo=0,Cr=null}function qt(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?Le.memoizedState=dt=n:dt=dt.next=n,dt}function ht(){if(ze===null){var n=Le.alternate;n=n!==null?n.memoizedState:null}else n=ze.next;var a=dt===null?Le.memoizedState:dt.next;if(a!==null)dt=a,ze=n;else{if(n===null)throw Le.alternate===null?Error(i(467)):Error(i(310));ze=n,n={memoizedState:ze.memoizedState,baseState:ze.baseState,baseQueue:ze.baseQueue,queue:ze.queue,next:null},dt===null?Le.memoizedState=dt=n:dt=dt.next=n}return dt}function of(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ya(n){var a=Ka;return Ka+=1,Cr===null&&(Cr=[]),n=Hm(Cr,n,a),a=Le,(dt===null?a.memoizedState:dt.next)===null&&(a=a.alternate,B.H=a===null||a.memoizedState===null?C0:O0),n}function _o(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Ya(n);if(n.$$typeof===A)return Nt(n)}throw Error(i(438,String(n)))}function uf(n){var a=null,c=Le.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var g=Le.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(a={data:g.data.map(function(p){return p.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=of(),Le.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(n),g=0;g<n;g++)c[g]=P;return a.index++,c}function Ts(n,a){return typeof a=="function"?a(n):a}function bo(n){var a=ht();return cf(a,ze,n)}function cf(n,a,c){var g=n.queue;if(g===null)throw Error(i(311));g.lastRenderedReducer=c;var p=n.baseQueue,T=g.pending;if(T!==null){if(p!==null){var L=p.next;p.next=T.next,T.next=L}a.baseQueue=p=T,g.pending=null}if(T=n.baseState,p===null)n.memoizedState=T;else{a=p.next;var w=L=null,F=null,Q=a,ee=!1;do{var le=Q.lane&-536870913;if(le!==Q.lane?(Pe&le)===le:(Vs&le)===le){var W=Q.revertLane;if(W===0)F!==null&&(F=F.next={lane:0,revertLane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),le===Rr&&(ee=!0);else if((Vs&W)===W){Q=Q.next,W===Rr&&(ee=!0);continue}else le={lane:0,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},F===null?(w=F=le,L=T):F=F.next=le,Le.lanes|=W,Ws|=W;le=Q.action,Un&&c(T,le),T=Q.hasEagerState?Q.eagerState:c(T,le)}else W={lane:le,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},F===null?(w=F=W,L=T):F=F.next=W,Le.lanes|=le,Ws|=le;Q=Q.next}while(Q!==null&&Q!==a);if(F===null?L=T:F.next=w,!ni(T,n.memoizedState)&&(xt=!0,ee&&(c=Dr,c!==null)))throw c;n.memoizedState=T,n.baseState=L,n.baseQueue=F,g.lastRenderedState=T}return p===null&&(g.lanes=0),[n.memoizedState,g.dispatch]}function ff(n){var a=ht(),c=a.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=n;var g=c.dispatch,p=c.pending,T=a.memoizedState;if(p!==null){c.pending=null;var L=p=p.next;do T=n(T,L.action),L=L.next;while(L!==p);ni(T,a.memoizedState)||(xt=!0),a.memoizedState=T,a.baseQueue===null&&(a.baseState=T),c.lastRenderedState=T}return[T,g]}function Wm(n,a,c){var g=Le,p=ht(),T=Be;if(T){if(c===void 0)throw Error(i(407));c=c()}else c=a();var L=!ni((ze||p).memoizedState,c);L&&(p.memoizedState=c,xt=!0),p=p.queue;var w=e0.bind(null,g,p,n);if(ja(2048,8,w,[n]),p.getSnapshot!==a||L||dt!==null&&dt.memoizedState.tag&1){if(g.flags|=2048,Or(9,Ao(),Jm.bind(null,g,p,c,a),null),We===null)throw Error(i(349));T||(Vs&124)!==0||Zm(g,a,c)}return c}function Zm(n,a,c){n.flags|=16384,n={getSnapshot:a,value:c},a=Le.updateQueue,a===null?(a=of(),Le.updateQueue=a,a.stores=[n]):(c=a.stores,c===null?a.stores=[n]:c.push(n))}function Jm(n,a,c,g){a.value=c,a.getSnapshot=g,t0(a)&&i0(n)}function e0(n,a,c){return c(function(){t0(a)&&i0(n)})}function t0(n){var a=n.getSnapshot;n=n.value;try{var c=a();return!ni(n,c)}catch{return!0}}function i0(n){var a=_r(n,2);a!==null&&ci(a,n,2)}function df(n){var a=qt();if(typeof n=="function"){var c=n;if(n=c(),Un){Qi(!0);try{c()}finally{Qi(!1)}}}return a.memoizedState=a.baseState=n,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ts,lastRenderedState:n},a}function s0(n,a,c,g){return n.baseState=c,cf(n,ze,typeof g=="function"?g:Ts)}function h_(n,a,c,g,p){if(Ro(n))throw Error(i(485));if(n=a.action,n!==null){var T={payload:p,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(L){T.listeners.push(L)}};B.T!==null?c(!0):T.isTransition=!1,g(T),c=a.pending,c===null?(T.next=a.pending=T,n0(a,T)):(T.next=c.next,a.pending=c.next=T)}}function n0(n,a){var c=a.action,g=a.payload,p=n.state;if(a.isTransition){var T=B.T,L={};B.T=L;try{var w=c(p,g),F=B.S;F!==null&&F(L,w),r0(n,a,w)}catch(Q){hf(n,a,Q)}finally{B.T=T}}else try{T=c(p,g),r0(n,a,T)}catch(Q){hf(n,a,Q)}}function r0(n,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(g){a0(n,a,g)},function(g){return hf(n,a,g)}):a0(n,a,c)}function a0(n,a,c){a.status="fulfilled",a.value=c,l0(a),n.state=c,a=n.pending,a!==null&&(c=a.next,c===a?n.pending=null:(c=c.next,a.next=c,n0(n,c)))}function hf(n,a,c){var g=n.pending;if(n.pending=null,g!==null){g=g.next;do a.status="rejected",a.reason=c,l0(a),a=a.next;while(a!==g)}n.action=null}function l0(n){n=n.listeners;for(var a=0;a<n.length;a++)(0,n[a])()}function o0(n,a){return a}function u0(n,a){if(Be){var c=We.formState;if(c!==null){e:{var g=Le;if(Be){if(rt){t:{for(var p=rt,T=Wi;p.nodeType!==8;){if(!T){p=null;break t}if(p=Vi(p.nextSibling),p===null){p=null;break t}}T=p.data,p=T==="F!"||T==="F"?p:null}if(p){rt=Vi(p.nextSibling),g=p.data==="F!";break e}}kn(g)}g=!1}g&&(a=c[0])}}return c=qt(),c.memoizedState=c.baseState=a,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o0,lastRenderedState:a},c.queue=g,c=D0.bind(null,Le,g),g.dispatch=c,g=df(!1),T=yf.bind(null,Le,!1,g.queue),g=qt(),p={state:a,dispatch:null,action:n,pending:null},g.queue=p,c=h_.bind(null,Le,p,T,c),p.dispatch=c,g.memoizedState=n,[a,c,!1]}function c0(n){var a=ht();return f0(a,ze,n)}function f0(n,a,c){if(a=cf(n,a,o0)[0],n=bo(Ts)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var g=Ya(a)}catch(L){throw L===Ga?yo:L}else g=a;a=ht();var p=a.queue,T=p.dispatch;return c!==a.memoizedState&&(Le.flags|=2048,Or(9,Ao(),g_.bind(null,p,c),null)),[g,T,n]}function g_(n,a){n.action=a}function d0(n){var a=ht(),c=ze;if(c!==null)return f0(a,c,n);ht(),a=a.memoizedState,c=ht();var g=c.queue.dispatch;return c.memoizedState=n,[a,g,!1]}function Or(n,a,c,g){return n={tag:n,create:c,deps:g,inst:a,next:null},a=Le.updateQueue,a===null&&(a=of(),Le.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=n.next=n:(g=c.next,c.next=n,n.next=g,a.lastEffect=n),n}function Ao(){return{destroy:void 0,resource:void 0}}function h0(){return ht().memoizedState}function Lo(n,a,c,g){var p=qt();g=g===void 0?null:g,Le.flags|=n,p.memoizedState=Or(1|a,Ao(),c,g)}function ja(n,a,c,g){var p=ht();g=g===void 0?null:g;var T=p.memoizedState.inst;ze!==null&&g!==null&&sf(g,ze.memoizedState.deps)?p.memoizedState=Or(a,T,c,g):(Le.flags|=n,p.memoizedState=Or(1|a,T,c,g))}function g0(n,a){Lo(8390656,8,n,a)}function m0(n,a){ja(2048,8,n,a)}function p0(n,a){return ja(4,2,n,a)}function v0(n,a){return ja(4,4,n,a)}function y0(n,a){if(typeof a=="function"){n=n();var c=a(n);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function S0(n,a,c){c=c!=null?c.concat([n]):null,ja(4,4,y0.bind(null,a,n),c)}function gf(){}function T0(n,a){var c=ht();a=a===void 0?null:a;var g=c.memoizedState;return a!==null&&sf(a,g[1])?g[0]:(c.memoizedState=[n,a],n)}function E0(n,a){var c=ht();a=a===void 0?null:a;var g=c.memoizedState;if(a!==null&&sf(a,g[1]))return g[0];if(g=n(),Un){Qi(!0);try{n()}finally{Qi(!1)}}return c.memoizedState=[g,a],g}function mf(n,a,c){return c===void 0||(Vs&1073741824)!==0?n.memoizedState=a:(n.memoizedState=c,n=bp(),Le.lanes|=n,Ws|=n,c)}function x0(n,a,c,g){return ni(c,a)?c:Ir.current!==null?(n=mf(n,c,g),ni(n,a)||(xt=!0),n):(Vs&42)===0?(xt=!0,n.memoizedState=c):(n=bp(),Le.lanes|=n,Ws|=n,a)}function _0(n,a,c,g,p){var T=K.p;K.p=T!==0&&8>T?T:8;var L=B.T,w={};B.T=w,yf(n,!1,a,c);try{var F=p(),Q=B.S;if(Q!==null&&Q(w,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var ee=c_(F,g);qa(n,a,ee,ui(n))}else qa(n,a,g,ui(n))}catch(le){qa(n,a,{then:function(){},status:"rejected",reason:le},ui())}finally{K.p=T,B.T=L}}function m_(){}function pf(n,a,c,g){if(n.tag!==5)throw Error(i(476));var p=b0(n).queue;_0(n,p,a,j,c===null?m_:function(){return A0(n),c(g)})}function b0(n){var a=n.memoizedState;if(a!==null)return a;a={memoizedState:j,baseState:j,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ts,lastRenderedState:j},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ts,lastRenderedState:c},next:null},n.memoizedState=a,n=n.alternate,n!==null&&(n.memoizedState=a),a}function A0(n){var a=b0(n).next.queue;qa(n,a,{},ui())}function vf(){return Nt(dl)}function L0(){return ht().memoizedState}function R0(){return ht().memoizedState}function p_(n){for(var a=n.return;a!==null;){switch(a.tag){case 24:case 3:var c=ui();n=zs(c);var g=Hs(a,n,c);g!==null&&(ci(g,a,c),za(g,a,c)),a={cache:Yc()},n.payload=a;return}a=a.return}}function v_(n,a,c){var g=ui();c={lane:g,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Ro(n)?I0(a,c):(c=Nc(n,a,c,g),c!==null&&(ci(c,n,g),w0(c,a,g)))}function D0(n,a,c){var g=ui();qa(n,a,c,g)}function qa(n,a,c,g){var p={lane:g,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Ro(n))I0(a,p);else{var T=n.alternate;if(n.lanes===0&&(T===null||T.lanes===0)&&(T=a.lastRenderedReducer,T!==null))try{var L=a.lastRenderedState,w=T(L,c);if(p.hasEagerState=!0,p.eagerState=w,ni(w,L))return uo(n,a,p,0),We===null&&oo(),!1}catch{}finally{}if(c=Nc(n,a,p,g),c!==null)return ci(c,n,g),w0(c,a,g),!0}return!1}function yf(n,a,c,g){if(g={lane:2,revertLane:Qf(),action:g,hasEagerState:!1,eagerState:null,next:null},Ro(n)){if(a)throw Error(i(479))}else a=Nc(n,c,g,2),a!==null&&ci(a,n,2)}function Ro(n){var a=n.alternate;return n===Le||a!==null&&a===Le}function I0(n,a){wr=Eo=!0;var c=n.pending;c===null?a.next=a:(a.next=c.next,c.next=a),n.pending=a}function w0(n,a,c){if((c&4194048)!==0){var g=a.lanes;g&=n.pendingLanes,c|=g,a.lanes=c,Fg(n,c)}}var Do={readContext:Nt,use:_o,useCallback:ot,useContext:ot,useEffect:ot,useImperativeHandle:ot,useLayoutEffect:ot,useInsertionEffect:ot,useMemo:ot,useReducer:ot,useRef:ot,useState:ot,useDebugValue:ot,useDeferredValue:ot,useTransition:ot,useSyncExternalStore:ot,useId:ot,useHostTransitionStatus:ot,useFormState:ot,useActionState:ot,useOptimistic:ot,useMemoCache:ot,useCacheRefresh:ot},C0={readContext:Nt,use:_o,useCallback:function(n,a){return qt().memoizedState=[n,a===void 0?null:a],n},useContext:Nt,useEffect:g0,useImperativeHandle:function(n,a,c){c=c!=null?c.concat([n]):null,Lo(4194308,4,y0.bind(null,a,n),c)},useLayoutEffect:function(n,a){return Lo(4194308,4,n,a)},useInsertionEffect:function(n,a){Lo(4,2,n,a)},useMemo:function(n,a){var c=qt();a=a===void 0?null:a;var g=n();if(Un){Qi(!0);try{n()}finally{Qi(!1)}}return c.memoizedState=[g,a],g},useReducer:function(n,a,c){var g=qt();if(c!==void 0){var p=c(a);if(Un){Qi(!0);try{c(a)}finally{Qi(!1)}}}else p=a;return g.memoizedState=g.baseState=p,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:p},g.queue=n,n=n.dispatch=v_.bind(null,Le,n),[g.memoizedState,n]},useRef:function(n){var a=qt();return n={current:n},a.memoizedState=n},useState:function(n){n=df(n);var a=n.queue,c=D0.bind(null,Le,a);return a.dispatch=c,[n.memoizedState,c]},useDebugValue:gf,useDeferredValue:function(n,a){var c=qt();return mf(c,n,a)},useTransition:function(){var n=df(!1);return n=_0.bind(null,Le,n.queue,!0,!1),qt().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,a,c){var g=Le,p=qt();if(Be){if(c===void 0)throw Error(i(407));c=c()}else{if(c=a(),We===null)throw Error(i(349));(Pe&124)!==0||Zm(g,a,c)}p.memoizedState=c;var T={value:c,getSnapshot:a};return p.queue=T,g0(e0.bind(null,g,T,n),[n]),g.flags|=2048,Or(9,Ao(),Jm.bind(null,g,T,c,a),null),c},useId:function(){var n=qt(),a=We.identifierPrefix;if(Be){var c=vs,g=ps;c=(g&~(1<<32-Pt(g)-1)).toString(32)+c,a=""+a+"R"+c,c=xo++,0<c&&(a+="H"+c.toString(32)),a+=""}else c=f_++,a=""+a+"r"+c.toString(32)+"";return n.memoizedState=a},useHostTransitionStatus:vf,useFormState:u0,useActionState:u0,useOptimistic:function(n){var a=qt();a.memoizedState=a.baseState=n;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=yf.bind(null,Le,!0,c),c.dispatch=a,[n,a]},useMemoCache:uf,useCacheRefresh:function(){return qt().memoizedState=p_.bind(null,Le)}},O0={readContext:Nt,use:_o,useCallback:T0,useContext:Nt,useEffect:m0,useImperativeHandle:S0,useInsertionEffect:p0,useLayoutEffect:v0,useMemo:E0,useReducer:bo,useRef:h0,useState:function(){return bo(Ts)},useDebugValue:gf,useDeferredValue:function(n,a){var c=ht();return x0(c,ze.memoizedState,n,a)},useTransition:function(){var n=bo(Ts)[0],a=ht().memoizedState;return[typeof n=="boolean"?n:Ya(n),a]},useSyncExternalStore:Wm,useId:L0,useHostTransitionStatus:vf,useFormState:c0,useActionState:c0,useOptimistic:function(n,a){var c=ht();return s0(c,ze,n,a)},useMemoCache:uf,useCacheRefresh:R0},y_={readContext:Nt,use:_o,useCallback:T0,useContext:Nt,useEffect:m0,useImperativeHandle:S0,useInsertionEffect:p0,useLayoutEffect:v0,useMemo:E0,useReducer:ff,useRef:h0,useState:function(){return ff(Ts)},useDebugValue:gf,useDeferredValue:function(n,a){var c=ht();return ze===null?mf(c,n,a):x0(c,ze.memoizedState,n,a)},useTransition:function(){var n=ff(Ts)[0],a=ht().memoizedState;return[typeof n=="boolean"?n:Ya(n),a]},useSyncExternalStore:Wm,useId:L0,useHostTransitionStatus:vf,useFormState:d0,useActionState:d0,useOptimistic:function(n,a){var c=ht();return ze!==null?s0(c,ze,n,a):(c.baseState=n,[n,c.queue.dispatch])},useMemoCache:uf,useCacheRefresh:R0},Mr=null,Xa=0;function Io(n){var a=Xa;return Xa+=1,Mr===null&&(Mr=[]),Hm(Mr,n,a)}function Qa(n,a){a=a.props.ref,n.ref=a!==void 0?a:null}function wo(n,a){throw a.$$typeof===m?Error(i(525)):(n=Object.prototype.toString.call(a),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n)))}function M0(n){var a=n._init;return a(n._payload)}function P0(n){function a(z,G){if(n){var Y=z.deletions;Y===null?(z.deletions=[G],z.flags|=16):Y.push(G)}}function c(z,G){if(!n)return null;for(;G!==null;)a(z,G),G=G.sibling;return null}function g(z){for(var G=new Map;z!==null;)z.key!==null?G.set(z.key,z):G.set(z.index,z),z=z.sibling;return G}function p(z,G){return z=ms(z,G),z.index=0,z.sibling=null,z}function T(z,G,Y){return z.index=Y,n?(Y=z.alternate,Y!==null?(Y=Y.index,Y<G?(z.flags|=67108866,G):Y):(z.flags|=67108866,G)):(z.flags|=1048576,G)}function L(z){return n&&z.alternate===null&&(z.flags|=67108866),z}function w(z,G,Y,ae){return G===null||G.tag!==6?(G=Fc(Y,z.mode,ae),G.return=z,G):(G=p(G,Y),G.return=z,G)}function F(z,G,Y,ae){var me=Y.type;return me===S?ee(z,G,Y.props.children,ae,Y.key):G!==null&&(G.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===M&&M0(me)===G.type)?(G=p(G,Y.props),Qa(G,Y),G.return=z,G):(G=fo(Y.type,Y.key,Y.props,null,z.mode,ae),Qa(G,Y),G.return=z,G)}function Q(z,G,Y,ae){return G===null||G.tag!==4||G.stateNode.containerInfo!==Y.containerInfo||G.stateNode.implementation!==Y.implementation?(G=Uc(Y,z.mode,ae),G.return=z,G):(G=p(G,Y.children||[]),G.return=z,G)}function ee(z,G,Y,ae,me){return G===null||G.tag!==7?(G=Cn(Y,z.mode,ae,me),G.return=z,G):(G=p(G,Y),G.return=z,G)}function le(z,G,Y){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Fc(""+G,z.mode,Y),G.return=z,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case v:return Y=fo(G.type,G.key,G.props,null,z.mode,Y),Qa(Y,G),Y.return=z,Y;case y:return G=Uc(G,z.mode,Y),G.return=z,G;case M:var ae=G._init;return G=ae(G._payload),le(z,G,Y)}if(te(G)||H(G))return G=Cn(G,z.mode,Y,null),G.return=z,G;if(typeof G.then=="function")return le(z,Io(G),Y);if(G.$$typeof===A)return le(z,po(z,G),Y);wo(z,G)}return null}function W(z,G,Y,ae){var me=G!==null?G.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return me!==null?null:w(z,G,""+Y,ae);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case v:return Y.key===me?F(z,G,Y,ae):null;case y:return Y.key===me?Q(z,G,Y,ae):null;case M:return me=Y._init,Y=me(Y._payload),W(z,G,Y,ae)}if(te(Y)||H(Y))return me!==null?null:ee(z,G,Y,ae,null);if(typeof Y.then=="function")return W(z,G,Io(Y),ae);if(Y.$$typeof===A)return W(z,G,po(z,Y),ae);wo(z,Y)}return null}function Z(z,G,Y,ae,me){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return z=z.get(Y)||null,w(G,z,""+ae,me);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case v:return z=z.get(ae.key===null?Y:ae.key)||null,F(G,z,ae,me);case y:return z=z.get(ae.key===null?Y:ae.key)||null,Q(G,z,ae,me);case M:var De=ae._init;return ae=De(ae._payload),Z(z,G,Y,ae,me)}if(te(ae)||H(ae))return z=z.get(Y)||null,ee(G,z,ae,me,null);if(typeof ae.then=="function")return Z(z,G,Y,Io(ae),me);if(ae.$$typeof===A)return Z(z,G,Y,po(G,ae),me);wo(G,ae)}return null}function Ee(z,G,Y,ae){for(var me=null,De=null,ye=G,Te=G=0,bt=null;ye!==null&&Te<Y.length;Te++){ye.index>Te?(bt=ye,ye=null):bt=ye.sibling;var ke=W(z,ye,Y[Te],ae);if(ke===null){ye===null&&(ye=bt);break}n&&ye&&ke.alternate===null&&a(z,ye),G=T(ke,G,Te),De===null?me=ke:De.sibling=ke,De=ke,ye=bt}if(Te===Y.length)return c(z,ye),Be&&Mn(z,Te),me;if(ye===null){for(;Te<Y.length;Te++)ye=le(z,Y[Te],ae),ye!==null&&(G=T(ye,G,Te),De===null?me=ye:De.sibling=ye,De=ye);return Be&&Mn(z,Te),me}for(ye=g(ye);Te<Y.length;Te++)bt=Z(ye,z,Te,Y[Te],ae),bt!==null&&(n&&bt.alternate!==null&&ye.delete(bt.key===null?Te:bt.key),G=T(bt,G,Te),De===null?me=bt:De.sibling=bt,De=bt);return n&&ye.forEach(function(ln){return a(z,ln)}),Be&&Mn(z,Te),me}function Se(z,G,Y,ae){if(Y==null)throw Error(i(151));for(var me=null,De=null,ye=G,Te=G=0,bt=null,ke=Y.next();ye!==null&&!ke.done;Te++,ke=Y.next()){ye.index>Te?(bt=ye,ye=null):bt=ye.sibling;var ln=W(z,ye,ke.value,ae);if(ln===null){ye===null&&(ye=bt);break}n&&ye&&ln.alternate===null&&a(z,ye),G=T(ln,G,Te),De===null?me=ln:De.sibling=ln,De=ln,ye=bt}if(ke.done)return c(z,ye),Be&&Mn(z,Te),me;if(ye===null){for(;!ke.done;Te++,ke=Y.next())ke=le(z,ke.value,ae),ke!==null&&(G=T(ke,G,Te),De===null?me=ke:De.sibling=ke,De=ke);return Be&&Mn(z,Te),me}for(ye=g(ye);!ke.done;Te++,ke=Y.next())ke=Z(ye,z,Te,ke.value,ae),ke!==null&&(n&&ke.alternate!==null&&ye.delete(ke.key===null?Te:ke.key),G=T(ke,G,Te),De===null?me=ke:De.sibling=ke,De=ke);return n&&ye.forEach(function(S1){return a(z,S1)}),Be&&Mn(z,Te),me}function Ve(z,G,Y,ae){if(typeof Y=="object"&&Y!==null&&Y.type===S&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case v:e:{for(var me=Y.key;G!==null;){if(G.key===me){if(me=Y.type,me===S){if(G.tag===7){c(z,G.sibling),ae=p(G,Y.props.children),ae.return=z,z=ae;break e}}else if(G.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===M&&M0(me)===G.type){c(z,G.sibling),ae=p(G,Y.props),Qa(ae,Y),ae.return=z,z=ae;break e}c(z,G);break}else a(z,G);G=G.sibling}Y.type===S?(ae=Cn(Y.props.children,z.mode,ae,Y.key),ae.return=z,z=ae):(ae=fo(Y.type,Y.key,Y.props,null,z.mode,ae),Qa(ae,Y),ae.return=z,z=ae)}return L(z);case y:e:{for(me=Y.key;G!==null;){if(G.key===me)if(G.tag===4&&G.stateNode.containerInfo===Y.containerInfo&&G.stateNode.implementation===Y.implementation){c(z,G.sibling),ae=p(G,Y.children||[]),ae.return=z,z=ae;break e}else{c(z,G);break}else a(z,G);G=G.sibling}ae=Uc(Y,z.mode,ae),ae.return=z,z=ae}return L(z);case M:return me=Y._init,Y=me(Y._payload),Ve(z,G,Y,ae)}if(te(Y))return Ee(z,G,Y,ae);if(H(Y)){if(me=H(Y),typeof me!="function")throw Error(i(150));return Y=me.call(Y),Se(z,G,Y,ae)}if(typeof Y.then=="function")return Ve(z,G,Io(Y),ae);if(Y.$$typeof===A)return Ve(z,G,po(z,Y),ae);wo(z,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,G!==null&&G.tag===6?(c(z,G.sibling),ae=p(G,Y),ae.return=z,z=ae):(c(z,G),ae=Fc(Y,z.mode,ae),ae.return=z,z=ae),L(z)):c(z,G)}return function(z,G,Y,ae){try{Xa=0;var me=Ve(z,G,Y,ae);return Mr=null,me}catch(ye){if(ye===Ga||ye===yo)throw ye;var De=ri(29,ye,null,z.mode);return De.lanes=ae,De.return=z,De}finally{}}}var Pr=P0(!0),k0=P0(!1),Di=$(null),Zi=null;function Ks(n){var a=n.alternate;ne(yt,yt.current&1),ne(Di,n),Zi===null&&(a===null||Ir.current!==null||a.memoizedState!==null)&&(Zi=n)}function N0(n){if(n.tag===22){if(ne(yt,yt.current),ne(Di,n),Zi===null){var a=n.alternate;a!==null&&a.memoizedState!==null&&(Zi=n)}}else Ys()}function Ys(){ne(yt,yt.current),ne(Di,Di.current)}function Es(n){q(Di),Zi===n&&(Zi=null),q(yt)}var yt=$(0);function Co(n){for(var a=n;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||od(c)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function Sf(n,a,c,g){a=n.memoizedState,c=c(g,a),c=c==null?a:h({},a,c),n.memoizedState=c,n.lanes===0&&(n.updateQueue.baseState=c)}var Tf={enqueueSetState:function(n,a,c){n=n._reactInternals;var g=ui(),p=zs(g);p.payload=a,c!=null&&(p.callback=c),a=Hs(n,p,g),a!==null&&(ci(a,n,g),za(a,n,g))},enqueueReplaceState:function(n,a,c){n=n._reactInternals;var g=ui(),p=zs(g);p.tag=1,p.payload=a,c!=null&&(p.callback=c),a=Hs(n,p,g),a!==null&&(ci(a,n,g),za(a,n,g))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var c=ui(),g=zs(c);g.tag=2,a!=null&&(g.callback=a),a=Hs(n,g,c),a!==null&&(ci(a,n,c),za(a,n,c))}};function B0(n,a,c,g,p,T,L){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(g,T,L):a.prototype&&a.prototype.isPureReactComponent?!Oa(c,g)||!Oa(p,T):!0}function F0(n,a,c,g){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,g),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,g),a.state!==n&&Tf.enqueueReplaceState(a,a.state,null)}function Gn(n,a){var c=a;if("ref"in a){c={};for(var g in a)g!=="ref"&&(c[g]=a[g])}if(n=n.defaultProps){c===a&&(c=h({},c));for(var p in n)c[p]===void 0&&(c[p]=n[p])}return c}var Oo=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function U0(n){Oo(n)}function G0(n){console.error(n)}function $0(n){Oo(n)}function Mo(n,a){try{var c=n.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(g){setTimeout(function(){throw g})}}function z0(n,a,c){try{var g=n.onCaughtError;g(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Ef(n,a,c){return c=zs(c),c.tag=3,c.payload={element:null},c.callback=function(){Mo(n,a)},c}function H0(n){return n=zs(n),n.tag=3,n}function V0(n,a,c,g){var p=c.type.getDerivedStateFromError;if(typeof p=="function"){var T=g.value;n.payload=function(){return p(T)},n.callback=function(){z0(a,c,g)}}var L=c.stateNode;L!==null&&typeof L.componentDidCatch=="function"&&(n.callback=function(){z0(a,c,g),typeof p!="function"&&(Zs===null?Zs=new Set([this]):Zs.add(this));var w=g.stack;this.componentDidCatch(g.value,{componentStack:w!==null?w:""})})}function S_(n,a,c,g,p){if(c.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(a=c.alternate,a!==null&&Ba(a,c,p,!0),c=Di.current,c!==null){switch(c.tag){case 13:return Zi===null?Kf():c.alternate===null&&at===0&&(at=3),c.flags&=-257,c.flags|=65536,c.lanes=p,g===Xc?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([g]):a.add(g),jf(n,g,p)),!1;case 22:return c.flags|=65536,g===Xc?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([g])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([g]):c.add(g)),jf(n,g,p)),!1}throw Error(i(435,c.tag))}return jf(n,g,p),Kf(),!1}if(Be)return a=Di.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=p,g!==zc&&(n=Error(i(422),{cause:g}),Na(bi(n,c)))):(g!==zc&&(a=Error(i(423),{cause:g}),Na(bi(a,c))),n=n.current.alternate,n.flags|=65536,p&=-p,n.lanes|=p,g=bi(g,c),p=Ef(n.stateNode,g,p),Zc(n,p),at!==4&&(at=2)),!1;var T=Error(i(520),{cause:g});if(T=bi(T,c),sl===null?sl=[T]:sl.push(T),at!==4&&(at=2),a===null)return!0;g=bi(g,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,n=p&-p,c.lanes|=n,n=Ef(c.stateNode,g,n),Zc(c,n),!1;case 1:if(a=c.type,T=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Zs===null||!Zs.has(T))))return c.flags|=65536,p&=-p,c.lanes|=p,p=H0(p),V0(p,n,c,g),Zc(c,p),!1}c=c.return}while(c!==null);return!1}var K0=Error(i(461)),xt=!1;function It(n,a,c,g){a.child=n===null?k0(a,null,c,g):Pr(a,n.child,c,g)}function Y0(n,a,c,g,p){c=c.render;var T=a.ref;if("ref"in g){var L={};for(var w in g)w!=="ref"&&(L[w]=g[w])}else L=g;return Bn(a),g=nf(n,a,c,L,T,p),w=rf(),n!==null&&!xt?(af(n,a,p),xs(n,a,p)):(Be&&w&&Gc(a),a.flags|=1,It(n,a,g,p),a.child)}function j0(n,a,c,g,p){if(n===null){var T=c.type;return typeof T=="function"&&!Bc(T)&&T.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=T,q0(n,a,T,g,p)):(n=fo(c.type,null,g,a,a.mode,p),n.ref=a.ref,n.return=a,a.child=n)}if(T=n.child,!If(n,p)){var L=T.memoizedProps;if(c=c.compare,c=c!==null?c:Oa,c(L,g)&&n.ref===a.ref)return xs(n,a,p)}return a.flags|=1,n=ms(T,g),n.ref=a.ref,n.return=a,a.child=n}function q0(n,a,c,g,p){if(n!==null){var T=n.memoizedProps;if(Oa(T,g)&&n.ref===a.ref)if(xt=!1,a.pendingProps=g=T,If(n,p))(n.flags&131072)!==0&&(xt=!0);else return a.lanes=n.lanes,xs(n,a,p)}return xf(n,a,c,g,p)}function X0(n,a,c){var g=a.pendingProps,p=g.children,T=n!==null?n.memoizedState:null;if(g.mode==="hidden"){if((a.flags&128)!==0){if(g=T!==null?T.baseLanes|c:c,n!==null){for(p=a.child=n.child,T=0;p!==null;)T=T|p.lanes|p.childLanes,p=p.sibling;a.childLanes=T&~g}else a.childLanes=0,a.child=null;return Q0(n,a,g,c)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},n!==null&&vo(a,T!==null?T.cachePool:null),T!==null?qm(a,T):ef(),N0(a);else return a.lanes=a.childLanes=536870912,Q0(n,a,T!==null?T.baseLanes|c:c,c)}else T!==null?(vo(a,T.cachePool),qm(a,T),Ys(),a.memoizedState=null):(n!==null&&vo(a,null),ef(),Ys());return It(n,a,p,c),a.child}function Q0(n,a,c,g){var p=qc();return p=p===null?null:{parent:vt._currentValue,pool:p},a.memoizedState={baseLanes:c,cachePool:p},n!==null&&vo(a,null),ef(),N0(a),n!==null&&Ba(n,a,g,!0),null}function Po(n,a){var c=a.ref;if(c===null)n!==null&&n.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(n===null||n.ref!==c)&&(a.flags|=4194816)}}function xf(n,a,c,g,p){return Bn(a),c=nf(n,a,c,g,void 0,p),g=rf(),n!==null&&!xt?(af(n,a,p),xs(n,a,p)):(Be&&g&&Gc(a),a.flags|=1,It(n,a,c,p),a.child)}function W0(n,a,c,g,p,T){return Bn(a),a.updateQueue=null,c=Qm(a,g,c,p),Xm(n),g=rf(),n!==null&&!xt?(af(n,a,T),xs(n,a,T)):(Be&&g&&Gc(a),a.flags|=1,It(n,a,c,T),a.child)}function Z0(n,a,c,g,p){if(Bn(a),a.stateNode===null){var T=br,L=c.contextType;typeof L=="object"&&L!==null&&(T=Nt(L)),T=new c(g,T),a.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=Tf,a.stateNode=T,T._reactInternals=a,T=a.stateNode,T.props=g,T.state=a.memoizedState,T.refs={},Qc(a),L=c.contextType,T.context=typeof L=="object"&&L!==null?Nt(L):br,T.state=a.memoizedState,L=c.getDerivedStateFromProps,typeof L=="function"&&(Sf(a,c,L,g),T.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(L=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),L!==T.state&&Tf.enqueueReplaceState(T,T.state,null),Va(a,g,T,p),Ha(),T.state=a.memoizedState),typeof T.componentDidMount=="function"&&(a.flags|=4194308),g=!0}else if(n===null){T=a.stateNode;var w=a.memoizedProps,F=Gn(c,w);T.props=F;var Q=T.context,ee=c.contextType;L=br,typeof ee=="object"&&ee!==null&&(L=Nt(ee));var le=c.getDerivedStateFromProps;ee=typeof le=="function"||typeof T.getSnapshotBeforeUpdate=="function",w=a.pendingProps!==w,ee||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(w||Q!==L)&&F0(a,T,g,L),$s=!1;var W=a.memoizedState;T.state=W,Va(a,g,T,p),Ha(),Q=a.memoizedState,w||W!==Q||$s?(typeof le=="function"&&(Sf(a,c,le,g),Q=a.memoizedState),(F=$s||B0(a,c,F,g,W,Q,L))?(ee||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(a.flags|=4194308)):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=g,a.memoizedState=Q),T.props=g,T.state=Q,T.context=L,g=F):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),g=!1)}else{T=a.stateNode,Wc(n,a),L=a.memoizedProps,ee=Gn(c,L),T.props=ee,le=a.pendingProps,W=T.context,Q=c.contextType,F=br,typeof Q=="object"&&Q!==null&&(F=Nt(Q)),w=c.getDerivedStateFromProps,(Q=typeof w=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(L!==le||W!==F)&&F0(a,T,g,F),$s=!1,W=a.memoizedState,T.state=W,Va(a,g,T,p),Ha();var Z=a.memoizedState;L!==le||W!==Z||$s||n!==null&&n.dependencies!==null&&mo(n.dependencies)?(typeof w=="function"&&(Sf(a,c,w,g),Z=a.memoizedState),(ee=$s||B0(a,c,ee,g,W,Z,F)||n!==null&&n.dependencies!==null&&mo(n.dependencies))?(Q||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(g,Z,F),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(g,Z,F)),typeof T.componentDidUpdate=="function"&&(a.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof T.componentDidUpdate!="function"||L===n.memoizedProps&&W===n.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||L===n.memoizedProps&&W===n.memoizedState||(a.flags|=1024),a.memoizedProps=g,a.memoizedState=Z),T.props=g,T.state=Z,T.context=F,g=ee):(typeof T.componentDidUpdate!="function"||L===n.memoizedProps&&W===n.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||L===n.memoizedProps&&W===n.memoizedState||(a.flags|=1024),g=!1)}return T=g,Po(n,a),g=(a.flags&128)!==0,T||g?(T=a.stateNode,c=g&&typeof c.getDerivedStateFromError!="function"?null:T.render(),a.flags|=1,n!==null&&g?(a.child=Pr(a,n.child,null,p),a.child=Pr(a,null,c,p)):It(n,a,c,p),a.memoizedState=T.state,n=a.child):n=xs(n,a,p),n}function J0(n,a,c,g){return ka(),a.flags|=256,It(n,a,c,g),a.child}var _f={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bf(n){return{baseLanes:n,cachePool:Gm()}}function Af(n,a,c){return n=n!==null?n.childLanes&~c:0,a&&(n|=Ii),n}function ep(n,a,c){var g=a.pendingProps,p=!1,T=(a.flags&128)!==0,L;if((L=T)||(L=n!==null&&n.memoizedState===null?!1:(yt.current&2)!==0),L&&(p=!0,a.flags&=-129),L=(a.flags&32)!==0,a.flags&=-33,n===null){if(Be){if(p?Ks(a):Ys(),Be){var w=rt,F;if(F=w){e:{for(F=w,w=Wi;F.nodeType!==8;){if(!w){w=null;break e}if(F=Vi(F.nextSibling),F===null){w=null;break e}}w=F}w!==null?(a.memoizedState={dehydrated:w,treeContext:On!==null?{id:ps,overflow:vs}:null,retryLane:536870912,hydrationErrors:null},F=ri(18,null,null,0),F.stateNode=w,F.return=a,a.child=F,$t=a,rt=null,F=!0):F=!1}F||kn(a)}if(w=a.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return od(w)?a.lanes=32:a.lanes=536870912,null;Es(a)}return w=g.children,g=g.fallback,p?(Ys(),p=a.mode,w=ko({mode:"hidden",children:w},p),g=Cn(g,p,c,null),w.return=a,g.return=a,w.sibling=g,a.child=w,p=a.child,p.memoizedState=bf(c),p.childLanes=Af(n,L,c),a.memoizedState=_f,g):(Ks(a),Lf(a,w))}if(F=n.memoizedState,F!==null&&(w=F.dehydrated,w!==null)){if(T)a.flags&256?(Ks(a),a.flags&=-257,a=Rf(n,a,c)):a.memoizedState!==null?(Ys(),a.child=n.child,a.flags|=128,a=null):(Ys(),p=g.fallback,w=a.mode,g=ko({mode:"visible",children:g.children},w),p=Cn(p,w,c,null),p.flags|=2,g.return=a,p.return=a,g.sibling=p,a.child=g,Pr(a,n.child,null,c),g=a.child,g.memoizedState=bf(c),g.childLanes=Af(n,L,c),a.memoizedState=_f,a=p);else if(Ks(a),od(w)){if(L=w.nextSibling&&w.nextSibling.dataset,L)var Q=L.dgst;L=Q,g=Error(i(419)),g.stack="",g.digest=L,Na({value:g,source:null,stack:null}),a=Rf(n,a,c)}else if(xt||Ba(n,a,c,!1),L=(c&n.childLanes)!==0,xt||L){if(L=We,L!==null&&(g=c&-c,g=(g&42)!==0?1:oc(g),g=(g&(L.suspendedLanes|c))!==0?0:g,g!==0&&g!==F.retryLane))throw F.retryLane=g,_r(n,g),ci(L,n,g),K0;w.data==="$?"||Kf(),a=Rf(n,a,c)}else w.data==="$?"?(a.flags|=192,a.child=n.child,a=null):(n=F.treeContext,rt=Vi(w.nextSibling),$t=a,Be=!0,Pn=null,Wi=!1,n!==null&&(Li[Ri++]=ps,Li[Ri++]=vs,Li[Ri++]=On,ps=n.id,vs=n.overflow,On=a),a=Lf(a,g.children),a.flags|=4096);return a}return p?(Ys(),p=g.fallback,w=a.mode,F=n.child,Q=F.sibling,g=ms(F,{mode:"hidden",children:g.children}),g.subtreeFlags=F.subtreeFlags&65011712,Q!==null?p=ms(Q,p):(p=Cn(p,w,c,null),p.flags|=2),p.return=a,g.return=a,g.sibling=p,a.child=g,g=p,p=a.child,w=n.child.memoizedState,w===null?w=bf(c):(F=w.cachePool,F!==null?(Q=vt._currentValue,F=F.parent!==Q?{parent:Q,pool:Q}:F):F=Gm(),w={baseLanes:w.baseLanes|c,cachePool:F}),p.memoizedState=w,p.childLanes=Af(n,L,c),a.memoizedState=_f,g):(Ks(a),c=n.child,n=c.sibling,c=ms(c,{mode:"visible",children:g.children}),c.return=a,c.sibling=null,n!==null&&(L=a.deletions,L===null?(a.deletions=[n],a.flags|=16):L.push(n)),a.child=c,a.memoizedState=null,c)}function Lf(n,a){return a=ko({mode:"visible",children:a},n.mode),a.return=n,n.child=a}function ko(n,a){return n=ri(22,n,null,a),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function Rf(n,a,c){return Pr(a,n.child,null,c),n=Lf(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function tp(n,a,c){n.lanes|=a;var g=n.alternate;g!==null&&(g.lanes|=a),Vc(n.return,a,c)}function Df(n,a,c,g,p){var T=n.memoizedState;T===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:g,tail:c,tailMode:p}:(T.isBackwards=a,T.rendering=null,T.renderingStartTime=0,T.last=g,T.tail=c,T.tailMode=p)}function ip(n,a,c){var g=a.pendingProps,p=g.revealOrder,T=g.tail;if(It(n,a,g.children,c),g=yt.current,(g&2)!==0)g=g&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&tp(n,c,a);else if(n.tag===19)tp(n,c,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}g&=1}switch(ne(yt,g),p){case"forwards":for(c=a.child,p=null;c!==null;)n=c.alternate,n!==null&&Co(n)===null&&(p=c),c=c.sibling;c=p,c===null?(p=a.child,a.child=null):(p=c.sibling,c.sibling=null),Df(a,!1,p,c,T);break;case"backwards":for(c=null,p=a.child,a.child=null;p!==null;){if(n=p.alternate,n!==null&&Co(n)===null){a.child=p;break}n=p.sibling,p.sibling=c,c=p,p=n}Df(a,!0,c,null,T);break;case"together":Df(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function xs(n,a,c){if(n!==null&&(a.dependencies=n.dependencies),Ws|=a.lanes,(c&a.childLanes)===0)if(n!==null){if(Ba(n,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(n!==null&&a.child!==n.child)throw Error(i(153));if(a.child!==null){for(n=a.child,c=ms(n,n.pendingProps),a.child=c,c.return=a;n.sibling!==null;)n=n.sibling,c=c.sibling=ms(n,n.pendingProps),c.return=a;c.sibling=null}return a.child}function If(n,a){return(n.lanes&a)!==0?!0:(n=n.dependencies,!!(n!==null&&mo(n)))}function T_(n,a,c){switch(a.tag){case 3:_e(a,a.stateNode.containerInfo),Gs(a,vt,n.memoizedState.cache),ka();break;case 27:case 5:Dt(a);break;case 4:_e(a,a.stateNode.containerInfo);break;case 10:Gs(a,a.type,a.memoizedProps.value);break;case 13:var g=a.memoizedState;if(g!==null)return g.dehydrated!==null?(Ks(a),a.flags|=128,null):(c&a.child.childLanes)!==0?ep(n,a,c):(Ks(a),n=xs(n,a,c),n!==null?n.sibling:null);Ks(a);break;case 19:var p=(n.flags&128)!==0;if(g=(c&a.childLanes)!==0,g||(Ba(n,a,c,!1),g=(c&a.childLanes)!==0),p){if(g)return ip(n,a,c);a.flags|=128}if(p=a.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),ne(yt,yt.current),g)break;return null;case 22:case 23:return a.lanes=0,X0(n,a,c);case 24:Gs(a,vt,n.memoizedState.cache)}return xs(n,a,c)}function sp(n,a,c){if(n!==null)if(n.memoizedProps!==a.pendingProps)xt=!0;else{if(!If(n,c)&&(a.flags&128)===0)return xt=!1,T_(n,a,c);xt=(n.flags&131072)!==0}else xt=!1,Be&&(a.flags&1048576)!==0&&Mm(a,go,a.index);switch(a.lanes=0,a.tag){case 16:e:{n=a.pendingProps;var g=a.elementType,p=g._init;if(g=p(g._payload),a.type=g,typeof g=="function")Bc(g)?(n=Gn(g,n),a.tag=1,a=Z0(null,a,g,n,c)):(a.tag=0,a=xf(null,a,g,n,c));else{if(g!=null){if(p=g.$$typeof,p===I){a.tag=11,a=Y0(null,a,g,n,c);break e}else if(p===C){a.tag=14,a=j0(null,a,g,n,c);break e}}throw a=ue(g)||g,Error(i(306,a,""))}}return a;case 0:return xf(n,a,a.type,a.pendingProps,c);case 1:return g=a.type,p=Gn(g,a.pendingProps),Z0(n,a,g,p,c);case 3:e:{if(_e(a,a.stateNode.containerInfo),n===null)throw Error(i(387));g=a.pendingProps;var T=a.memoizedState;p=T.element,Wc(n,a),Va(a,g,null,c);var L=a.memoizedState;if(g=L.cache,Gs(a,vt,g),g!==T.cache&&Kc(a,[vt],c,!0),Ha(),g=L.element,T.isDehydrated)if(T={element:g,isDehydrated:!1,cache:L.cache},a.updateQueue.baseState=T,a.memoizedState=T,a.flags&256){a=J0(n,a,g,c);break e}else if(g!==p){p=bi(Error(i(424)),a),Na(p),a=J0(n,a,g,c);break e}else{switch(n=a.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(rt=Vi(n.firstChild),$t=a,Be=!0,Pn=null,Wi=!0,c=k0(a,null,g,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(ka(),g===p){a=xs(n,a,c);break e}It(n,a,g,c)}a=a.child}return a;case 26:return Po(n,a),n===null?(c=lv(a.type,null,a.pendingProps,null))?a.memoizedState=c:Be||(c=a.type,n=a.pendingProps,g=Xo(ce.current).createElement(c),g[kt]=a,g[Yt]=n,Ct(g,c,n),Et(g),a.stateNode=g):a.memoizedState=lv(a.type,n.memoizedProps,a.pendingProps,n.memoizedState),null;case 27:return Dt(a),n===null&&Be&&(g=a.stateNode=nv(a.type,a.pendingProps,ce.current),$t=a,Wi=!0,p=rt,tn(a.type)?(ud=p,rt=Vi(g.firstChild)):rt=p),It(n,a,a.pendingProps.children,c),Po(n,a),n===null&&(a.flags|=4194304),a.child;case 5:return n===null&&Be&&((p=g=rt)&&(g=q_(g,a.type,a.pendingProps,Wi),g!==null?(a.stateNode=g,$t=a,rt=Vi(g.firstChild),Wi=!1,p=!0):p=!1),p||kn(a)),Dt(a),p=a.type,T=a.pendingProps,L=n!==null?n.memoizedProps:null,g=T.children,rd(p,T)?g=null:L!==null&&rd(p,L)&&(a.flags|=32),a.memoizedState!==null&&(p=nf(n,a,d_,null,null,c),dl._currentValue=p),Po(n,a),It(n,a,g,c),a.child;case 6:return n===null&&Be&&((n=c=rt)&&(c=X_(c,a.pendingProps,Wi),c!==null?(a.stateNode=c,$t=a,rt=null,n=!0):n=!1),n||kn(a)),null;case 13:return ep(n,a,c);case 4:return _e(a,a.stateNode.containerInfo),g=a.pendingProps,n===null?a.child=Pr(a,null,g,c):It(n,a,g,c),a.child;case 11:return Y0(n,a,a.type,a.pendingProps,c);case 7:return It(n,a,a.pendingProps,c),a.child;case 8:return It(n,a,a.pendingProps.children,c),a.child;case 12:return It(n,a,a.pendingProps.children,c),a.child;case 10:return g=a.pendingProps,Gs(a,a.type,g.value),It(n,a,g.children,c),a.child;case 9:return p=a.type._context,g=a.pendingProps.children,Bn(a),p=Nt(p),g=g(p),a.flags|=1,It(n,a,g,c),a.child;case 14:return j0(n,a,a.type,a.pendingProps,c);case 15:return q0(n,a,a.type,a.pendingProps,c);case 19:return ip(n,a,c);case 31:return g=a.pendingProps,c=a.mode,g={mode:g.mode,children:g.children},n===null?(c=ko(g,c),c.ref=a.ref,a.child=c,c.return=a,a=c):(c=ms(n.child,g),c.ref=a.ref,a.child=c,c.return=a,a=c),a;case 22:return X0(n,a,c);case 24:return Bn(a),g=Nt(vt),n===null?(p=qc(),p===null&&(p=We,T=Yc(),p.pooledCache=T,T.refCount++,T!==null&&(p.pooledCacheLanes|=c),p=T),a.memoizedState={parent:g,cache:p},Qc(a),Gs(a,vt,p)):((n.lanes&c)!==0&&(Wc(n,a),Va(a,null,null,c),Ha()),p=n.memoizedState,T=a.memoizedState,p.parent!==g?(p={parent:g,cache:g},a.memoizedState=p,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=p),Gs(a,vt,g)):(g=T.cache,Gs(a,vt,g),g!==p.cache&&Kc(a,[vt],c,!0))),It(n,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function _s(n){n.flags|=4}function np(n,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!dv(a)){if(a=Di.current,a!==null&&((Pe&4194048)===Pe?Zi!==null:(Pe&62914560)!==Pe&&(Pe&536870912)===0||a!==Zi))throw $a=Xc,$m;n.flags|=8192}}function No(n,a){a!==null&&(n.flags|=4),n.flags&16384&&(a=n.tag!==22?Ng():536870912,n.lanes|=a,Fr|=a)}function Wa(n,a){if(!Be)switch(n.tailMode){case"hidden":a=n.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?n.tail=null:c.sibling=null;break;case"collapsed":c=n.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:g.sibling=null}}function tt(n){var a=n.alternate!==null&&n.alternate.child===n.child,c=0,g=0;if(a)for(var p=n.child;p!==null;)c|=p.lanes|p.childLanes,g|=p.subtreeFlags&65011712,g|=p.flags&65011712,p.return=n,p=p.sibling;else for(p=n.child;p!==null;)c|=p.lanes|p.childLanes,g|=p.subtreeFlags,g|=p.flags,p.return=n,p=p.sibling;return n.subtreeFlags|=g,n.childLanes=c,a}function E_(n,a,c){var g=a.pendingProps;switch($c(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tt(a),null;case 1:return tt(a),null;case 3:return c=a.stateNode,g=null,n!==null&&(g=n.memoizedState.cache),a.memoizedState.cache!==g&&(a.flags|=2048),Ss(vt),$e(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(Pa(a)?_s(a):n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Nm())),tt(a),null;case 26:return c=a.memoizedState,n===null?(_s(a),c!==null?(tt(a),np(a,c)):(tt(a),a.flags&=-16777217)):c?c!==n.memoizedState?(_s(a),tt(a),np(a,c)):(tt(a),a.flags&=-16777217):(n.memoizedProps!==g&&_s(a),tt(a),a.flags&=-16777217),null;case 27:Ei(a),c=ce.current;var p=a.type;if(n!==null&&a.stateNode!=null)n.memoizedProps!==g&&_s(a);else{if(!g){if(a.stateNode===null)throw Error(i(166));return tt(a),null}n=fe.current,Pa(a)?Pm(a):(n=nv(p,g,c),a.stateNode=n,_s(a))}return tt(a),null;case 5:if(Ei(a),c=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==g&&_s(a);else{if(!g){if(a.stateNode===null)throw Error(i(166));return tt(a),null}if(n=fe.current,Pa(a))Pm(a);else{switch(p=Xo(ce.current),n){case 1:n=p.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:n=p.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":n=p.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":n=p.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":n=p.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof g.is=="string"?p.createElement("select",{is:g.is}):p.createElement("select"),g.multiple?n.multiple=!0:g.size&&(n.size=g.size);break;default:n=typeof g.is=="string"?p.createElement(c,{is:g.is}):p.createElement(c)}}n[kt]=a,n[Yt]=g;e:for(p=a.child;p!==null;){if(p.tag===5||p.tag===6)n.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===a)break e;for(;p.sibling===null;){if(p.return===null||p.return===a)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}a.stateNode=n;e:switch(Ct(n,c,g),c){case"button":case"input":case"select":case"textarea":n=!!g.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&_s(a)}}return tt(a),a.flags&=-16777217,null;case 6:if(n&&a.stateNode!=null)n.memoizedProps!==g&&_s(a);else{if(typeof g!="string"&&a.stateNode===null)throw Error(i(166));if(n=ce.current,Pa(a)){if(n=a.stateNode,c=a.memoizedProps,g=null,p=$t,p!==null)switch(p.tag){case 27:case 5:g=p.memoizedProps}n[kt]=a,n=!!(n.nodeValue===c||g!==null&&g.suppressHydrationWarning===!0||Wp(n.nodeValue,c)),n||kn(a)}else n=Xo(n).createTextNode(g),n[kt]=a,a.stateNode=n}return tt(a),null;case 13:if(g=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(p=Pa(a),g!==null&&g.dehydrated!==null){if(n===null){if(!p)throw Error(i(318));if(p=a.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[kt]=a}else ka(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;tt(a),p=!1}else p=Nm(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=p),p=!0;if(!p)return a.flags&256?(Es(a),a):(Es(a),null)}if(Es(a),(a.flags&128)!==0)return a.lanes=c,a;if(c=g!==null,n=n!==null&&n.memoizedState!==null,c){g=a.child,p=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(p=g.alternate.memoizedState.cachePool.pool);var T=null;g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(T=g.memoizedState.cachePool.pool),T!==p&&(g.flags|=2048)}return c!==n&&c&&(a.child.flags|=8192),No(a,a.updateQueue),tt(a),null;case 4:return $e(),n===null&&ed(a.stateNode.containerInfo),tt(a),null;case 10:return Ss(a.type),tt(a),null;case 19:if(q(yt),p=a.memoizedState,p===null)return tt(a),null;if(g=(a.flags&128)!==0,T=p.rendering,T===null)if(g)Wa(p,!1);else{if(at!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(T=Co(n),T!==null){for(a.flags|=128,Wa(p,!1),n=T.updateQueue,a.updateQueue=n,No(a,n),a.subtreeFlags=0,n=c,c=a.child;c!==null;)Om(c,n),c=c.sibling;return ne(yt,yt.current&1|2),a.child}n=n.sibling}p.tail!==null&&Ye()>Uo&&(a.flags|=128,g=!0,Wa(p,!1),a.lanes=4194304)}else{if(!g)if(n=Co(T),n!==null){if(a.flags|=128,g=!0,n=n.updateQueue,a.updateQueue=n,No(a,n),Wa(p,!0),p.tail===null&&p.tailMode==="hidden"&&!T.alternate&&!Be)return tt(a),null}else 2*Ye()-p.renderingStartTime>Uo&&c!==536870912&&(a.flags|=128,g=!0,Wa(p,!1),a.lanes=4194304);p.isBackwards?(T.sibling=a.child,a.child=T):(n=p.last,n!==null?n.sibling=T:a.child=T,p.last=T)}return p.tail!==null?(a=p.tail,p.rendering=a,p.tail=a.sibling,p.renderingStartTime=Ye(),a.sibling=null,n=yt.current,ne(yt,g?n&1|2:n&1),a):(tt(a),null);case 22:case 23:return Es(a),tf(),g=a.memoizedState!==null,n!==null?n.memoizedState!==null!==g&&(a.flags|=8192):g&&(a.flags|=8192),g?(c&536870912)!==0&&(a.flags&128)===0&&(tt(a),a.subtreeFlags&6&&(a.flags|=8192)):tt(a),c=a.updateQueue,c!==null&&No(a,c.retryQueue),c=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),g=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(g=a.memoizedState.cachePool.pool),g!==c&&(a.flags|=2048),n!==null&&q(Fn),null;case 24:return c=null,n!==null&&(c=n.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Ss(vt),tt(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function x_(n,a){switch($c(a),a.tag){case 1:return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return Ss(vt),$e(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 26:case 27:case 5:return Ei(a),null;case 13:if(Es(a),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(i(340));ka()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return q(yt),null;case 4:return $e(),null;case 10:return Ss(a.type),null;case 22:case 23:return Es(a),tf(),n!==null&&q(Fn),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 24:return Ss(vt),null;case 25:return null;default:return null}}function rp(n,a){switch($c(a),a.tag){case 3:Ss(vt),$e();break;case 26:case 27:case 5:Ei(a);break;case 4:$e();break;case 13:Es(a);break;case 19:q(yt);break;case 10:Ss(a.type);break;case 22:case 23:Es(a),tf(),n!==null&&q(Fn);break;case 24:Ss(vt)}}function Za(n,a){try{var c=a.updateQueue,g=c!==null?c.lastEffect:null;if(g!==null){var p=g.next;c=p;do{if((c.tag&n)===n){g=void 0;var T=c.create,L=c.inst;g=T(),L.destroy=g}c=c.next}while(c!==p)}}catch(w){je(a,a.return,w)}}function js(n,a,c){try{var g=a.updateQueue,p=g!==null?g.lastEffect:null;if(p!==null){var T=p.next;g=T;do{if((g.tag&n)===n){var L=g.inst,w=L.destroy;if(w!==void 0){L.destroy=void 0,p=a;var F=c,Q=w;try{Q()}catch(ee){je(p,F,ee)}}}g=g.next}while(g!==T)}}catch(ee){je(a,a.return,ee)}}function ap(n){var a=n.updateQueue;if(a!==null){var c=n.stateNode;try{jm(a,c)}catch(g){je(n,n.return,g)}}}function lp(n,a,c){c.props=Gn(n.type,n.memoizedProps),c.state=n.memoizedState;try{c.componentWillUnmount()}catch(g){je(n,a,g)}}function Ja(n,a){try{var c=n.ref;if(c!==null){switch(n.tag){case 26:case 27:case 5:var g=n.stateNode;break;case 30:g=n.stateNode;break;default:g=n.stateNode}typeof c=="function"?n.refCleanup=c(g):c.current=g}}catch(p){je(n,a,p)}}function Ji(n,a){var c=n.ref,g=n.refCleanup;if(c!==null)if(typeof g=="function")try{g()}catch(p){je(n,a,p)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(p){je(n,a,p)}else c.current=null}function op(n){var a=n.type,c=n.memoizedProps,g=n.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&g.focus();break e;case"img":c.src?g.src=c.src:c.srcSet&&(g.srcset=c.srcSet)}}catch(p){je(n,n.return,p)}}function wf(n,a,c){try{var g=n.stateNode;H_(g,n.type,c,a),g[Yt]=a}catch(p){je(n,n.return,p)}}function up(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&tn(n.type)||n.tag===4}function Cf(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||up(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&tn(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Of(n,a,c){var g=n.tag;if(g===5||g===6)n=n.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(n,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(n),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=qo));else if(g!==4&&(g===27&&tn(n.type)&&(c=n.stateNode,a=null),n=n.child,n!==null))for(Of(n,a,c),n=n.sibling;n!==null;)Of(n,a,c),n=n.sibling}function Bo(n,a,c){var g=n.tag;if(g===5||g===6)n=n.stateNode,a?c.insertBefore(n,a):c.appendChild(n);else if(g!==4&&(g===27&&tn(n.type)&&(c=n.stateNode),n=n.child,n!==null))for(Bo(n,a,c),n=n.sibling;n!==null;)Bo(n,a,c),n=n.sibling}function cp(n){var a=n.stateNode,c=n.memoizedProps;try{for(var g=n.type,p=a.attributes;p.length;)a.removeAttributeNode(p[0]);Ct(a,g,c),a[kt]=n,a[Yt]=c}catch(T){je(n,n.return,T)}}var bs=!1,ut=!1,Mf=!1,fp=typeof WeakSet=="function"?WeakSet:Set,_t=null;function __(n,a){if(n=n.containerInfo,sd=tu,n=xm(n),wc(n)){if("selectionStart"in n)var c={start:n.selectionStart,end:n.selectionEnd};else e:{c=(c=n.ownerDocument)&&c.defaultView||window;var g=c.getSelection&&c.getSelection();if(g&&g.rangeCount!==0){c=g.anchorNode;var p=g.anchorOffset,T=g.focusNode;g=g.focusOffset;try{c.nodeType,T.nodeType}catch{c=null;break e}var L=0,w=-1,F=-1,Q=0,ee=0,le=n,W=null;t:for(;;){for(var Z;le!==c||p!==0&&le.nodeType!==3||(w=L+p),le!==T||g!==0&&le.nodeType!==3||(F=L+g),le.nodeType===3&&(L+=le.nodeValue.length),(Z=le.firstChild)!==null;)W=le,le=Z;for(;;){if(le===n)break t;if(W===c&&++Q===p&&(w=L),W===T&&++ee===g&&(F=L),(Z=le.nextSibling)!==null)break;le=W,W=le.parentNode}le=Z}c=w===-1||F===-1?null:{start:w,end:F}}else c=null}c=c||{start:0,end:0}}else c=null;for(nd={focusedElem:n,selectionRange:c},tu=!1,_t=a;_t!==null;)if(a=_t,n=a.child,(a.subtreeFlags&1024)!==0&&n!==null)n.return=a,_t=n;else for(;_t!==null;){switch(a=_t,T=a.alternate,n=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&T!==null){n=void 0,c=a,p=T.memoizedProps,T=T.memoizedState,g=c.stateNode;try{var Ee=Gn(c.type,p,c.elementType===c.type);n=g.getSnapshotBeforeUpdate(Ee,T),g.__reactInternalSnapshotBeforeUpdate=n}catch(Se){je(c,c.return,Se)}}break;case 3:if((n&1024)!==0){if(n=a.stateNode.containerInfo,c=n.nodeType,c===9)ld(n);else if(c===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":ld(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=a.sibling,n!==null){n.return=a.return,_t=n;break}_t=a.return}}function dp(n,a,c){var g=c.flags;switch(c.tag){case 0:case 11:case 15:qs(n,c),g&4&&Za(5,c);break;case 1:if(qs(n,c),g&4)if(n=c.stateNode,a===null)try{n.componentDidMount()}catch(L){je(c,c.return,L)}else{var p=Gn(c.type,a.memoizedProps);a=a.memoizedState;try{n.componentDidUpdate(p,a,n.__reactInternalSnapshotBeforeUpdate)}catch(L){je(c,c.return,L)}}g&64&&ap(c),g&512&&Ja(c,c.return);break;case 3:if(qs(n,c),g&64&&(n=c.updateQueue,n!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{jm(n,a)}catch(L){je(c,c.return,L)}}break;case 27:a===null&&g&4&&cp(c);case 26:case 5:qs(n,c),a===null&&g&4&&op(c),g&512&&Ja(c,c.return);break;case 12:qs(n,c);break;case 13:qs(n,c),g&4&&mp(n,c),g&64&&(n=c.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(c=O_.bind(null,c),Q_(n,c))));break;case 22:if(g=c.memoizedState!==null||bs,!g){a=a!==null&&a.memoizedState!==null||ut,p=bs;var T=ut;bs=g,(ut=a)&&!T?Xs(n,c,(c.subtreeFlags&8772)!==0):qs(n,c),bs=p,ut=T}break;case 30:break;default:qs(n,c)}}function hp(n){var a=n.alternate;a!==null&&(n.alternate=null,hp(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&fc(a)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Je=null,Xt=!1;function As(n,a,c){for(c=c.child;c!==null;)gp(n,a,c),c=c.sibling}function gp(n,a,c){if(Mt&&typeof Mt.onCommitFiberUnmount=="function")try{Mt.onCommitFiberUnmount($i,c)}catch{}switch(c.tag){case 26:ut||Ji(c,a),As(n,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:ut||Ji(c,a);var g=Je,p=Xt;tn(c.type)&&(Je=c.stateNode,Xt=!1),As(n,a,c),ol(c.stateNode),Je=g,Xt=p;break;case 5:ut||Ji(c,a);case 6:if(g=Je,p=Xt,Je=null,As(n,a,c),Je=g,Xt=p,Je!==null)if(Xt)try{(Je.nodeType===9?Je.body:Je.nodeName==="HTML"?Je.ownerDocument.body:Je).removeChild(c.stateNode)}catch(T){je(c,a,T)}else try{Je.removeChild(c.stateNode)}catch(T){je(c,a,T)}break;case 18:Je!==null&&(Xt?(n=Je,iv(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,c.stateNode),pl(n)):iv(Je,c.stateNode));break;case 4:g=Je,p=Xt,Je=c.stateNode.containerInfo,Xt=!0,As(n,a,c),Je=g,Xt=p;break;case 0:case 11:case 14:case 15:ut||js(2,c,a),ut||js(4,c,a),As(n,a,c);break;case 1:ut||(Ji(c,a),g=c.stateNode,typeof g.componentWillUnmount=="function"&&lp(c,a,g)),As(n,a,c);break;case 21:As(n,a,c);break;case 22:ut=(g=ut)||c.memoizedState!==null,As(n,a,c),ut=g;break;default:As(n,a,c)}}function mp(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{pl(n)}catch(c){je(a,a.return,c)}}function b_(n){switch(n.tag){case 13:case 19:var a=n.stateNode;return a===null&&(a=n.stateNode=new fp),a;case 22:return n=n.stateNode,a=n._retryCache,a===null&&(a=n._retryCache=new fp),a;default:throw Error(i(435,n.tag))}}function Pf(n,a){var c=b_(n);a.forEach(function(g){var p=M_.bind(null,n,g);c.has(g)||(c.add(g),g.then(p,p))})}function ai(n,a){var c=a.deletions;if(c!==null)for(var g=0;g<c.length;g++){var p=c[g],T=n,L=a,w=L;e:for(;w!==null;){switch(w.tag){case 27:if(tn(w.type)){Je=w.stateNode,Xt=!1;break e}break;case 5:Je=w.stateNode,Xt=!1;break e;case 3:case 4:Je=w.stateNode.containerInfo,Xt=!0;break e}w=w.return}if(Je===null)throw Error(i(160));gp(T,L,p),Je=null,Xt=!1,T=p.alternate,T!==null&&(T.return=null),p.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)pp(a,n),a=a.sibling}var Hi=null;function pp(n,a){var c=n.alternate,g=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:ai(a,n),li(n),g&4&&(js(3,n,n.return),Za(3,n),js(5,n,n.return));break;case 1:ai(a,n),li(n),g&512&&(ut||c===null||Ji(c,c.return)),g&64&&bs&&(n=n.updateQueue,n!==null&&(g=n.callbacks,g!==null&&(c=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=c===null?g:c.concat(g))));break;case 26:var p=Hi;if(ai(a,n),li(n),g&512&&(ut||c===null||Ji(c,c.return)),g&4){var T=c!==null?c.memoizedState:null;if(g=n.memoizedState,c===null)if(g===null)if(n.stateNode===null){e:{g=n.type,c=n.memoizedProps,p=p.ownerDocument||p;t:switch(g){case"title":T=p.getElementsByTagName("title")[0],(!T||T[_a]||T[kt]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=p.createElement(g),p.head.insertBefore(T,p.querySelector("head > title"))),Ct(T,g,c),T[kt]=n,Et(T),g=T;break e;case"link":var L=cv("link","href",p).get(g+(c.href||""));if(L){for(var w=0;w<L.length;w++)if(T=L[w],T.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&T.getAttribute("rel")===(c.rel==null?null:c.rel)&&T.getAttribute("title")===(c.title==null?null:c.title)&&T.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){L.splice(w,1);break t}}T=p.createElement(g),Ct(T,g,c),p.head.appendChild(T);break;case"meta":if(L=cv("meta","content",p).get(g+(c.content||""))){for(w=0;w<L.length;w++)if(T=L[w],T.getAttribute("content")===(c.content==null?null:""+c.content)&&T.getAttribute("name")===(c.name==null?null:c.name)&&T.getAttribute("property")===(c.property==null?null:c.property)&&T.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&T.getAttribute("charset")===(c.charSet==null?null:c.charSet)){L.splice(w,1);break t}}T=p.createElement(g),Ct(T,g,c),p.head.appendChild(T);break;default:throw Error(i(468,g))}T[kt]=n,Et(T),g=T}n.stateNode=g}else fv(p,n.type,n.stateNode);else n.stateNode=uv(p,g,n.memoizedProps);else T!==g?(T===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):T.count--,g===null?fv(p,n.type,n.stateNode):uv(p,g,n.memoizedProps)):g===null&&n.stateNode!==null&&wf(n,n.memoizedProps,c.memoizedProps)}break;case 27:ai(a,n),li(n),g&512&&(ut||c===null||Ji(c,c.return)),c!==null&&g&4&&wf(n,n.memoizedProps,c.memoizedProps);break;case 5:if(ai(a,n),li(n),g&512&&(ut||c===null||Ji(c,c.return)),n.flags&32){p=n.stateNode;try{pr(p,"")}catch(Z){je(n,n.return,Z)}}g&4&&n.stateNode!=null&&(p=n.memoizedProps,wf(n,p,c!==null?c.memoizedProps:p)),g&1024&&(Mf=!0);break;case 6:if(ai(a,n),li(n),g&4){if(n.stateNode===null)throw Error(i(162));g=n.memoizedProps,c=n.stateNode;try{c.nodeValue=g}catch(Z){je(n,n.return,Z)}}break;case 3:if(Zo=null,p=Hi,Hi=Qo(a.containerInfo),ai(a,n),Hi=p,li(n),g&4&&c!==null&&c.memoizedState.isDehydrated)try{pl(a.containerInfo)}catch(Z){je(n,n.return,Z)}Mf&&(Mf=!1,vp(n));break;case 4:g=Hi,Hi=Qo(n.stateNode.containerInfo),ai(a,n),li(n),Hi=g;break;case 12:ai(a,n),li(n);break;case 13:ai(a,n),li(n),n.child.flags&8192&&n.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Gf=Ye()),g&4&&(g=n.updateQueue,g!==null&&(n.updateQueue=null,Pf(n,g)));break;case 22:p=n.memoizedState!==null;var F=c!==null&&c.memoizedState!==null,Q=bs,ee=ut;if(bs=Q||p,ut=ee||F,ai(a,n),ut=ee,bs=Q,li(n),g&8192)e:for(a=n.stateNode,a._visibility=p?a._visibility&-2:a._visibility|1,p&&(c===null||F||bs||ut||$n(n)),c=null,a=n;;){if(a.tag===5||a.tag===26){if(c===null){F=c=a;try{if(T=F.stateNode,p)L=T.style,typeof L.setProperty=="function"?L.setProperty("display","none","important"):L.display="none";else{w=F.stateNode;var le=F.memoizedProps.style,W=le!=null&&le.hasOwnProperty("display")?le.display:null;w.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(Z){je(F,F.return,Z)}}}else if(a.tag===6){if(c===null){F=a;try{F.stateNode.nodeValue=p?"":F.memoizedProps}catch(Z){je(F,F.return,Z)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===n)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break e;for(;a.sibling===null;){if(a.return===null||a.return===n)break e;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}g&4&&(g=n.updateQueue,g!==null&&(c=g.retryQueue,c!==null&&(g.retryQueue=null,Pf(n,c))));break;case 19:ai(a,n),li(n),g&4&&(g=n.updateQueue,g!==null&&(n.updateQueue=null,Pf(n,g)));break;case 30:break;case 21:break;default:ai(a,n),li(n)}}function li(n){var a=n.flags;if(a&2){try{for(var c,g=n.return;g!==null;){if(up(g)){c=g;break}g=g.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var p=c.stateNode,T=Cf(n);Bo(n,T,p);break;case 5:var L=c.stateNode;c.flags&32&&(pr(L,""),c.flags&=-33);var w=Cf(n);Bo(n,w,L);break;case 3:case 4:var F=c.stateNode.containerInfo,Q=Cf(n);Of(n,Q,F);break;default:throw Error(i(161))}}catch(ee){je(n,n.return,ee)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function vp(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var a=n;vp(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),n=n.sibling}}function qs(n,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)dp(n,a.alternate,a),a=a.sibling}function $n(n){for(n=n.child;n!==null;){var a=n;switch(a.tag){case 0:case 11:case 14:case 15:js(4,a,a.return),$n(a);break;case 1:Ji(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&lp(a,a.return,c),$n(a);break;case 27:ol(a.stateNode);case 26:case 5:Ji(a,a.return),$n(a);break;case 22:a.memoizedState===null&&$n(a);break;case 30:$n(a);break;default:$n(a)}n=n.sibling}}function Xs(n,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var g=a.alternate,p=n,T=a,L=T.flags;switch(T.tag){case 0:case 11:case 15:Xs(p,T,c),Za(4,T);break;case 1:if(Xs(p,T,c),g=T,p=g.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(Q){je(g,g.return,Q)}if(g=T,p=g.updateQueue,p!==null){var w=g.stateNode;try{var F=p.shared.hiddenCallbacks;if(F!==null)for(p.shared.hiddenCallbacks=null,p=0;p<F.length;p++)Ym(F[p],w)}catch(Q){je(g,g.return,Q)}}c&&L&64&&ap(T),Ja(T,T.return);break;case 27:cp(T);case 26:case 5:Xs(p,T,c),c&&g===null&&L&4&&op(T),Ja(T,T.return);break;case 12:Xs(p,T,c);break;case 13:Xs(p,T,c),c&&L&4&&mp(p,T);break;case 22:T.memoizedState===null&&Xs(p,T,c),Ja(T,T.return);break;case 30:break;default:Xs(p,T,c)}a=a.sibling}}function kf(n,a){var c=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),n=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(n=a.memoizedState.cachePool.pool),n!==c&&(n!=null&&n.refCount++,c!=null&&Fa(c))}function Nf(n,a){n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Fa(n))}function es(n,a,c,g){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)yp(n,a,c,g),a=a.sibling}function yp(n,a,c,g){var p=a.flags;switch(a.tag){case 0:case 11:case 15:es(n,a,c,g),p&2048&&Za(9,a);break;case 1:es(n,a,c,g);break;case 3:es(n,a,c,g),p&2048&&(n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Fa(n)));break;case 12:if(p&2048){es(n,a,c,g),n=a.stateNode;try{var T=a.memoizedProps,L=T.id,w=T.onPostCommit;typeof w=="function"&&w(L,a.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(F){je(a,a.return,F)}}else es(n,a,c,g);break;case 13:es(n,a,c,g);break;case 23:break;case 22:T=a.stateNode,L=a.alternate,a.memoizedState!==null?T._visibility&2?es(n,a,c,g):el(n,a):T._visibility&2?es(n,a,c,g):(T._visibility|=2,kr(n,a,c,g,(a.subtreeFlags&10256)!==0)),p&2048&&kf(L,a);break;case 24:es(n,a,c,g),p&2048&&Nf(a.alternate,a);break;default:es(n,a,c,g)}}function kr(n,a,c,g,p){for(p=p&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var T=n,L=a,w=c,F=g,Q=L.flags;switch(L.tag){case 0:case 11:case 15:kr(T,L,w,F,p),Za(8,L);break;case 23:break;case 22:var ee=L.stateNode;L.memoizedState!==null?ee._visibility&2?kr(T,L,w,F,p):el(T,L):(ee._visibility|=2,kr(T,L,w,F,p)),p&&Q&2048&&kf(L.alternate,L);break;case 24:kr(T,L,w,F,p),p&&Q&2048&&Nf(L.alternate,L);break;default:kr(T,L,w,F,p)}a=a.sibling}}function el(n,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=n,g=a,p=g.flags;switch(g.tag){case 22:el(c,g),p&2048&&kf(g.alternate,g);break;case 24:el(c,g),p&2048&&Nf(g.alternate,g);break;default:el(c,g)}a=a.sibling}}var tl=8192;function Nr(n){if(n.subtreeFlags&tl)for(n=n.child;n!==null;)Sp(n),n=n.sibling}function Sp(n){switch(n.tag){case 26:Nr(n),n.flags&tl&&n.memoizedState!==null&&u1(Hi,n.memoizedState,n.memoizedProps);break;case 5:Nr(n);break;case 3:case 4:var a=Hi;Hi=Qo(n.stateNode.containerInfo),Nr(n),Hi=a;break;case 22:n.memoizedState===null&&(a=n.alternate,a!==null&&a.memoizedState!==null?(a=tl,tl=16777216,Nr(n),tl=a):Nr(n));break;default:Nr(n)}}function Tp(n){var a=n.alternate;if(a!==null&&(n=a.child,n!==null)){a.child=null;do a=n.sibling,n.sibling=null,n=a;while(n!==null)}}function il(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var g=a[c];_t=g,xp(g,n)}Tp(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Ep(n),n=n.sibling}function Ep(n){switch(n.tag){case 0:case 11:case 15:il(n),n.flags&2048&&js(9,n,n.return);break;case 3:il(n);break;case 12:il(n);break;case 22:var a=n.stateNode;n.memoizedState!==null&&a._visibility&2&&(n.return===null||n.return.tag!==13)?(a._visibility&=-3,Fo(n)):il(n);break;default:il(n)}}function Fo(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var g=a[c];_t=g,xp(g,n)}Tp(n)}for(n=n.child;n!==null;){switch(a=n,a.tag){case 0:case 11:case 15:js(8,a,a.return),Fo(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,Fo(a));break;default:Fo(a)}n=n.sibling}}function xp(n,a){for(;_t!==null;){var c=_t;switch(c.tag){case 0:case 11:case 15:js(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var g=c.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Fa(c.memoizedState.cache)}if(g=c.child,g!==null)g.return=c,_t=g;else e:for(c=n;_t!==null;){g=_t;var p=g.sibling,T=g.return;if(hp(g),g===c){_t=null;break e}if(p!==null){p.return=T,_t=p;break e}_t=T}}}var A_={getCacheForType:function(n){var a=Nt(vt),c=a.data.get(n);return c===void 0&&(c=n(),a.data.set(n,c)),c}},L_=typeof WeakMap=="function"?WeakMap:Map,Fe=0,We=null,we=null,Pe=0,Ue=0,oi=null,Qs=!1,Br=!1,Bf=!1,Ls=0,at=0,Ws=0,zn=0,Ff=0,Ii=0,Fr=0,sl=null,Qt=null,Uf=!1,Gf=0,Uo=1/0,Go=null,Zs=null,wt=0,Js=null,Ur=null,Gr=0,$f=0,zf=null,_p=null,nl=0,Hf=null;function ui(){if((Fe&2)!==0&&Pe!==0)return Pe&-Pe;if(B.T!==null){var n=Rr;return n!==0?n:Qf()}return Ug()}function bp(){Ii===0&&(Ii=(Pe&536870912)===0||Be?kg():536870912);var n=Di.current;return n!==null&&(n.flags|=32),Ii}function ci(n,a,c){(n===We&&(Ue===2||Ue===9)||n.cancelPendingCommit!==null)&&($r(n,0),en(n,Pe,Ii,!1)),xa(n,c),((Fe&2)===0||n!==We)&&(n===We&&((Fe&2)===0&&(zn|=c),at===4&&en(n,Pe,Ii,!1)),ts(n))}function Ap(n,a,c){if((Fe&6)!==0)throw Error(i(327));var g=!c&&(a&124)===0&&(a&n.expiredLanes)===0||Ea(n,a),p=g?I_(n,a):Yf(n,a,!0),T=g;do{if(p===0){Br&&!g&&en(n,a,0,!1);break}else{if(c=n.current.alternate,T&&!R_(c)){p=Yf(n,a,!1),T=!1;continue}if(p===2){if(T=a,n.errorRecoveryDisabledLanes&T)var L=0;else L=n.pendingLanes&-536870913,L=L!==0?L:L&536870912?536870912:0;if(L!==0){a=L;e:{var w=n;p=sl;var F=w.current.memoizedState.isDehydrated;if(F&&($r(w,L).flags|=256),L=Yf(w,L,!1),L!==2){if(Bf&&!F){w.errorRecoveryDisabledLanes|=T,zn|=T,p=4;break e}T=Qt,Qt=p,T!==null&&(Qt===null?Qt=T:Qt.push.apply(Qt,T))}p=L}if(T=!1,p!==2)continue}}if(p===1){$r(n,0),en(n,a,0,!0);break}e:{switch(g=n,T=p,T){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:en(g,a,Ii,!Qs);break e;case 2:Qt=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(p=Gf+300-Ye(),10<p)){if(en(g,a,Ii,!Qs),Ql(g,0,!0)!==0)break e;g.timeoutHandle=ev(Lp.bind(null,g,c,Qt,Go,Uf,a,Ii,zn,Fr,Qs,T,2,-0,0),p);break e}Lp(g,c,Qt,Go,Uf,a,Ii,zn,Fr,Qs,T,0,-0,0)}}break}while(!0);ts(n)}function Lp(n,a,c,g,p,T,L,w,F,Q,ee,le,W,Z){if(n.timeoutHandle=-1,le=a.subtreeFlags,(le&8192||(le&16785408)===16785408)&&(fl={stylesheets:null,count:0,unsuspend:o1},Sp(a),le=c1(),le!==null)){n.cancelPendingCommit=le(Mp.bind(null,n,a,T,c,g,p,L,w,F,ee,1,W,Z)),en(n,T,L,!Q);return}Mp(n,a,T,c,g,p,L,w,F)}function R_(n){for(var a=n;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var g=0;g<c.length;g++){var p=c[g],T=p.getSnapshot;p=p.value;try{if(!ni(T(),p))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function en(n,a,c,g){a&=~Ff,a&=~zn,n.suspendedLanes|=a,n.pingedLanes&=~a,g&&(n.warmLanes|=a),g=n.expirationTimes;for(var p=a;0<p;){var T=31-Pt(p),L=1<<T;g[T]=-1,p&=~L}c!==0&&Bg(n,c,a)}function $o(){return(Fe&6)===0?(rl(0),!1):!0}function Vf(){if(we!==null){if(Ue===0)var n=we.return;else n=we,ys=Nn=null,lf(n),Mr=null,Xa=0,n=we;for(;n!==null;)rp(n.alternate,n),n=n.return;we=null}}function $r(n,a){var c=n.timeoutHandle;c!==-1&&(n.timeoutHandle=-1,K_(c)),c=n.cancelPendingCommit,c!==null&&(n.cancelPendingCommit=null,c()),Vf(),We=n,we=c=ms(n.current,null),Pe=a,Ue=0,oi=null,Qs=!1,Br=Ea(n,a),Bf=!1,Fr=Ii=Ff=zn=Ws=at=0,Qt=sl=null,Uf=!1,(a&8)!==0&&(a|=a&32);var g=n.entangledLanes;if(g!==0)for(n=n.entanglements,g&=a;0<g;){var p=31-Pt(g),T=1<<p;a|=n[p],g&=~T}return Ls=a,oo(),c}function Rp(n,a){Le=null,B.H=Do,a===Ga||a===yo?(a=Vm(),Ue=3):a===$m?(a=Vm(),Ue=4):Ue=a===K0?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,oi=a,we===null&&(at=1,Mo(n,bi(a,n.current)))}function Dp(){var n=B.H;return B.H=Do,n===null?Do:n}function Ip(){var n=B.A;return B.A=A_,n}function Kf(){at=4,Qs||(Pe&4194048)!==Pe&&Di.current!==null||(Br=!0),(Ws&134217727)===0&&(zn&134217727)===0||We===null||en(We,Pe,Ii,!1)}function Yf(n,a,c){var g=Fe;Fe|=2;var p=Dp(),T=Ip();(We!==n||Pe!==a)&&(Go=null,$r(n,a)),a=!1;var L=at;e:do try{if(Ue!==0&&we!==null){var w=we,F=oi;switch(Ue){case 8:Vf(),L=6;break e;case 3:case 2:case 9:case 6:Di.current===null&&(a=!0);var Q=Ue;if(Ue=0,oi=null,zr(n,w,F,Q),c&&Br){L=0;break e}break;default:Q=Ue,Ue=0,oi=null,zr(n,w,F,Q)}}D_(),L=at;break}catch(ee){Rp(n,ee)}while(!0);return a&&n.shellSuspendCounter++,ys=Nn=null,Fe=g,B.H=p,B.A=T,we===null&&(We=null,Pe=0,oo()),L}function D_(){for(;we!==null;)wp(we)}function I_(n,a){var c=Fe;Fe|=2;var g=Dp(),p=Ip();We!==n||Pe!==a?(Go=null,Uo=Ye()+500,$r(n,a)):Br=Ea(n,a);e:do try{if(Ue!==0&&we!==null){a=we;var T=oi;t:switch(Ue){case 1:Ue=0,oi=null,zr(n,a,T,1);break;case 2:case 9:if(zm(T)){Ue=0,oi=null,Cp(a);break}a=function(){Ue!==2&&Ue!==9||We!==n||(Ue=7),ts(n)},T.then(a,a);break e;case 3:Ue=7;break e;case 4:Ue=5;break e;case 7:zm(T)?(Ue=0,oi=null,Cp(a)):(Ue=0,oi=null,zr(n,a,T,7));break;case 5:var L=null;switch(we.tag){case 26:L=we.memoizedState;case 5:case 27:var w=we;if(!L||dv(L)){Ue=0,oi=null;var F=w.sibling;if(F!==null)we=F;else{var Q=w.return;Q!==null?(we=Q,zo(Q)):we=null}break t}}Ue=0,oi=null,zr(n,a,T,5);break;case 6:Ue=0,oi=null,zr(n,a,T,6);break;case 8:Vf(),at=6;break e;default:throw Error(i(462))}}w_();break}catch(ee){Rp(n,ee)}while(!0);return ys=Nn=null,B.H=g,B.A=p,Fe=c,we!==null?0:(We=null,Pe=0,oo(),at)}function w_(){for(;we!==null&&!Pg();)wp(we)}function wp(n){var a=sp(n.alternate,n,Ls);n.memoizedProps=n.pendingProps,a===null?zo(n):we=a}function Cp(n){var a=n,c=a.alternate;switch(a.tag){case 15:case 0:a=W0(c,a,a.pendingProps,a.type,void 0,Pe);break;case 11:a=W0(c,a,a.pendingProps,a.type.render,a.ref,Pe);break;case 5:lf(a);default:rp(c,a),a=we=Om(a,Ls),a=sp(c,a,Ls)}n.memoizedProps=n.pendingProps,a===null?zo(n):we=a}function zr(n,a,c,g){ys=Nn=null,lf(a),Mr=null,Xa=0;var p=a.return;try{if(S_(n,p,a,c,Pe)){at=1,Mo(n,bi(c,n.current)),we=null;return}}catch(T){if(p!==null)throw we=p,T;at=1,Mo(n,bi(c,n.current)),we=null;return}a.flags&32768?(Be||g===1?n=!0:Br||(Pe&536870912)!==0?n=!1:(Qs=n=!0,(g===2||g===9||g===3||g===6)&&(g=Di.current,g!==null&&g.tag===13&&(g.flags|=16384))),Op(a,n)):zo(a)}function zo(n){var a=n;do{if((a.flags&32768)!==0){Op(a,Qs);return}n=a.return;var c=E_(a.alternate,a,Ls);if(c!==null){we=c;return}if(a=a.sibling,a!==null){we=a;return}we=a=n}while(a!==null);at===0&&(at=5)}function Op(n,a){do{var c=x_(n.alternate,n);if(c!==null){c.flags&=32767,we=c;return}if(c=n.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(n=n.sibling,n!==null)){we=n;return}we=n=c}while(n!==null);at=6,we=null}function Mp(n,a,c,g,p,T,L,w,F){n.cancelPendingCommit=null;do Ho();while(wt!==0);if((Fe&6)!==0)throw Error(i(327));if(a!==null){if(a===n.current)throw Error(i(177));if(T=a.lanes|a.childLanes,T|=kc,ox(n,c,T,L,w,F),n===We&&(we=We=null,Pe=0),Ur=a,Js=n,Gr=c,$f=T,zf=p,_p=g,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,P_(Gi,function(){return Fp(),null})):(n.callbackNode=null,n.callbackPriority=0),g=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||g){g=B.T,B.T=null,p=K.p,K.p=2,L=Fe,Fe|=4;try{__(n,a,c)}finally{Fe=L,K.p=p,B.T=g}}wt=1,Pp(),kp(),Np()}}function Pp(){if(wt===1){wt=0;var n=Js,a=Ur,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=B.T,B.T=null;var g=K.p;K.p=2;var p=Fe;Fe|=4;try{pp(a,n);var T=nd,L=xm(n.containerInfo),w=T.focusedElem,F=T.selectionRange;if(L!==w&&w&&w.ownerDocument&&Em(w.ownerDocument.documentElement,w)){if(F!==null&&wc(w)){var Q=F.start,ee=F.end;if(ee===void 0&&(ee=Q),"selectionStart"in w)w.selectionStart=Q,w.selectionEnd=Math.min(ee,w.value.length);else{var le=w.ownerDocument||document,W=le&&le.defaultView||window;if(W.getSelection){var Z=W.getSelection(),Ee=w.textContent.length,Se=Math.min(F.start,Ee),Ve=F.end===void 0?Se:Math.min(F.end,Ee);!Z.extend&&Se>Ve&&(L=Ve,Ve=Se,Se=L);var z=Tm(w,Se),G=Tm(w,Ve);if(z&&G&&(Z.rangeCount!==1||Z.anchorNode!==z.node||Z.anchorOffset!==z.offset||Z.focusNode!==G.node||Z.focusOffset!==G.offset)){var Y=le.createRange();Y.setStart(z.node,z.offset),Z.removeAllRanges(),Se>Ve?(Z.addRange(Y),Z.extend(G.node,G.offset)):(Y.setEnd(G.node,G.offset),Z.addRange(Y))}}}}for(le=[],Z=w;Z=Z.parentNode;)Z.nodeType===1&&le.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<le.length;w++){var ae=le[w];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}tu=!!sd,nd=sd=null}finally{Fe=p,K.p=g,B.T=c}}n.current=a,wt=2}}function kp(){if(wt===2){wt=0;var n=Js,a=Ur,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=B.T,B.T=null;var g=K.p;K.p=2;var p=Fe;Fe|=4;try{dp(n,a.alternate,a)}finally{Fe=p,K.p=g,B.T=c}}wt=3}}function Np(){if(wt===4||wt===3){wt=0,Me();var n=Js,a=Ur,c=Gr,g=_p;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?wt=5:(wt=0,Ur=Js=null,Bp(n,n.pendingLanes));var p=n.pendingLanes;if(p===0&&(Zs=null),uc(c),a=a.stateNode,Mt&&typeof Mt.onCommitFiberRoot=="function")try{Mt.onCommitFiberRoot($i,a,void 0,(a.current.flags&128)===128)}catch{}if(g!==null){a=B.T,p=K.p,K.p=2,B.T=null;try{for(var T=n.onRecoverableError,L=0;L<g.length;L++){var w=g[L];T(w.value,{componentStack:w.stack})}}finally{B.T=a,K.p=p}}(Gr&3)!==0&&Ho(),ts(n),p=n.pendingLanes,(c&4194090)!==0&&(p&42)!==0?n===Hf?nl++:(nl=0,Hf=n):nl=0,rl(0)}}function Bp(n,a){(n.pooledCacheLanes&=a)===0&&(a=n.pooledCache,a!=null&&(n.pooledCache=null,Fa(a)))}function Ho(n){return Pp(),kp(),Np(),Fp()}function Fp(){if(wt!==5)return!1;var n=Js,a=$f;$f=0;var c=uc(Gr),g=B.T,p=K.p;try{K.p=32>c?32:c,B.T=null,c=zf,zf=null;var T=Js,L=Gr;if(wt=0,Ur=Js=null,Gr=0,(Fe&6)!==0)throw Error(i(331));var w=Fe;if(Fe|=4,Ep(T.current),yp(T,T.current,L,c),Fe=w,rl(0,!1),Mt&&typeof Mt.onPostCommitFiberRoot=="function")try{Mt.onPostCommitFiberRoot($i,T)}catch{}return!0}finally{K.p=p,B.T=g,Bp(n,a)}}function Up(n,a,c){a=bi(c,a),a=Ef(n.stateNode,a,2),n=Hs(n,a,2),n!==null&&(xa(n,2),ts(n))}function je(n,a,c){if(n.tag===3)Up(n,n,c);else for(;a!==null;){if(a.tag===3){Up(a,n,c);break}else if(a.tag===1){var g=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Zs===null||!Zs.has(g))){n=bi(c,n),c=H0(2),g=Hs(a,c,2),g!==null&&(V0(c,g,a,n),xa(g,2),ts(g));break}}a=a.return}}function jf(n,a,c){var g=n.pingCache;if(g===null){g=n.pingCache=new L_;var p=new Set;g.set(a,p)}else p=g.get(a),p===void 0&&(p=new Set,g.set(a,p));p.has(c)||(Bf=!0,p.add(c),n=C_.bind(null,n,a,c),a.then(n,n))}function C_(n,a,c){var g=n.pingCache;g!==null&&g.delete(a),n.pingedLanes|=n.suspendedLanes&c,n.warmLanes&=~c,We===n&&(Pe&c)===c&&(at===4||at===3&&(Pe&62914560)===Pe&&300>Ye()-Gf?(Fe&2)===0&&$r(n,0):Ff|=c,Fr===Pe&&(Fr=0)),ts(n)}function Gp(n,a){a===0&&(a=Ng()),n=_r(n,a),n!==null&&(xa(n,a),ts(n))}function O_(n){var a=n.memoizedState,c=0;a!==null&&(c=a.retryLane),Gp(n,c)}function M_(n,a){var c=0;switch(n.tag){case 13:var g=n.stateNode,p=n.memoizedState;p!==null&&(c=p.retryLane);break;case 19:g=n.stateNode;break;case 22:g=n.stateNode._retryCache;break;default:throw Error(i(314))}g!==null&&g.delete(a),Gp(n,c)}function P_(n,a){return _n(n,a)}var Vo=null,Hr=null,qf=!1,Ko=!1,Xf=!1,Hn=0;function ts(n){n!==Hr&&n.next===null&&(Hr===null?Vo=Hr=n:Hr=Hr.next=n),Ko=!0,qf||(qf=!0,N_())}function rl(n,a){if(!Xf&&Ko){Xf=!0;do for(var c=!1,g=Vo;g!==null;){if(n!==0){var p=g.pendingLanes;if(p===0)var T=0;else{var L=g.suspendedLanes,w=g.pingedLanes;T=(1<<31-Pt(42|n)+1)-1,T&=p&~(L&~w),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(c=!0,Vp(g,T))}else T=Pe,T=Ql(g,g===We?T:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(T&3)===0||Ea(g,T)||(c=!0,Vp(g,T));g=g.next}while(c);Xf=!1}}function k_(){$p()}function $p(){Ko=qf=!1;var n=0;Hn!==0&&(V_()&&(n=Hn),Hn=0);for(var a=Ye(),c=null,g=Vo;g!==null;){var p=g.next,T=zp(g,a);T===0?(g.next=null,c===null?Vo=p:c.next=p,p===null&&(Hr=c)):(c=g,(n!==0||(T&3)!==0)&&(Ko=!0)),g=p}rl(n)}function zp(n,a){for(var c=n.suspendedLanes,g=n.pingedLanes,p=n.expirationTimes,T=n.pendingLanes&-62914561;0<T;){var L=31-Pt(T),w=1<<L,F=p[L];F===-1?((w&c)===0||(w&g)!==0)&&(p[L]=lx(w,a)):F<=a&&(n.expiredLanes|=w),T&=~w}if(a=We,c=Pe,c=Ql(n,n===a?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),g=n.callbackNode,c===0||n===a&&(Ue===2||Ue===9)||n.cancelPendingCommit!==null)return g!==null&&g!==null&&bn(g),n.callbackNode=null,n.callbackPriority=0;if((c&3)===0||Ea(n,c)){if(a=c&-c,a===n.callbackPriority)return a;switch(g!==null&&bn(g),uc(c)){case 2:case 8:c=Kt;break;case 32:c=Gi;break;case 268435456:c=Ta;break;default:c=Gi}return g=Hp.bind(null,n),c=_n(c,g),n.callbackPriority=a,n.callbackNode=c,a}return g!==null&&g!==null&&bn(g),n.callbackPriority=2,n.callbackNode=null,2}function Hp(n,a){if(wt!==0&&wt!==5)return n.callbackNode=null,n.callbackPriority=0,null;var c=n.callbackNode;if(Ho()&&n.callbackNode!==c)return null;var g=Pe;return g=Ql(n,n===We?g:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),g===0?null:(Ap(n,g,a),zp(n,Ye()),n.callbackNode!=null&&n.callbackNode===c?Hp.bind(null,n):null)}function Vp(n,a){if(Ho())return null;Ap(n,a,!0)}function N_(){Y_(function(){(Fe&6)!==0?_n(Xi,k_):$p()})}function Qf(){return Hn===0&&(Hn=kg()),Hn}function Kp(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:to(""+n)}function Yp(n,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,n.id&&c.setAttribute("form",n.id),a.parentNode.insertBefore(c,a),n=new FormData(n),c.parentNode.removeChild(c),n}function B_(n,a,c,g,p){if(a==="submit"&&c&&c.stateNode===p){var T=Kp((p[Yt]||null).action),L=g.submitter;L&&(a=(a=L[Yt]||null)?Kp(a.formAction):L.getAttribute("formAction"),a!==null&&(T=a,L=null));var w=new ro("action","action",null,g,p);n.push({event:w,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(Hn!==0){var F=L?Yp(p,L):new FormData(p);pf(c,{pending:!0,data:F,method:p.method,action:T},null,F)}}else typeof T=="function"&&(w.preventDefault(),F=L?Yp(p,L):new FormData(p),pf(c,{pending:!0,data:F,method:p.method,action:T},T,F))},currentTarget:p}]})}}for(var Wf=0;Wf<Pc.length;Wf++){var Zf=Pc[Wf],F_=Zf.toLowerCase(),U_=Zf[0].toUpperCase()+Zf.slice(1);zi(F_,"on"+U_)}zi(Am,"onAnimationEnd"),zi(Lm,"onAnimationIteration"),zi(Rm,"onAnimationStart"),zi("dblclick","onDoubleClick"),zi("focusin","onFocus"),zi("focusout","onBlur"),zi(i_,"onTransitionRun"),zi(s_,"onTransitionStart"),zi(n_,"onTransitionCancel"),zi(Dm,"onTransitionEnd"),hr("onMouseEnter",["mouseout","mouseover"]),hr("onMouseLeave",["mouseout","mouseover"]),hr("onPointerEnter",["pointerout","pointerover"]),hr("onPointerLeave",["pointerout","pointerover"]),Rn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Rn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Rn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Rn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Rn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Rn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var al="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(al));function jp(n,a){a=(a&4)!==0;for(var c=0;c<n.length;c++){var g=n[c],p=g.event;g=g.listeners;e:{var T=void 0;if(a)for(var L=g.length-1;0<=L;L--){var w=g[L],F=w.instance,Q=w.currentTarget;if(w=w.listener,F!==T&&p.isPropagationStopped())break e;T=w,p.currentTarget=Q;try{T(p)}catch(ee){Oo(ee)}p.currentTarget=null,T=F}else for(L=0;L<g.length;L++){if(w=g[L],F=w.instance,Q=w.currentTarget,w=w.listener,F!==T&&p.isPropagationStopped())break e;T=w,p.currentTarget=Q;try{T(p)}catch(ee){Oo(ee)}p.currentTarget=null,T=F}}}}function Ce(n,a){var c=a[cc];c===void 0&&(c=a[cc]=new Set);var g=n+"__bubble";c.has(g)||(qp(a,n,2,!1),c.add(g))}function Jf(n,a,c){var g=0;a&&(g|=4),qp(c,n,g,a)}var Yo="_reactListening"+Math.random().toString(36).slice(2);function ed(n){if(!n[Yo]){n[Yo]=!0,$g.forEach(function(c){c!=="selectionchange"&&(G_.has(c)||Jf(c,!1,n),Jf(c,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[Yo]||(a[Yo]=!0,Jf("selectionchange",!1,a))}}function qp(n,a,c,g){switch(yv(a)){case 2:var p=h1;break;case 8:p=g1;break;default:p=gd}c=p.bind(null,a,c,n),p=void 0,!Ec||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(p=!0),g?p!==void 0?n.addEventListener(a,c,{capture:!0,passive:p}):n.addEventListener(a,c,!0):p!==void 0?n.addEventListener(a,c,{passive:p}):n.addEventListener(a,c,!1)}function td(n,a,c,g,p){var T=g;if((a&1)===0&&(a&2)===0&&g!==null)e:for(;;){if(g===null)return;var L=g.tag;if(L===3||L===4){var w=g.stateNode.containerInfo;if(w===p)break;if(L===4)for(L=g.return;L!==null;){var F=L.tag;if((F===3||F===4)&&L.stateNode.containerInfo===p)return;L=L.return}for(;w!==null;){if(L=cr(w),L===null)return;if(F=L.tag,F===5||F===6||F===26||F===27){g=T=L;continue e}w=w.parentNode}}g=g.return}tm(function(){var Q=T,ee=Sc(c),le=[];e:{var W=Im.get(n);if(W!==void 0){var Z=ro,Ee=n;switch(n){case"keypress":if(so(c)===0)break e;case"keydown":case"keyup":Z=Px;break;case"focusin":Ee="focus",Z=Ac;break;case"focusout":Ee="blur",Z=Ac;break;case"beforeblur":case"afterblur":Z=Ac;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=nm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=xx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=Bx;break;case Am:case Lm:case Rm:Z=Ax;break;case Dm:Z=Ux;break;case"scroll":case"scrollend":Z=Tx;break;case"wheel":Z=$x;break;case"copy":case"cut":case"paste":Z=Rx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=am;break;case"toggle":case"beforetoggle":Z=Hx}var Se=(a&4)!==0,Ve=!Se&&(n==="scroll"||n==="scrollend"),z=Se?W!==null?W+"Capture":null:W;Se=[];for(var G=Q,Y;G!==null;){var ae=G;if(Y=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||Y===null||z===null||(ae=Aa(G,z),ae!=null&&Se.push(ll(G,ae,Y))),Ve)break;G=G.return}0<Se.length&&(W=new Z(W,Ee,null,c,ee),le.push({event:W,listeners:Se}))}}if((a&7)===0){e:{if(W=n==="mouseover"||n==="pointerover",Z=n==="mouseout"||n==="pointerout",W&&c!==yc&&(Ee=c.relatedTarget||c.fromElement)&&(cr(Ee)||Ee[ur]))break e;if((Z||W)&&(W=ee.window===ee?ee:(W=ee.ownerDocument)?W.defaultView||W.parentWindow:window,Z?(Ee=c.relatedTarget||c.toElement,Z=Q,Ee=Ee?cr(Ee):null,Ee!==null&&(Ve=r(Ee),Se=Ee.tag,Ee!==Ve||Se!==5&&Se!==27&&Se!==6)&&(Ee=null)):(Z=null,Ee=Q),Z!==Ee)){if(Se=nm,ae="onMouseLeave",z="onMouseEnter",G="mouse",(n==="pointerout"||n==="pointerover")&&(Se=am,ae="onPointerLeave",z="onPointerEnter",G="pointer"),Ve=Z==null?W:ba(Z),Y=Ee==null?W:ba(Ee),W=new Se(ae,G+"leave",Z,c,ee),W.target=Ve,W.relatedTarget=Y,ae=null,cr(ee)===Q&&(Se=new Se(z,G+"enter",Ee,c,ee),Se.target=Y,Se.relatedTarget=Ve,ae=Se),Ve=ae,Z&&Ee)t:{for(Se=Z,z=Ee,G=0,Y=Se;Y;Y=Vr(Y))G++;for(Y=0,ae=z;ae;ae=Vr(ae))Y++;for(;0<G-Y;)Se=Vr(Se),G--;for(;0<Y-G;)z=Vr(z),Y--;for(;G--;){if(Se===z||z!==null&&Se===z.alternate)break t;Se=Vr(Se),z=Vr(z)}Se=null}else Se=null;Z!==null&&Xp(le,W,Z,Se,!1),Ee!==null&&Ve!==null&&Xp(le,Ve,Ee,Se,!0)}}e:{if(W=Q?ba(Q):window,Z=W.nodeName&&W.nodeName.toLowerCase(),Z==="select"||Z==="input"&&W.type==="file")var me=gm;else if(dm(W))if(mm)me=Jx;else{me=Wx;var De=Qx}else Z=W.nodeName,!Z||Z.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?Q&&vc(Q.elementType)&&(me=gm):me=Zx;if(me&&(me=me(n,Q))){hm(le,me,c,ee);break e}De&&De(n,W,Q),n==="focusout"&&Q&&W.type==="number"&&Q.memoizedProps.value!=null&&pc(W,"number",W.value)}switch(De=Q?ba(Q):window,n){case"focusin":(dm(De)||De.contentEditable==="true")&&(Tr=De,Cc=Q,Ma=null);break;case"focusout":Ma=Cc=Tr=null;break;case"mousedown":Oc=!0;break;case"contextmenu":case"mouseup":case"dragend":Oc=!1,_m(le,c,ee);break;case"selectionchange":if(t_)break;case"keydown":case"keyup":_m(le,c,ee)}var ye;if(Rc)e:{switch(n){case"compositionstart":var Te="onCompositionStart";break e;case"compositionend":Te="onCompositionEnd";break e;case"compositionupdate":Te="onCompositionUpdate";break e}Te=void 0}else Sr?cm(n,c)&&(Te="onCompositionEnd"):n==="keydown"&&c.keyCode===229&&(Te="onCompositionStart");Te&&(lm&&c.locale!=="ko"&&(Sr||Te!=="onCompositionStart"?Te==="onCompositionEnd"&&Sr&&(ye=im()):(Us=ee,xc="value"in Us?Us.value:Us.textContent,Sr=!0)),De=jo(Q,Te),0<De.length&&(Te=new rm(Te,n,null,c,ee),le.push({event:Te,listeners:De}),ye?Te.data=ye:(ye=fm(c),ye!==null&&(Te.data=ye)))),(ye=Kx?Yx(n,c):jx(n,c))&&(Te=jo(Q,"onBeforeInput"),0<Te.length&&(De=new rm("onBeforeInput","beforeinput",null,c,ee),le.push({event:De,listeners:Te}),De.data=ye)),B_(le,n,Q,c,ee)}jp(le,a)})}function ll(n,a,c){return{instance:n,listener:a,currentTarget:c}}function jo(n,a){for(var c=a+"Capture",g=[];n!==null;){var p=n,T=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||T===null||(p=Aa(n,c),p!=null&&g.unshift(ll(n,p,T)),p=Aa(n,a),p!=null&&g.push(ll(n,p,T))),n.tag===3)return g;n=n.return}return[]}function Vr(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Xp(n,a,c,g,p){for(var T=a._reactName,L=[];c!==null&&c!==g;){var w=c,F=w.alternate,Q=w.stateNode;if(w=w.tag,F!==null&&F===g)break;w!==5&&w!==26&&w!==27||Q===null||(F=Q,p?(Q=Aa(c,T),Q!=null&&L.unshift(ll(c,Q,F))):p||(Q=Aa(c,T),Q!=null&&L.push(ll(c,Q,F)))),c=c.return}L.length!==0&&n.push({event:a,listeners:L})}var $_=/\r\n?/g,z_=/\u0000|\uFFFD/g;function Qp(n){return(typeof n=="string"?n:""+n).replace($_,`
`).replace(z_,"")}function Wp(n,a){return a=Qp(a),Qp(n)===a}function qo(){}function He(n,a,c,g,p,T){switch(c){case"children":typeof g=="string"?a==="body"||a==="textarea"&&g===""||pr(n,g):(typeof g=="number"||typeof g=="bigint")&&a!=="body"&&pr(n,""+g);break;case"className":Zl(n,"class",g);break;case"tabIndex":Zl(n,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Zl(n,c,g);break;case"style":Jg(n,g,T);break;case"data":if(a!=="object"){Zl(n,"data",g);break}case"src":case"href":if(g===""&&(a!=="a"||c!=="href")){n.removeAttribute(c);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){n.removeAttribute(c);break}g=to(""+g),n.setAttribute(c,g);break;case"action":case"formAction":if(typeof g=="function"){n.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(c==="formAction"?(a!=="input"&&He(n,a,"name",p.name,p,null),He(n,a,"formEncType",p.formEncType,p,null),He(n,a,"formMethod",p.formMethod,p,null),He(n,a,"formTarget",p.formTarget,p,null)):(He(n,a,"encType",p.encType,p,null),He(n,a,"method",p.method,p,null),He(n,a,"target",p.target,p,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){n.removeAttribute(c);break}g=to(""+g),n.setAttribute(c,g);break;case"onClick":g!=null&&(n.onclick=qo);break;case"onScroll":g!=null&&Ce("scroll",n);break;case"onScrollEnd":g!=null&&Ce("scrollend",n);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(i(61));if(c=g.__html,c!=null){if(p.children!=null)throw Error(i(60));n.innerHTML=c}}break;case"multiple":n.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":n.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){n.removeAttribute("xlink:href");break}c=to(""+g),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?n.setAttribute(c,""+g):n.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?n.setAttribute(c,""):n.removeAttribute(c);break;case"capture":case"download":g===!0?n.setAttribute(c,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?n.setAttribute(c,g):n.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?n.setAttribute(c,g):n.removeAttribute(c);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?n.removeAttribute(c):n.setAttribute(c,g);break;case"popover":Ce("beforetoggle",n),Ce("toggle",n),Wl(n,"popover",g);break;case"xlinkActuate":hs(n,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":hs(n,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":hs(n,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":hs(n,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":hs(n,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":hs(n,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":hs(n,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":hs(n,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":hs(n,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Wl(n,"is",g);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=yx.get(c)||c,Wl(n,c,g))}}function id(n,a,c,g,p,T){switch(c){case"style":Jg(n,g,T);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(i(61));if(c=g.__html,c!=null){if(p.children!=null)throw Error(i(60));n.innerHTML=c}}break;case"children":typeof g=="string"?pr(n,g):(typeof g=="number"||typeof g=="bigint")&&pr(n,""+g);break;case"onScroll":g!=null&&Ce("scroll",n);break;case"onScrollEnd":g!=null&&Ce("scrollend",n);break;case"onClick":g!=null&&(n.onclick=qo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zg.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(p=c.endsWith("Capture"),a=c.slice(2,p?c.length-7:void 0),T=n[Yt]||null,T=T!=null?T[c]:null,typeof T=="function"&&n.removeEventListener(a,T,p),typeof g=="function")){typeof T!="function"&&T!==null&&(c in n?n[c]=null:n.hasAttribute(c)&&n.removeAttribute(c)),n.addEventListener(a,g,p);break e}c in n?n[c]=g:g===!0?n.setAttribute(c,""):Wl(n,c,g)}}}function Ct(n,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ce("error",n),Ce("load",n);var g=!1,p=!1,T;for(T in c)if(c.hasOwnProperty(T)){var L=c[T];if(L!=null)switch(T){case"src":g=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:He(n,a,T,L,c,null)}}p&&He(n,a,"srcSet",c.srcSet,c,null),g&&He(n,a,"src",c.src,c,null);return;case"input":Ce("invalid",n);var w=T=L=p=null,F=null,Q=null;for(g in c)if(c.hasOwnProperty(g)){var ee=c[g];if(ee!=null)switch(g){case"name":p=ee;break;case"type":L=ee;break;case"checked":F=ee;break;case"defaultChecked":Q=ee;break;case"value":T=ee;break;case"defaultValue":w=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(i(137,a));break;default:He(n,a,g,ee,c,null)}}Xg(n,T,w,F,Q,L,p,!1),Jl(n);return;case"select":Ce("invalid",n),g=L=T=null;for(p in c)if(c.hasOwnProperty(p)&&(w=c[p],w!=null))switch(p){case"value":T=w;break;case"defaultValue":L=w;break;case"multiple":g=w;default:He(n,a,p,w,c,null)}a=T,c=L,n.multiple=!!g,a!=null?mr(n,!!g,a,!1):c!=null&&mr(n,!!g,c,!0);return;case"textarea":Ce("invalid",n),T=p=g=null;for(L in c)if(c.hasOwnProperty(L)&&(w=c[L],w!=null))switch(L){case"value":g=w;break;case"defaultValue":p=w;break;case"children":T=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(i(91));break;default:He(n,a,L,w,c,null)}Wg(n,g,p,T),Jl(n);return;case"option":for(F in c)if(c.hasOwnProperty(F)&&(g=c[F],g!=null))switch(F){case"selected":n.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:He(n,a,F,g,c,null)}return;case"dialog":Ce("beforetoggle",n),Ce("toggle",n),Ce("cancel",n),Ce("close",n);break;case"iframe":case"object":Ce("load",n);break;case"video":case"audio":for(g=0;g<al.length;g++)Ce(al[g],n);break;case"image":Ce("error",n),Ce("load",n);break;case"details":Ce("toggle",n);break;case"embed":case"source":case"link":Ce("error",n),Ce("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in c)if(c.hasOwnProperty(Q)&&(g=c[Q],g!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:He(n,a,Q,g,c,null)}return;default:if(vc(a)){for(ee in c)c.hasOwnProperty(ee)&&(g=c[ee],g!==void 0&&id(n,a,ee,g,c,void 0));return}}for(w in c)c.hasOwnProperty(w)&&(g=c[w],g!=null&&He(n,a,w,g,c,null))}function H_(n,a,c,g){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,T=null,L=null,w=null,F=null,Q=null,ee=null;for(Z in c){var le=c[Z];if(c.hasOwnProperty(Z)&&le!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":F=le;default:g.hasOwnProperty(Z)||He(n,a,Z,null,g,le)}}for(var W in g){var Z=g[W];if(le=c[W],g.hasOwnProperty(W)&&(Z!=null||le!=null))switch(W){case"type":T=Z;break;case"name":p=Z;break;case"checked":Q=Z;break;case"defaultChecked":ee=Z;break;case"value":L=Z;break;case"defaultValue":w=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,a));break;default:Z!==le&&He(n,a,W,Z,g,le)}}mc(n,L,w,F,Q,ee,T,p);return;case"select":Z=L=w=W=null;for(T in c)if(F=c[T],c.hasOwnProperty(T)&&F!=null)switch(T){case"value":break;case"multiple":Z=F;default:g.hasOwnProperty(T)||He(n,a,T,null,g,F)}for(p in g)if(T=g[p],F=c[p],g.hasOwnProperty(p)&&(T!=null||F!=null))switch(p){case"value":W=T;break;case"defaultValue":w=T;break;case"multiple":L=T;default:T!==F&&He(n,a,p,T,g,F)}a=w,c=L,g=Z,W!=null?mr(n,!!c,W,!1):!!g!=!!c&&(a!=null?mr(n,!!c,a,!0):mr(n,!!c,c?[]:"",!1));return;case"textarea":Z=W=null;for(w in c)if(p=c[w],c.hasOwnProperty(w)&&p!=null&&!g.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:He(n,a,w,null,g,p)}for(L in g)if(p=g[L],T=c[L],g.hasOwnProperty(L)&&(p!=null||T!=null))switch(L){case"value":W=p;break;case"defaultValue":Z=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==T&&He(n,a,L,p,g,T)}Qg(n,W,Z);return;case"option":for(var Ee in c)if(W=c[Ee],c.hasOwnProperty(Ee)&&W!=null&&!g.hasOwnProperty(Ee))switch(Ee){case"selected":n.selected=!1;break;default:He(n,a,Ee,null,g,W)}for(F in g)if(W=g[F],Z=c[F],g.hasOwnProperty(F)&&W!==Z&&(W!=null||Z!=null))switch(F){case"selected":n.selected=W&&typeof W!="function"&&typeof W!="symbol";break;default:He(n,a,F,W,g,Z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Se in c)W=c[Se],c.hasOwnProperty(Se)&&W!=null&&!g.hasOwnProperty(Se)&&He(n,a,Se,null,g,W);for(Q in g)if(W=g[Q],Z=c[Q],g.hasOwnProperty(Q)&&W!==Z&&(W!=null||Z!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(137,a));break;default:He(n,a,Q,W,g,Z)}return;default:if(vc(a)){for(var Ve in c)W=c[Ve],c.hasOwnProperty(Ve)&&W!==void 0&&!g.hasOwnProperty(Ve)&&id(n,a,Ve,void 0,g,W);for(ee in g)W=g[ee],Z=c[ee],!g.hasOwnProperty(ee)||W===Z||W===void 0&&Z===void 0||id(n,a,ee,W,g,Z);return}}for(var z in c)W=c[z],c.hasOwnProperty(z)&&W!=null&&!g.hasOwnProperty(z)&&He(n,a,z,null,g,W);for(le in g)W=g[le],Z=c[le],!g.hasOwnProperty(le)||W===Z||W==null&&Z==null||He(n,a,le,W,g,Z)}var sd=null,nd=null;function Xo(n){return n.nodeType===9?n:n.ownerDocument}function Zp(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Jp(n,a){if(n===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&a==="foreignObject"?0:n}function rd(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var ad=null;function V_(){var n=window.event;return n&&n.type==="popstate"?n===ad?!1:(ad=n,!0):(ad=null,!1)}var ev=typeof setTimeout=="function"?setTimeout:void 0,K_=typeof clearTimeout=="function"?clearTimeout:void 0,tv=typeof Promise=="function"?Promise:void 0,Y_=typeof queueMicrotask=="function"?queueMicrotask:typeof tv<"u"?function(n){return tv.resolve(null).then(n).catch(j_)}:ev;function j_(n){setTimeout(function(){throw n})}function tn(n){return n==="head"}function iv(n,a){var c=a,g=0,p=0;do{var T=c.nextSibling;if(n.removeChild(c),T&&T.nodeType===8)if(c=T.data,c==="/$"){if(0<g&&8>g){c=g;var L=n.ownerDocument;if(c&1&&ol(L.documentElement),c&2&&ol(L.body),c&4)for(c=L.head,ol(c),L=c.firstChild;L;){var w=L.nextSibling,F=L.nodeName;L[_a]||F==="SCRIPT"||F==="STYLE"||F==="LINK"&&L.rel.toLowerCase()==="stylesheet"||c.removeChild(L),L=w}}if(p===0){n.removeChild(T),pl(a);return}p--}else c==="$"||c==="$?"||c==="$!"?p++:g=c.charCodeAt(0)-48;else g=0;c=T}while(c);pl(a)}function ld(n){var a=n.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":ld(c),fc(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}n.removeChild(c)}}function q_(n,a,c,g){for(;n.nodeType===1;){var p=c;if(n.nodeName.toLowerCase()!==a.toLowerCase()){if(!g&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(g){if(!n[_a])switch(a){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(T=n.getAttribute("rel"),T==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(T!==p.rel||n.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||n.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||n.getAttribute("title")!==(p.title==null?null:p.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(T=n.getAttribute("src"),(T!==(p.src==null?null:p.src)||n.getAttribute("type")!==(p.type==null?null:p.type)||n.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&T&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(a==="input"&&n.type==="hidden"){var T=p.name==null?null:""+p.name;if(p.type==="hidden"&&n.getAttribute("name")===T)return n}else return n;if(n=Vi(n.nextSibling),n===null)break}return null}function X_(n,a,c){if(a==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!c||(n=Vi(n.nextSibling),n===null))return null;return n}function od(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function Q_(n,a){var c=n.ownerDocument;if(n.data!=="$?"||c.readyState==="complete")a();else{var g=function(){a(),c.removeEventListener("DOMContentLoaded",g)};c.addEventListener("DOMContentLoaded",g),n._reactRetry=g}}function Vi(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return n}var ud=null;function sv(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var c=n.data;if(c==="$"||c==="$!"||c==="$?"){if(a===0)return n;a--}else c==="/$"&&a++}n=n.previousSibling}return null}function nv(n,a,c){switch(a=Xo(c),n){case"html":if(n=a.documentElement,!n)throw Error(i(452));return n;case"head":if(n=a.head,!n)throw Error(i(453));return n;case"body":if(n=a.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function ol(n){for(var a=n.attributes;a.length;)n.removeAttributeNode(a[0]);fc(n)}var wi=new Map,rv=new Set;function Qo(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Rs=K.d;K.d={f:W_,r:Z_,D:J_,C:e1,L:t1,m:i1,X:n1,S:s1,M:r1};function W_(){var n=Rs.f(),a=$o();return n||a}function Z_(n){var a=fr(n);a!==null&&a.tag===5&&a.type==="form"?A0(a):Rs.r(n)}var Kr=typeof document>"u"?null:document;function av(n,a,c){var g=Kr;if(g&&typeof a=="string"&&a){var p=_i(a);p='link[rel="'+n+'"][href="'+p+'"]',typeof c=="string"&&(p+='[crossorigin="'+c+'"]'),rv.has(p)||(rv.add(p),n={rel:n,crossOrigin:c,href:a},g.querySelector(p)===null&&(a=g.createElement("link"),Ct(a,"link",n),Et(a),g.head.appendChild(a)))}}function J_(n){Rs.D(n),av("dns-prefetch",n,null)}function e1(n,a){Rs.C(n,a),av("preconnect",n,a)}function t1(n,a,c){Rs.L(n,a,c);var g=Kr;if(g&&n&&a){var p='link[rel="preload"][as="'+_i(a)+'"]';a==="image"&&c&&c.imageSrcSet?(p+='[imagesrcset="'+_i(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(p+='[imagesizes="'+_i(c.imageSizes)+'"]')):p+='[href="'+_i(n)+'"]';var T=p;switch(a){case"style":T=Yr(n);break;case"script":T=jr(n)}wi.has(T)||(n=h({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:n,as:a},c),wi.set(T,n),g.querySelector(p)!==null||a==="style"&&g.querySelector(ul(T))||a==="script"&&g.querySelector(cl(T))||(a=g.createElement("link"),Ct(a,"link",n),Et(a),g.head.appendChild(a)))}}function i1(n,a){Rs.m(n,a);var c=Kr;if(c&&n){var g=a&&typeof a.as=="string"?a.as:"script",p='link[rel="modulepreload"][as="'+_i(g)+'"][href="'+_i(n)+'"]',T=p;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=jr(n)}if(!wi.has(T)&&(n=h({rel:"modulepreload",href:n},a),wi.set(T,n),c.querySelector(p)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(cl(T)))return}g=c.createElement("link"),Ct(g,"link",n),Et(g),c.head.appendChild(g)}}}function s1(n,a,c){Rs.S(n,a,c);var g=Kr;if(g&&n){var p=dr(g).hoistableStyles,T=Yr(n);a=a||"default";var L=p.get(T);if(!L){var w={loading:0,preload:null};if(L=g.querySelector(ul(T)))w.loading=5;else{n=h({rel:"stylesheet",href:n,"data-precedence":a},c),(c=wi.get(T))&&cd(n,c);var F=L=g.createElement("link");Et(F),Ct(F,"link",n),F._p=new Promise(function(Q,ee){F.onload=Q,F.onerror=ee}),F.addEventListener("load",function(){w.loading|=1}),F.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Wo(L,a,g)}L={type:"stylesheet",instance:L,count:1,state:w},p.set(T,L)}}}function n1(n,a){Rs.X(n,a);var c=Kr;if(c&&n){var g=dr(c).hoistableScripts,p=jr(n),T=g.get(p);T||(T=c.querySelector(cl(p)),T||(n=h({src:n,async:!0},a),(a=wi.get(p))&&fd(n,a),T=c.createElement("script"),Et(T),Ct(T,"link",n),c.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},g.set(p,T))}}function r1(n,a){Rs.M(n,a);var c=Kr;if(c&&n){var g=dr(c).hoistableScripts,p=jr(n),T=g.get(p);T||(T=c.querySelector(cl(p)),T||(n=h({src:n,async:!0,type:"module"},a),(a=wi.get(p))&&fd(n,a),T=c.createElement("script"),Et(T),Ct(T,"link",n),c.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},g.set(p,T))}}function lv(n,a,c,g){var p=(p=ce.current)?Qo(p):null;if(!p)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=Yr(c.href),c=dr(p).hoistableStyles,g=c.get(a),g||(g={type:"style",instance:null,count:0,state:null},c.set(a,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){n=Yr(c.href);var T=dr(p).hoistableStyles,L=T.get(n);if(L||(p=p.ownerDocument||p,L={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(n,L),(T=p.querySelector(ul(n)))&&!T._p&&(L.instance=T,L.state.loading=5),wi.has(n)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},wi.set(n,c),T||a1(p,n,c,L.state))),a&&g===null)throw Error(i(528,""));return L}if(a&&g!==null)throw Error(i(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=jr(c),c=dr(p).hoistableScripts,g=c.get(a),g||(g={type:"script",instance:null,count:0,state:null},c.set(a,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Yr(n){return'href="'+_i(n)+'"'}function ul(n){return'link[rel="stylesheet"]['+n+"]"}function ov(n){return h({},n,{"data-precedence":n.precedence,precedence:null})}function a1(n,a,c,g){n.querySelector('link[rel="preload"][as="style"]['+a+"]")?g.loading=1:(a=n.createElement("link"),g.preload=a,a.addEventListener("load",function(){return g.loading|=1}),a.addEventListener("error",function(){return g.loading|=2}),Ct(a,"link",c),Et(a),n.head.appendChild(a))}function jr(n){return'[src="'+_i(n)+'"]'}function cl(n){return"script[async]"+n}function uv(n,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var g=n.querySelector('style[data-href~="'+_i(c.href)+'"]');if(g)return a.instance=g,Et(g),g;var p=h({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return g=(n.ownerDocument||n).createElement("style"),Et(g),Ct(g,"style",p),Wo(g,c.precedence,n),a.instance=g;case"stylesheet":p=Yr(c.href);var T=n.querySelector(ul(p));if(T)return a.state.loading|=4,a.instance=T,Et(T),T;g=ov(c),(p=wi.get(p))&&cd(g,p),T=(n.ownerDocument||n).createElement("link"),Et(T);var L=T;return L._p=new Promise(function(w,F){L.onload=w,L.onerror=F}),Ct(T,"link",g),a.state.loading|=4,Wo(T,c.precedence,n),a.instance=T;case"script":return T=jr(c.src),(p=n.querySelector(cl(T)))?(a.instance=p,Et(p),p):(g=c,(p=wi.get(T))&&(g=h({},c),fd(g,p)),n=n.ownerDocument||n,p=n.createElement("script"),Et(p),Ct(p,"link",g),n.head.appendChild(p),a.instance=p);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(g=a.instance,a.state.loading|=4,Wo(g,c.precedence,n));return a.instance}function Wo(n,a,c){for(var g=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=g.length?g[g.length-1]:null,T=p,L=0;L<g.length;L++){var w=g[L];if(w.dataset.precedence===a)T=w;else if(T!==p)break}T?T.parentNode.insertBefore(n,T.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(n,a.firstChild))}function cd(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.title==null&&(n.title=a.title)}function fd(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.integrity==null&&(n.integrity=a.integrity)}var Zo=null;function cv(n,a,c){if(Zo===null){var g=new Map,p=Zo=new Map;p.set(c,g)}else p=Zo,g=p.get(c),g||(g=new Map,p.set(c,g));if(g.has(n))return g;for(g.set(n,null),c=c.getElementsByTagName(n),p=0;p<c.length;p++){var T=c[p];if(!(T[_a]||T[kt]||n==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var L=T.getAttribute(a)||"";L=n+L;var w=g.get(L);w?w.push(T):g.set(L,[T])}}return g}function fv(n,a,c){n=n.ownerDocument||n,n.head.insertBefore(c,a==="title"?n.querySelector("head > title"):null)}function l1(n,a,c){if(c===1||a.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return n=a.disabled,typeof a.precedence=="string"&&n==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function dv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var fl=null;function o1(){}function u1(n,a,c){if(fl===null)throw Error(i(475));var g=fl;if(a.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var p=Yr(c.href),T=n.querySelector(ul(p));if(T){n=T._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(g.count++,g=Jo.bind(g),n.then(g,g)),a.state.loading|=4,a.instance=T,Et(T);return}T=n.ownerDocument||n,c=ov(c),(p=wi.get(p))&&cd(c,p),T=T.createElement("link"),Et(T);var L=T;L._p=new Promise(function(w,F){L.onload=w,L.onerror=F}),Ct(T,"link",c),a.instance=T}g.stylesheets===null&&(g.stylesheets=new Map),g.stylesheets.set(a,n),(n=a.state.preload)&&(a.state.loading&3)===0&&(g.count++,a=Jo.bind(g),n.addEventListener("load",a),n.addEventListener("error",a))}}function c1(){if(fl===null)throw Error(i(475));var n=fl;return n.stylesheets&&n.count===0&&dd(n,n.stylesheets),0<n.count?function(a){var c=setTimeout(function(){if(n.stylesheets&&dd(n,n.stylesheets),n.unsuspend){var g=n.unsuspend;n.unsuspend=null,g()}},6e4);return n.unsuspend=a,function(){n.unsuspend=null,clearTimeout(c)}}:null}function Jo(){if(this.count--,this.count===0){if(this.stylesheets)dd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var eu=null;function dd(n,a){n.stylesheets=null,n.unsuspend!==null&&(n.count++,eu=new Map,a.forEach(f1,n),eu=null,Jo.call(n))}function f1(n,a){if(!(a.state.loading&4)){var c=eu.get(n);if(c)var g=c.get(null);else{c=new Map,eu.set(n,c);for(var p=n.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<p.length;T++){var L=p[T];(L.nodeName==="LINK"||L.getAttribute("media")!=="not all")&&(c.set(L.dataset.precedence,L),g=L)}g&&c.set(null,g)}p=a.instance,L=p.getAttribute("data-precedence"),T=c.get(L)||g,T===g&&c.set(null,p),c.set(L,p),this.count++,g=Jo.bind(this),p.addEventListener("load",g),p.addEventListener("error",g),T?T.parentNode.insertBefore(p,T.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(p,n.firstChild)),a.state.loading|=4}}var dl={$$typeof:A,Provider:null,Consumer:null,_currentValue:j,_currentValue2:j,_threadCount:0};function d1(n,a,c,g,p,T,L,w){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=lc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lc(0),this.hiddenUpdates=lc(null),this.identifierPrefix=g,this.onUncaughtError=p,this.onCaughtError=T,this.onRecoverableError=L,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function hv(n,a,c,g,p,T,L,w,F,Q,ee,le){return n=new d1(n,a,c,L,w,F,Q,le),a=1,T===!0&&(a|=24),T=ri(3,null,null,a),n.current=T,T.stateNode=n,a=Yc(),a.refCount++,n.pooledCache=a,a.refCount++,T.memoizedState={element:g,isDehydrated:c,cache:a},Qc(T),n}function gv(n){return n?(n=br,n):br}function mv(n,a,c,g,p,T){p=gv(p),g.context===null?g.context=p:g.pendingContext=p,g=zs(a),g.payload={element:c},T=T===void 0?null:T,T!==null&&(g.callback=T),c=Hs(n,g,a),c!==null&&(ci(c,n,a),za(c,n,a))}function pv(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var c=n.retryLane;n.retryLane=c!==0&&c<a?c:a}}function hd(n,a){pv(n,a),(n=n.alternate)&&pv(n,a)}function vv(n){if(n.tag===13){var a=_r(n,67108864);a!==null&&ci(a,n,67108864),hd(n,67108864)}}var tu=!0;function h1(n,a,c,g){var p=B.T;B.T=null;var T=K.p;try{K.p=2,gd(n,a,c,g)}finally{K.p=T,B.T=p}}function g1(n,a,c,g){var p=B.T;B.T=null;var T=K.p;try{K.p=8,gd(n,a,c,g)}finally{K.p=T,B.T=p}}function gd(n,a,c,g){if(tu){var p=md(g);if(p===null)td(n,a,g,iu,c),Sv(n,g);else if(p1(p,n,a,c,g))g.stopPropagation();else if(Sv(n,g),a&4&&-1<m1.indexOf(n)){for(;p!==null;){var T=fr(p);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var L=Ln(T.pendingLanes);if(L!==0){var w=T;for(w.pendingLanes|=2,w.entangledLanes|=2;L;){var F=1<<31-Pt(L);w.entanglements[1]|=F,L&=~F}ts(T),(Fe&6)===0&&(Uo=Ye()+500,rl(0))}}break;case 13:w=_r(T,2),w!==null&&ci(w,T,2),$o(),hd(T,2)}if(T=md(g),T===null&&td(n,a,g,iu,c),T===p)break;p=T}p!==null&&g.stopPropagation()}else td(n,a,g,null,c)}}function md(n){return n=Sc(n),pd(n)}var iu=null;function pd(n){if(iu=null,n=cr(n),n!==null){var a=r(n);if(a===null)n=null;else{var c=a.tag;if(c===13){if(n=o(a),n!==null)return n;n=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null)}}return iu=n,null}function yv(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Vt()){case Xi:return 2;case Kt:return 8;case Gi:case ds:return 32;case Ta:return 268435456;default:return 32}default:return 32}}var vd=!1,sn=null,nn=null,rn=null,hl=new Map,gl=new Map,an=[],m1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Sv(n,a){switch(n){case"focusin":case"focusout":sn=null;break;case"dragenter":case"dragleave":nn=null;break;case"mouseover":case"mouseout":rn=null;break;case"pointerover":case"pointerout":hl.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":gl.delete(a.pointerId)}}function ml(n,a,c,g,p,T){return n===null||n.nativeEvent!==T?(n={blockedOn:a,domEventName:c,eventSystemFlags:g,nativeEvent:T,targetContainers:[p]},a!==null&&(a=fr(a),a!==null&&vv(a)),n):(n.eventSystemFlags|=g,a=n.targetContainers,p!==null&&a.indexOf(p)===-1&&a.push(p),n)}function p1(n,a,c,g,p){switch(a){case"focusin":return sn=ml(sn,n,a,c,g,p),!0;case"dragenter":return nn=ml(nn,n,a,c,g,p),!0;case"mouseover":return rn=ml(rn,n,a,c,g,p),!0;case"pointerover":var T=p.pointerId;return hl.set(T,ml(hl.get(T)||null,n,a,c,g,p)),!0;case"gotpointercapture":return T=p.pointerId,gl.set(T,ml(gl.get(T)||null,n,a,c,g,p)),!0}return!1}function Tv(n){var a=cr(n.target);if(a!==null){var c=r(a);if(c!==null){if(a=c.tag,a===13){if(a=o(c),a!==null){n.blockedOn=a,ux(n.priority,function(){if(c.tag===13){var g=ui();g=oc(g);var p=_r(c,g);p!==null&&ci(p,c,g),hd(c,g)}});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){n.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}n.blockedOn=null}function su(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var c=md(n.nativeEvent);if(c===null){c=n.nativeEvent;var g=new c.constructor(c.type,c);yc=g,c.target.dispatchEvent(g),yc=null}else return a=fr(c),a!==null&&vv(a),n.blockedOn=c,!1;a.shift()}return!0}function Ev(n,a,c){su(n)&&c.delete(a)}function v1(){vd=!1,sn!==null&&su(sn)&&(sn=null),nn!==null&&su(nn)&&(nn=null),rn!==null&&su(rn)&&(rn=null),hl.forEach(Ev),gl.forEach(Ev)}function nu(n,a){n.blockedOn===a&&(n.blockedOn=null,vd||(vd=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,v1)))}var ru=null;function xv(n){ru!==n&&(ru=n,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){ru===n&&(ru=null);for(var a=0;a<n.length;a+=3){var c=n[a],g=n[a+1],p=n[a+2];if(typeof g!="function"){if(pd(g||c)===null)continue;break}var T=fr(c);T!==null&&(n.splice(a,3),a-=3,pf(T,{pending:!0,data:p,method:c.method,action:g},g,p))}}))}function pl(n){function a(F){return nu(F,n)}sn!==null&&nu(sn,n),nn!==null&&nu(nn,n),rn!==null&&nu(rn,n),hl.forEach(a),gl.forEach(a);for(var c=0;c<an.length;c++){var g=an[c];g.blockedOn===n&&(g.blockedOn=null)}for(;0<an.length&&(c=an[0],c.blockedOn===null);)Tv(c),c.blockedOn===null&&an.shift();if(c=(n.ownerDocument||n).$$reactFormReplay,c!=null)for(g=0;g<c.length;g+=3){var p=c[g],T=c[g+1],L=p[Yt]||null;if(typeof T=="function")L||xv(c);else if(L){var w=null;if(T&&T.hasAttribute("formAction")){if(p=T,L=T[Yt]||null)w=L.formAction;else if(pd(p)!==null)continue}else w=L.action;typeof w=="function"?c[g+1]=w:(c.splice(g,3),g-=3),xv(c)}}}function yd(n){this._internalRoot=n}au.prototype.render=yd.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(i(409));var c=a.current,g=ui();mv(c,g,n,a,null,null)},au.prototype.unmount=yd.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;mv(n.current,2,null,n,null,null),$o(),a[ur]=null}};function au(n){this._internalRoot=n}au.prototype.unstable_scheduleHydration=function(n){if(n){var a=Ug();n={blockedOn:null,target:n,priority:a};for(var c=0;c<an.length&&a!==0&&a<an[c].priority;c++);an.splice(c,0,n),c===0&&Tv(n)}};var _v=e.version;if(_v!=="19.1.0")throw Error(i(527,_v,"19.1.0"));K.findDOMNode=function(n){var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=d(a),n=n!==null?f(n):null,n=n===null?null:n.stateNode,n};var y1={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lu.isDisabled&&lu.supportsFiber)try{$i=lu.inject(y1),Mt=lu}catch{}}return yl.createRoot=function(n,a){if(!s(n))throw Error(i(299));var c=!1,g="",p=U0,T=G0,L=$0,w=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(g=a.identifierPrefix),a.onUncaughtError!==void 0&&(p=a.onUncaughtError),a.onCaughtError!==void 0&&(T=a.onCaughtError),a.onRecoverableError!==void 0&&(L=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(w=a.unstable_transitionCallbacks)),a=hv(n,1,!1,null,null,c,g,p,T,L,w,null),n[ur]=a.current,ed(n),new yd(a)},yl.hydrateRoot=function(n,a,c){if(!s(n))throw Error(i(299));var g=!1,p="",T=U0,L=G0,w=$0,F=null,Q=null;return c!=null&&(c.unstable_strictMode===!0&&(g=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(T=c.onUncaughtError),c.onCaughtError!==void 0&&(L=c.onCaughtError),c.onRecoverableError!==void 0&&(w=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(F=c.unstable_transitionCallbacks),c.formState!==void 0&&(Q=c.formState)),a=hv(n,1,!0,a,c??null,g,p,T,L,w,F,Q),a.context=gv(null),c=a.current,g=ui(),g=oc(g),p=zs(g),p.callback=null,Hs(c,p,g),c=g,a.current.lanes=c,xa(a,c),ts(a),n[ur]=a.current,ed(n),new au(a)},yl.version="19.1.0",yl}var Mv;function I1(){if(Mv)return Ed.exports;Mv=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(e){console.error(e)}}return l(),Ed.exports=D1(),Ed.exports}var w1=I1();function Cs(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l}function bS(l,e){l.prototype=Object.create(e.prototype),l.prototype.constructor=l,l.__proto__=e}/*!
 * GSAP 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var vi={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},ca={duration:.5,overwrite:!1,delay:0},Yh,Ot,et,ki=1e8,Xe=1/ki,oh=Math.PI*2,C1=oh/4,O1=0,AS=Math.sqrt,M1=Math.cos,P1=Math.sin,Rt=function(e){return typeof e=="string"},lt=function(e){return typeof e=="function"},Ns=function(e){return typeof e=="number"},jh=function(e){return typeof e>"u"},cs=function(e){return typeof e=="object"},Jt=function(e){return e!==!1},qh=function(){return typeof window<"u"},ou=function(e){return lt(e)||Rt(e)},LS=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Gt=Array.isArray,uh=/(?:-?\.?\d|\.)+/gi,RS=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,ea=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Ad=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,DS=/[+-]=-?[.\d]+/,IS=/[^,'"\[\]\s]+/gi,k1=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,st,ns,ch,Xh,Si={},Nu={},wS,CS=function(e){return(Nu=fa(e,Si))&&si},Qh=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Cl=function(e,t){return!t&&console.warn(e)},OS=function(e,t){return e&&(Si[e]=t)&&Nu&&(Nu[e]=t)||Si},Ol=function(){return 0},N1={suppressEvents:!0,isStart:!0,kill:!1},bu={suppressEvents:!0,kill:!1},B1={suppressEvents:!0},Wh={},pn=[],fh={},MS,fi={},Ld={},Pv=30,Au=[],Zh="",Jh=function(e){var t=e[0],i,s;if(cs(t)||lt(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(s=Au.length;s--&&!Au[s].targetTest(t););i=Au[s]}for(s=e.length;s--;)e[s]&&(e[s]._gsap||(e[s]._gsap=new sT(e[s],i)))||e.splice(s,1);return e},Wn=function(e){return e._gsap||Jh(Ni(e))[0]._gsap},PS=function(e,t,i){return(i=e[t])&&lt(i)?e[t]():jh(i)&&e.getAttribute&&e.getAttribute(t)||i},ei=function(e,t){return(e=e.split(",")).forEach(t)||e},ct=function(e){return Math.round(e*1e5)/1e5||0},mt=function(e){return Math.round(e*1e7)/1e7||0},sa=function(e,t){var i=t.charAt(0),s=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+s:i==="-"?e-s:i==="*"?e*s:e/s},F1=function(e,t){for(var i=t.length,s=0;e.indexOf(t[s])<0&&++s<i;);return s<i},Bu=function(){var e=pn.length,t=pn.slice(0),i,s;for(fh={},pn.length=0,i=0;i<e;i++)s=t[i],s&&s._lazy&&(s.render(s._lazy[0],s._lazy[1],!0)._lazy=0)},eg=function(e){return!!(e._initted||e._startAt||e.add)},kS=function(e,t,i,s){pn.length&&!Ot&&Bu(),e.render(t,i,!!(Ot&&t<0&&eg(e))),pn.length&&!Ot&&Bu()},NS=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(IS).length<2?t:Rt(e)?e.trim():e},BS=function(e){return e},Ti=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},U1=function(e){return function(t,i){for(var s in i)s in t||s==="duration"&&e||s==="ease"||(t[s]=i[s])}},fa=function(e,t){for(var i in t)e[i]=t[i];return e},kv=function l(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=cs(t[i])?l(e[i]||(e[i]={}),t[i]):t[i]);return e},Fu=function(e,t){var i={},s;for(s in e)s in t||(i[s]=e[s]);return i},bl=function(e){var t=e.parent||st,i=e.keyframes?U1(Gt(e.keyframes)):Ti;if(Jt(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},G1=function(e,t){for(var i=e.length,s=i===t.length;s&&i--&&e[i]===t[i];);return i<0},FS=function(e,t,i,s,r){var o=e[s],u;if(r)for(u=t[r];o&&o[r]>u;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[s]=t,t._prev=o,t.parent=t._dp=e,t},tc=function(e,t,i,s){i===void 0&&(i="_first"),s===void 0&&(s="_last");var r=t._prev,o=t._next;r?r._next=o:e[i]===t&&(e[i]=o),o?o._prev=r:e[s]===t&&(e[s]=r),t._next=t._prev=t.parent=null},yn=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Zn=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},$1=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},dh=function(e,t,i,s){return e._startAt&&(Ot?e._startAt.revert(bu):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,s))},z1=function l(e){return!e||e._ts&&l(e.parent)},Nv=function(e){return e._repeat?da(e._tTime,e=e.duration()+e._rDelay)*e:0},da=function(e,t){var i=Math.floor(e=mt(e/t));return e&&i===e?i-1:i},Uu=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},ic=function(e){return e._end=mt(e._start+(e._tDur/Math.abs(e._ts||e._rts||Xe)||0))},sc=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=mt(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),ic(e),i._dirty||Zn(i,e)),e},US=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=Uu(e.rawTime(),t),(!t._dur||Kl(0,t.totalDuration(),i)-t._tTime>Xe)&&t.render(i,!0)),Zn(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-Xe}},as=function(e,t,i,s){return t.parent&&yn(t),t._start=mt((Ns(i)?i:i||e!==st?Oi(e,i,t):e._time)+t._delay),t._end=mt(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),FS(e,t,"_first","_last",e._sort?"_start":0),hh(t)||(e._recent=t),s||US(e,t),e._ts<0&&sc(e,e._tTime),e},GS=function(e,t){return(Si.ScrollTrigger||Qh("scrollTrigger",t))&&Si.ScrollTrigger.create(t,e)},$S=function(e,t,i,s,r){if(ig(e,t,r),!e._initted)return 1;if(!i&&e._pt&&!Ot&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&MS!==gi.frame)return pn.push(e),e._lazy=[r,s],1},H1=function l(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||l(t))},hh=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},V1=function(e,t,i,s){var r=e.ratio,o=t<0||!t&&(!e._start&&H1(e)&&!(!e._initted&&hh(e))||(e._ts<0||e._dp._ts<0)&&!hh(e))?0:1,u=e._rDelay,d=0,f,h,m;if(u&&e._repeat&&(d=Kl(0,e._tDur,t),h=da(d,u),e._yoyo&&h&1&&(o=1-o),h!==da(e._tTime,u)&&(r=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==r||Ot||s||e._zTime===Xe||!t&&e._zTime){if(!e._initted&&$S(e,t,s,i,d))return;for(m=e._zTime,e._zTime=t||(i?Xe:0),i||(i=t&&!m),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=d,f=e._pt;f;)f.r(o,f.d),f=f._next;t<0&&dh(e,t,i,!0),e._onUpdate&&!i&&pi(e,"onUpdate"),d&&e._repeat&&!i&&e.parent&&pi(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&yn(e,1),!i&&!Ot&&(pi(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},K1=function(e,t,i){var s;if(i>t)for(s=e._first;s&&s._start<=i;){if(s.data==="isPause"&&s._start>t)return s;s=s._next}else for(s=e._last;s&&s._start>=i;){if(s.data==="isPause"&&s._start<t)return s;s=s._prev}},ha=function(e,t,i,s){var r=e._repeat,o=mt(t)||0,u=e._tTime/e._tDur;return u&&!s&&(e._time*=o/e._dur),e._dur=o,e._tDur=r?r<0?1e10:mt(o*(r+1)+e._rDelay*r):o,u>0&&!s&&sc(e,e._tTime=e._tDur*u),e.parent&&ic(e),i||Zn(e.parent,e),e},Bv=function(e){return e instanceof zt?Zn(e):ha(e,e._dur)},Y1={_start:0,endTime:Ol,totalDuration:Ol},Oi=function l(e,t,i){var s=e.labels,r=e._recent||Y1,o=e.duration()>=ki?r.endTime(!1):e._dur,u,d,f;return Rt(t)&&(isNaN(t)||t in s)?(d=t.charAt(0),f=t.substr(-1)==="%",u=t.indexOf("="),d==="<"||d===">"?(u>=0&&(t=t.replace(/=/,"")),(d==="<"?r._start:r.endTime(r._repeat>=0))+(parseFloat(t.substr(1))||0)*(f?(u<0?r:i).totalDuration()/100:1)):u<0?(t in s||(s[t]=o),s[t]):(d=parseFloat(t.charAt(u-1)+t.substr(u+1)),f&&i&&(d=d/100*(Gt(i)?i[0]:i).totalDuration()),u>1?l(e,t.substr(0,u-1),i)+d:o+d)):t==null?o:+t},Al=function(e,t,i){var s=Ns(t[1]),r=(s?2:1)+(e<2?0:1),o=t[r],u,d;if(s&&(o.duration=t[1]),o.parent=i,e){for(u=o,d=i;d&&!("immediateRender"in u);)u=d.vars.defaults||{},d=Jt(d.vars.inherit)&&d.parent;o.immediateRender=Jt(u.immediateRender),e<2?o.runBackwards=1:o.startAt=t[r-1]}return new gt(t[0],o,t[r+1])},xn=function(e,t){return e||e===0?t(e):t},Kl=function(e,t,i){return i<e?e:i>t?t:i},Ut=function(e,t){return!Rt(e)||!(t=k1.exec(e))?"":t[1]},j1=function(e,t,i){return xn(i,function(s){return Kl(e,t,s)})},gh=[].slice,zS=function(e,t){return e&&cs(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&cs(e[0]))&&!e.nodeType&&e!==ns},q1=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(s){var r;return Rt(s)&&!t||zS(s,1)?(r=i).push.apply(r,Ni(s)):i.push(s)})||i},Ni=function(e,t,i){return et&&!t&&et.selector?et.selector(e):Rt(e)&&!i&&(ch||!ga())?gh.call((t||Xh).querySelectorAll(e),0):Gt(e)?q1(e,i):zS(e)?gh.call(e,0):e?[e]:[]},mh=function(e){return e=Ni(e)[0]||Cl("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return Ni(t,i.querySelectorAll?i:i===e?Cl("Invalid scope")||Xh.createElement("div"):e)}},HS=function(e){return e.sort(function(){return .5-Math.random()})},VS=function(e){if(lt(e))return e;var t=cs(e)?e:{each:e},i=Jn(t.ease),s=t.from||0,r=parseFloat(t.base)||0,o={},u=s>0&&s<1,d=isNaN(s)||u,f=t.axis,h=s,m=s;return Rt(s)?h=m={center:.5,edges:.5,end:1}[s]||0:!u&&d&&(h=s[0],m=s[1]),function(v,y,S){var E=(S||t).length,x=o[E],_,R,A,I,D,N,C,M,O;if(!x){if(O=t.grid==="auto"?0:(t.grid||[1,ki])[1],!O){for(C=-ki;C<(C=S[O++].getBoundingClientRect().left)&&O<E;);O<E&&O--}for(x=o[E]=[],_=d?Math.min(O,E)*h-.5:s%O,R=O===ki?0:d?E*m/O-.5:s/O|0,C=0,M=ki,N=0;N<E;N++)A=N%O-_,I=R-(N/O|0),x[N]=D=f?Math.abs(f==="y"?I:A):AS(A*A+I*I),D>C&&(C=D),D<M&&(M=D);s==="random"&&HS(x),x.max=C-M,x.min=M,x.v=E=(parseFloat(t.amount)||parseFloat(t.each)*(O>E?E-1:f?f==="y"?E/O:O:Math.max(O,E/O))||0)*(s==="edges"?-1:1),x.b=E<0?r-E:r,x.u=Ut(t.amount||t.each)||0,i=i&&E<0?eT(i):i}return E=(x[v]-x.min)/x.max||0,mt(x.b+(i?i(E):E)*x.v)+x.u}},ph=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var s=mt(Math.round(parseFloat(i)/e)*e*t);return(s-s%1)/t+(Ns(i)?0:Ut(i))}},KS=function(e,t){var i=Gt(e),s,r;return!i&&cs(e)&&(s=i=e.radius||ki,e.values?(e=Ni(e.values),(r=!Ns(e[0]))&&(s*=s)):e=ph(e.increment)),xn(t,i?lt(e)?function(o){return r=e(o),Math.abs(r-o)<=s?r:o}:function(o){for(var u=parseFloat(r?o.x:o),d=parseFloat(r?o.y:0),f=ki,h=0,m=e.length,v,y;m--;)r?(v=e[m].x-u,y=e[m].y-d,v=v*v+y*y):v=Math.abs(e[m]-u),v<f&&(f=v,h=m);return h=!s||f<=s?e[h]:o,r||h===o||Ns(o)?h:h+Ut(o)}:ph(e))},YS=function(e,t,i,s){return xn(Gt(e)?!t:i===!0?!!(i=0):!s,function(){return Gt(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(s=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*s)/s})},X1=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(s){return t.reduce(function(r,o){return o(r)},s)}},Q1=function(e,t){return function(i){return e(parseFloat(i))+(t||Ut(i))}},W1=function(e,t,i){return qS(e,t,0,1,i)},jS=function(e,t,i){return xn(i,function(s){return e[~~t(s)]})},Z1=function l(e,t,i){var s=t-e;return Gt(e)?jS(e,l(0,e.length),t):xn(i,function(r){return(s+(r-e)%s)%s+e})},J1=function l(e,t,i){var s=t-e,r=s*2;return Gt(e)?jS(e,l(0,e.length-1),t):xn(i,function(o){return o=(r+(o-e)%r)%r||0,e+(o>s?r-o:o)})},Ml=function(e){for(var t=0,i="",s,r,o,u;~(s=e.indexOf("random(",t));)o=e.indexOf(")",s),u=e.charAt(s+7)==="[",r=e.substr(s+7,o-s-7).match(u?IS:uh),i+=e.substr(t,s-t)+YS(u?r:+r[0],u?0:+r[1],+r[2]||1e-5),t=o+1;return i+e.substr(t,e.length-t)},qS=function(e,t,i,s,r){var o=t-e,u=s-i;return xn(r,function(d){return i+((d-e)/o*u||0)})},eb=function l(e,t,i,s){var r=isNaN(e+t)?0:function(y){return(1-y)*e+y*t};if(!r){var o=Rt(e),u={},d,f,h,m,v;if(i===!0&&(s=1)&&(i=null),o)e={p:e},t={p:t};else if(Gt(e)&&!Gt(t)){for(h=[],m=e.length,v=m-2,f=1;f<m;f++)h.push(l(e[f-1],e[f]));m--,r=function(S){S*=m;var E=Math.min(v,~~S);return h[E](S-E)},i=t}else s||(e=fa(Gt(e)?[]:{},e));if(!h){for(d in t)tg.call(u,e,d,"get",t[d]);r=function(S){return rg(S,u)||(o?e.p:e)}}}return xn(i,r)},Fv=function(e,t,i){var s=e.labels,r=ki,o,u,d;for(o in s)u=s[o]-t,u<0==!!i&&u&&r>(u=Math.abs(u))&&(d=o,r=u);return d},pi=function(e,t,i){var s=e.vars,r=s[t],o=et,u=e._ctx,d,f,h;if(r)return d=s[t+"Params"],f=s.callbackScope||e,i&&pn.length&&Bu(),u&&(et=u),h=d?r.apply(f,d):r.call(f),et=o,h},El=function(e){return yn(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Ot),e.progress()<1&&pi(e,"onInterrupt"),e},ta,XS=[],QS=function(e){if(e)if(e=!e.name&&e.default||e,qh()||e.headless){var t=e.name,i=lt(e),s=t&&!i&&e.init?function(){this._props=[]}:e,r={init:Ol,render:rg,add:tg,kill:pb,modifier:mb,rawVars:0},o={targetTest:0,get:0,getSetter:ng,aliases:{},register:0};if(ga(),e!==s){if(fi[t])return;Ti(s,Ti(Fu(e,r),o)),fa(s.prototype,fa(r,Fu(e,o))),fi[s.prop=t]=s,e.targetTest&&(Au.push(s),Wh[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}OS(t,s),e.register&&e.register(si,s,ti)}else XS.push(e)},qe=255,xl={aqua:[0,qe,qe],lime:[0,qe,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,qe],navy:[0,0,128],white:[qe,qe,qe],olive:[128,128,0],yellow:[qe,qe,0],orange:[qe,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[qe,0,0],pink:[qe,192,203],cyan:[0,qe,qe],transparent:[qe,qe,qe,0]},Rd=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*qe+.5|0},WS=function(e,t,i){var s=e?Ns(e)?[e>>16,e>>8&qe,e&qe]:0:xl.black,r,o,u,d,f,h,m,v,y,S;if(!s){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),xl[e])s=xl[e];else if(e.charAt(0)==="#"){if(e.length<6&&(r=e.charAt(1),o=e.charAt(2),u=e.charAt(3),e="#"+r+r+o+o+u+u+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return s=parseInt(e.substr(1,6),16),[s>>16,s>>8&qe,s&qe,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),s=[e>>16,e>>8&qe,e&qe]}else if(e.substr(0,3)==="hsl"){if(s=S=e.match(uh),!t)d=+s[0]%360/360,f=+s[1]/100,h=+s[2]/100,o=h<=.5?h*(f+1):h+f-h*f,r=h*2-o,s.length>3&&(s[3]*=1),s[0]=Rd(d+1/3,r,o),s[1]=Rd(d,r,o),s[2]=Rd(d-1/3,r,o);else if(~e.indexOf("="))return s=e.match(RS),i&&s.length<4&&(s[3]=1),s}else s=e.match(uh)||xl.transparent;s=s.map(Number)}return t&&!S&&(r=s[0]/qe,o=s[1]/qe,u=s[2]/qe,m=Math.max(r,o,u),v=Math.min(r,o,u),h=(m+v)/2,m===v?d=f=0:(y=m-v,f=h>.5?y/(2-m-v):y/(m+v),d=m===r?(o-u)/y+(o<u?6:0):m===o?(u-r)/y+2:(r-o)/y+4,d*=60),s[0]=~~(d+.5),s[1]=~~(f*100+.5),s[2]=~~(h*100+.5)),i&&s.length<4&&(s[3]=1),s},ZS=function(e){var t=[],i=[],s=-1;return e.split(vn).forEach(function(r){var o=r.match(ea)||[];t.push.apply(t,o),i.push(s+=o.length+1)}),t.c=i,t},Uv=function(e,t,i){var s="",r=(e+s).match(vn),o=t?"hsla(":"rgba(",u=0,d,f,h,m;if(!r)return e;if(r=r.map(function(v){return(v=WS(v,t,1))&&o+(t?v[0]+","+v[1]+"%,"+v[2]+"%,"+v[3]:v.join(","))+")"}),i&&(h=ZS(e),d=i.c,d.join(s)!==h.c.join(s)))for(f=e.replace(vn,"1").split(ea),m=f.length-1;u<m;u++)s+=f[u]+(~d.indexOf(u)?r.shift()||o+"0,0,0,0)":(h.length?h:r.length?r:i).shift());if(!f)for(f=e.split(vn),m=f.length-1;u<m;u++)s+=f[u]+r[u];return s+f[m]},vn=function(){var l="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in xl)l+="|"+e+"\\b";return new RegExp(l+")","gi")}(),tb=/hsl[a]?\(/,JS=function(e){var t=e.join(" "),i;if(vn.lastIndex=0,vn.test(t))return i=tb.test(t),e[1]=Uv(e[1],i),e[0]=Uv(e[0],i,ZS(e[1])),!0},Pl,gi=function(){var l=Date.now,e=500,t=33,i=l(),s=i,r=1e3/240,o=r,u=[],d,f,h,m,v,y,S=function E(x){var _=l()-s,R=x===!0,A,I,D,N;if((_>e||_<0)&&(i+=_-t),s+=_,D=s-i,A=D-o,(A>0||R)&&(N=++m.frame,v=D-m.time*1e3,m.time=D=D/1e3,o+=A+(A>=r?4:r-A),I=1),R||(d=f(E)),I)for(y=0;y<u.length;y++)u[y](D,v,N,x)};return m={time:0,frame:0,tick:function(){S(!0)},deltaRatio:function(x){return v/(1e3/(x||60))},wake:function(){wS&&(!ch&&qh()&&(ns=ch=window,Xh=ns.document||{},Si.gsap=si,(ns.gsapVersions||(ns.gsapVersions=[])).push(si.version),CS(Nu||ns.GreenSockGlobals||!ns.gsap&&ns||{}),XS.forEach(QS)),h=typeof requestAnimationFrame<"u"&&requestAnimationFrame,d&&m.sleep(),f=h||function(x){return setTimeout(x,o-m.time*1e3+1|0)},Pl=1,S(2))},sleep:function(){(h?cancelAnimationFrame:clearTimeout)(d),Pl=0,f=Ol},lagSmoothing:function(x,_){e=x||1/0,t=Math.min(_||33,e)},fps:function(x){r=1e3/(x||240),o=m.time*1e3+r},add:function(x,_,R){var A=_?function(I,D,N,C){x(I,D,N,C),m.remove(A)}:x;return m.remove(x),u[R?"unshift":"push"](A),ga(),A},remove:function(x,_){~(_=u.indexOf(x))&&u.splice(_,1)&&y>=_&&y--},_listeners:u},m}(),ga=function(){return!Pl&&gi.wake()},Oe={},ib=/^[\d.\-M][\d.\-,\s]/,sb=/["']/g,nb=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),s=i[0],r=1,o=i.length,u,d,f;r<o;r++)d=i[r],u=r!==o-1?d.lastIndexOf(","):d.length,f=d.substr(0,u),t[s]=isNaN(f)?f.replace(sb,"").trim():+f,s=d.substr(u+1).trim();return t},rb=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),s=e.indexOf("(",t);return e.substring(t,~s&&s<i?e.indexOf(")",i+1):i)},ab=function(e){var t=(e+"").split("("),i=Oe[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[nb(t[1])]:rb(e).split(",").map(NS)):Oe._CE&&ib.test(e)?Oe._CE("",e):i},eT=function(e){return function(t){return 1-e(1-t)}},tT=function l(e,t){for(var i=e._first,s;i;)i instanceof zt?l(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?l(i.timeline,t):(s=i._ease,i._ease=i._yEase,i._yEase=s,i._yoyo=t)),i=i._next},Jn=function(e,t){return e&&(lt(e)?e:Oe[e]||ab(e))||t},ar=function(e,t,i,s){i===void 0&&(i=function(d){return 1-t(1-d)}),s===void 0&&(s=function(d){return d<.5?t(d*2)/2:1-t((1-d)*2)/2});var r={easeIn:t,easeOut:i,easeInOut:s},o;return ei(e,function(u){Oe[u]=Si[u]=r,Oe[o=u.toLowerCase()]=i;for(var d in r)Oe[o+(d==="easeIn"?".in":d==="easeOut"?".out":".inOut")]=Oe[u+"."+d]=r[d]}),r},iT=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},Dd=function l(e,t,i){var s=t>=1?t:1,r=(i||(e?.3:.45))/(t<1?t:1),o=r/oh*(Math.asin(1/s)||0),u=function(h){return h===1?1:s*Math.pow(2,-10*h)*P1((h-o)*r)+1},d=e==="out"?u:e==="in"?function(f){return 1-u(1-f)}:iT(u);return r=oh/r,d.config=function(f,h){return l(e,f,h)},d},Id=function l(e,t){t===void 0&&(t=1.70158);var i=function(o){return o?--o*o*((t+1)*o+t)+1:0},s=e==="out"?i:e==="in"?function(r){return 1-i(1-r)}:iT(i);return s.config=function(r){return l(e,r)},s};ei("Linear,Quad,Cubic,Quart,Quint,Strong",function(l,e){var t=e<5?e+1:e;ar(l+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});Oe.Linear.easeNone=Oe.none=Oe.Linear.easeIn;ar("Elastic",Dd("in"),Dd("out"),Dd());(function(l,e){var t=1/e,i=2*t,s=2.5*t,r=function(u){return u<t?l*u*u:u<i?l*Math.pow(u-1.5/e,2)+.75:u<s?l*(u-=2.25/e)*u+.9375:l*Math.pow(u-2.625/e,2)+.984375};ar("Bounce",function(o){return 1-r(1-o)},r)})(7.5625,2.75);ar("Expo",function(l){return Math.pow(2,10*(l-1))*l+l*l*l*l*l*l*(1-l)});ar("Circ",function(l){return-(AS(1-l*l)-1)});ar("Sine",function(l){return l===1?1:-M1(l*C1)+1});ar("Back",Id("in"),Id("out"),Id());Oe.SteppedEase=Oe.steps=Si.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,s=e+(t?0:1),r=t?1:0,o=1-Xe;return function(u){return((s*Kl(0,o,u)|0)+r)*i}}};ca.ease=Oe["quad.out"];ei("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(l){return Zh+=l+","+l+"Params,"});var sT=function(e,t){this.id=O1++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:PS,this.set=t?t.getSetter:ng},kl=function(){function l(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,ha(this,+t.duration,1,1),this.data=t.data,et&&(this._ctx=et,et.data.push(this)),Pl||gi.wake()}var e=l.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,ha(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,s){if(ga(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(sc(this,i),!r._dp||r.parent||US(r,this);r&&r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&as(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!s||this._initted&&Math.abs(this._zTime)===Xe||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),kS(this,i,s)),this},e.time=function(i,s){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+Nv(this))%(this._dur+this._rDelay)||(i?this._dur:0),s):this._time},e.totalProgress=function(i,s){return arguments.length?this.totalTime(this.totalDuration()*i,s):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(i,s){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+Nv(this),s):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(i,s){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*r,s):this._repeat?da(this._tTime,r)+1:1},e.timeScale=function(i,s){if(!arguments.length)return this._rts===-Xe?0:this._rts;if(this._rts===i)return this;var r=this.parent&&this._ts?Uu(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-Xe?0:this._rts,this.totalTime(Kl(-Math.abs(this._delay),this.totalDuration(),r),s!==!1),ic(this),$1(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(ga(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Xe&&(this._tTime-=Xe)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var s=this.parent||this._dp;return s&&(s._sort||!this.parent)&&as(s,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(Jt(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var s=this.parent||this._dp;return s?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Uu(s.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=B1);var s=Ot;return Ot=i,eg(this)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),Ot=s,this},e.globalTime=function(i){for(var s=this,r=arguments.length?i:s.rawTime();s;)r=s._start+r/(Math.abs(s._ts)||1),s=s._dp;return!this.parent&&this._sat?this._sat.globalTime(i):r},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,Bv(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var s=this._time;return this._rDelay=i,Bv(this),s?this.time(s):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,s){return this.totalTime(Oi(this,i),Jt(s))},e.restart=function(i,s){return this.play().totalTime(i?-this._delay:0,Jt(s)),this._dur||(this._zTime=-Xe),this},e.play=function(i,s){return i!=null&&this.seek(i,s),this.reversed(!1).paused(!1)},e.reverse=function(i,s){return i!=null&&this.seek(i||this.totalDuration(),s),this.reversed(!0).paused(!1)},e.pause=function(i,s){return i!=null&&this.seek(i,s),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-Xe:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Xe,this},e.isActive=function(){var i=this.parent||this._dp,s=this._start,r;return!!(!i||this._ts&&this._initted&&i.isActive()&&(r=i.rawTime(!0))>=s&&r<this.endTime(!0)-Xe)},e.eventCallback=function(i,s,r){var o=this.vars;return arguments.length>1?(s?(o[i]=s,r&&(o[i+"Params"]=r),i==="onUpdate"&&(this._onUpdate=s)):delete o[i],this):o[i]},e.then=function(i){var s=this;return new Promise(function(r){var o=lt(i)?i:BS,u=function(){var f=s.then;s.then=null,lt(o)&&(o=o(s))&&(o.then||o===s)&&(s.then=f),r(o),s.then=f};s._initted&&s.totalProgress()===1&&s._ts>=0||!s._tTime&&s._ts<0?u():s._prom=u})},e.kill=function(){El(this)},l}();Ti(kl.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Xe,_prom:0,_ps:!1,_rts:1});var zt=function(l){bS(e,l);function e(i,s){var r;return i===void 0&&(i={}),r=l.call(this,i)||this,r.labels={},r.smoothChildTiming=!!i.smoothChildTiming,r.autoRemoveChildren=!!i.autoRemoveChildren,r._sort=Jt(i.sortChildren),st&&as(i.parent||st,Cs(r),s),i.reversed&&r.reverse(),i.paused&&r.paused(!0),i.scrollTrigger&&GS(Cs(r),i.scrollTrigger),r}var t=e.prototype;return t.to=function(s,r,o){return Al(0,arguments,this),this},t.from=function(s,r,o){return Al(1,arguments,this),this},t.fromTo=function(s,r,o,u){return Al(2,arguments,this),this},t.set=function(s,r,o){return r.duration=0,r.parent=this,bl(r).repeatDelay||(r.repeat=0),r.immediateRender=!!r.immediateRender,new gt(s,r,Oi(this,o),1),this},t.call=function(s,r,o){return as(this,gt.delayedCall(0,s,r),o)},t.staggerTo=function(s,r,o,u,d,f,h){return o.duration=r,o.stagger=o.stagger||u,o.onComplete=f,o.onCompleteParams=h,o.parent=this,new gt(s,o,Oi(this,d)),this},t.staggerFrom=function(s,r,o,u,d,f,h){return o.runBackwards=1,bl(o).immediateRender=Jt(o.immediateRender),this.staggerTo(s,r,o,u,d,f,h)},t.staggerFromTo=function(s,r,o,u,d,f,h,m){return u.startAt=o,bl(u).immediateRender=Jt(u.immediateRender),this.staggerTo(s,r,u,d,f,h,m)},t.render=function(s,r,o){var u=this._time,d=this._dirty?this.totalDuration():this._tDur,f=this._dur,h=s<=0?0:mt(s),m=this._zTime<0!=s<0&&(this._initted||!f),v,y,S,E,x,_,R,A,I,D,N,C;if(this!==st&&h>d&&s>=0&&(h=d),h!==this._tTime||o||m){if(u!==this._time&&f&&(h+=this._time-u,s+=this._time-u),v=h,I=this._start,A=this._ts,_=!A,m&&(f||(u=this._zTime),(s||!r)&&(this._zTime=s)),this._repeat){if(N=this._yoyo,x=f+this._rDelay,this._repeat<-1&&s<0)return this.totalTime(x*100+s,r,o);if(v=mt(h%x),h===d?(E=this._repeat,v=f):(D=mt(h/x),E=~~D,E&&E===D&&(v=f,E--),v>f&&(v=f)),D=da(this._tTime,x),!u&&this._tTime&&D!==E&&this._tTime-D*x-this._dur<=0&&(D=E),N&&E&1&&(v=f-v,C=1),E!==D&&!this._lock){var M=N&&D&1,O=M===(N&&E&1);if(E<D&&(M=!M),u=M?0:h%f?f:h,this._lock=1,this.render(u||(C?0:mt(E*x)),r,!f)._lock=0,this._tTime=h,!r&&this.parent&&pi(this,"onRepeat"),this.vars.repeatRefresh&&!C&&(this.invalidate()._lock=1),u&&u!==this._time||_!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(f=this._dur,d=this._tDur,O&&(this._lock=2,u=M?f:-1e-4,this.render(u,!0),this.vars.repeatRefresh&&!C&&this.invalidate()),this._lock=0,!this._ts&&!_)return this;tT(this,C)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(R=K1(this,mt(u),mt(v)),R&&(h-=v-(v=R._start))),this._tTime=h,this._time=v,this._act=!A,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=s,u=0),!u&&h&&!r&&!D&&(pi(this,"onStart"),this._tTime!==h))return this;if(v>=u&&s>=0)for(y=this._first;y;){if(S=y._next,(y._act||v>=y._start)&&y._ts&&R!==y){if(y.parent!==this)return this.render(s,r,o);if(y.render(y._ts>0?(v-y._start)*y._ts:(y._dirty?y.totalDuration():y._tDur)+(v-y._start)*y._ts,r,o),v!==this._time||!this._ts&&!_){R=0,S&&(h+=this._zTime=-Xe);break}}y=S}else{y=this._last;for(var P=s<0?s:v;y;){if(S=y._prev,(y._act||P<=y._end)&&y._ts&&R!==y){if(y.parent!==this)return this.render(s,r,o);if(y.render(y._ts>0?(P-y._start)*y._ts:(y._dirty?y.totalDuration():y._tDur)+(P-y._start)*y._ts,r,o||Ot&&eg(y)),v!==this._time||!this._ts&&!_){R=0,S&&(h+=this._zTime=P?-Xe:Xe);break}}y=S}}if(R&&!r&&(this.pause(),R.render(v>=u?0:-Xe)._zTime=v>=u?1:-1,this._ts))return this._start=I,ic(this),this.render(s,r,o);this._onUpdate&&!r&&pi(this,"onUpdate",!0),(h===d&&this._tTime>=this.totalDuration()||!h&&u)&&(I===this._start||Math.abs(A)!==Math.abs(this._ts))&&(this._lock||((s||!f)&&(h===d&&this._ts>0||!h&&this._ts<0)&&yn(this,1),!r&&!(s<0&&!u)&&(h||u||!d)&&(pi(this,h===d&&s>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(h<d&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(s,r){var o=this;if(Ns(r)||(r=Oi(this,r,s)),!(s instanceof kl)){if(Gt(s))return s.forEach(function(u){return o.add(u,r)}),this;if(Rt(s))return this.addLabel(s,r);if(lt(s))s=gt.delayedCall(0,s);else return this}return this!==s?as(this,s,r):this},t.getChildren=function(s,r,o,u){s===void 0&&(s=!0),r===void 0&&(r=!0),o===void 0&&(o=!0),u===void 0&&(u=-ki);for(var d=[],f=this._first;f;)f._start>=u&&(f instanceof gt?r&&d.push(f):(o&&d.push(f),s&&d.push.apply(d,f.getChildren(!0,r,o)))),f=f._next;return d},t.getById=function(s){for(var r=this.getChildren(1,1,1),o=r.length;o--;)if(r[o].vars.id===s)return r[o]},t.remove=function(s){return Rt(s)?this.removeLabel(s):lt(s)?this.killTweensOf(s):(s.parent===this&&tc(this,s),s===this._recent&&(this._recent=this._last),Zn(this))},t.totalTime=function(s,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=mt(gi.time-(this._ts>0?s/this._ts:(this.totalDuration()-s)/-this._ts))),l.prototype.totalTime.call(this,s,r),this._forcing=0,this):this._tTime},t.addLabel=function(s,r){return this.labels[s]=Oi(this,r),this},t.removeLabel=function(s){return delete this.labels[s],this},t.addPause=function(s,r,o){var u=gt.delayedCall(0,r||Ol,o);return u.data="isPause",this._hasPause=1,as(this,u,Oi(this,s))},t.removePause=function(s){var r=this._first;for(s=Oi(this,s);r;)r._start===s&&r.data==="isPause"&&yn(r),r=r._next},t.killTweensOf=function(s,r,o){for(var u=this.getTweensOf(s,o),d=u.length;d--;)dn!==u[d]&&u[d].kill(s,r);return this},t.getTweensOf=function(s,r){for(var o=[],u=Ni(s),d=this._first,f=Ns(r),h;d;)d instanceof gt?F1(d._targets,u)&&(f?(!dn||d._initted&&d._ts)&&d.globalTime(0)<=r&&d.globalTime(d.totalDuration())>r:!r||d.isActive())&&o.push(d):(h=d.getTweensOf(u,r)).length&&o.push.apply(o,h),d=d._next;return o},t.tweenTo=function(s,r){r=r||{};var o=this,u=Oi(o,s),d=r,f=d.startAt,h=d.onStart,m=d.onStartParams,v=d.immediateRender,y,S=gt.to(o,Ti({ease:r.ease||"none",lazy:!1,immediateRender:!1,time:u,overwrite:"auto",duration:r.duration||Math.abs((u-(f&&"time"in f?f.time:o._time))/o.timeScale())||Xe,onStart:function(){if(o.pause(),!y){var x=r.duration||Math.abs((u-(f&&"time"in f?f.time:o._time))/o.timeScale());S._dur!==x&&ha(S,x,0,1).render(S._time,!0,!0),y=1}h&&h.apply(S,m||[])}},r));return v?S.render(0):S},t.tweenFromTo=function(s,r,o){return this.tweenTo(r,Ti({startAt:{time:Oi(this,s)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(s){return s===void 0&&(s=this._time),Fv(this,Oi(this,s))},t.previousLabel=function(s){return s===void 0&&(s=this._time),Fv(this,Oi(this,s),1)},t.currentLabel=function(s){return arguments.length?this.seek(s,!0):this.previousLabel(this._time+Xe)},t.shiftChildren=function(s,r,o){o===void 0&&(o=0);for(var u=this._first,d=this.labels,f;u;)u._start>=o&&(u._start+=s,u._end+=s),u=u._next;if(r)for(f in d)d[f]>=o&&(d[f]+=s);return Zn(this)},t.invalidate=function(s){var r=this._first;for(this._lock=0;r;)r.invalidate(s),r=r._next;return l.prototype.invalidate.call(this,s)},t.clear=function(s){s===void 0&&(s=!0);for(var r=this._first,o;r;)o=r._next,this.remove(r),r=o;return this._dp&&(this._time=this._tTime=this._pTime=0),s&&(this.labels={}),Zn(this)},t.totalDuration=function(s){var r=0,o=this,u=o._last,d=ki,f,h,m;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-s:s));if(o._dirty){for(m=o.parent;u;)f=u._prev,u._dirty&&u.totalDuration(),h=u._start,h>d&&o._sort&&u._ts&&!o._lock?(o._lock=1,as(o,u,h-u._delay,1)._lock=0):d=h,h<0&&u._ts&&(r-=h,(!m&&!o._dp||m&&m.smoothChildTiming)&&(o._start+=h/o._ts,o._time-=h,o._tTime-=h),o.shiftChildren(-h,!1,-1/0),d=0),u._end>r&&u._ts&&(r=u._end),u=f;ha(o,o===st&&o._time>r?o._time:r,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(s){if(st._ts&&(kS(st,Uu(s,st)),MS=gi.frame),gi.frame>=Pv){Pv+=vi.autoSleep||120;var r=st._first;if((!r||!r._ts)&&vi.autoSleep&&gi._listeners.length<2){for(;r&&!r._ts;)r=r._next;r||gi.sleep()}}},e}(kl);Ti(zt.prototype,{_lock:0,_hasPause:0,_forcing:0});var lb=function(e,t,i,s,r,o,u){var d=new ti(this._pt,e,t,0,1,uT,null,r),f=0,h=0,m,v,y,S,E,x,_,R;for(d.b=i,d.e=s,i+="",s+="",(_=~s.indexOf("random("))&&(s=Ml(s)),o&&(R=[i,s],o(R,e,t),i=R[0],s=R[1]),v=i.match(Ad)||[];m=Ad.exec(s);)S=m[0],E=s.substring(f,m.index),y?y=(y+1)%5:E.substr(-5)==="rgba("&&(y=1),S!==v[h++]&&(x=parseFloat(v[h-1])||0,d._pt={_next:d._pt,p:E||h===1?E:",",s:x,c:S.charAt(1)==="="?sa(x,S)-x:parseFloat(S)-x,m:y&&y<4?Math.round:0},f=Ad.lastIndex);return d.c=f<s.length?s.substring(f,s.length):"",d.fp=u,(DS.test(s)||_)&&(d.e=0),this._pt=d,d},tg=function(e,t,i,s,r,o,u,d,f,h){lt(s)&&(s=s(r||0,e,o));var m=e[t],v=i!=="get"?i:lt(m)?f?e[t.indexOf("set")||!lt(e["get"+t.substr(3)])?t:"get"+t.substr(3)](f):e[t]():m,y=lt(m)?f?db:lT:sg,S;if(Rt(s)&&(~s.indexOf("random(")&&(s=Ml(s)),s.charAt(1)==="="&&(S=sa(v,s)+(Ut(v)||0),(S||S===0)&&(s=S))),!h||v!==s||vh)return!isNaN(v*s)&&s!==""?(S=new ti(this._pt,e,t,+v||0,s-(v||0),typeof m=="boolean"?gb:oT,0,y),f&&(S.fp=f),u&&S.modifier(u,this,e),this._pt=S):(!m&&!(t in e)&&Qh(t,s),lb.call(this,e,t,v,s,y,d||vi.stringFilter,f))},ob=function(e,t,i,s,r){if(lt(e)&&(e=Ll(e,r,t,i,s)),!cs(e)||e.style&&e.nodeType||Gt(e)||LS(e))return Rt(e)?Ll(e,r,t,i,s):e;var o={},u;for(u in e)o[u]=Ll(e[u],r,t,i,s);return o},nT=function(e,t,i,s,r,o){var u,d,f,h;if(fi[e]&&(u=new fi[e]).init(r,u.rawVars?t[e]:ob(t[e],s,r,o,i),i,s,o)!==!1&&(i._pt=d=new ti(i._pt,r,e,0,1,u.render,u,0,u.priority),i!==ta))for(f=i._ptLookup[i._targets.indexOf(r)],h=u._props.length;h--;)f[u._props[h]]=d;return u},dn,vh,ig=function l(e,t,i){var s=e.vars,r=s.ease,o=s.startAt,u=s.immediateRender,d=s.lazy,f=s.onUpdate,h=s.runBackwards,m=s.yoyoEase,v=s.keyframes,y=s.autoRevert,S=e._dur,E=e._startAt,x=e._targets,_=e.parent,R=_&&_.data==="nested"?_.vars.targets:x,A=e._overwrite==="auto"&&!Yh,I=e.timeline,D,N,C,M,O,P,U,H,se,ue,te,B,K;if(I&&(!v||!r)&&(r="none"),e._ease=Jn(r,ca.ease),e._yEase=m?eT(Jn(m===!0?r:m,ca.ease)):0,m&&e._yoyo&&!e._repeat&&(m=e._yEase,e._yEase=e._ease,e._ease=m),e._from=!I&&!!s.runBackwards,!I||v&&!s.stagger){if(H=x[0]?Wn(x[0]).harness:0,B=H&&s[H.prop],D=Fu(s,Wh),E&&(E._zTime<0&&E.progress(1),t<0&&h&&u&&!y?E.render(-1,!0):E.revert(h&&S?bu:N1),E._lazy=0),o){if(yn(e._startAt=gt.set(x,Ti({data:"isStart",overwrite:!1,parent:_,immediateRender:!0,lazy:!E&&Jt(d),startAt:null,delay:0,onUpdate:f&&function(){return pi(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Ot||!u&&!y)&&e._startAt.revert(bu),u&&S&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(h&&S&&!E){if(t&&(u=!1),C=Ti({overwrite:!1,data:"isFromStart",lazy:u&&!E&&Jt(d),immediateRender:u,stagger:0,parent:_},D),B&&(C[H.prop]=B),yn(e._startAt=gt.set(x,C)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Ot?e._startAt.revert(bu):e._startAt.render(-1,!0)),e._zTime=t,!u)l(e._startAt,Xe,Xe);else if(!t)return}for(e._pt=e._ptCache=0,d=S&&Jt(d)||d&&!S,N=0;N<x.length;N++){if(O=x[N],U=O._gsap||Jh(x)[N]._gsap,e._ptLookup[N]=ue={},fh[U.id]&&pn.length&&Bu(),te=R===x?N:R.indexOf(O),H&&(se=new H).init(O,B||D,e,te,R)!==!1&&(e._pt=M=new ti(e._pt,O,se.name,0,1,se.render,se,0,se.priority),se._props.forEach(function(j){ue[j]=M}),se.priority&&(P=1)),!H||B)for(C in D)fi[C]&&(se=nT(C,D,e,te,O,R))?se.priority&&(P=1):ue[C]=M=tg.call(e,O,C,"get",D[C],te,R,0,s.stringFilter);e._op&&e._op[N]&&e.kill(O,e._op[N]),A&&e._pt&&(dn=e,st.killTweensOf(O,ue,e.globalTime(t)),K=!e.parent,dn=0),e._pt&&d&&(fh[U.id]=1)}P&&cT(e),e._onInit&&e._onInit(e)}e._onUpdate=f,e._initted=(!e._op||e._pt)&&!K,v&&t<=0&&I.render(ki,!0,!0)},ub=function(e,t,i,s,r,o,u,d){var f=(e._pt&&e._ptCache||(e._ptCache={}))[t],h,m,v,y;if(!f)for(f=e._ptCache[t]=[],v=e._ptLookup,y=e._targets.length;y--;){if(h=v[y][t],h&&h.d&&h.d._pt)for(h=h.d._pt;h&&h.p!==t&&h.fp!==t;)h=h._next;if(!h)return vh=1,e.vars[t]="+=0",ig(e,u),vh=0,d?Cl(t+" not eligible for reset"):1;f.push(h)}for(y=f.length;y--;)m=f[y],h=m._pt||m,h.s=(s||s===0)&&!r?s:h.s+(s||0)+o*h.c,h.c=i-h.s,m.e&&(m.e=ct(i)+Ut(m.e)),m.b&&(m.b=h.s+Ut(m.b))},cb=function(e,t){var i=e[0]?Wn(e[0]).harness:0,s=i&&i.aliases,r,o,u,d;if(!s)return t;r=fa({},t);for(o in s)if(o in r)for(d=s[o].split(","),u=d.length;u--;)r[d[u]]=r[o];return r},fb=function(e,t,i,s){var r=t.ease||s||"power1.inOut",o,u;if(Gt(t))u=i[e]||(i[e]=[]),t.forEach(function(d,f){return u.push({t:f/(t.length-1)*100,v:d,e:r})});else for(o in t)u=i[o]||(i[o]=[]),o==="ease"||u.push({t:parseFloat(e),v:t[o],e:r})},Ll=function(e,t,i,s,r){return lt(e)?e.call(t,i,s,r):Rt(e)&&~e.indexOf("random(")?Ml(e):e},rT=Zh+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",aT={};ei(rT+",id,stagger,delay,duration,paused,scrollTrigger",function(l){return aT[l]=1});var gt=function(l){bS(e,l);function e(i,s,r,o){var u;typeof s=="number"&&(r.duration=s,s=r,r=null),u=l.call(this,o?s:bl(s))||this;var d=u.vars,f=d.duration,h=d.delay,m=d.immediateRender,v=d.stagger,y=d.overwrite,S=d.keyframes,E=d.defaults,x=d.scrollTrigger,_=d.yoyoEase,R=s.parent||st,A=(Gt(i)||LS(i)?Ns(i[0]):"length"in s)?[i]:Ni(i),I,D,N,C,M,O,P,U;if(u._targets=A.length?Jh(A):Cl("GSAP target "+i+" not found. https://gsap.com",!vi.nullTargetWarn)||[],u._ptLookup=[],u._overwrite=y,S||v||ou(f)||ou(h)){if(s=u.vars,I=u.timeline=new zt({data:"nested",defaults:E||{},targets:R&&R.data==="nested"?R.vars.targets:A}),I.kill(),I.parent=I._dp=Cs(u),I._start=0,v||ou(f)||ou(h)){if(C=A.length,P=v&&VS(v),cs(v))for(M in v)~rT.indexOf(M)&&(U||(U={}),U[M]=v[M]);for(D=0;D<C;D++)N=Fu(s,aT),N.stagger=0,_&&(N.yoyoEase=_),U&&fa(N,U),O=A[D],N.duration=+Ll(f,Cs(u),D,O,A),N.delay=(+Ll(h,Cs(u),D,O,A)||0)-u._delay,!v&&C===1&&N.delay&&(u._delay=h=N.delay,u._start+=h,N.delay=0),I.to(O,N,P?P(D,O,A):0),I._ease=Oe.none;I.duration()?f=h=0:u.timeline=0}else if(S){bl(Ti(I.vars.defaults,{ease:"none"})),I._ease=Jn(S.ease||s.ease||"none");var H=0,se,ue,te;if(Gt(S))S.forEach(function(B){return I.to(A,B,">")}),I.duration();else{N={};for(M in S)M==="ease"||M==="easeEach"||fb(M,S[M],N,S.easeEach);for(M in N)for(se=N[M].sort(function(B,K){return B.t-K.t}),H=0,D=0;D<se.length;D++)ue=se[D],te={ease:ue.e,duration:(ue.t-(D?se[D-1].t:0))/100*f},te[M]=ue.v,I.to(A,te,H),H+=te.duration;I.duration()<f&&I.to({},{duration:f-I.duration()})}}f||u.duration(f=I.duration())}else u.timeline=0;return y===!0&&!Yh&&(dn=Cs(u),st.killTweensOf(A),dn=0),as(R,Cs(u),r),s.reversed&&u.reverse(),s.paused&&u.paused(!0),(m||!f&&!S&&u._start===mt(R._time)&&Jt(m)&&z1(Cs(u))&&R.data!=="nested")&&(u._tTime=-Xe,u.render(Math.max(0,-h)||0)),x&&GS(Cs(u),x),u}var t=e.prototype;return t.render=function(s,r,o){var u=this._time,d=this._tDur,f=this._dur,h=s<0,m=s>d-Xe&&!h?d:s<Xe?0:s,v,y,S,E,x,_,R,A,I;if(!f)V1(this,s,r,o);else if(m!==this._tTime||!s||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==h||this._lazy){if(v=m,A=this.timeline,this._repeat){if(E=f+this._rDelay,this._repeat<-1&&h)return this.totalTime(E*100+s,r,o);if(v=mt(m%E),m===d?(S=this._repeat,v=f):(x=mt(m/E),S=~~x,S&&S===x?(v=f,S--):v>f&&(v=f)),_=this._yoyo&&S&1,_&&(I=this._yEase,v=f-v),x=da(this._tTime,E),v===u&&!o&&this._initted&&S===x)return this._tTime=m,this;S!==x&&(A&&this._yEase&&tT(A,_),this.vars.repeatRefresh&&!_&&!this._lock&&v!==E&&this._initted&&(this._lock=o=1,this.render(mt(E*S),!0).invalidate()._lock=0))}if(!this._initted){if($S(this,h?s:v,o,r,m))return this._tTime=0,this;if(u!==this._time&&!(o&&this.vars.repeatRefresh&&S!==x))return this;if(f!==this._dur)return this.render(s,r,o)}if(this._tTime=m,this._time=v,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=R=(I||this._ease)(v/f),this._from&&(this.ratio=R=1-R),!u&&m&&!r&&!x&&(pi(this,"onStart"),this._tTime!==m))return this;for(y=this._pt;y;)y.r(R,y.d),y=y._next;A&&A.render(s<0?s:A._dur*A._ease(v/this._dur),r,o)||this._startAt&&(this._zTime=s),this._onUpdate&&!r&&(h&&dh(this,s,r,o),pi(this,"onUpdate")),this._repeat&&S!==x&&this.vars.onRepeat&&!r&&this.parent&&pi(this,"onRepeat"),(m===this._tDur||!m)&&this._tTime===m&&(h&&!this._onUpdate&&dh(this,s,!0,!0),(s||!f)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&yn(this,1),!r&&!(h&&!u)&&(m||u||_)&&(pi(this,m===d?"onComplete":"onReverseComplete",!0),this._prom&&!(m<d&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(s){return(!s||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(s),l.prototype.invalidate.call(this,s)},t.resetTo=function(s,r,o,u,d){Pl||gi.wake(),this._ts||this.play();var f=Math.min(this._dur,(this._dp._time-this._start)*this._ts),h;return this._initted||ig(this,f),h=this._ease(f/this._dur),ub(this,s,r,o,u,h,f,d)?this.resetTo(s,r,o,u,1):(sc(this,0),this.parent||FS(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(s,r){if(r===void 0&&(r="all"),!s&&(!r||r==="all"))return this._lazy=this._pt=0,this.parent?El(this):this.scrollTrigger&&this.scrollTrigger.kill(!!Ot),this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(s,r,dn&&dn.vars.overwrite!==!0)._first||El(this),this.parent&&o!==this.timeline.totalDuration()&&ha(this,this._dur*this.timeline._tDur/o,0,1),this}var u=this._targets,d=s?Ni(s):u,f=this._ptLookup,h=this._pt,m,v,y,S,E,x,_;if((!r||r==="all")&&G1(u,d))return r==="all"&&(this._pt=0),El(this);for(m=this._op=this._op||[],r!=="all"&&(Rt(r)&&(E={},ei(r,function(R){return E[R]=1}),r=E),r=cb(u,r)),_=u.length;_--;)if(~d.indexOf(u[_])){v=f[_],r==="all"?(m[_]=r,S=v,y={}):(y=m[_]=m[_]||{},S=r);for(E in S)x=v&&v[E],x&&((!("kill"in x.d)||x.d.kill(E)===!0)&&tc(this,x,"_pt"),delete v[E]),y!=="all"&&(y[E]=1)}return this._initted&&!this._pt&&h&&El(this),this},e.to=function(s,r){return new e(s,r,arguments[2])},e.from=function(s,r){return Al(1,arguments)},e.delayedCall=function(s,r,o,u){return new e(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:s,onComplete:r,onReverseComplete:r,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:u})},e.fromTo=function(s,r,o){return Al(2,arguments)},e.set=function(s,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new e(s,r)},e.killTweensOf=function(s,r,o){return st.killTweensOf(s,r,o)},e}(kl);Ti(gt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});ei("staggerTo,staggerFrom,staggerFromTo",function(l){gt[l]=function(){var e=new zt,t=gh.call(arguments,0);return t.splice(l==="staggerFromTo"?5:4,0,0),e[l].apply(e,t)}});var sg=function(e,t,i){return e[t]=i},lT=function(e,t,i){return e[t](i)},db=function(e,t,i,s){return e[t](s.fp,i)},hb=function(e,t,i){return e.setAttribute(t,i)},ng=function(e,t){return lt(e[t])?lT:jh(e[t])&&e.setAttribute?hb:sg},oT=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},gb=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},uT=function(e,t){var i=t._pt,s="";if(!e&&t.b)s=t.b;else if(e===1&&t.e)s=t.e;else{for(;i;)s=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+s,i=i._next;s+=t.c}t.set(t.t,t.p,s,t)},rg=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},mb=function(e,t,i,s){for(var r=this._pt,o;r;)o=r._next,r.p===s&&r.modifier(e,t,i),r=o},pb=function(e){for(var t=this._pt,i,s;t;)s=t._next,t.p===e&&!t.op||t.op===e?tc(this,t,"_pt"):t.dep||(i=1),t=s;return!i},vb=function(e,t,i,s){s.mSet(e,t,s.m.call(s.tween,i,s.mt),s)},cT=function(e){for(var t=e._pt,i,s,r,o;t;){for(i=t._next,s=r;s&&s.pr>t.pr;)s=s._next;(t._prev=s?s._prev:o)?t._prev._next=t:r=t,(t._next=s)?s._prev=t:o=t,t=i}e._pt=r},ti=function(){function l(t,i,s,r,o,u,d,f,h){this.t=i,this.s=r,this.c=o,this.p=s,this.r=u||oT,this.d=d||this,this.set=f||sg,this.pr=h||0,this._next=t,t&&(t._prev=this)}var e=l.prototype;return e.modifier=function(i,s,r){this.mSet=this.mSet||this.set,this.set=vb,this.m=i,this.mt=r,this.tween=s},l}();ei(Zh+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(l){return Wh[l]=1});Si.TweenMax=Si.TweenLite=gt;Si.TimelineLite=Si.TimelineMax=zt;st=new zt({sortChildren:!1,defaults:ca,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});vi.stringFilter=JS;var er=[],Lu={},yb=[],Gv=0,Sb=0,wd=function(e){return(Lu[e]||yb).map(function(t){return t()})},yh=function(){var e=Date.now(),t=[];e-Gv>2&&(wd("matchMediaInit"),er.forEach(function(i){var s=i.queries,r=i.conditions,o,u,d,f;for(u in s)o=ns.matchMedia(s[u]).matches,o&&(d=1),o!==r[u]&&(r[u]=o,f=1);f&&(i.revert(),d&&t.push(i))}),wd("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(s){return i.add(null,s)})}),Gv=e,wd("matchMedia"))},fT=function(){function l(t,i){this.selector=i&&mh(i),this.data=[],this._r=[],this.isReverted=!1,this.id=Sb++,t&&this.add(t)}var e=l.prototype;return e.add=function(i,s,r){lt(i)&&(r=s,s=i,i=lt);var o=this,u=function(){var f=et,h=o.selector,m;return f&&f!==o&&f.data.push(o),r&&(o.selector=mh(r)),et=o,m=s.apply(o,arguments),lt(m)&&o._r.push(m),et=f,o.selector=h,o.isReverted=!1,m};return o.last=u,i===lt?u(o,function(d){return o.add(null,d)}):i?o[i]=u:u},e.ignore=function(i){var s=et;et=null,i(this),et=s},e.getTweens=function(){var i=[];return this.data.forEach(function(s){return s instanceof l?i.push.apply(i,s.getTweens()):s instanceof gt&&!(s.parent&&s.parent.data==="nested")&&i.push(s)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,s){var r=this;if(i?function(){for(var u=r.getTweens(),d=r.data.length,f;d--;)f=r.data[d],f.data==="isFlip"&&(f.revert(),f.getChildren(!0,!0,!1).forEach(function(h){return u.splice(u.indexOf(h),1)}));for(u.map(function(h){return{g:h._dur||h._delay||h._sat&&!h._sat.vars.immediateRender?h.globalTime(0):-1/0,t:h}}).sort(function(h,m){return m.g-h.g||-1/0}).forEach(function(h){return h.t.revert(i)}),d=r.data.length;d--;)f=r.data[d],f instanceof zt?f.data!=="nested"&&(f.scrollTrigger&&f.scrollTrigger.revert(),f.kill()):!(f instanceof gt)&&f.revert&&f.revert(i);r._r.forEach(function(h){return h(i,r)}),r.isReverted=!0}():this.data.forEach(function(u){return u.kill&&u.kill()}),this.clear(),s)for(var o=er.length;o--;)er[o].id===this.id&&er.splice(o,1)},e.revert=function(i){this.kill(i||{})},l}(),Tb=function(){function l(t){this.contexts=[],this.scope=t,et&&et.data.push(this)}var e=l.prototype;return e.add=function(i,s,r){cs(i)||(i={matches:i});var o=new fT(0,r||this.scope),u=o.conditions={},d,f,h;et&&!o.selector&&(o.selector=et.selector),this.contexts.push(o),s=o.add("onMatch",s),o.queries=i;for(f in i)f==="all"?h=1:(d=ns.matchMedia(i[f]),d&&(er.indexOf(o)<0&&er.push(o),(u[f]=d.matches)&&(h=1),d.addListener?d.addListener(yh):d.addEventListener("change",yh)));return h&&s(o,function(m){return o.add(null,m)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(s){return s.kill(i,!0)})},l}(),Gu={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(s){return QS(s)})},timeline:function(e){return new zt(e)},getTweensOf:function(e,t){return st.getTweensOf(e,t)},getProperty:function(e,t,i,s){Rt(e)&&(e=Ni(e)[0]);var r=Wn(e||{}).get,o=i?BS:NS;return i==="native"&&(i=""),e&&(t?o((fi[t]&&fi[t].get||r)(e,t,i,s)):function(u,d,f){return o((fi[u]&&fi[u].get||r)(e,u,d,f))})},quickSetter:function(e,t,i){if(e=Ni(e),e.length>1){var s=e.map(function(h){return si.quickSetter(h,t,i)}),r=s.length;return function(h){for(var m=r;m--;)s[m](h)}}e=e[0]||{};var o=fi[t],u=Wn(e),d=u.harness&&(u.harness.aliases||{})[t]||t,f=o?function(h){var m=new o;ta._pt=0,m.init(e,i?h+i:h,ta,0,[e]),m.render(1,m),ta._pt&&rg(1,ta)}:u.set(e,d);return o?f:function(h){return f(e,d,i?h+i:h,u,1)}},quickTo:function(e,t,i){var s,r=si.to(e,Ti((s={},s[t]="+=0.1",s.paused=!0,s.stagger=0,s),i||{})),o=function(d,f,h){return r.resetTo(t,d,f,h)};return o.tween=r,o},isTweening:function(e){return st.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Jn(e.ease,ca.ease)),kv(ca,e||{})},config:function(e){return kv(vi,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,s=e.plugins,r=e.defaults,o=e.extendTimeline;(s||"").split(",").forEach(function(u){return u&&!fi[u]&&!Si[u]&&Cl(t+" effect requires "+u+" plugin.")}),Ld[t]=function(u,d,f){return i(Ni(u),Ti(d||{},r),f)},o&&(zt.prototype[t]=function(u,d,f){return this.add(Ld[t](u,cs(d)?d:(f=d)&&{},this),f)})},registerEase:function(e,t){Oe[e]=Jn(t)},parseEase:function(e,t){return arguments.length?Jn(e,t):Oe},getById:function(e){return st.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new zt(e),s,r;for(i.smoothChildTiming=Jt(e.smoothChildTiming),st.remove(i),i._dp=0,i._time=i._tTime=st._time,s=st._first;s;)r=s._next,(t||!(!s._dur&&s instanceof gt&&s.vars.onComplete===s._targets[0]))&&as(i,s,s._start-s._delay),s=r;return as(st,i,0),i},context:function(e,t){return e?new fT(e,t):et},matchMedia:function(e){return new Tb(e)},matchMediaRefresh:function(){return er.forEach(function(e){var t=e.conditions,i,s;for(s in t)t[s]&&(t[s]=!1,i=1);i&&e.revert()})||yh()},addEventListener:function(e,t){var i=Lu[e]||(Lu[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=Lu[e],s=i&&i.indexOf(t);s>=0&&i.splice(s,1)},utils:{wrap:Z1,wrapYoyo:J1,distribute:VS,random:YS,snap:KS,normalize:W1,getUnit:Ut,clamp:j1,splitColor:WS,toArray:Ni,selector:mh,mapRange:qS,pipe:X1,unitize:Q1,interpolate:eb,shuffle:HS},install:CS,effects:Ld,ticker:gi,updateRoot:zt.updateRoot,plugins:fi,globalTimeline:st,core:{PropTween:ti,globals:OS,Tween:gt,Timeline:zt,Animation:kl,getCache:Wn,_removeLinkedListItem:tc,reverting:function(){return Ot},context:function(e){return e&&et&&(et.data.push(e),e._ctx=et),et},suppressOverwrites:function(e){return Yh=e}}};ei("to,from,fromTo,delayedCall,set,killTweensOf",function(l){return Gu[l]=gt[l]});gi.add(zt.updateRoot);ta=Gu.to({},{duration:0});var Eb=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},xb=function(e,t){var i=e._targets,s,r,o;for(s in t)for(r=i.length;r--;)o=e._ptLookup[r][s],o&&(o=o.d)&&(o._pt&&(o=Eb(o,s)),o&&o.modifier&&o.modifier(t[s],e,i[r],s))},Cd=function(e,t){return{name:e,headless:1,rawVars:1,init:function(s,r,o){o._onInit=function(u){var d,f;if(Rt(r)&&(d={},ei(r,function(h){return d[h]=1}),r=d),t){d={};for(f in r)d[f]=t(r[f]);r=d}xb(u,r)}}}},si=Gu.registerPlugin({name:"attr",init:function(e,t,i,s,r){var o,u,d;this.tween=i;for(o in t)d=e.getAttribute(o)||"",u=this.add(e,"setAttribute",(d||0)+"",t[o],s,r,0,0,o),u.op=o,u.b=d,this._props.push(o)},render:function(e,t){for(var i=t._pt;i;)Ot?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",headless:1,init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},Cd("roundProps",ph),Cd("modifiers"),Cd("snap",KS))||Gu;gt.version=zt.version=si.version="3.13.0";wS=1;qh()&&ga();Oe.Power0;Oe.Power1;Oe.Power2;Oe.Power3;Oe.Power4;Oe.Linear;Oe.Quad;Oe.Cubic;Oe.Quart;Oe.Quint;Oe.Strong;Oe.Elastic;Oe.Back;Oe.SteppedEase;Oe.Bounce;Oe.Sine;Oe.Expo;Oe.Circ;/*!
 * CSSPlugin 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var $v,hn,na,ag,Qn,zv,lg,_b=function(){return typeof window<"u"},Bs={},jn=180/Math.PI,ra=Math.PI/180,qr=Math.atan2,Hv=1e8,og=/([A-Z])/g,bb=/(left|right|width|margin|padding|x)/i,Ab=/[\s,\(]\S/,ls={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Sh=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},Lb=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},Rb=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},Db=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},dT=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},hT=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},Ib=function(e,t,i){return e.style[t]=i},wb=function(e,t,i){return e.style.setProperty(t,i)},Cb=function(e,t,i){return e._gsap[t]=i},Ob=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},Mb=function(e,t,i,s,r){var o=e._gsap;o.scaleX=o.scaleY=i,o.renderTransform(r,o)},Pb=function(e,t,i,s,r){var o=e._gsap;o[t]=i,o.renderTransform(r,o)},nt="transform",ii=nt+"Origin",kb=function l(e,t){var i=this,s=this.target,r=s.style,o=s._gsap;if(e in Bs&&r){if(this.tfm=this.tfm||{},e!=="transform")e=ls[e]||e,~e.indexOf(",")?e.split(",").forEach(function(u){return i.tfm[u]=Ps(s,u)}):this.tfm[e]=o.x?o[e]:Ps(s,e),e===ii&&(this.tfm.zOrigin=o.zOrigin);else return ls.transform.split(",").forEach(function(u){return l.call(i,u,t)});if(this.props.indexOf(nt)>=0)return;o.svg&&(this.svgo=s.getAttribute("data-svg-origin"),this.props.push(ii,t,"")),e=nt}(r||t)&&this.props.push(e,t,r[e])},gT=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Nb=function(){var e=this.props,t=this.target,i=t.style,s=t._gsap,r,o;for(r=0;r<e.length;r+=3)e[r+1]?e[r+1]===2?t[e[r]](e[r+2]):t[e[r]]=e[r+2]:e[r+2]?i[e[r]]=e[r+2]:i.removeProperty(e[r].substr(0,2)==="--"?e[r]:e[r].replace(og,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)s[o]=this.tfm[o];s.svg&&(s.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),r=lg(),(!r||!r.isStart)&&!i[nt]&&(gT(i),s.zOrigin&&i[ii]&&(i[ii]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},mT=function(e,t){var i={target:e,props:[],revert:Nb,save:kb};return e._gsap||si.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(s){return i.save(s)}),i},pT,Th=function(e,t){var i=hn.createElementNS?hn.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):hn.createElement(e);return i&&i.style?i:hn.createElement(e)},Bi=function l(e,t,i){var s=getComputedStyle(e);return s[t]||s.getPropertyValue(t.replace(og,"-$1").toLowerCase())||s.getPropertyValue(t)||!i&&l(e,ma(t)||t,1)||""},Vv="O,Moz,ms,Ms,Webkit".split(","),ma=function(e,t,i){var s=t||Qn,r=s.style,o=5;if(e in r&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(Vv[o]+e in r););return o<0?null:(o===3?"ms":o>=0?Vv[o]:"")+e},Eh=function(){_b()&&window.document&&($v=window,hn=$v.document,na=hn.documentElement,Qn=Th("div")||{style:{}},Th("div"),nt=ma(nt),ii=nt+"Origin",Qn.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",pT=!!ma("perspective"),lg=si.core.reverting,ag=1)},Kv=function(e){var t=e.ownerSVGElement,i=Th("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=e.cloneNode(!0),r;s.style.display="block",i.appendChild(s),na.appendChild(i);try{r=s.getBBox()}catch{}return i.removeChild(s),na.removeChild(i),r},Yv=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},vT=function(e){var t,i;try{t=e.getBBox()}catch{t=Kv(e),i=1}return t&&(t.width||t.height)||i||(t=Kv(e)),t&&!t.width&&!t.x&&!t.y?{x:+Yv(e,["x","cx","x1"])||0,y:+Yv(e,["y","cy","y1"])||0,width:0,height:0}:t},yT=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&vT(e))},sr=function(e,t){if(t){var i=e.style,s;t in Bs&&t!==ii&&(t=nt),i.removeProperty?(s=t.substr(0,2),(s==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(s==="--"?t:t.replace(og,"-$1").toLowerCase())):i.removeAttribute(t)}},gn=function(e,t,i,s,r,o){var u=new ti(e._pt,t,i,0,1,o?hT:dT);return e._pt=u,u.b=s,u.e=r,e._props.push(i),u},jv={deg:1,rad:1,turn:1},Bb={grid:1,flex:1},Sn=function l(e,t,i,s){var r=parseFloat(i)||0,o=(i+"").trim().substr((r+"").length)||"px",u=Qn.style,d=bb.test(t),f=e.tagName.toLowerCase()==="svg",h=(f?"client":"offset")+(d?"Width":"Height"),m=100,v=s==="px",y=s==="%",S,E,x,_;if(s===o||!r||jv[s]||jv[o])return r;if(o!=="px"&&!v&&(r=l(e,t,i,"px")),_=e.getCTM&&yT(e),(y||o==="%")&&(Bs[t]||~t.indexOf("adius")))return S=_?e.getBBox()[d?"width":"height"]:e[h],ct(y?r/S*m:r/100*S);if(u[d?"width":"height"]=m+(v?o:s),E=s!=="rem"&&~t.indexOf("adius")||s==="em"&&e.appendChild&&!f?e:e.parentNode,_&&(E=(e.ownerSVGElement||{}).parentNode),(!E||E===hn||!E.appendChild)&&(E=hn.body),x=E._gsap,x&&y&&x.width&&d&&x.time===gi.time&&!x.uncache)return ct(r/x.width*m);if(y&&(t==="height"||t==="width")){var R=e.style[t];e.style[t]=m+s,S=e[h],R?e.style[t]=R:sr(e,t)}else(y||o==="%")&&!Bb[Bi(E,"display")]&&(u.position=Bi(e,"position")),E===e&&(u.position="static"),E.appendChild(Qn),S=Qn[h],E.removeChild(Qn),u.position="absolute";return d&&y&&(x=Wn(E),x.time=gi.time,x.width=E[h]),ct(v?S*r/m:S&&r?m/S*r:0)},Ps=function(e,t,i,s){var r;return ag||Eh(),t in ls&&t!=="transform"&&(t=ls[t],~t.indexOf(",")&&(t=t.split(",")[0])),Bs[t]&&t!=="transform"?(r=Bl(e,s),r=t!=="transformOrigin"?r[t]:r.svg?r.origin:zu(Bi(e,ii))+" "+r.zOrigin+"px"):(r=e.style[t],(!r||r==="auto"||s||~(r+"").indexOf("calc("))&&(r=$u[t]&&$u[t](e,t,i)||Bi(e,t)||PS(e,t)||(t==="opacity"?1:0))),i&&!~(r+"").trim().indexOf(" ")?Sn(e,t,r,i)+i:r},Fb=function(e,t,i,s){if(!i||i==="none"){var r=ma(t,e,1),o=r&&Bi(e,r,1);o&&o!==i?(t=r,i=o):t==="borderColor"&&(i=Bi(e,"borderTopColor"))}var u=new ti(this._pt,e.style,t,0,1,uT),d=0,f=0,h,m,v,y,S,E,x,_,R,A,I,D;if(u.b=i,u.e=s,i+="",s+="",s.substring(0,6)==="var(--"&&(s=Bi(e,s.substring(4,s.indexOf(")")))),s==="auto"&&(E=e.style[t],e.style[t]=s,s=Bi(e,t)||s,E?e.style[t]=E:sr(e,t)),h=[i,s],JS(h),i=h[0],s=h[1],v=i.match(ea)||[],D=s.match(ea)||[],D.length){for(;m=ea.exec(s);)x=m[0],R=s.substring(d,m.index),S?S=(S+1)%5:(R.substr(-5)==="rgba("||R.substr(-5)==="hsla(")&&(S=1),x!==(E=v[f++]||"")&&(y=parseFloat(E)||0,I=E.substr((y+"").length),x.charAt(1)==="="&&(x=sa(y,x)+I),_=parseFloat(x),A=x.substr((_+"").length),d=ea.lastIndex-A.length,A||(A=A||vi.units[t]||I,d===s.length&&(s+=A,u.e+=A)),I!==A&&(y=Sn(e,t,E,A)||0),u._pt={_next:u._pt,p:R||f===1?R:",",s:y,c:_-y,m:S&&S<4||t==="zIndex"?Math.round:0});u.c=d<s.length?s.substring(d,s.length):""}else u.r=t==="display"&&s==="none"?hT:dT;return DS.test(s)&&(u.e=0),this._pt=u,u},qv={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Ub=function(e){var t=e.split(" "),i=t[0],s=t[1]||"50%";return(i==="top"||i==="bottom"||s==="left"||s==="right")&&(e=i,i=s,s=e),t[0]=qv[i]||i,t[1]=qv[s]||s,t.join(" ")},Gb=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,s=i.style,r=t.u,o=i._gsap,u,d,f;if(r==="all"||r===!0)s.cssText="",d=1;else for(r=r.split(","),f=r.length;--f>-1;)u=r[f],Bs[u]&&(d=1,u=u==="transformOrigin"?ii:nt),sr(i,u);d&&(sr(i,nt),o&&(o.svg&&i.removeAttribute("transform"),s.scale=s.rotate=s.translate="none",Bl(i,1),o.uncache=1,gT(s)))}},$u={clearProps:function(e,t,i,s,r){if(r.data!=="isFromStart"){var o=e._pt=new ti(e._pt,t,i,0,0,Gb);return o.u=s,o.pr=-10,o.tween=r,e._props.push(i),1}}},Nl=[1,0,0,1,0,0],ST={},TT=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},Xv=function(e){var t=Bi(e,nt);return TT(t)?Nl:t.substr(7).match(RS).map(ct)},ug=function(e,t){var i=e._gsap||Wn(e),s=e.style,r=Xv(e),o,u,d,f;return i.svg&&e.getAttribute("transform")?(d=e.transform.baseVal.consolidate().matrix,r=[d.a,d.b,d.c,d.d,d.e,d.f],r.join(",")==="1,0,0,1,0,0"?Nl:r):(r===Nl&&!e.offsetParent&&e!==na&&!i.svg&&(d=s.display,s.display="block",o=e.parentNode,(!o||!e.offsetParent&&!e.getBoundingClientRect().width)&&(f=1,u=e.nextElementSibling,na.appendChild(e)),r=Xv(e),d?s.display=d:sr(e,"display"),f&&(u?o.insertBefore(e,u):o?o.appendChild(e):na.removeChild(e))),t&&r.length>6?[r[0],r[1],r[4],r[5],r[12],r[13]]:r)},xh=function(e,t,i,s,r,o){var u=e._gsap,d=r||ug(e,!0),f=u.xOrigin||0,h=u.yOrigin||0,m=u.xOffset||0,v=u.yOffset||0,y=d[0],S=d[1],E=d[2],x=d[3],_=d[4],R=d[5],A=t.split(" "),I=parseFloat(A[0])||0,D=parseFloat(A[1])||0,N,C,M,O;i?d!==Nl&&(C=y*x-S*E)&&(M=I*(x/C)+D*(-E/C)+(E*R-x*_)/C,O=I*(-S/C)+D*(y/C)-(y*R-S*_)/C,I=M,D=O):(N=vT(e),I=N.x+(~A[0].indexOf("%")?I/100*N.width:I),D=N.y+(~(A[1]||A[0]).indexOf("%")?D/100*N.height:D)),s||s!==!1&&u.smooth?(_=I-f,R=D-h,u.xOffset=m+(_*y+R*E)-_,u.yOffset=v+(_*S+R*x)-R):u.xOffset=u.yOffset=0,u.xOrigin=I,u.yOrigin=D,u.smooth=!!s,u.origin=t,u.originIsAbsolute=!!i,e.style[ii]="0px 0px",o&&(gn(o,u,"xOrigin",f,I),gn(o,u,"yOrigin",h,D),gn(o,u,"xOffset",m,u.xOffset),gn(o,u,"yOffset",v,u.yOffset)),e.setAttribute("data-svg-origin",I+" "+D)},Bl=function(e,t){var i=e._gsap||new sT(e);if("x"in i&&!t&&!i.uncache)return i;var s=e.style,r=i.scaleX<0,o="px",u="deg",d=getComputedStyle(e),f=Bi(e,ii)||"0",h,m,v,y,S,E,x,_,R,A,I,D,N,C,M,O,P,U,H,se,ue,te,B,K,j,oe,k,$,q,ne,fe,re;return h=m=v=E=x=_=R=A=I=0,y=S=1,i.svg=!!(e.getCTM&&yT(e)),d.translate&&((d.translate!=="none"||d.scale!=="none"||d.rotate!=="none")&&(s[nt]=(d.translate!=="none"?"translate3d("+(d.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(d.rotate!=="none"?"rotate("+d.rotate+") ":"")+(d.scale!=="none"?"scale("+d.scale.split(" ").join(",")+") ":"")+(d[nt]!=="none"?d[nt]:"")),s.scale=s.rotate=s.translate="none"),C=ug(e,i.svg),i.svg&&(i.uncache?(j=e.getBBox(),f=i.xOrigin-j.x+"px "+(i.yOrigin-j.y)+"px",K=""):K=!t&&e.getAttribute("data-svg-origin"),xh(e,K||f,!!K||i.originIsAbsolute,i.smooth!==!1,C)),D=i.xOrigin||0,N=i.yOrigin||0,C!==Nl&&(U=C[0],H=C[1],se=C[2],ue=C[3],h=te=C[4],m=B=C[5],C.length===6?(y=Math.sqrt(U*U+H*H),S=Math.sqrt(ue*ue+se*se),E=U||H?qr(H,U)*jn:0,R=se||ue?qr(se,ue)*jn+E:0,R&&(S*=Math.abs(Math.cos(R*ra))),i.svg&&(h-=D-(D*U+N*se),m-=N-(D*H+N*ue))):(re=C[6],ne=C[7],k=C[8],$=C[9],q=C[10],fe=C[11],h=C[12],m=C[13],v=C[14],M=qr(re,q),x=M*jn,M&&(O=Math.cos(-M),P=Math.sin(-M),K=te*O+k*P,j=B*O+$*P,oe=re*O+q*P,k=te*-P+k*O,$=B*-P+$*O,q=re*-P+q*O,fe=ne*-P+fe*O,te=K,B=j,re=oe),M=qr(-se,q),_=M*jn,M&&(O=Math.cos(-M),P=Math.sin(-M),K=U*O-k*P,j=H*O-$*P,oe=se*O-q*P,fe=ue*P+fe*O,U=K,H=j,se=oe),M=qr(H,U),E=M*jn,M&&(O=Math.cos(M),P=Math.sin(M),K=U*O+H*P,j=te*O+B*P,H=H*O-U*P,B=B*O-te*P,U=K,te=j),x&&Math.abs(x)+Math.abs(E)>359.9&&(x=E=0,_=180-_),y=ct(Math.sqrt(U*U+H*H+se*se)),S=ct(Math.sqrt(B*B+re*re)),M=qr(te,B),R=Math.abs(M)>2e-4?M*jn:0,I=fe?1/(fe<0?-fe:fe):0),i.svg&&(K=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!TT(Bi(e,nt)),K&&e.setAttribute("transform",K))),Math.abs(R)>90&&Math.abs(R)<270&&(r?(y*=-1,R+=E<=0?180:-180,E+=E<=0?180:-180):(S*=-1,R+=R<=0?180:-180)),t=t||i.uncache,i.x=h-((i.xPercent=h&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-h)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+o,i.y=m-((i.yPercent=m&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-m)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+o,i.z=v+o,i.scaleX=ct(y),i.scaleY=ct(S),i.rotation=ct(E)+u,i.rotationX=ct(x)+u,i.rotationY=ct(_)+u,i.skewX=R+u,i.skewY=A+u,i.transformPerspective=I+o,(i.zOrigin=parseFloat(f.split(" ")[2])||!t&&i.zOrigin||0)&&(s[ii]=zu(f)),i.xOffset=i.yOffset=0,i.force3D=vi.force3D,i.renderTransform=i.svg?zb:pT?ET:$b,i.uncache=0,i},zu=function(e){return(e=e.split(" "))[0]+" "+e[1]},Od=function(e,t,i){var s=Ut(t);return ct(parseFloat(t)+parseFloat(Sn(e,"x",i+"px",s)))+s},$b=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,ET(e,t)},Vn="0deg",Sl="0px",Kn=") ",ET=function(e,t){var i=t||this,s=i.xPercent,r=i.yPercent,o=i.x,u=i.y,d=i.z,f=i.rotation,h=i.rotationY,m=i.rotationX,v=i.skewX,y=i.skewY,S=i.scaleX,E=i.scaleY,x=i.transformPerspective,_=i.force3D,R=i.target,A=i.zOrigin,I="",D=_==="auto"&&e&&e!==1||_===!0;if(A&&(m!==Vn||h!==Vn)){var N=parseFloat(h)*ra,C=Math.sin(N),M=Math.cos(N),O;N=parseFloat(m)*ra,O=Math.cos(N),o=Od(R,o,C*O*-A),u=Od(R,u,-Math.sin(N)*-A),d=Od(R,d,M*O*-A+A)}x!==Sl&&(I+="perspective("+x+Kn),(s||r)&&(I+="translate("+s+"%, "+r+"%) "),(D||o!==Sl||u!==Sl||d!==Sl)&&(I+=d!==Sl||D?"translate3d("+o+", "+u+", "+d+") ":"translate("+o+", "+u+Kn),f!==Vn&&(I+="rotate("+f+Kn),h!==Vn&&(I+="rotateY("+h+Kn),m!==Vn&&(I+="rotateX("+m+Kn),(v!==Vn||y!==Vn)&&(I+="skew("+v+", "+y+Kn),(S!==1||E!==1)&&(I+="scale("+S+", "+E+Kn),R.style[nt]=I||"translate(0, 0)"},zb=function(e,t){var i=t||this,s=i.xPercent,r=i.yPercent,o=i.x,u=i.y,d=i.rotation,f=i.skewX,h=i.skewY,m=i.scaleX,v=i.scaleY,y=i.target,S=i.xOrigin,E=i.yOrigin,x=i.xOffset,_=i.yOffset,R=i.forceCSS,A=parseFloat(o),I=parseFloat(u),D,N,C,M,O;d=parseFloat(d),f=parseFloat(f),h=parseFloat(h),h&&(h=parseFloat(h),f+=h,d+=h),d||f?(d*=ra,f*=ra,D=Math.cos(d)*m,N=Math.sin(d)*m,C=Math.sin(d-f)*-v,M=Math.cos(d-f)*v,f&&(h*=ra,O=Math.tan(f-h),O=Math.sqrt(1+O*O),C*=O,M*=O,h&&(O=Math.tan(h),O=Math.sqrt(1+O*O),D*=O,N*=O)),D=ct(D),N=ct(N),C=ct(C),M=ct(M)):(D=m,M=v,N=C=0),(A&&!~(o+"").indexOf("px")||I&&!~(u+"").indexOf("px"))&&(A=Sn(y,"x",o,"px"),I=Sn(y,"y",u,"px")),(S||E||x||_)&&(A=ct(A+S-(S*D+E*C)+x),I=ct(I+E-(S*N+E*M)+_)),(s||r)&&(O=y.getBBox(),A=ct(A+s/100*O.width),I=ct(I+r/100*O.height)),O="matrix("+D+","+N+","+C+","+M+","+A+","+I+")",y.setAttribute("transform",O),R&&(y.style[nt]=O)},Hb=function(e,t,i,s,r){var o=360,u=Rt(r),d=parseFloat(r)*(u&&~r.indexOf("rad")?jn:1),f=d-s,h=s+f+"deg",m,v;return u&&(m=r.split("_")[1],m==="short"&&(f%=o,f!==f%(o/2)&&(f+=f<0?o:-o)),m==="cw"&&f<0?f=(f+o*Hv)%o-~~(f/o)*o:m==="ccw"&&f>0&&(f=(f-o*Hv)%o-~~(f/o)*o)),e._pt=v=new ti(e._pt,t,i,s,f,Lb),v.e=h,v.u="deg",e._props.push(i),v},Qv=function(e,t){for(var i in t)e[i]=t[i];return e},Vb=function(e,t,i){var s=Qv({},i._gsap),r="perspective,force3D,transformOrigin,svgOrigin",o=i.style,u,d,f,h,m,v,y,S;s.svg?(f=i.getAttribute("transform"),i.setAttribute("transform",""),o[nt]=t,u=Bl(i,1),sr(i,nt),i.setAttribute("transform",f)):(f=getComputedStyle(i)[nt],o[nt]=t,u=Bl(i,1),o[nt]=f);for(d in Bs)f=s[d],h=u[d],f!==h&&r.indexOf(d)<0&&(y=Ut(f),S=Ut(h),m=y!==S?Sn(i,d,f,S):parseFloat(f),v=parseFloat(h),e._pt=new ti(e._pt,u,d,m,v-m,Sh),e._pt.u=S||0,e._props.push(d));Qv(u,s)};ei("padding,margin,Width,Radius",function(l,e){var t="Top",i="Right",s="Bottom",r="Left",o=(e<3?[t,i,s,r]:[t+r,t+i,s+i,s+r]).map(function(u){return e<2?l+u:"border"+u+l});$u[e>1?"border"+l:l]=function(u,d,f,h,m){var v,y;if(arguments.length<4)return v=o.map(function(S){return Ps(u,S,f)}),y=v.join(" "),y.split(v[0]).length===5?v[0]:y;v=(h+"").split(" "),y={},o.forEach(function(S,E){return y[S]=v[E]=v[E]||v[(E-1)/2|0]}),u.init(d,y,m)}});var xT={name:"css",register:Eh,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,s,r){var o=this._props,u=e.style,d=i.vars.startAt,f,h,m,v,y,S,E,x,_,R,A,I,D,N,C,M;ag||Eh(),this.styles=this.styles||mT(e),M=this.styles.props,this.tween=i;for(E in t)if(E!=="autoRound"&&(h=t[E],!(fi[E]&&nT(E,t,i,s,e,r)))){if(y=typeof h,S=$u[E],y==="function"&&(h=h.call(i,s,e,r),y=typeof h),y==="string"&&~h.indexOf("random(")&&(h=Ml(h)),S)S(this,e,E,h,i)&&(C=1);else if(E.substr(0,2)==="--")f=(getComputedStyle(e).getPropertyValue(E)+"").trim(),h+="",vn.lastIndex=0,vn.test(f)||(x=Ut(f),_=Ut(h)),_?x!==_&&(f=Sn(e,E,f,_)+_):x&&(h+=x),this.add(u,"setProperty",f,h,s,r,0,0,E),o.push(E),M.push(E,0,u[E]);else if(y!=="undefined"){if(d&&E in d?(f=typeof d[E]=="function"?d[E].call(i,s,e,r):d[E],Rt(f)&&~f.indexOf("random(")&&(f=Ml(f)),Ut(f+"")||f==="auto"||(f+=vi.units[E]||Ut(Ps(e,E))||""),(f+"").charAt(1)==="="&&(f=Ps(e,E))):f=Ps(e,E),v=parseFloat(f),R=y==="string"&&h.charAt(1)==="="&&h.substr(0,2),R&&(h=h.substr(2)),m=parseFloat(h),E in ls&&(E==="autoAlpha"&&(v===1&&Ps(e,"visibility")==="hidden"&&m&&(v=0),M.push("visibility",0,u.visibility),gn(this,u,"visibility",v?"inherit":"hidden",m?"inherit":"hidden",!m)),E!=="scale"&&E!=="transform"&&(E=ls[E],~E.indexOf(",")&&(E=E.split(",")[0]))),A=E in Bs,A){if(this.styles.save(E),y==="string"&&h.substring(0,6)==="var(--"&&(h=Bi(e,h.substring(4,h.indexOf(")"))),m=parseFloat(h)),I||(D=e._gsap,D.renderTransform&&!t.parseTransform||Bl(e,t.parseTransform),N=t.smoothOrigin!==!1&&D.smooth,I=this._pt=new ti(this._pt,u,nt,0,1,D.renderTransform,D,0,-1),I.dep=1),E==="scale")this._pt=new ti(this._pt,D,"scaleY",D.scaleY,(R?sa(D.scaleY,R+m):m)-D.scaleY||0,Sh),this._pt.u=0,o.push("scaleY",E),E+="X";else if(E==="transformOrigin"){M.push(ii,0,u[ii]),h=Ub(h),D.svg?xh(e,h,0,N,0,this):(_=parseFloat(h.split(" ")[2])||0,_!==D.zOrigin&&gn(this,D,"zOrigin",D.zOrigin,_),gn(this,u,E,zu(f),zu(h)));continue}else if(E==="svgOrigin"){xh(e,h,1,N,0,this);continue}else if(E in ST){Hb(this,D,E,v,R?sa(v,R+h):h);continue}else if(E==="smoothOrigin"){gn(this,D,"smooth",D.smooth,h);continue}else if(E==="force3D"){D[E]=h;continue}else if(E==="transform"){Vb(this,h,e);continue}}else E in u||(E=ma(E)||E);if(A||(m||m===0)&&(v||v===0)&&!Ab.test(h)&&E in u)x=(f+"").substr((v+"").length),m||(m=0),_=Ut(h)||(E in vi.units?vi.units[E]:x),x!==_&&(v=Sn(e,E,f,_)),this._pt=new ti(this._pt,A?D:u,E,v,(R?sa(v,R+m):m)-v,!A&&(_==="px"||E==="zIndex")&&t.autoRound!==!1?Db:Sh),this._pt.u=_||0,x!==_&&_!=="%"&&(this._pt.b=f,this._pt.r=Rb);else if(E in u)Fb.call(this,e,E,f,R?R+h:h);else if(E in e)this.add(e,E,f||e[E],R?R+h:h,s,r);else if(E!=="parseTransform"){Qh(E,h);continue}A||(E in u?M.push(E,0,u[E]):typeof e[E]=="function"?M.push(E,2,e[E]()):M.push(E,1,f||e[E])),o.push(E)}}C&&cT(this)},render:function(e,t){if(t.tween._time||!lg())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:Ps,aliases:ls,getSetter:function(e,t,i){var s=ls[t];return s&&s.indexOf(",")<0&&(t=s),t in Bs&&t!==ii&&(e._gsap.x||Ps(e,"x"))?i&&zv===i?t==="scale"?Ob:Cb:(zv=i||{})&&(t==="scale"?Mb:Pb):e.style&&!jh(e.style[t])?Ib:~t.indexOf("-")?wb:ng(e,t)},core:{_removeProperty:sr,_getMatrix:ug}};si.utils.checkPrefix=ma;si.core.getStyleSaver=mT;(function(l,e,t,i){var s=ei(l+","+e+","+t,function(r){Bs[r]=1});ei(e,function(r){vi.units[r]="deg",ST[r]=1}),ls[s[13]]=l+","+e,ei(i,function(r){var o=r.split(":");ls[o[1]]=s[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");ei("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(l){vi.units[l]="px"});si.registerPlugin(xT);var Pi=si.registerPlugin(xT)||si;Pi.core.Tween;const de=Number.isFinite||function(l){return typeof l=="number"&&isFinite(l)},Kb=Number.isSafeInteger||function(l){return typeof l=="number"&&Math.abs(l)<=Yb},Yb=Number.MAX_SAFE_INTEGER||9007199254740991;let pe=function(l){return l.NETWORK_ERROR="networkError",l.MEDIA_ERROR="mediaError",l.KEY_SYSTEM_ERROR="keySystemError",l.MUX_ERROR="muxError",l.OTHER_ERROR="otherError",l}({}),X=function(l){return l.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",l.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",l.KEY_SYSTEM_NO_SESSION="keySystemNoSession",l.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",l.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",l.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",l.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",l.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",l.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",l.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",l.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",l.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",l.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",l.MANIFEST_LOAD_ERROR="manifestLoadError",l.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",l.MANIFEST_PARSING_ERROR="manifestParsingError",l.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",l.LEVEL_EMPTY_ERROR="levelEmptyError",l.LEVEL_LOAD_ERROR="levelLoadError",l.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",l.LEVEL_PARSING_ERROR="levelParsingError",l.LEVEL_SWITCH_ERROR="levelSwitchError",l.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",l.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",l.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",l.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",l.FRAG_LOAD_ERROR="fragLoadError",l.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",l.FRAG_DECRYPT_ERROR="fragDecryptError",l.FRAG_PARSING_ERROR="fragParsingError",l.FRAG_GAP="fragGap",l.REMUX_ALLOC_ERROR="remuxAllocError",l.KEY_LOAD_ERROR="keyLoadError",l.KEY_LOAD_TIMEOUT="keyLoadTimeOut",l.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",l.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",l.BUFFER_APPEND_ERROR="bufferAppendError",l.BUFFER_APPENDING_ERROR="bufferAppendingError",l.BUFFER_STALLED_ERROR="bufferStalledError",l.BUFFER_FULL_ERROR="bufferFullError",l.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",l.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",l.ASSET_LIST_LOAD_ERROR="assetListLoadError",l.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",l.ASSET_LIST_PARSING_ERROR="assetListParsingError",l.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",l.INTERNAL_EXCEPTION="internalException",l.INTERNAL_ABORTED="aborted",l.ATTACH_MEDIA_ERROR="attachMediaError",l.UNKNOWN="unknown",l}({}),b=function(l){return l.MEDIA_ATTACHING="hlsMediaAttaching",l.MEDIA_ATTACHED="hlsMediaAttached",l.MEDIA_DETACHING="hlsMediaDetaching",l.MEDIA_DETACHED="hlsMediaDetached",l.MEDIA_ENDED="hlsMediaEnded",l.STALL_RESOLVED="hlsStallResolved",l.BUFFER_RESET="hlsBufferReset",l.BUFFER_CODECS="hlsBufferCodecs",l.BUFFER_CREATED="hlsBufferCreated",l.BUFFER_APPENDING="hlsBufferAppending",l.BUFFER_APPENDED="hlsBufferAppended",l.BUFFER_EOS="hlsBufferEos",l.BUFFERED_TO_END="hlsBufferedToEnd",l.BUFFER_FLUSHING="hlsBufferFlushing",l.BUFFER_FLUSHED="hlsBufferFlushed",l.MANIFEST_LOADING="hlsManifestLoading",l.MANIFEST_LOADED="hlsManifestLoaded",l.MANIFEST_PARSED="hlsManifestParsed",l.LEVEL_SWITCHING="hlsLevelSwitching",l.LEVEL_SWITCHED="hlsLevelSwitched",l.LEVEL_LOADING="hlsLevelLoading",l.LEVEL_LOADED="hlsLevelLoaded",l.LEVEL_UPDATED="hlsLevelUpdated",l.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",l.LEVELS_UPDATED="hlsLevelsUpdated",l.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",l.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",l.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",l.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",l.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",l.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",l.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",l.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",l.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",l.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",l.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",l.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",l.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",l.CUES_PARSED="hlsCuesParsed",l.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",l.INIT_PTS_FOUND="hlsInitPtsFound",l.FRAG_LOADING="hlsFragLoading",l.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",l.FRAG_LOADED="hlsFragLoaded",l.FRAG_DECRYPTED="hlsFragDecrypted",l.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",l.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",l.FRAG_PARSING_METADATA="hlsFragParsingMetadata",l.FRAG_PARSED="hlsFragParsed",l.FRAG_BUFFERED="hlsFragBuffered",l.FRAG_CHANGED="hlsFragChanged",l.FPS_DROP="hlsFpsDrop",l.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",l.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",l.ERROR="hlsError",l.DESTROYING="hlsDestroying",l.KEY_LOADING="hlsKeyLoading",l.KEY_LOADED="hlsKeyLoaded",l.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",l.BACK_BUFFER_REACHED="hlsBackBufferReached",l.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",l.ASSET_LIST_LOADING="hlsAssetListLoading",l.ASSET_LIST_LOADED="hlsAssetListLoaded",l.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",l.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",l.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",l.INTERSTITIAL_STARTED="hlsInterstitialStarted",l.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",l.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",l.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",l.INTERSTITIAL_ENDED="hlsInterstitialEnded",l.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",l.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",l.EVENT_CUE_ENTER="hlsEventCueEnter",l}({});var Ie={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ge={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Xr{constructor(e,t=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}sample(e,t){const i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class jb{constructor(e,t,i,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Xr(e),this.fast_=new Xr(t),this.defaultTTFB_=s,this.ttfb_=new Xr(e)}update(e,t){const{slow_:i,fast_:s,ttfb_:r}=this;i.halfLife!==e&&(this.slow_=new Xr(e,i.getEstimate(),i.getTotalWeight())),s.halfLife!==t&&(this.fast_=new Xr(t,s.getEstimate(),s.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new Xr(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const i=8*t,s=e/1e3,r=i/s;this.fast_.sample(s,r),this.slow_.sample(s,r)}sampleTTFB(e){const t=e/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(i,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function qb(l,e,t){return(e=Qb(e))in l?Object.defineProperty(l,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):l[e]=t,l}function Ge(){return Ge=Object.assign?Object.assign.bind():function(l){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(l[i]=t[i])}return l},Ge.apply(null,arguments)}function Wv(l,e){var t=Object.keys(l);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(l);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(l,s).enumerable})),t.push.apply(t,i)}return t}function Ke(l){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wv(Object(t),!0).forEach(function(i){qb(l,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(t)):Wv(Object(t)).forEach(function(i){Object.defineProperty(l,i,Object.getOwnPropertyDescriptor(t,i))})}return l}function Xb(l,e){if(typeof l!="object"||!l)return l;var t=l[Symbol.toPrimitive];if(t!==void 0){var i=t.call(l,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(l)}function Qb(l){var e=Xb(l,"string");return typeof e=="symbol"?e:e+""}class qi{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const i=`[${e}]:`;this.trace=cn,this.debug=t.debug.bind(null,i),this.log=t.log.bind(null,i),this.warn=t.warn.bind(null,i),this.info=t.info.bind(null,i),this.error=t.error.bind(null,i)}}const cn=function(){},Wb={trace:cn,debug:cn,log:cn,warn:cn,info:cn,error:cn};function _h(){return Ge({},Wb)}function Zb(l,e){const t=self.console[l];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${l}] >`):cn}function Zv(l,e,t){return e[l]?e[l].bind(e):Zb(l,t)}const bh=_h();function Jb(l,e,t){const i=_h();if(typeof console=="object"&&l===!0||typeof l=="object"){const s=["debug","log","info","warn","error"];s.forEach(r=>{i[r]=Zv(r,l,t)});try{i.log(`Debug logs enabled for "${e}" in hls.js version 1.6.7`)}catch{return _h()}s.forEach(r=>{bh[r]=Zv(r,l)})}else Ge(bh,i);return i}const Ne=bh;function Tn(l=!0){return typeof self>"u"?void 0:(l||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function eA(l){return typeof self<"u"&&l===self.ManagedMediaSource}function _T(l,e){const t=Object.keys(l),i=Object.keys(e),s=t.length,r=i.length;return!s||!r||s===r&&!t.some(o=>i.indexOf(o)===-1)}function yi(l,e=!1){if(typeof TextDecoder<"u"){const f=new TextDecoder("utf-8").decode(l);if(e){const h=f.indexOf("\0");return h!==-1?f.substring(0,h):f}return f.replace(/\0/g,"")}const t=l.length;let i,s,r,o="",u=0;for(;u<t;){if(i=l[u++],i===0&&e)return o;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(i);break;case 12:case 13:s=l[u++],o+=String.fromCharCode((i&31)<<6|s&63);break;case 14:s=l[u++],r=l[u++],o+=String.fromCharCode((i&15)<<12|(s&63)<<6|(r&63)<<0);break}}return o}const Xn={hexDump:function(l){let e="";for(let t=0;t<l.length;t++){let i=l[t].toString(16);i.length<2&&(i="0"+i),e+=i}return e}};function bT(l){return Uint8Array.from(l.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function tA(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var Md={exports:{}},Jv;function iA(){return Jv||(Jv=1,function(l,e){(function(t){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,r=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,u={buildAbsoluteURL:function(d,f,h){if(h=h||{},d=d.trim(),f=f.trim(),!f){if(!h.alwaysNormalize)return d;var m=u.parseURL(d);if(!m)throw new Error("Error trying to parse base URL.");return m.path=u.normalizePath(m.path),u.buildURLFromParts(m)}var v=u.parseURL(f);if(!v)throw new Error("Error trying to parse relative URL.");if(v.scheme)return h.alwaysNormalize?(v.path=u.normalizePath(v.path),u.buildURLFromParts(v)):f;var y=u.parseURL(d);if(!y)throw new Error("Error trying to parse base URL.");if(!y.netLoc&&y.path&&y.path[0]!=="/"){var S=s.exec(y.path);y.netLoc=S[1],y.path=S[2]}y.netLoc&&!y.path&&(y.path="/");var E={scheme:y.scheme,netLoc:v.netLoc,path:null,params:v.params,query:v.query,fragment:v.fragment};if(!v.netLoc&&(E.netLoc=y.netLoc,v.path[0]!=="/"))if(!v.path)E.path=y.path,v.params||(E.params=y.params,v.query||(E.query=y.query));else{var x=y.path,_=x.substring(0,x.lastIndexOf("/")+1)+v.path;E.path=u.normalizePath(_)}return E.path===null&&(E.path=h.alwaysNormalize?u.normalizePath(v.path):v.path),u.buildURLFromParts(E)},parseURL:function(d){var f=i.exec(d);return f?{scheme:f[1]||"",netLoc:f[2]||"",path:f[3]||"",params:f[4]||"",query:f[5]||"",fragment:f[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(r,"");d.length!==(d=d.replace(o,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};l.exports=u})()}(Md)),Md.exports}var cg=iA();class fg{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Qe={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class AT{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,nA(this,"stats")}setByteRange(e,t){const i=e.split("@",2);let s;i.length===1?s=t?.byteRangeEndOffset||0:s=parseInt(i[1]),this._byteRange=[s,parseInt(i[0])+s]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[Qe.AUDIO]:null,[Qe.VIDEO]:null,[Qe.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new fg),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=cg.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Qe.AUDIO]=null,e[Qe.VIDEO]=null,e[Qe.AUDIOVIDEO]=null}}function pt(l){return l.sn!=="initSegment"}class Pd extends AT{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(de(e)&&de(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const i=Object.keys(this.levelkeys);if(i.length===1)return this._decryptdata=this.levelkeys[i[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=de(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),i=t.length;if(i>1||i===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!de(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return pt(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,i,s,r,o=!1){const{elementaryStreams:u}=this,d=u[e];if(!d){u[e]={startPTS:t,endPTS:i,startDTS:s,endDTS:r,partial:o};return}d.startPTS=Math.min(d.startPTS,t),d.endPTS=Math.max(d.endPTS,i),d.startDTS=Math.min(d.startDTS,s),d.endDTS=Math.max(d.endDTS,r)}}class sA extends AT{constructor(e,t,i,s,r){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=s;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function LT(l,e){const t=Object.getPrototypeOf(l);if(t){const i=Object.getOwnPropertyDescriptor(t,e);return i||LT(t,e)}}function nA(l,e){const t=LT(l,e);t&&(t.enumerable=!0,Object.defineProperty(l,e,t))}const ey=Math.pow(2,32)-1,rA=[].push,RT={video:1,audio:2,id3:3,text:4};function Lt(l){return String.fromCharCode.apply(null,l)}function DT(l,e){const t=l[e]<<8|l[e+1];return t<0?65536+t:t}function xe(l,e){const t=IT(l,e);return t<0?4294967296+t:t}function ty(l,e){let t=xe(l,e);return t*=Math.pow(2,32),t+=xe(l,e+4),t}function IT(l,e){return l[e]<<24|l[e+1]<<16|l[e+2]<<8|l[e+3]}function aA(l){const e=l.byteLength;for(let t=0;t<e;){const i=xe(l,t);if(i>8&&l[t+4]===109&&l[t+5]===111&&l[t+6]===111&&l[t+7]===102)return!0;t=i>1?t+i:e}return!1}function Re(l,e){const t=[];if(!e.length)return t;const i=l.byteLength;for(let s=0;s<i;){const r=xe(l,s),o=Lt(l.subarray(s+4,s+8)),u=r>1?s+r:i;if(o===e[0])if(e.length===1)t.push(l.subarray(s+8,u));else{const d=Re(l.subarray(s+8,u),e.slice(1));d.length&&rA.apply(t,d)}s=u}return t}function lA(l){const e=[],t=l[0];let i=8;const s=xe(l,i);i+=4;let r=0,o=0;t===0?(r=xe(l,i),o=xe(l,i+4),i+=8):(r=ty(l,i),o=ty(l,i+8),i+=16),i+=2;let u=l.length+o;const d=DT(l,i);i+=2;for(let f=0;f<d;f++){let h=i;const m=xe(l,h);h+=4;const v=m&2147483647;if((m&2147483648)>>>31===1)return Ne.warn("SIDX has hierarchical references (not supported)"),null;const S=xe(l,h);h+=4,e.push({referenceSize:v,subsegmentDuration:S,info:{duration:S/s,start:u,end:u+v-1}}),u+=v,h+=4,i=h}return{earliestPresentationTime:r,timescale:s,version:t,referencesCount:d,references:e}}function wT(l){const e=[],t=Re(l,["moov","trak"]);for(let s=0;s<t.length;s++){const r=t[s],o=Re(r,["tkhd"])[0];if(o){let u=o[0];const d=xe(o,u===0?12:20),f=Re(r,["mdia","mdhd"])[0];if(f){u=f[0];const h=xe(f,u===0?12:20),m=Re(r,["mdia","hdlr"])[0];if(m){const v=Lt(m.subarray(8,12)),y={soun:Qe.AUDIO,vide:Qe.VIDEO}[v],S=Re(r,["mdia","minf","stbl","stsd"])[0],E=oA(S);y?(e[d]={timescale:h,type:y,stsd:E},e[y]=Ke({timescale:h,id:d},E)):e[d]={timescale:h,type:v,stsd:E}}}}}return Re(l,["moov","mvex","trex"]).forEach(s=>{const r=xe(s,4),o=e[r];o&&(o.default={duration:xe(s,12),flags:xe(s,20)})}),e}function oA(l){const e=l.subarray(8),t=e.subarray(86),i=Lt(e.subarray(4,8));let s=i,r;const o=i==="enca"||i==="encv";if(o){const f=Re(e,[i])[0].subarray(i==="enca"?28:78);Re(f,["sinf"]).forEach(m=>{const v=Re(m,["schm"])[0];if(v){const y=Lt(v.subarray(4,8));if(y==="cbcs"||y==="cenc"){const S=Re(m,["frma"])[0];S&&(s=Lt(S))}}})}const u=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const d=Re(t,["avcC"])[0];d&&d.length>3&&(s+="."+cu(d[1])+cu(d[2])+cu(d[3]),r=uu(u==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const d=Re(e,[i])[0],f=Re(d.subarray(28),["esds"])[0];if(f&&f.length>7){let h=4;if(f[h++]!==3)break;h=kd(f,h),h+=2;const m=f[h++];if(m&128&&(h+=2),m&64&&(h+=f[h++]),f[h++]!==4)break;h=kd(f,h);const v=f[h++];if(v===64)s+="."+cu(v);else break;if(h+=12,f[h++]!==5)break;h=kd(f,h);const y=f[h++];let S=(y&248)>>3;S===31&&(S+=1+((y&7)<<3)+((f[h]&224)>>5)),s+="."+S}break}case"hvc1":case"hev1":{const d=Re(t,["hvcC"])[0];if(d&&d.length>12){const f=d[1],h=["","A","B","C"][f>>6],m=f&31,v=xe(d,2),y=(f&32)>>5?"H":"L",S=d[12],E=d.subarray(6,12);s+="."+h+m,s+="."+uA(v).toString(16).toUpperCase(),s+="."+y+S;let x="";for(let _=E.length;_--;){const R=E[_];(R||x)&&(x="."+R.toString(16).toUpperCase()+x)}s+=x}r=uu(u=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{s=uu(s,t)||s;break}case"vp09":{const d=Re(t,["vpcC"])[0];if(d&&d.length>6){const f=d[4],h=d[5],m=d[6]>>4&15;s+="."+ss(f)+"."+ss(h)+"."+ss(m)}break}case"av01":{const d=Re(t,["av1C"])[0];if(d&&d.length>2){const f=d[1]>>>5,h=d[1]&31,m=d[2]>>>7?"H":"M",v=(d[2]&64)>>6,y=(d[2]&32)>>5,S=f===2&&v?y?12:10:v?10:8,E=(d[2]&16)>>4,x=(d[2]&8)>>3,_=(d[2]&4)>>2,R=d[2]&3;s+="."+f+"."+ss(h)+m+"."+ss(S)+"."+E+"."+x+_+R+"."+ss(1)+"."+ss(1)+"."+ss(1)+"."+0,r=uu("dav1",t)}break}}return{codec:s,encrypted:o,supplemental:r}}function uu(l,e){const t=Re(e,["dvvC"]),i=t.length?t[0]:Re(e,["dvcC"])[0];if(i){const s=i[2]>>1&127,r=i[2]<<5&32|i[3]>>3&31;return l+"."+ss(s)+"."+ss(r)}}function uA(l){let e=0;for(let t=0;t<32;t++)e|=(l>>t&1)<<31-t;return e>>>0}function kd(l,e){const t=e+5;for(;l[e++]&128&&e<t;);return e}function cu(l){return("0"+l.toString(16).toUpperCase()).slice(-2)}function ss(l){return(l<10?"0":"")+l}function cA(l,e){if(!l||!e)return l;const t=e.keyId;return t&&e.isCommonEncryption&&Re(l,["moov","trak"]).forEach(s=>{const o=Re(s,["mdia","minf","stbl","stsd"])[0].subarray(8);let u=Re(o,["enca"]);const d=u.length>0;d||(u=Re(o,["encv"])),u.forEach(f=>{const h=d?f.subarray(28):f.subarray(78);Re(h,["sinf"]).forEach(v=>{const y=fA(v);if(y){const S=y.subarray(8,24);S.some(E=>E!==0)||(Ne.log(`[eme] Patching keyId in 'enc${d?"a":"v"}>sinf>>tenc' box: ${Xn.hexDump(S)} -> ${Xn.hexDump(t)}`),y.set(t,8))}})})}),l}function fA(l){const e=Re(l,["schm"])[0];if(e){const t=Lt(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Re(l,["schi","tenc"])[0]}return null}function dA(l,e,t){const i={},s=Re(l,["moof","traf"]);for(let r=0;r<s.length;r++){const o=s[r],u=Re(o,["tfhd"])[0],d=xe(u,4),f=e[d];if(!f)continue;const h=i[d]||(i[d]={start:NaN,duration:0,sampleCount:0,timescale:f.timescale,type:f.type}),m=Re(o,["tfdt"])[0];if(m){const A=m[0];let I=xe(m,4);A===1&&(I===ey?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(I*=ey+1,I+=xe(m,8))),de(I)&&(!de(h.start)||I<h.start)&&(h.start=I)}const v=f.default,y=xe(u,0)|v?.flags;let S=v?.duration||0;y&8&&(y&2?S=xe(u,12):S=xe(u,8));const E=Re(o,["trun"]);let x=h.start||0,_=0,R=S;for(let A=0;A<E.length;A++){const I=E[A],D=xe(I,4),N=h.sampleCount;h.sampleCount+=D;const C=I[3]&1,M=I[3]&4,O=I[2]&1,P=I[2]&2,U=I[2]&4,H=I[2]&8;let se=8,ue=D;for(C&&(se+=4),M&&D&&(!(I[se+1]&1)&&h.keyFrameIndex===void 0&&(h.keyFrameIndex=N),se+=4,O?(R=xe(I,se),se+=4):R=S,P&&(se+=4),H&&(se+=4),x+=R,_+=R,ue--);ue--;)O?(R=xe(I,se),se+=4):R=S,P&&(se+=4),U&&(I[se+1]&1||h.keyFrameIndex===void 0&&(h.keyFrameIndex=h.sampleCount-(ue+1),h.keyFrameStart=x),se+=4),H&&(se+=4),x+=R,_+=R;!_&&S&&(_+=S*D)}h.duration+=_}if(!Object.keys(i).some(r=>i[r].duration)){let r=1/0,o=0;const u=Re(l,["sidx"]);for(let d=0;d<u.length;d++){const f=lA(u[d]);if(f!=null&&f.references){r=Math.min(r,f.earliestPresentationTime/f.timescale);const h=f.references.reduce((m,v)=>m+v.info.duration||0,0);o=Math.max(o,h+f.earliestPresentationTime/f.timescale)}}o&&de(o)&&Object.keys(i).forEach(d=>{i[d].duration||(i[d].duration=o*i[d].timescale-i[d].start)})}return i}function hA(l){const e={valid:null,remainder:null},t=Re(l,["moof"]);if(t.length<2)return e.remainder=l,e;const i=t[t.length-1];return e.valid=l.slice(0,i.byteOffset-8),e.remainder=l.slice(i.byteOffset-8),e}function Ui(l,e){const t=new Uint8Array(l.length+e.length);return t.set(l),t.set(e,l.length),t}function iy(l,e){const t=[],i=e.samples,s=e.timescale,r=e.id;let o=!1;return Re(i,["moof"]).map(d=>{const f=d.byteOffset-8;Re(d,["traf"]).map(m=>{const v=Re(m,["tfdt"]).map(y=>{const S=y[0];let E=xe(y,4);return S===1&&(E*=Math.pow(2,32),E+=xe(y,8)),E/s})[0];return v!==void 0&&(l=v),Re(m,["tfhd"]).map(y=>{const S=xe(y,4),E=xe(y,0)&16777215,x=(E&1)!==0,_=(E&2)!==0,R=(E&8)!==0;let A=0;const I=(E&16)!==0;let D=0;const N=(E&32)!==0;let C=8;S===r&&(x&&(C+=8),_&&(C+=4),R&&(A=xe(y,C),C+=4),I&&(D=xe(y,C),C+=4),N&&(C+=4),e.type==="video"&&(o=nc(e.codec)),Re(m,["trun"]).map(M=>{const O=M[0],P=xe(M,0)&16777215,U=(P&1)!==0;let H=0;const se=(P&4)!==0,ue=(P&256)!==0;let te=0;const B=(P&512)!==0;let K=0;const j=(P&1024)!==0,oe=(P&2048)!==0;let k=0;const $=xe(M,4);let q=8;U&&(H=xe(M,q),q+=4),se&&(q+=4);let ne=H+f;for(let fe=0;fe<$;fe++){if(ue?(te=xe(M,q),q+=4):te=A,B?(K=xe(M,q),q+=4):K=D,j&&(q+=4),oe&&(O===0?k=xe(M,q):k=IT(M,q),q+=4),e.type===Qe.VIDEO){let re=0;for(;re<K;){const ce=xe(i,ne);if(ne+=4,gA(o,i[ne])){const ve=i.subarray(ne,ne+ce);dg(ve,o?2:1,l+k/s,t)}ne+=ce,re+=ce+4}}l+=te/s}}))})})}),t}function nc(l){if(!l)return!1;const e=l.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function gA(l,e){if(l){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function dg(l,e,t,i){const s=CT(l);let r=0;r+=e;let o=0,u=0,d=0;for(;r<s.length;){o=0;do{if(r>=s.length)break;d=s[r++],o+=d}while(d===255);u=0;do{if(r>=s.length)break;d=s[r++],u+=d}while(d===255);const f=s.length-r;let h=r;if(u<f)r+=u;else if(u>f){Ne.error(`Malformed SEI payload. ${u} is too small, only ${f} bytes left to parse.`);break}if(o===4){if(s[h++]===181){const v=DT(s,h);if(h+=2,v===49){const y=xe(s,h);if(h+=4,y===1195456820){const S=s[h++];if(S===3){const E=s[h++],x=31&E,_=64&E,R=_?2+x*3:0,A=new Uint8Array(R);if(_){A[0]=E;for(let I=1;I<R;I++)A[I]=s[h++]}i.push({type:S,payloadType:o,pts:t,bytes:A})}}}}}else if(o===5&&u>16){const m=[];for(let S=0;S<16;S++){const E=s[h++].toString(16);m.push(E.length==1?"0"+E:E),(S===3||S===5||S===7||S===9)&&m.push("-")}const v=u-16,y=new Uint8Array(v);for(let S=0;S<v;S++)y[S]=s[h++];i.push({payloadType:o,pts:t,uuid:m.join(""),userData:yi(y),userDataBytes:y})}}}function CT(l){const e=l.byteLength,t=[];let i=1;for(;i<e-2;)l[i]===0&&l[i+1]===0&&l[i+2]===3?(t.push(i+2),i+=2):i++;if(t.length===0)return l;const s=e-t.length,r=new Uint8Array(s);let o=0;for(i=0;i<s;o++,i++)o===t[0]&&(o++,t.shift()),r[i]=l[o];return r}function mA(l){const e=l[0];let t="",i="",s=0,r=0,o=0,u=0,d=0,f=0;if(e===0){for(;Lt(l.subarray(f,f+1))!=="\0";)t+=Lt(l.subarray(f,f+1)),f+=1;for(t+=Lt(l.subarray(f,f+1)),f+=1;Lt(l.subarray(f,f+1))!=="\0";)i+=Lt(l.subarray(f,f+1)),f+=1;i+=Lt(l.subarray(f,f+1)),f+=1,s=xe(l,12),r=xe(l,16),u=xe(l,20),d=xe(l,24),f=28}else if(e===1){f+=4,s=xe(l,f),f+=4;const m=xe(l,f);f+=4;const v=xe(l,f);for(f+=4,o=2**32*m+v,Kb(o)||(o=Number.MAX_SAFE_INTEGER,Ne.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),u=xe(l,f),f+=4,d=xe(l,f),f+=4;Lt(l.subarray(f,f+1))!=="\0";)t+=Lt(l.subarray(f,f+1)),f+=1;for(t+=Lt(l.subarray(f,f+1)),f+=1;Lt(l.subarray(f,f+1))!=="\0";)i+=Lt(l.subarray(f,f+1)),f+=1;i+=Lt(l.subarray(f,f+1)),f+=1}const h=l.subarray(f,l.byteLength);return{schemeIdUri:t,value:i,timeScale:s,presentationTime:o,presentationTimeDelta:r,eventDuration:u,id:d,payload:h}}function pA(l,...e){const t=e.length;let i=8,s=t;for(;s--;)i+=e[s].byteLength;const r=new Uint8Array(i);for(r[0]=i>>24&255,r[1]=i>>16&255,r[2]=i>>8&255,r[3]=i&255,r.set(l,4),s=0,i=8;s<t;s++)r.set(e[s],i),i+=e[s].byteLength;return r}function vA(l,e,t){if(l.byteLength!==16)throw new RangeError("Invalid system id");let i,s;i=0,s=new Uint8Array;let r;i>0?(r=new Uint8Array(4),e.length>0&&new DataView(r.buffer).setUint32(0,e.length,!1)):r=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),pA([112,115,115,104],new Uint8Array([i,0,0,0]),l,r,s,o,t||new Uint8Array)}const OT=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),pa={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function hg(l,e){const t=pa[e];return!!t&&!!t[l.slice(0,4)]}function Ah(l,e,t=!0){return!l.split(",").some(i=>!gg(i,e,t))}function gg(l,e,t=!0){var i;const s=Tn(t);return(i=s?.isTypeSupported(Fl(l,e)))!=null?i:!1}function Fl(l,e){return`${e}/mp4;codecs=${l}`}function sy(l){if(l){const e=l.substring(0,4);return pa.video[e]}return 2}function Hu(l){const e=OT();return l.split(",").reduce((t,i)=>{const r=e&&nc(i)?9:pa.video[i];return r?(r*2+t)/(t?3:2):(pa.audio[i]+t)/(t?2:1)},0)}const Nd={};function yA(l,e=!0){if(Nd[l])return Nd[l];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[l];for(let s=0;s<t.length;s++){var i;if(gg(t[s],"audio",e))return Nd[l]=t[s],t[s];if(t[s]==="mp3"&&(i=Tn(e))!=null&&i.isTypeSupported("audio/mpeg"))return""}return l}const SA=/flac|opus|mp4a\.40\.34/i;function Vu(l,e=!0){return l.replace(SA,t=>yA(t.toLowerCase(),e))}function TA(l,e){const t=[];if(l){const i=l.split(",");for(let s=0;s<i.length;s++)hg(i[s],"video")||t.push(i[s])}return e&&t.push(e),t.join(",")}function Ru(l,e){if(l&&(l.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(l)!==-1)&&(ny(l,"audio")||ny(l,"video")))return l;if(e){const t=e.split(",");if(t.length>1){if(l){for(let i=t.length;i--;)if(t[i].substring(0,4)===l.substring(0,4))return t[i]}return t[0]}}return e||l}function ny(l,e){return hg(l,e)&&gg(l,e)}function EA(l){const e=l.split(",");for(let t=0;t<e.length;t++){const i=e[t].split(".");i.length>2&&i[0]==="avc1"&&(e[t]=`avc1.${parseInt(i[1]).toString(16)}${("000"+parseInt(i[2]).toString(16)).slice(-4)}`)}return e.join(",")}function xA(l){if(l.startsWith("av01.")){const e=l.split("."),t=["0","111","01","01","01","0"];for(let i=e.length;i>4&&i<10;i++)e[i]=t[i-4];return e.join(".")}return l}function ry(l){const e=Tn(l)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Lh(l){return l.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const MT={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function PT(l,e){return{supported:!1,configurations:e,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:l}}function _A(l,e,t,i,s,r){const o=l.videoCodec,u=l.audioCodec?l.audioGroups:null,d=r?.audioCodec,f=r?.channels,h=f?parseInt(f):d?1/0:2;let m=null;if(u!=null&&u.length)try{u.length===1&&u[0]?m=e.groups[u[0]].channels:m=u.reduce((v,y)=>{if(y){const S=e.groups[y];if(!S)throw new Error(`Audio track group ${y} not found`);Object.keys(S.channels).forEach(E=>{v[E]=(v[E]||0)+S.channels[E]})}return v},{2:0})}catch{return!0}return o!==void 0&&(o.split(",").some(v=>nc(v))||l.width>1920&&l.height>1088||l.height>1920&&l.width>1088||l.frameRate>Math.max(i,30)||l.videoRange!=="SDR"&&l.videoRange!==t||l.bitrate>Math.max(s,8e6))||!!m&&de(h)&&Object.keys(m).some(v=>parseInt(v)>h)}function kT(l,e,t,i={}){const s=l.videoCodec;if(!s&&!l.audioCodec||!t)return Promise.resolve(MT);const r=[],o=bA(l),u=o.length,d=AA(l,e,u>0),f=d.length;for(let h=u||1*f||1;h--;){const m={type:"media-source"};if(u&&(m.video=o[h%u]),f){m.audio=d[h%f];const v=m.audio.bitrate;m.video&&v&&(m.video.bitrate-=v)}r.push(m)}if(s){const h=navigator.userAgent;if(s.split(",").some(m=>nc(m))&&OT())return Promise.resolve(PT(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${h})`),r))}return Promise.all(r.map(h=>{const m=RA(h);return i[m]||(i[m]=t.decodingInfo(h))})).then(h=>({supported:!h.some(m=>!m.supported),configurations:r,decodingInfoResults:h})).catch(h=>({supported:!1,configurations:r,decodingInfoResults:[],error:h}))}function bA(l){var e;const t=(e=l.videoCodec)==null?void 0:e.split(","),i=NT(l),s=l.width||640,r=l.height||480,o=l.frameRate||30,u=l.videoRange.toLowerCase();return t?t.map(d=>{const f={contentType:Fl(xA(d),"video"),width:s,height:r,bitrate:i,framerate:o};return u!=="sdr"&&(f.transferFunction=u),f}):[]}function AA(l,e,t){var i;const s=(i=l.audioCodec)==null?void 0:i.split(","),r=NT(l);return s&&l.audioGroups?l.audioGroups.reduce((o,u)=>{var d;const f=u?(d=e.groups[u])==null?void 0:d.tracks:null;return f?f.reduce((h,m)=>{if(m.groupId===u){const v=parseFloat(m.channels||"");s.forEach(y=>{const S={contentType:Fl(y,"audio"),bitrate:t?LA(y,r):r};v&&(S.channels=""+v),h.push(S)})}return h},o):o},[]):[]}function LA(l,e){if(e<=1)return 1;let t=128e3;return l==="ec-3"?t=768e3:l==="ac-3"&&(t=64e4),Math.min(e/2,t)}function NT(l){return Math.ceil(Math.max(l.bitrate*.9,l.averageBitrate)/1e3)*1e3||1}function RA(l){let e="";const{audio:t,video:i}=l;if(i){const s=Lh(i.contentType);e+=`${s}_r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${Math.ceil(i.bitrate/1e5)}`}if(t){const s=Lh(t.contentType);e+=`${i?"_":""}${s}_c${t.channels}`}return e}const Rh=["NONE","TYPE-0","TYPE-1",null];function DA(l){return Rh.indexOf(l)>-1}const Ku=["SDR","PQ","HLG"];function IA(l){return!!l&&Ku.indexOf(l)>-1}var Du={No:"",Yes:"YES",v2:"v2"};function ay(l){const{canSkipUntil:e,canSkipDateRanges:t,age:i}=l,s=i<e/2;return e&&s?t?Du.v2:Du.Yes:Du.No}class ly{constructor(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Ul{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(i=>!!i).map(i=>i.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const i=(t=e.supplemental)==null?void 0:t.videoCodec;i&&i!==e.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return oy(this._audioGroups,e)}hasSubtitleGroup(e){return oy(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(t)===-1&&i.push(t)}else if(e==="text"){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),i.indexOf(t)===-1&&i.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function oy(l,e){return!e||!l?!1:l.indexOf(e)!==-1}function wA(){if(typeof matchMedia=="function"){const l=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(l.media!==e.media)return l.matches===!0}return!1}function CA(l,e){let t=!1,i=[];if(l&&(t=l!=="SDR",i=[l]),e){i=e.allowedVideoRanges||Ku.slice(0);const s=i.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:s&&wA(),t||(i=["SDR"])}return{preferHDR:t,allowedVideoRanges:i}}const OA=l=>{const e=new WeakSet;return(t,i)=>{if(l&&(i=l(t,i)),typeof i=="object"&&i!==null){if(e.has(i))return;e.add(i)}return i}},Ze=(l,e)=>JSON.stringify(l,OA(e));function MA(l,e,t,i,s){const r=Object.keys(l),o=i?.channels,u=i?.audioCodec,d=s?.videoCodec,f=o&&parseInt(o)===2;let h=!1,m=!1,v=1/0,y=1/0,S=1/0,E=1/0,x=0,_=[];const{preferHDR:R,allowedVideoRanges:A}=CA(e,s);for(let M=r.length;M--;){const O=l[r[M]];h||(h=O.channels[2]>0),v=Math.min(v,O.minHeight),y=Math.min(y,O.minFramerate),S=Math.min(S,O.minBitrate),A.filter(U=>O.videoRanges[U]>0).length>0&&(m=!0)}v=de(v)?v:0,y=de(y)?y:0;const I=Math.max(1080,v),D=Math.max(30,y);S=de(S)?S:t,t=Math.max(S,t),m||(e=void 0);const N=r.length>1;return{codecSet:r.reduce((M,O)=>{const P=l[O];if(O===M)return M;if(_=m?A.filter(U=>P.videoRanges[U]>0):[],N){if(P.minBitrate>t)return is(O,`min bitrate of ${P.minBitrate} > current estimate of ${t}`),M;if(!P.hasDefaultAudio)return is(O,"no renditions with default or auto-select sound found"),M;if(u&&O.indexOf(u.substring(0,4))%5!==0)return is(O,`audio codec preference "${u}" not found`),M;if(o&&!f){if(!P.channels[o])return is(O,`no renditions with ${o} channel sound found (channels options: ${Object.keys(P.channels)})`),M}else if((!u||f)&&h&&P.channels[2]===0)return is(O,"no renditions with stereo sound found"),M;if(P.minHeight>I)return is(O,`min resolution of ${P.minHeight} > maximum of ${I}`),M;if(P.minFramerate>D)return is(O,`min framerate of ${P.minFramerate} > maximum of ${D}`),M;if(!_.some(U=>P.videoRanges[U]>0))return is(O,`no variants with VIDEO-RANGE of ${Ze(_)} found`),M;if(d&&O.indexOf(d.substring(0,4))%5!==0)return is(O,`video codec preference "${d}" not found`),M;if(P.maxScore<x)return is(O,`max score of ${P.maxScore} < selected max of ${x}`),M}return M&&(Hu(O)>=Hu(M)||P.fragmentError>l[M].fragmentError)?M:(E=P.minIndex,x=P.maxScore,O)},void 0),videoRanges:_,preferHDR:R,minFramerate:y,minBitrate:S,minIndex:E}}function is(l,e){Ne.log(`[abr] start candidates with "${l}" ignored because ${e}`)}function BT(l){return l.reduce((e,t)=>{let i=e.groups[t.groupId];i||(i=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(t);const s=t.channels||"2";return i.channels[s]=(i.channels[s]||0)+1,i.hasDefault=i.hasDefault||t.default,i.hasAutoSelect=i.hasAutoSelect||t.autoselect,i.hasDefault&&(e.hasDefaultAudio=!0),i.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function PA(l,e,t,i){return l.slice(t,i+1).reduce((s,r,o)=>{if(!r.codecSet)return s;const u=r.audioGroups;let d=s[r.codecSet];d||(s[r.codecSet]=d={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:o,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!u,fragmentError:0}),d.minBitrate=Math.min(d.minBitrate,r.bitrate);const f=Math.min(r.height,r.width);return d.minHeight=Math.min(d.minHeight,f),d.minFramerate=Math.min(d.minFramerate,r.frameRate),d.minIndex=Math.min(d.minIndex,o),d.maxScore=Math.max(d.maxScore,r.score),d.fragmentError+=r.fragmentError,d.videoRanges[r.videoRange]=(d.videoRanges[r.videoRange]||0)+1,u&&u.forEach(h=>{if(!h)return;const m=e.groups[h];m&&(d.hasDefaultAudio=d.hasDefaultAudio||e.hasDefaultAudio?m.hasDefault:m.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(m.channels).forEach(v=>{d.channels[v]=(d.channels[v]||0)+m.channels[v]}))}),s},{})}function uy(l){if(!l)return l;const{lang:e,assocLang:t,characteristics:i,channels:s,audioCodec:r}=l;return{lang:e,assocLang:t,characteristics:i,channels:s,audioCodec:r}}function os(l,e,t){if("attrs"in l){const i=e.indexOf(l);if(i!==-1)return i}for(let i=0;i<e.length;i++){const s=e[i];if(tr(l,s,t))return i}return-1}function tr(l,e,t){const{groupId:i,name:s,lang:r,assocLang:o,default:u}=l,d=l.forced;return(i===void 0||e.groupId===i)&&(s===void 0||e.name===s)&&(r===void 0||kA(r,e.lang))&&(r===void 0||e.assocLang===o)&&(u===void 0||e.default===u)&&(d===void 0||e.forced===d)&&(!("characteristics"in l)||NA(l.characteristics||"",e.characteristics))&&(t===void 0||t(l,e))}function kA(l,e="--"){return l.length===e.length?l===e:l.startsWith(e)||e.startsWith(l)}function NA(l,e=""){const t=l.split(","),i=e.split(",");return t.length===i.length&&!t.some(s=>i.indexOf(s)===-1)}function qn(l,e){const{audioCodec:t,channels:i}=l;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(i===void 0||i===(e.channels||"2"))}function BA(l,e,t,i,s){const r=e[i],u=e.reduce((v,y,S)=>{const E=y.uri;return(v[E]||(v[E]=[])).push(S),v},{})[r.uri];u.length>1&&(i=Math.max.apply(Math,u));const d=r.videoRange,f=r.frameRate,h=r.codecSet.substring(0,4),m=cy(e,i,v=>{if(v.videoRange!==d||v.frameRate!==f||v.codecSet.substring(0,4)!==h)return!1;const y=v.audioGroups,S=t.filter(E=>!y||y.indexOf(E.groupId)!==-1);return os(l,S,s)>-1});return m>-1?m:cy(e,i,v=>{const y=v.audioGroups,S=t.filter(E=>!y||y.indexOf(E.groupId)!==-1);return os(l,S,s)>-1})}function cy(l,e,t){for(let i=e;i>-1;i--)if(t(l[i]))return i;for(let i=e+1;i<l.length;i++)if(t(l[i]))return i;return-1}function Yu(l,e){var t;return!!l&&l!==((t=e.loadLevelObj)==null?void 0:t.uri)}class FA extends qi{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var i;const{fragCurrent:s,partCurrent:r,hls:o}=this,{autoLevelEnabled:u,media:d}=o;if(!s||!d)return;const f=performance.now(),h=r?r.stats:s.stats,m=r?r.duration:s.duration,v=f-h.loading.start,y=o.minAutoLevel,S=s.level,E=this._nextAutoLevel;if(h.aborted||h.loaded&&h.loaded===h.total||S<=y){this.clearTimer(),this._nextAutoLevel=-1;return}if(!u)return;const x=E>-1&&E!==S,_=!!t||x;if(!_&&(d.paused||!d.playbackRate||!d.readyState))return;const R=o.mainForwardBufferInfo;if(!_&&R===null)return;const A=this.bwEstimator.getEstimateTTFB(),I=Math.abs(d.playbackRate);if(v<=Math.max(A,1e3*(m/(I*2))))return;const D=R?R.len/I:0,N=h.loading.first?h.loading.first-h.loading.start:-1,C=h.loaded&&N>-1,M=this.getBwEstimate(),O=o.levels,P=O[S],U=Math.max(h.loaded,Math.round(m*(s.bitrate||P.averageBitrate)/8));let H=C?v-N:v;H<1&&C&&(H=Math.min(v,h.loaded*8/M));const se=C?h.loaded*1e3/H:0,ue=A/1e3,te=se?(U-h.loaded)/se:U*8/M+ue;if(te<=D)return;const B=se?se*8:M,K=((i=t?.details||this.hls.latestLevelDetails)==null?void 0:i.live)===!0,j=this.hls.config.abrBandWidthUpFactor;let oe=Number.POSITIVE_INFINITY,k;for(k=S-1;k>y;k--){const fe=O[k].maxBitrate,re=!O[k].details||K;if(oe=this.getTimeToLoadFrag(ue,B,m*fe,re),oe<Math.min(D,m+ue))break}if(oe>=te||oe>m*10)return;C?this.bwEstimator.sample(v-Math.min(A,N),h.loaded):this.bwEstimator.sampleTTFB(v);const $=O[k].maxBitrate;this.getBwEstimate()*j>$&&this.resetEstimator($);const q=this.findBestLevel($,y,k,0,D,1,1);q>-1&&(k=q),this.warn(`Fragment ${s.sn}${r?" part "+r.index:""} of level ${S} is loading too slowly;
      Fragment duration: ${s.duration.toFixed(3)}
      Time to underbuffer: ${D.toFixed(3)} s
      Estimated load time for current fragment: ${te.toFixed(3)} s
      Estimated load time for down switch fragment: ${oe.toFixed(3)} s
      TTFB estimate: ${N|0} ms
      Current BW estimate: ${de(M)?M|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${k} @ ${$|0} bps`),o.nextLoadLevel=o.nextAutoLevel=k,this.clearTimer();const ne=()=>{if(this.clearTimer(),this.fragCurrent===s&&this.hls.loadLevel===k&&k>0){const fe=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${k>0?"and switching down":""}
      Fragment duration: ${s.duration.toFixed(3)} s
      Time to underbuffer: ${fe.toFixed(3)} s`),s.abortRequests(),this.fragCurrent=this.partCurrent=null,k>y){let re=this.findBestLevel(this.hls.levels[y].bitrate,y,k,0,fe,1,1);re===-1&&(re=y),this.hls.nextLoadLevel=this.hls.nextAutoLevel=re,this.resetEstimator(this.hls.levels[re].bitrate)}}};x||te>oe*2?ne():this.timer=self.setInterval(ne,oe*1e3),o.trigger(b.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:r,stats:h})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new jb(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.FRAG_LOADING,this.onFragLoading,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(b.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const i=t.frag;if(!this.ignoreFragment(i)){if(!i.bitrateTest){var s;this.fragCurrent=i,this.partCurrent=(s=t.part)!=null?s:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case X.BUFFER_ADD_CODEC_ERROR:case X.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case X.FRAG_LOAD_TIMEOUT:{const i=t.frag,{fragCurrent:s,partCurrent:r}=this;if(i&&s&&i.sn===s.sn&&i.level===s.level){const o=performance.now(),u=r?r.stats:i.stats,d=o-u.loading.start,f=u.loading.first?u.loading.first-u.loading.start:-1;if(u.loaded&&f>-1){const m=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(d-Math.min(m,f),u.loaded)}else this.bwEstimator.sampleTTFB(d)}break}}}getTimeToLoadFrag(e,t,i,s){const r=e+i/t,o=s?e+this.lastLevelLoadSec:0;return r+o}onLevelLoaded(e,t){const i=this.hls.config,{loading:s}=t.stats,r=s.end-s.first;de(r)&&(this.lastLevelLoadSec=r/1e3),t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:i}){const s=i?i.stats:t.stats;if(t.type===ge.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const r=i?i.duration:t.duration,o=this.hls.levels[t.level],u=(o.loaded?o.loaded.bytes:0)+s.loaded,d=(o.loaded?o.loaded.duration:0)+r;o.loaded={bytes:u,duration:d},o.realBitrate=Math.round(8*u/d)}if(t.bitrateTest){const r={stats:s,frag:t,part:i,id:t.type};this.onFragBuffered(b.FRAG_BUFFERED,r),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:i,part:s}=t,r=s!=null&&s.stats.loaded?s.stats:i.stats;if(r.aborted||this.ignoreFragment(i))return;const o=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,r.loaded),r.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ge.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,i=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,r=this.findBestLevel(i,t,e,0,s,1,1);if(r>-1)return r;const o=this.hls.firstLevel,u=Math.min(Math.max(o,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${u}`),u}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),s=this.lastLoadedFragLevel>-1;if(e!==-1&&(!i||!s||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const r=i&&s?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,r)&&o[e].loadError<=o[r].loadError)return e}return this._nextAutoLevel=r,this.nextAutoLevelKey=this.getAutoLevelKey(),r}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;const{maxAutoLevel:s,config:r,minAutoLevel:o}=i,u=t?t.duration:e?e.duration:0,d=this.getBwEstimate(),f=this.getStarvationDelay();let h=r.abrBandWidthFactor,m=r.abrBandWidthUpFactor;if(f){const x=this.findBestLevel(d,o,s,f,0,h,m);if(x>=0)return this.rebufferNotice=-1,x}let v=u?Math.min(u,r.maxStarvationDelay):r.maxStarvationDelay;if(!f){const x=this.bitrateTestDelay;x&&(v=(u?Math.min(u,r.maxLoadingDelay):r.maxLoadingDelay)-x,this.info(`bitrate test took ${Math.round(1e3*x)}ms, set first fragment max fetchDuration to ${Math.round(1e3*v)} ms`),h=m=1)}const y=this.findBestLevel(d,o,s,f,v,h,m);if(this.rebufferNotice!==y&&(this.rebufferNotice=y,this.info(`${f?"rebuffering expected":"buffer is empty"}, optimal quality level ${y}`)),y>-1)return y;const S=i.levels[o],E=i.loadLevelObj;return E&&S?.bitrate<E.bitrate?o:i.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const i=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,s=e.mainForwardBufferInfo;return(s?s.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,i,s,r,o,u){var d;const f=s+r,h=this.lastLoadedFragLevel,m=h===-1?this.hls.firstLevel:h,{fragCurrent:v,partCurrent:y}=this,{levels:S,allAudioTracks:E,loadLevel:x,config:_}=this.hls;if(S.length===1)return 0;const R=S[m],A=!!((d=this.hls.latestLevelDetails)!=null&&d.live),I=x===-1||h===-1;let D,N="SDR",C=R?.frameRate||0;const{audioPreference:M,videoPreference:O}=_,P=this.audioTracksByGroup||(this.audioTracksByGroup=BT(E));let U=-1;if(I){if(this.firstSelection!==-1)return this.firstSelection;const K=this.codecTiers||(this.codecTiers=PA(S,P,t,i)),j=MA(K,N,e,M,O),{codecSet:oe,videoRanges:k,minFramerate:$,minBitrate:q,minIndex:ne,preferHDR:fe}=j;U=ne,D=oe,N=fe?k[k.length-1]:k[0],C=$,e=Math.max(e,q),this.log(`picked start tier ${Ze(j)}`)}else D=R?.codecSet,N=R?.videoRange;const H=y?y.duration:v?v.duration:0,se=this.bwEstimator.getEstimateTTFB()/1e3,ue=[];for(let K=i;K>=t;K--){var te,B;const j=S[K],oe=K>m;if(!j)continue;if(_.useMediaCapabilities&&!j.supportedResult&&!j.supportedPromise){const ce=navigator.mediaCapabilities;typeof ce?.decodingInfo=="function"&&_A(j,P,N,C,e,M)?(j.supportedPromise=kT(j,P,ce,this.supportedCache),j.supportedPromise.then(ve=>{if(!this.hls)return;j.supportedResult=ve;const _e=this.hls.levels,$e=_e.indexOf(j);ve.error?this.warn(`MediaCapabilities decodingInfo error: "${ve.error}" for level ${$e} ${Ze(ve)}`):ve.supported?ve.decodingInfoResults.some(Dt=>Dt.smooth===!1||Dt.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${$e} not smooth or powerEfficient: ${Ze(ve)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${$e} ${Ze(ve)}`),$e>-1&&_e.length>1&&(this.log(`Removing unsupported level ${$e}`),this.hls.removeLevel($e),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))})):j.supportedResult=MT}if((D&&j.codecSet!==D||N&&j.videoRange!==N||oe&&C>j.frameRate||!oe&&C>0&&C<j.frameRate||(te=j.supportedResult)!=null&&(B=te.decodingInfoResults)!=null&&B.some(ce=>ce.smooth===!1))&&(!I||K!==U)){ue.push(K);continue}const k=j.details,$=(y?k?.partTarget:k?.averagetargetduration)||H;let q;oe?q=u*e:q=o*e;const ne=H&&s>=H*2&&r===0?j.averageBitrate:j.maxBitrate,fe=this.getTimeToLoadFrag(se,q,ne*$,k===void 0);if(q>=ne&&(K===h||j.loadError===0&&j.fragmentError===0)&&(fe<=se||!de(fe)||A&&!this.bitrateTestDelay||fe<f)){const ce=this.forcedAutoLevel;return K!==x&&(ce===-1||ce!==x)&&(ue.length&&this.trace(`Skipped level(s) ${ue.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${S[ue[0]].codecs}" ${S[ue[0]].videoRange}; not compatible with "${D}" ${N}`),this.info(`switch candidate:${m}->${K} adjustedbw(${Math.round(q)})-bitrate=${Math.round(q-ne)} ttfb:${se.toFixed(1)} avgDuration:${$.toFixed(1)} maxFetchDuration:${f.toFixed(1)} fetchDuration:${fe.toFixed(1)} firstSelection:${I} codecSet:${j.codecSet} videoRange:${j.videoRange} hls.loadLevel:${x}`)),I&&(this.firstSelection=K),K}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:i}=this.hls;return Math.min(Math.max(e,i),t)}}const FT={search:function(l,e){let t=0,i=l.length-1,s=null,r=null;for(;t<=i;){s=(t+i)/2|0,r=l[s];const o=e(r);if(o>0)t=s+1;else if(o<0)i=s-1;else return r}return null}};function UA(l,e,t){if(e===null||!Array.isArray(l)||!l.length||!de(e))return null;const i=l[0].programDateTime;if(e<(i||0))return null;const s=l[l.length-1].endProgramDateTime;if(e>=(s||0))return null;for(let r=0;r<l.length;++r){const o=l[r];if($A(e,t,o))return o}return null}function nr(l,e,t=0,i=0,s=.005){let r=null;if(l){r=e[1+l.sn-e[0].sn]||null;const u=l.endDTS-t;u>0&&u<15e-7&&(t+=15e-7),r&&l.level!==r.level&&r.end<=l.end&&(r=e[2+l.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(r=e[0]);if(r&&((!l||l.level===r.level)&&fy(t,i,r)===0||GA(r,l,Math.min(s,i))))return r;const o=FT.search(e,fy.bind(null,t,i));return o&&(o!==l||!r)?o:r}function GA(l,e,t){if(e&&e.start===0&&e.level<l.level&&(e.endPTS||0)>0){const i=e.tagList.reduce((s,r)=>(r[0]==="INF"&&(s+=parseFloat(r[1])),s),t);return l.start<=i}return!1}function fy(l=0,e=0,t){if(t.start<=l&&t.start+t.duration>l)return 0;const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-i<=l?1:t.start-i>l&&t.start?-1:0}function $A(l,e,t){const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-i>l}function UT(l,e,t){if(l&&l.startCC<=e&&l.endCC>=e){let i=l.fragments;const{fragmentHint:s}=l;s&&(i=i.concat(s));let r;return FT.search(i,o=>o.cc<e?1:o.cc>e?-1:(r=o,o.end<=t?1:o.start>t?-1:0)),r||null}return null}function ju(l){switch(l.details){case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_TIMEOUT:case X.LEVEL_LOAD_TIMEOUT:case X.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function dy(l,e){const t=ju(e);return l.default[`${t?"timeout":"error"}Retry`]}function mg(l,e){const t=l.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*l.retryDelayMs,l.maxRetryDelayMs)}function hy(l){return Ke(Ke({},l),{errorRetry:null,timeoutRetry:null})}function qu(l,e,t,i){if(!l)return!1;const s=i?.code,r=e<l.maxNumRetry&&(zA(s)||!!t);return l.shouldRetry?l.shouldRetry(l,e,t,i,r):r}function zA(l){return l===0&&navigator.onLine===!1||!!l&&(l<400||l>499)}var Ft={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Yi={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class HA extends qi{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(b.ERROR,this.onError,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(b.ERROR,this.onError,this),e.off(b.ERROR,this.onErrorOut,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return e?.type===ge.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var i;if(t.fatal)return;const s=this.hls,r=t.context;switch(t.details){case X.FRAG_LOAD_ERROR:case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_ERROR:case X.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case X.FRAG_PARSING_ERROR:if((i=t.frag)!=null&&i.gap){t.errorAction=Gl();return}case X.FRAG_GAP:case X.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Ft.SendAlternateToPenaltyBox;return}case X.LEVEL_EMPTY_ERROR:case X.LEVEL_PARSING_ERROR:{var o,u;const f=t.parent===ge.MAIN?t.level:s.loadLevel;t.details===X.LEVEL_EMPTY_ERROR&&((o=t.context)!=null&&(u=o.levelDetails)!=null&&u.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,f):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,f))}return;case X.LEVEL_LOAD_ERROR:case X.LEVEL_LOAD_TIMEOUT:typeof r?.level=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.level));return;case X.AUDIO_TRACK_LOAD_ERROR:case X.AUDIO_TRACK_LOAD_TIMEOUT:case X.SUBTITLE_LOAD_ERROR:case X.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){const f=s.loadLevelObj;if(f&&(r.type===Ie.AUDIO_TRACK&&f.hasAudioGroup(r.groupId)||r.type===Ie.SUBTITLE_TRACK&&f.hasSubtitleGroup(r.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=Ft.SendAlternateToPenaltyBox,t.errorAction.flags=Yi.MoveAllAlternatesMatchingHost;return}}return;case X.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const f=s.loadLevelObj,h=f?.attrs["HDCP-LEVEL"];h?t.errorAction={action:Ft.SendAlternateToPenaltyBox,flags:Yi.MoveAllAlternatesMatchingHDCP,hdcpLevel:h}:this.keySystemError(t)}return;case X.BUFFER_ADD_CODEC_ERROR:case X.REMUX_ALLOC_ERROR:case X.BUFFER_APPEND_ERROR:if(!t.errorAction){var d;t.errorAction=this.getLevelSwitchAction(t,(d=t.level)!=null?d:s.loadLevel)}return;case X.INTERNAL_EXCEPTION:case X.BUFFER_APPENDING_ERROR:case X.BUFFER_FULL_ERROR:case X.LEVEL_SWITCH_ERROR:case X.BUFFER_STALLED_ERROR:case X.BUFFER_SEEK_OVER_HOLE:case X.BUFFER_NUDGE_ON_STALL:t.errorAction=Gl();return}t.type===pe.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const i=this.hls,s=dy(i.config.playlistLoadPolicy,e),r=this.playlistError++;if(qu(s,r,ju(e),e.response))return{action:Ft.RetryRequest,flags:Yi.None,retryConfig:s,retryCount:r};const u=this.getLevelSwitchAction(e,t);return s&&(u.retryConfig=s,u.retryCount=r),u}getFragRetryOrSwitchAction(e){const t=this.hls,i=this.getVariantLevelIndex(e.frag),s=t.levels[i],{fragLoadPolicy:r,keyLoadPolicy:o}=t.config,u=dy(e.details.startsWith("key")?o:r,e),d=t.levels.reduce((h,m)=>h+m.fragmentError,0);if(s&&(e.details!==X.FRAG_GAP&&s.fragmentError++,qu(u,d,ju(e),e.response)))return{action:Ft.RetryRequest,flags:Yi.None,retryConfig:u,retryCount:d};const f=this.getLevelSwitchAction(e,i);return u&&(f.retryConfig=u,f.retryCount=d),f}getLevelSwitchAction(e,t){const i=this.hls;t==null&&(t=i.loadLevel);const s=this.hls.levels[t];if(s){var r,o;const f=e.details;s.loadError++,f===X.BUFFER_APPEND_ERROR&&s.fragmentError++;let h=-1;const{levels:m,loadLevel:v,minAutoLevel:y,maxAutoLevel:S}=i;!i.autoLevelEnabled&&!i.config.preserveManualLevelOnError&&(i.loadLevel=-1);const E=(r=e.frag)==null?void 0:r.type,_=(E===ge.AUDIO&&f===X.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(f===X.BUFFER_ADD_CODEC_ERROR||f===X.BUFFER_APPEND_ERROR))&&m.some(({audioCodec:N})=>s.audioCodec!==N),A=e.sourceBufferName==="video"&&(f===X.BUFFER_ADD_CODEC_ERROR||f===X.BUFFER_APPEND_ERROR)&&m.some(({codecSet:N,audioCodec:C})=>s.codecSet!==N&&s.audioCodec===C),{type:I,groupId:D}=(o=e.context)!=null?o:{};for(let N=m.length;N--;){const C=(N+v)%m.length;if(C!==v&&C>=y&&C<=S&&m[C].loadError===0){var u,d;const M=m[C];if(f===X.FRAG_GAP&&E===ge.MAIN&&e.frag){const O=m[C].details;if(O){const P=nr(e.frag,O.fragments,e.frag.start);if(P!=null&&P.gap)continue}}else{if(I===Ie.AUDIO_TRACK&&M.hasAudioGroup(D)||I===Ie.SUBTITLE_TRACK&&M.hasSubtitleGroup(D))continue;if(E===ge.AUDIO&&(u=s.audioGroups)!=null&&u.some(O=>M.hasAudioGroup(O))||E===ge.SUBTITLE&&(d=s.subtitleGroups)!=null&&d.some(O=>M.hasSubtitleGroup(O))||_&&s.audioCodec===M.audioCodec||!_&&s.audioCodec!==M.audioCodec||A&&s.codecSet===M.codecSet)continue}h=C;break}}if(h>-1&&i.loadLevel!==h)return e.levelRetry=!0,this.playlistError=0,{action:Ft.SendAlternateToPenaltyBox,flags:Yi.None,nextAutoLevel:h}}return{action:Ft.SendAlternateToPenaltyBox,flags:Yi.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var i;switch((i=t.errorAction)==null?void 0:i.action){case Ft.DoNothing:break;case Ft.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==X.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,i=e.errorAction;if(!i)return;const{flags:s,hdcpLevel:r,nextAutoLevel:o}=i;switch(s){case Yi.None:this.switchLevel(e,o);break;case Yi.MoveAllAlternatesMatchingHDCP:r&&(t.maxHdcpLevel=Rh[Rh.indexOf(r)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}i.resolved||this.switchLevel(e,o)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===X.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const i=Lh(e.mimeType),s=this.hls.levels;for(let r=s.length;r--;)s[r][`${e.sourceBufferName}Codec`]===i&&this.hls.removeLevel(r)}}}function Gl(l){const e={action:Ft.DoNothing,flags:Yi.None};return l&&(e.resolved=!0),e}var Tt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class VA{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.BUFFER_APPENDED,this.onBufferAppended,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.BUFFER_APPENDED,this.onBufferAppended,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const i=this.activePartLists[t];if(i)for(let s=i.length;s--;){const r=i[s];if(!r)break;const o=r.end;if(r.start<=e&&o!==null&&e<=o)return r}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,i){const{fragments:s}=this,r=Object.keys(s);for(let o=r.length;o--;){const u=s[r[o]];if(u?.body.type===t&&(!i||u.buffered)){const d=u.body;if(d.start<=e&&e<=d.end)return d}}return null}detectEvictedFragments(e,t,i,s,r){this.timeRanges&&(this.timeRanges[e]=t);const o=s?.fragment.sn||-1;Object.keys(this.fragments).forEach(u=>{const d=this.fragments[u];if(!d||o>=d.body.sn)return;if(!d.buffered&&(!d.loaded||r)){d.body.type===i&&this.removeFragment(d.body);return}const f=d.range[e];if(f){if(f.time.length===0){this.removeFragment(d.body);return}f.time.some(h=>{const m=!this.isTimeBuffered(h.startPTS,h.endPTS,t);return m&&this.removeFragment(d.body),m})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const i=e.frag,s=Qr(i),r=this.fragments[s];if(!r||r.buffered&&i.gap)return;const o=!i.relurl;Object.keys(t).forEach(u=>{const d=i.elementaryStreams[u];if(!d)return;const f=t[u],h=o||d.partial===!0;r.range[u]=this.getBufferedTimes(i,e.part,h,f)}),r.loaded=null,Object.keys(r.range).length?(r.buffered=!0,(r.body.endList=i.endList||r.body.endList)&&(this.endListFragments[r.body.type]=r),fu(r)||this.removeParts(i.sn-1,i.type)):this.removeFragment(r.body)}removeParts(e,t){const i=this.activePartLists[t];i&&(this.activePartLists[t]=gy(i,s=>s.fragment.sn>=e))}fragBuffered(e,t){const i=Qr(e);let s=this.fragments[i];!s&&t&&(s=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,s.buffered=!0)}getBufferedTimes(e,t,i,s){const r={time:[],partial:i},o=e.start,u=e.end,d=e.minEndPTS||u,f=e.maxStartPTS||o;for(let h=0;h<s.length;h++){const m=s.start(h)-this.bufferPadding,v=s.end(h)+this.bufferPadding;if(f>=m&&d<=v){r.time.push({startPTS:Math.max(o,s.start(h)),endPTS:Math.min(u,s.end(h))});break}else if(o<v&&u>m){const y=Math.max(o,s.start(h)),S=Math.min(u,s.end(h));S>y&&(r.partial=!0,r.time.push({startPTS:y,endPTS:S}))}else if(u<=m)break}return r}getPartialFragment(e){let t=null,i,s,r,o=0;const{bufferPadding:u,fragments:d}=this;return Object.keys(d).forEach(f=>{const h=d[f];h&&fu(h)&&(s=h.body.start-u,r=h.body.end+u,e>=s&&e<=r&&(i=Math.min(e-s,r-e),o<=i&&(t=h.body,o=i)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||fu(t))}getState(e){const t=Qr(e),i=this.fragments[t];return i?i.buffered?fu(i)?Tt.PARTIAL:Tt.OK:Tt.APPENDING:Tt.NOT_LOADED}isTimeBuffered(e,t,i){let s,r;for(let o=0;o<i.length;o++){if(s=i.start(o)-this.bufferPadding,r=i.end(o)+this.bufferPadding,e>=s&&t<=r)return!0;if(t<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const i=t.frag,s=t.part?null:t,r=Qr(i);this.fragments[r]={body:i,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:i,part:s,timeRanges:r,type:o}=t;if(i.sn==="initSegment")return;const u=i.type;if(s){let f=this.activePartLists[u];f||(this.activePartLists[u]=f=[]),f.push(s)}this.timeRanges=r;const d=r[o];this.detectEvictedFragments(o,d,u,s)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Qr(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,i=Object.keys(t);if(!e)return i.length>0;for(let s=i.length;s--;){const r=t[i[s]];if(r?.body.type===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,i,s,r){s&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const u=this.fragments[o];if(!u)return;const d=u.body;d.type!==i||s&&!d.gap||d.start<t&&d.end>e&&(u.buffered||r)&&this.removeFragment(d)})}removeFragment(e){const t=Qr(e);e.clearElementaryStreamInfo();const i=this.activePartLists[e.type];if(i){const s=e.sn;this.activePartLists[e.type]=gy(i,r=>r.fragment.sn!==s)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const i=(e=this.hls)==null||(t=e.latestLevelDetails)==null?void 0:t.partList;i&&i.forEach(s=>s.clearElementaryStreamInfo())}}function fu(l){var e,t,i;return l.buffered&&(l.body.gap||((e=l.range.video)==null?void 0:e.partial)||((t=l.range.audio)==null?void 0:t.partial)||((i=l.range.audiovideo)==null?void 0:i.partial))}function Qr(l){return`${l.type}_${l.level}_${l.sn}`}function gy(l,e){return l.filter(t=>{const i=e(t);return i||t.clearElementaryStreamInfo(),i})}var En={cbc:0,ctr:1};class KA{constructor(e,t,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=i}decrypt(e,t){switch(this.aesMode){case En.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case En.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function YA(l){const e=l.byteLength,t=e&&new DataView(l.buffer).getUint8(e-1);return t?l.slice(0,e-t):l}class jA{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),i=new Uint32Array(4);for(let s=0;s<4;s++)i[s]=t.getUint32(s*4);return i}initTable(){const e=this.sBox,t=this.invSBox,i=this.subMix,s=i[0],r=i[1],o=i[2],u=i[3],d=this.invSubMix,f=d[0],h=d[1],m=d[2],v=d[3],y=new Uint32Array(256);let S=0,E=0,x=0;for(x=0;x<256;x++)x<128?y[x]=x<<1:y[x]=x<<1^283;for(x=0;x<256;x++){let _=E^E<<1^E<<2^E<<3^E<<4;_=_>>>8^_&255^99,e[S]=_,t[_]=S;const R=y[S],A=y[R],I=y[A];let D=y[_]*257^_*16843008;s[S]=D<<24|D>>>8,r[S]=D<<16|D>>>16,o[S]=D<<8|D>>>24,u[S]=D,D=I*16843009^A*65537^R*257^S*16843008,f[_]=D<<24|D>>>8,h[_]=D<<16|D>>>16,m[_]=D<<8|D>>>24,v[_]=D,S?(S=R^y[y[y[I^R]]],E^=y[y[E]]):S=E=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let i=!0,s=0;for(;s<t.length&&i;)i=t[s]===this.key[s],s++;if(i)return;this.key=t;const r=this.keySize=t.length;if(r!==4&&r!==6&&r!==8)throw new Error("Invalid aes key size="+r);const o=this.ksRows=(r+6+1)*4;let u,d;const f=this.keySchedule=new Uint32Array(o),h=this.invKeySchedule=new Uint32Array(o),m=this.sBox,v=this.rcon,y=this.invSubMix,S=y[0],E=y[1],x=y[2],_=y[3];let R,A;for(u=0;u<o;u++){if(u<r){R=f[u]=t[u];continue}A=R,u%r===0?(A=A<<8|A>>>24,A=m[A>>>24]<<24|m[A>>>16&255]<<16|m[A>>>8&255]<<8|m[A&255],A^=v[u/r|0]<<24):r>6&&u%r===4&&(A=m[A>>>24]<<24|m[A>>>16&255]<<16|m[A>>>8&255]<<8|m[A&255]),f[u]=R=(f[u-r]^A)>>>0}for(d=0;d<o;d++)u=o-d,d&3?A=f[u]:A=f[u-4],d<4||u<=4?h[d]=A:h[d]=S[m[A>>>24]]^E[m[A>>>16&255]]^x[m[A>>>8&255]]^_[m[A&255]],h[d]=h[d]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,i){const s=this.keySize+6,r=this.invKeySchedule,o=this.invSBox,u=this.invSubMix,d=u[0],f=u[1],h=u[2],m=u[3],v=this.uint8ArrayToUint32Array_(i);let y=v[0],S=v[1],E=v[2],x=v[3];const _=new Int32Array(e),R=new Int32Array(_.length);let A,I,D,N,C,M,O,P,U,H,se,ue,te,B;const K=this.networkToHostOrderSwap;for(;t<_.length;){for(U=K(_[t]),H=K(_[t+1]),se=K(_[t+2]),ue=K(_[t+3]),C=U^r[0],M=ue^r[1],O=se^r[2],P=H^r[3],te=4,B=1;B<s;B++)A=d[C>>>24]^f[M>>16&255]^h[O>>8&255]^m[P&255]^r[te],I=d[M>>>24]^f[O>>16&255]^h[P>>8&255]^m[C&255]^r[te+1],D=d[O>>>24]^f[P>>16&255]^h[C>>8&255]^m[M&255]^r[te+2],N=d[P>>>24]^f[C>>16&255]^h[M>>8&255]^m[O&255]^r[te+3],C=A,M=I,O=D,P=N,te=te+4;A=o[C>>>24]<<24^o[M>>16&255]<<16^o[O>>8&255]<<8^o[P&255]^r[te],I=o[M>>>24]<<24^o[O>>16&255]<<16^o[P>>8&255]<<8^o[C&255]^r[te+1],D=o[O>>>24]<<24^o[P>>16&255]<<16^o[C>>8&255]<<8^o[M&255]^r[te+2],N=o[P>>>24]<<24^o[C>>16&255]<<16^o[M>>8&255]<<8^o[O&255]^r[te+3],R[t]=K(A^y),R[t+1]=K(N^S),R[t+2]=K(D^E),R[t+3]=K(I^x),y=U,S=H,E=se,x=ue,t=t+4}return R.buffer}}class qA{constructor(e,t,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=i}expandKey(){const e=XA(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function XA(l){switch(l){case En.cbc:return"AES-CBC";case En.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${l}`)}}const QA=16;class pg{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?YA(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,i,s){return this.useSoftware?new Promise((r,o)=>{const u=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(u,t,i,s);const d=this.flush();d?r(d.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,i,s)}softwareDecrypt(e,t,i,s){const{currentIV:r,currentResult:o,remainderData:u}=this;if(s!==En.cbc||t.byteLength!==16)return Ne.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),u&&(e=Ui(u,e),this.remainderData=null);const d=this.getValidChunk(e);if(!d.length)return null;r&&(i=r);let f=this.softwareDecrypter;f||(f=this.softwareDecrypter=new jA),f.expandKey(t);const h=o;return this.currentResult=f.decrypt(d.buffer,0,i),this.currentIV=d.slice(-16).buffer,h||null}webCryptoDecrypt(e,t,i,s){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,i,s));this.key=t,this.fastAesKey=new qA(this.subtle,t,s)}return this.fastAesKey.expandKey().then(r=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new KA(this.subtle,new Uint8Array(i),s).decrypt(e.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(Ne.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,i,s)))}onWebCryptoError(e,t,i,s){const r=this.enableSoftwareAES;if(r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,i,s);const o=this.flush();if(o)return o.buffer}throw new Error("WebCrypto"+(r?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const i=e.length-e.length%QA;return i!==e.length&&(t=e.slice(0,i),this.remainderData=e.slice(i)),t}logOnce(e){this.logEnabled&&(Ne.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const my=Math.pow(2,17);class WA{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const i=e.url;if(!i)return Promise.reject(new Os({type:pe.NETWORK_ERROR,details:X.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();const s=this.config,r=s.fLoader,o=s.loader;return new Promise((u,d)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(S=>S[0]==="GAP")){d(vy(e));return}else e.gap=!1;const f=this.loader=r?new r(s):new o(s),h=py(e);e.loader=f;const m=hy(s.fragLoadPolicy.default),v={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:my};e.stats=f.stats;const y={onSuccess:(S,E,x,_)=>{this.resetLoader(e,f);let R=S.data;x.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(R.slice(0,16)),R=R.slice(16)),u({frag:e,part:null,payload:R,networkDetails:_})},onError:(S,E,x,_)=>{this.resetLoader(e,f),d(new Os({type:pe.NETWORK_ERROR,details:X.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Ke({url:i,data:void 0},S),error:new Error(`HTTP Error ${S.code} ${S.text}`),networkDetails:x,stats:_}))},onAbort:(S,E,x)=>{this.resetLoader(e,f),d(new Os({type:pe.NETWORK_ERROR,details:X.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:x,stats:S}))},onTimeout:(S,E,x)=>{this.resetLoader(e,f),d(new Os({type:pe.NETWORK_ERROR,details:X.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:x,stats:S}))}};t&&(y.onProgress=(S,E,x,_)=>t({frag:e,part:null,payload:x,networkDetails:_})),f.load(h,v,y)})}loadPart(e,t,i){this.abort();const s=this.config,r=s.fLoader,o=s.loader;return new Promise((u,d)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){d(vy(e,t));return}const f=this.loader=r?new r(s):new o(s),h=py(e,t);e.loader=f;const m=hy(s.fragLoadPolicy.default),v={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:my};t.stats=f.stats,f.load(h,v,{onSuccess:(y,S,E,x)=>{this.resetLoader(e,f),this.updateStatsFromPart(e,t);const _={frag:e,part:t,payload:y.data,networkDetails:x};i(_),u(_)},onError:(y,S,E,x)=>{this.resetLoader(e,f),d(new Os({type:pe.NETWORK_ERROR,details:X.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Ke({url:h.url,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:E,stats:x}))},onAbort:(y,S,E)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,f),d(new Os({type:pe.NETWORK_ERROR,details:X.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:E,stats:y}))},onTimeout:(y,S,E)=>{this.resetLoader(e,f),d(new Os({type:pe.NETWORK_ERROR,details:X.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:E,stats:y}))}})})}updateStatsFromPart(e,t){const i=e.stats,s=t.stats,r=s.total;if(i.loaded+=s.loaded,r){const d=Math.round(e.duration/t.duration),f=Math.min(Math.round(i.loaded/r),d),m=(d-f)*Math.round(i.loaded/f);i.total=i.loaded+m}else i.total=Math.max(i.loaded,i.total);const o=i.loading,u=s.loading;o.start?o.first+=u.first-u.start:(o.start=u.start,o.first=u.first),o.end=u.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function py(l,e=null){const t=e||l,i={frag:l,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},s=t.byteRangeStartOffset,r=t.byteRangeEndOffset;if(de(s)&&de(r)){var o;let u=s,d=r;if(l.sn==="initSegment"&&ZA((o=l.decryptdata)==null?void 0:o.method)){const f=r-s;f%16&&(d=r+(16-f%16)),s!==0&&(i.resetIV=!0,u=s-16)}i.rangeStart=u,i.rangeEnd=d}return i}function vy(l,e){const t=new Error(`GAP ${l.gap?"tag":"attribute"} found`),i={type:pe.MEDIA_ERROR,details:X.FRAG_GAP,fatal:!1,frag:l,error:t,networkDetails:null};return e&&(i.part=e),(e||l).stats.aborted=!0,new Os(i)}function ZA(l){return l==="AES-128"||l==="AES-256"}class Os extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class GT extends qi{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class vg{constructor(e,t,i,s=0,r=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=du(),this.buffering={audio:du(),video:du(),audiovideo:du()},this.level=e,this.sn=t,this.id=i,this.size=s,this.part=r,this.partial=o}}function du(){return{start:0,executeStart:0,executeEnd:0,end:0}}const yy={length:0,start:()=>0,end:()=>0};class be{static isBuffered(e,t){if(e){const i=be.getBuffered(e);for(let s=i.length;s--;)if(t>=i.start(s)&&t<=i.end(s))return!0}return!1}static bufferedRanges(e){if(e){const t=be.getBuffered(e);return be.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}static bufferInfo(e,t,i){if(e){const s=be.bufferedRanges(e);if(s.length)return be.bufferedInfo(s,t,i)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,i){t=Math.max(0,t),e.length>1&&e.sort((h,m)=>h.start-m.start||m.end-h.end);let s=-1,r=[];if(i)for(let h=0;h<e.length;h++){t>=e[h].start&&t<=e[h].end&&(s=h);const m=r.length;if(m){const v=r[m-1].end;e[h].start-v<i?e[h].end>v&&(r[m-1].end=e[h].end):r.push(e[h])}else r.push(e[h])}else r=e;let o=0,u,d=t,f=t;for(let h=0;h<r.length;h++){const m=r[h].start,v=r[h].end;if(s===-1&&t>=m&&t<=v&&(s=h),t+i>=m&&t<v)d=m,f=v,o=f-t;else if(t+i<m){u=m;break}}return{len:o,start:d||0,end:f||0,nextStart:u,buffered:e,bufferedIndex:s}}static getBuffered(e){try{return e.buffered||yy}catch(t){return Ne.log("failed to get media.buffered",t),yy}}}const $T=/\{\$([a-zA-Z0-9-_]+)\}/g;function Sy(l){return $T.test(l)}function Dh(l,e){if(l.variableList!==null||l.hasVariableRefs){const t=l.variableList;return e.replace($T,i=>{const s=i.substring(2,i.length-1),r=t?.[s];return r===void 0?(l.playlistParsingError||(l.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),i):r})}return e}function Ty(l,e,t){let i=l.variableList;i||(l.variableList=i={});let s,r;if("QUERYPARAM"in e){s=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(s))r=o.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${t}"`)}catch(o){l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else s=e.NAME,r=e.VALUE;s in i?l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):i[s]=r||""}function JA(l,e,t){const i=e.IMPORT;if(t&&i in t){let s=l.variableList;s||(l.variableList=s={}),s[i]=t[i]}else l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const eL=/^(\d+)x(\d+)$/,Ey=/(.+?)=(".*?"|.*?)(?:,|$)/g;class it{constructor(e,t){typeof e=="string"&&(e=it.parseAttrList(e,t)),Ge(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const i=new Uint8Array(t.length/2);for(let s=0;s<t.length/2;s++)i[s]=parseInt(t.slice(s*2,s*2+2),16);return i}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const i=this[e];return(i?i.split(/[ ,]+/):[]).reduce((s,r)=>(s[r.toLowerCase()]=!0,s),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=eL.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let i;const s={};for(Ey.lastIndex=0;(i=Ey.exec(e))!==null;){const o=i[1].trim();let u=i[2];const d=u.indexOf('"')===0&&u.lastIndexOf('"')===u.length-1;let f=!1;if(d)u=u.slice(1,-1);else switch(o){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":f=!0}if(t&&(d||f))u=Dh(t,u);else if(!f&&!d)switch(o){case"CLOSED-CAPTIONS":if(u==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Ne.warn(`${e}: attribute ${o} is missing quotes`)}s[o]=u}return s}}const tL="com.apple.hls.interstitial";function iL(l){return l!=="ID"&&l!=="CLASS"&&l!=="CUE"&&l!=="START-DATE"&&l!=="DURATION"&&l!=="END-DATE"&&l!=="END-ON-NEXT"}function sL(l){return l==="SCTE35-OUT"||l==="SCTE35-IN"||l==="SCTE35-CMD"}class zT{constructor(e,t,i=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=t?.tagAnchor||null,this.tagOrder=(s=t?.tagOrder)!=null?s:i,t){const r=t.attr;for(const o in r)if(Object.prototype.hasOwnProperty.call(e,o)&&e[o]!==r[o]){Ne.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=o;break}e=Ge(new it({}),r,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const r=t?.endDate||new Date(this.attr["END-DATE"]);de(r.getTime())&&(this._endDate=r)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(Ne.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(de(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===tL}get isValid(){return!!this.id&&!this._badValueForSameId&&de(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const nL=10;class rL{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}get hasProgramDateTime(){return this.fragments.length?de(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||nL}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let i=e.length;i--;)if(e[i].index>t)return e[i].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function aa(l){return l==="AES-128"||l==="AES-256"||l==="AES-256-CTR"}function yg(l){switch(l){case"AES-128":case"AES-256":return En.cbc;case"AES-256-CTR":return En.ctr;default:throw new Error(`invalid full segment method ${l}`)}}function HT(l){return Uint8Array.from(atob(l),e=>e.charCodeAt(0))}function Ih(l){return Uint8Array.from(unescape(encodeURIComponent(l)),e=>e.charCodeAt(0))}function aL(l){const e=Ih(l).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function lL(l){const e=function(i,s,r){const o=i[s];i[s]=i[r],i[r]=o};e(l,0,3),e(l,1,2),e(l,4,5),e(l,6,7)}function oL(l){const e=l.split(":");let t=null;if(e[0]==="data"&&e.length===2){const i=e[1].split(";"),s=i[i.length-1].split(",");if(s.length===2){const r=s[0]==="base64",o=s[1];r?(i.splice(-1,1),t=HT(o)):t=aL(o)}}return t}const Xu=typeof self<"u"?self:void 0;var ft={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Zt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function wh(l){switch(l){case Zt.FAIRPLAY:return ft.FAIRPLAY;case Zt.PLAYREADY:return ft.PLAYREADY;case Zt.WIDEVINE:return ft.WIDEVINE;case Zt.CLEARKEY:return ft.CLEARKEY}}function xy(l){switch(l){case ft.FAIRPLAY:return Zt.FAIRPLAY;case ft.PLAYREADY:return Zt.PLAYREADY;case ft.WIDEVINE:return Zt.WIDEVINE;case ft.CLEARKEY:return Zt.CLEARKEY}}function Iu(l){const{drmSystems:e,widevineLicenseUrl:t}=l,i=e?[ft.FAIRPLAY,ft.WIDEVINE,ft.PLAYREADY,ft.CLEARKEY].filter(s=>!!e[s]):[];return!i[ft.WIDEVINE]&&t&&i.push(ft.WIDEVINE),i}const VT=function(l){return Xu!=null&&(l=Xu.navigator)!=null&&l.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function uL(l,e,t,i){let s;switch(l){case ft.FAIRPLAY:s=["cenc","sinf"];break;case ft.WIDEVINE:case ft.PLAYREADY:s=["cenc"];break;case ft.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${l}`)}return cL(s,e,t,i)}function cL(l,e,t,i){return[{initDataTypes:l,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:e.map(r=>({contentType:`audio/mp4; codecs=${r}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:t.map(r=>({contentType:`video/mp4; codecs=${r}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function fL(l){var e;return l.sessionType==="persistent-license"||!!((e=l.sessionTypes)!=null&&e.some(t=>t==="persistent-license"))}function dL(l){const e=new Uint16Array(l.buffer,l.byteOffset,l.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),i=t.substring(t.indexOf("<"),t.length),o=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(o){const u=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(u){const d=HT(u).subarray(0,16);return lL(d),d}}return null}let hu={};class rc{static clearKeyUriToKeyIdMap(){hu={}}constructor(e,t,i,s=[1],r=null,o){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=i,this.keyFormatVersions=s,this.iv=r,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!aa(e),o!=null&&o.startsWith("0x")&&(this.keyId=new Uint8Array(bT(o)))}matches(e){var t,i;return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&e.keyFormatVersions.join(",")===this.keyFormatVersions.join(",")&&((t=e.iv)==null?void 0:t.join(","))===((i=this.iv)==null?void 0:i.join(","))}isSupported(){if(this.method){if(aa(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Zt.FAIRPLAY:case Zt.WIDEVINE:case Zt.PLAYREADY:case Zt.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(aa(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(Ne.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const i=hL(e);return new rc(this.method,this.uri,"identity",this.keyFormatVersions,i)}if(this.pssh&&this.keyId)return this;const t=oL(this.uri);if(t)switch(this.keyFormat){case Zt.WIDEVINE:if(this.pssh=t,!this.keyId&&t.length>=22){const i=t.length-22;this.keyId=t.subarray(i,i+16)}break;case Zt.PLAYREADY:{const i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=vA(i,null,t),this.keyId=dL(t);break}default:{let i=t.subarray(0,16);if(i.length!==16){const s=new Uint8Array(16);s.set(i,16-i.length),i=s}this.keyId=i;break}}if(!this.keyId||this.keyId.byteLength!==16){let i=hu[this.uri];if(!i){const s=Object.keys(hu).length%Number.MAX_SAFE_INTEGER;i=new Uint8Array(16),new DataView(i.buffer,12,4).setUint32(0,s),hu[this.uri]=i}this.keyId=i}return this}}function hL(l){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=l>>8*(15-t)&255;return e}const _y=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,by=/#EXT-X-MEDIA:(.*)/g,gL=/^#EXT(?:INF|-X-TARGETDURATION):/m,Bd=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),mL=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class us{static findGroup(e,t){for(let i=0;i<e.length;i++){const s=e[i];if(s.id===t)return s}}static resolve(e,t){return cg.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return gL.test(e)}static parseMasterPlaylist(e,t){const i=Sy(e),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},r=[];_y.lastIndex=0;let o;for(;(o=_y.exec(e))!=null;)if(o[1]){var u;const f=new it(o[1],s),h=Dh(s,o[2]),m={attrs:f,bitrate:f.decimalInteger("BANDWIDTH")||f.decimalInteger("AVERAGE-BANDWIDTH"),name:f.NAME,url:us.resolve(h,t)},v=f.decimalResolution("RESOLUTION");v&&(m.width=v.width,m.height=v.height),Ry(f.CODECS,m);const y=f["SUPPLEMENTAL-CODECS"];y&&(m.supplemental={},Ry(y,m.supplemental)),(u=m.unknownCodecs)!=null&&u.length||r.push(m),s.levels.push(m)}else if(o[3]){const f=o[3],h=o[4];switch(f){case"SESSION-DATA":{const m=new it(h,s),v=m["DATA-ID"];v&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[v]=m);break}case"SESSION-KEY":{const m=Ay(h,t,s);m.encrypted&&m.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(m)):Ne.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${h}"`);break}case"DEFINE":{{const m=new it(h,s);Ty(s,m,t)}break}case"CONTENT-STEERING":{const m=new it(h,s);s.contentSteering={uri:us.resolve(m["SERVER-URI"],t),pathwayId:m["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=Ly(h);break}}}const d=r.length>0&&r.length<s.levels.length;return s.levels=d?r:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(e,t,i){let s;const r={},o=i.levels,u={AUDIO:o.map(f=>({id:f.attrs.AUDIO,audioCodec:f.audioCodec})),SUBTITLES:o.map(f=>({id:f.attrs.SUBTITLES,textCodec:f.textCodec})),"CLOSED-CAPTIONS":[]};let d=0;for(by.lastIndex=0;(s=by.exec(e))!==null;){const f=new it(s[1],i),h=f.TYPE;if(h){const m=u[h],v=r[h]||[];r[h]=v;const y=f.LANGUAGE,S=f["ASSOC-LANGUAGE"],E=f.CHANNELS,x=f.CHARACTERISTICS,_=f["INSTREAM-ID"],R={attrs:f,bitrate:0,id:d++,groupId:f["GROUP-ID"]||"",name:f.NAME||y||"",type:h,default:f.bool("DEFAULT"),autoselect:f.bool("AUTOSELECT"),forced:f.bool("FORCED"),lang:y,url:f.URI?us.resolve(f.URI,t):""};if(S&&(R.assocLang=S),E&&(R.channels=E),x&&(R.characteristics=x),_&&(R.instreamId=_),m!=null&&m.length){const A=us.findGroup(m,R.groupId)||m[0];Dy(R,A,"audioCodec"),Dy(R,A,"textCodec")}v.push(R)}}return r}static parseLevelPlaylist(e,t,i,s,r,o){var u;const d={url:t},f=new rL(t),h=f.fragments,m=[];let v=null,y=0,S=0,E=0,x=0,_=0,R=null,A=new Pd(s,d),I,D,N,C=-1,M=!1,O=null,P;if(Bd.lastIndex=0,f.m3u8=e,f.hasVariableRefs=Sy(e),((u=Bd.exec(e))==null?void 0:u[0])!=="#EXTM3U")return f.playlistParsingError=new Error("Missing format identifier #EXTM3U"),f;for(;(I=Bd.exec(e))!==null;){M&&(M=!1,A=new Pd(s,d),A.playlistOffset=E,A.start=E,A.sn=y,A.cc=x,_&&(A.bitrate=_),A.level=i,v&&(A.initSegment=v,v.rawProgramDateTime&&(A.rawProgramDateTime=v.rawProgramDateTime,v.rawProgramDateTime=null),O&&(A.setByteRange(O),O=null)));const ue=I[1];if(ue){A.duration=parseFloat(ue);const te=(" "+I[2]).slice(1);A.title=te||null,A.tagList.push(te?["INF",ue,te]:["INF",ue])}else if(I[3]){if(de(A.duration)){A.playlistOffset=E,A.start=E,N&&wy(A,N,f),A.sn=y,A.level=i,A.cc=x,h.push(A);const te=(" "+I[3]).slice(1);A.relurl=Dh(f,te),Ch(A,R,m),R=A,E+=A.duration,y++,S=0,M=!0}}else{if(I=I[0].match(mL),!I){Ne.warn("No matches on slow regex match for level playlist!");continue}for(D=1;D<I.length&&I[D]===void 0;D++);const te=(" "+I[D]).slice(1),B=(" "+I[D+1]).slice(1),K=I[D+2]?(" "+I[D+2]).slice(1):null;switch(te){case"BYTERANGE":R?A.setByteRange(B,R):A.setByteRange(B);break;case"PROGRAM-DATE-TIME":A.rawProgramDateTime=B,A.tagList.push(["PROGRAM-DATE-TIME",B]),C===-1&&(C=h.length);break;case"PLAYLIST-TYPE":f.type&&Ds(f,te,I),f.type=B.toUpperCase();break;case"MEDIA-SEQUENCE":f.startSN!==0?Ds(f,te,I):h.length>0&&Cy(f,te,I),y=f.startSN=parseInt(B);break;case"SKIP":{f.skippedSegments&&Ds(f,te,I);const j=new it(B,f),oe=j.decimalInteger("SKIPPED-SEGMENTS");if(de(oe)){f.skippedSegments+=oe;for(let $=oe;$--;)h.push(null);y+=oe}const k=j.enumeratedString("RECENTLY-REMOVED-DATERANGES");k&&(f.recentlyRemovedDateranges=(f.recentlyRemovedDateranges||[]).concat(k.split("	")));break}case"TARGETDURATION":f.targetduration!==0&&Ds(f,te,I),f.targetduration=Math.max(parseInt(B),1);break;case"VERSION":f.version!==null&&Ds(f,te,I),f.version=parseInt(B);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":f.live||Ds(f,te,I),f.live=!1;break;case"#":(B||K)&&A.tagList.push(K?[B,K]:[B]);break;case"DISCONTINUITY":x++,A.tagList.push(["DIS"]);break;case"GAP":A.gap=!0,A.tagList.push([te]);break;case"BITRATE":A.tagList.push([te,B]),_=parseInt(B)*1e3,de(_)?A.bitrate=_:_=0;break;case"DATERANGE":{const j=new it(B,f),oe=new zT(j,f.dateRanges[j.ID],f.dateRangeTagCount);f.dateRangeTagCount++,oe.isValid||f.skippedSegments?f.dateRanges[oe.id]=oe:Ne.warn(`Ignoring invalid DATERANGE tag: "${B}"`),A.tagList.push(["EXT-X-DATERANGE",B]);break}case"DEFINE":{{const j=new it(B,f);"IMPORT"in j?JA(f,j,o):Ty(f,j,t)}break}case"DISCONTINUITY-SEQUENCE":f.startCC!==0?Ds(f,te,I):h.length>0&&Cy(f,te,I),f.startCC=x=parseInt(B);break;case"KEY":{const j=Ay(B,t,f);if(j.isSupported()){if(j.method==="NONE"){N=void 0;break}N||(N={});const oe=N[j.keyFormat];oe!=null&&oe.matches(j)||(oe&&(N=Ge({},N)),N[j.keyFormat]=j)}else Ne.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${B}"`);break}case"START":f.startTimeOffset=Ly(B);break;case"MAP":{const j=new it(B,f);if(A.duration){const oe=new Pd(s,d);Iy(oe,j,i,N),v=oe,A.initSegment=v,v.rawProgramDateTime&&!A.rawProgramDateTime&&(A.rawProgramDateTime=v.rawProgramDateTime)}else{const oe=A.byteRangeEndOffset;if(oe){const k=A.byteRangeStartOffset;O=`${oe-k}@${k}`}else O=null;Iy(A,j,i,N),v=A,M=!0}v.cc=x;break}case"SERVER-CONTROL":{P&&Ds(f,te,I),P=new it(B),f.canBlockReload=P.bool("CAN-BLOCK-RELOAD"),f.canSkipUntil=P.optionalFloat("CAN-SKIP-UNTIL",0),f.canSkipDateRanges=f.canSkipUntil>0&&P.bool("CAN-SKIP-DATERANGES"),f.partHoldBack=P.optionalFloat("PART-HOLD-BACK",0),f.holdBack=P.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{f.partTarget&&Ds(f,te,I);const j=new it(B);f.partTarget=j.decimalFloatingPoint("PART-TARGET");break}case"PART":{let j=f.partList;j||(j=f.partList=[]);const oe=S>0?j[j.length-1]:void 0,k=S++,$=new it(B,f),q=new sA($,A,d,k,oe);j.push(q),A.duration+=q.duration;break}case"PRELOAD-HINT":{const j=new it(B,f);f.preloadHint=j;break}case"RENDITION-REPORT":{const j=new it(B,f);f.renditionReports=f.renditionReports||[],f.renditionReports.push(j);break}default:Ne.warn(`line parsed but not handled: ${I}`);break}}}R&&!R.relurl?(h.pop(),E-=R.duration,f.partList&&(f.fragmentHint=R)):f.partList&&(Ch(A,R,m),A.cc=x,f.fragmentHint=A,N&&wy(A,N,f)),f.targetduration||(f.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const U=h.length,H=h[0],se=h[U-1];if(E+=f.skippedSegments*f.targetduration,E>0&&U&&se){f.averagetargetduration=E/U;const ue=se.sn;f.endSN=ue!=="initSegment"?ue:0,f.live||(se.endList=!0),H&&f.startCC===void 0&&(f.startCC=H.cc),C>0&&(vL(h,C),H&&m.unshift(H))}else f.endSN=0,f.startCC=0;return f.fragmentHint&&(E+=f.fragmentHint.duration),f.totalduration=E,m.length&&f.dateRangeTagCount&&H&&KT(m,f),f.endCC=x,f}}function KT(l,e){const t=l.length;if(!t)return;const i=l[t-1],s=e.live?1/0:e.totalduration,r=Object.keys(e.dateRanges);for(let o=r.length;o--;){const u=e.dateRanges[r[o]],d=u.startDate.getTime();u.tagAnchor=i.ref;for(let f=t;f--;){const h=pL(e,d,l,f,s);if(h!==-1){u.tagAnchor=e.fragments[h].ref;break}}}}function pL(l,e,t,i,s){const r=t[i];if(r){const u=r.programDateTime;if(e>=u||i===0){var o;const d=(((o=t[i+1])==null?void 0:o.start)||s)-r.start;if(e<=u+d*1e3){const f=t[i].sn-l.startSN,h=l.fragments;if(h.length>t.length){const v=(t[i+1]||h[h.length-1]).sn-l.startSN;for(let y=v;y>f;y--){const S=h[y].programDateTime;if(e>=S&&e<S+h[y].duration*1e3)return y}}return f}}}return-1}function Ay(l,e,t){var i,s;const r=new it(l,t),o=(i=r.METHOD)!=null?i:"",u=r.URI,d=r.hexadecimalInteger("IV"),f=r.KEYFORMATVERSIONS,h=(s=r.KEYFORMAT)!=null?s:"identity";u&&r.IV&&!d&&Ne.error(`Invalid IV: ${r.IV}`);const m=u?us.resolve(u,e):"",v=(f||"1").split("/").map(Number).filter(Number.isFinite);return new rc(o,m,h,v,d,r.KEYID)}function Ly(l){const t=new it(l).decimalFloatingPoint("TIME-OFFSET");return de(t)?t:null}function Ry(l,e){let t=(l||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{const s=t.filter(r=>hg(r,i));s.length&&(e[`${i}Codec`]=s.map(r=>r.split("/")[0]).join(","),t=t.filter(r=>s.indexOf(r)===-1))}),e.unknownCodecs=t}function Dy(l,e,t){const i=e[t];i&&(l[t]=i)}function vL(l,e){let t=l[e];for(let i=e;i--;){const s=l[i];if(!s)return;s.programDateTime=t.programDateTime-s.duration*1e3,t=s}}function Ch(l,e,t){l.rawProgramDateTime?t.push(l):e!=null&&e.programDateTime&&(l.programDateTime=e.endProgramDateTime)}function Iy(l,e,t,i){l.relurl=e.URI,e.BYTERANGE&&l.setByteRange(e.BYTERANGE),l.level=t,l.sn="initSegment",i&&(l.levelkeys=i),l.initSegment=null}function wy(l,e,t){l.levelkeys=e;const{encryptedFragments:i}=t;(!i.length||i[i.length-1].levelkeys!==e)&&Object.keys(e).some(s=>e[s].isCommonEncryption)&&i.push(l)}function Ds(l,e,t){l.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function Cy(l,e,t){l.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Fd(l,e){const t=e.startPTS;if(de(t)){let i=0,s;e.sn>l.sn?(i=t-l.start,s=l):(i=l.start-t,s=e),s.duration!==i&&s.setDuration(i)}else e.sn>l.sn?l.cc===e.cc&&l.minEndPTS?e.setStart(l.start+(l.minEndPTS-l.start)):e.setStart(l.start+l.duration):e.setStart(Math.max(l.start-e.duration,0))}function YT(l,e,t,i,s,r){i-t<=0&&(Ne.warn("Fragment should have a positive duration",e),i=t+e.duration,r=s+e.duration);let u=t,d=i;const f=e.startPTS,h=e.endPTS;if(de(f)){const x=Math.abs(f-t);de(e.deltaPTS)?e.deltaPTS=Math.max(x,e.deltaPTS):e.deltaPTS=x,u=Math.max(t,f),t=Math.min(t,f),s=Math.min(s,e.startDTS),d=Math.min(i,h),i=Math.max(i,h),r=Math.max(r,e.endDTS)}const m=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(i-e.start),e.startPTS=t,e.maxStartPTS=u,e.startDTS=s,e.endPTS=i,e.minEndPTS=d,e.endDTS=r;const v=e.sn;if(!l||v<l.startSN||v>l.endSN)return 0;let y;const S=v-l.startSN,E=l.fragments;for(E[S]=e,y=S;y>0;y--)Fd(E[y],E[y-1]);for(y=S;y<E.length-1;y++)Fd(E[y],E[y+1]);return l.fragmentHint&&Fd(E[E.length-1],l.fragmentHint),l.PTSKnown=l.alignedSliding=!0,m}function yL(l,e){if(l===e)return;let t=null;const i=l.fragments;for(let f=i.length-1;f>=0;f--){const h=i[f].initSegment;if(h){t=h;break}}l.fragmentHint&&delete l.fragmentHint.endPTS;let s;EL(l,e,(f,h,m,v)=>{if((!e.startCC||e.skippedSegments)&&h.cc!==f.cc){const y=f.cc-h.cc;for(let S=m;S<v.length;S++)v[S].cc+=y;e.endCC=v[v.length-1].cc}de(f.startPTS)&&de(f.endPTS)&&(h.setStart(h.startPTS=f.startPTS),h.startDTS=f.startDTS,h.maxStartPTS=f.maxStartPTS,h.endPTS=f.endPTS,h.endDTS=f.endDTS,h.minEndPTS=f.minEndPTS,h.setDuration(f.endPTS-f.startPTS),h.duration&&(s=h),e.PTSKnown=e.alignedSliding=!0),f.hasStreams&&(h.elementaryStreams=f.elementaryStreams),h.loader=f.loader,f.hasStats&&(h.stats=f.stats),f.initSegment&&(h.initSegment=f.initSegment,t=f.initSegment)});const r=e.fragments,o=e.fragmentHint?r.concat(e.fragmentHint):r;if(t&&o.forEach(f=>{var h;f&&(!f.initSegment||f.initSegment.relurl===((h=t)==null?void 0:h.relurl))&&(f.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=r.some(f=>!f),e.deltaUpdateFailed){Ne.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let f=e.skippedSegments;f--;)r.shift();e.startSN=r[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=SL(l.dateRanges,e));const f=l.fragments.filter(h=>h.rawProgramDateTime);if(l.hasProgramDateTime&&!e.hasProgramDateTime)for(let h=1;h<o.length;h++)o[h].programDateTime===null&&Ch(o[h],o[h-1],f);KT(f,e)}e.endCC=r[r.length-1].cc}if(!e.startCC){var u;const f=XT(l,e.startSN-1);e.startCC=(u=f?.cc)!=null?u:r[0].cc}TL(l.partList,e.partList,(f,h)=>{h.elementaryStreams=f.elementaryStreams,h.stats=f.stats}),s?YT(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):jT(l,e),r.length&&(e.totalduration=e.edge-r[0].start),e.driftStartTime=l.driftStartTime,e.driftStart=l.driftStart;const d=e.advancedDateTime;if(e.advanced&&d){const f=e.edge;e.driftStart||(e.driftStartTime=d,e.driftStart=f),e.driftEndTime=d,e.driftEnd=f}else e.driftEndTime=l.driftEndTime,e.driftEnd=l.driftEnd,e.advancedDateTime=l.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=l.requestScheduled)}function SL(l,e){const{dateRanges:t,recentlyRemovedDateranges:i}=e,s=Ge({},l);i&&i.forEach(u=>{delete s[u]});const o=Object.keys(s).length;return o&&Object.keys(t).forEach(u=>{const d=s[u],f=new zT(t[u].attr,d);f.isValid?(s[u]=f,d||(f.tagOrder+=o)):Ne.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Ze(t[u].attr)}"`)}),s}function TL(l,e,t){if(l&&e){let i=0;for(let s=0,r=l.length;s<=r;s++){const o=l[s],u=e[s+i];o&&u&&o.index===u.index&&o.fragment.sn===u.fragment.sn?t(o,u):i--}}}function EL(l,e,t){const i=e.skippedSegments,s=Math.max(l.startSN,e.startSN)-e.startSN,r=(l.fragmentHint?1:0)+(i?e.endSN:Math.min(l.endSN,e.endSN))-e.startSN,o=e.startSN-l.startSN,u=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,d=l.fragmentHint?l.fragments.concat(l.fragmentHint):l.fragments;for(let f=s;f<=r;f++){const h=d[o+f];let m=u[f];if(i&&!m&&h&&(m=e.fragments[f]=h),h&&m){if(t(h,m,f,u),h.url&&h.url!==m.url){e.playlistParsingError=Oy(`media sequence mismatch ${m.sn}:`,l,e,h,m);return}else if(h.cc!==m.cc){e.playlistParsingError=Oy(`discontinuity sequence mismatch (${h.cc}!=${m.cc})`,l,e,h,m);return}}}}function Oy(l,e,t,i,s){return new Error(`${l} ${s.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function jT(l,e,t=!0){const i=e.startSN+e.skippedSegments-l.startSN,s=l.fragments,r=i>=0;let o=0;if(r&&i<s.length)o=s[i].start;else if(r&&e.startSN===l.endSN+1)o=l.fragmentEnd;else if(r&&t)o=l.fragmentStart+i*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)o=l.fragmentStart;else return;Oh(e,o)}function Oh(l,e){if(e){const t=l.fragments;for(let i=l.skippedSegments;i<t.length;i++)t[i].addStart(e);l.fragmentHint&&l.fragmentHint.addStart(e)}}function qT(l,e=1/0){let t=1e3*l.targetduration;if(l.updated){const i=l.fragments;if(i.length&&t*4>e){const r=i[i.length-1].duration*1e3;r<t&&(t=r)}}else t/=2;return Math.round(t)}function XT(l,e,t){if(!l)return null;let i=l.fragments[e-l.startSN];return i||(i=l.fragmentHint,i&&i.sn===e)?i:e<l.startSN&&t&&t.sn===e?t:null}function My(l,e,t){return l?QT(l.partList,e,t):null}function QT(l,e,t){if(l)for(let i=l.length;i--;){const s=l[i];if(s.index===t&&s.fragment.sn===e)return s}return null}function WT(l){l.forEach((e,t)=>{var i;(i=e.details)==null||i.fragments.forEach(s=>{s.level=t,s.initSegment&&(s.initSegment.level=t)})})}function Rl(l,e){for(let i=0,s=l.length;i<s;i++){var t;if(((t=l[i])==null?void 0:t.cc)===e)return l[i]}return null}function xL(l,e){return!!(l&&e.startCC<l.endCC&&e.endCC>l.startCC)}function Py(l,e){if(l){const t=l.start+e;l.start=l.startPTS=t,l.endPTS=t+l.duration}}function ZT(l,e){const t=e.fragments;for(let i=0,s=t.length;i<s;i++)Py(t[i],l);e.fragmentHint&&Py(e.fragmentHint,l),e.alignedSliding=!0}function _L(l,e){l&&(JT(e,l),!e.alignedSliding&&l&&Qu(e,l),!e.alignedSliding&&l&&!e.skippedSegments&&jT(l,e,!1))}function JT(l,e){if(!xL(e,l))return;const t=Math.min(e.endCC,l.endCC),i=Rl(e.fragments,t),s=Rl(l.fragments,t);if(!i||!s)return;Ne.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const r=i.start-s.start;ZT(r,l)}function Qu(l,e){if(!l.hasProgramDateTime||!e.hasProgramDateTime)return;const t=l.fragments,i=e.fragments;if(!t.length||!i.length)return;let s,r;const o=Math.min(e.endCC,l.endCC);e.startCC<o&&l.startCC<o&&(s=Rl(i,o),r=Rl(t,o)),(!s||!r)&&(s=i[Math.floor(i.length/2)],r=Rl(t,s.cc)||t[Math.floor(t.length/2)]);const u=s.programDateTime,d=r.programDateTime;if(!u||!d)return;const f=(d-u)/1e3-(r.start-s.start);ZT(f,l)}const bL={toString:function(l){let e="";const t=l.length;for(let i=0;i<t;i++)e+=`[${l.start(i).toFixed(3)}-${l.end(i).toFixed(3)}]`;return e}},ie={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Sg extends GT{constructor(e,t,i,s,r){super(s,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=ie.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:o,fragCurrent:u,media:d,mediaBuffer:f,state:h}=this,m=d?d.currentTime:0,v=be.bufferInfo(f||d,m,o.maxBufferHole),y=!v.len;if(this.log(`Media seeking to ${de(m)?m.toFixed(3):m}, state: ${h}, ${y?"out of":"in"} buffer`),this.state===ie.ENDED)this.resetLoadingState();else if(u){const S=o.maxFragLookUpTolerance,E=u.start-S,x=u.start+u.duration+S;if(y||x<v.start||E>v.end){const _=m>x;(m<E||_)&&(_&&u.loader&&(this.log(`Cancelling fragment load for seek (sn: ${u.sn})`),u.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(d){this.fragmentTracker.removeFragmentsInRange(m,1/0,this.playlistType,!0);const S=this.lastCurrentTime;if(m>S&&(this.lastCurrentTime=m),!this.loadingParts){const E=Math.max(v.end,m),x=this.shouldLoadParts(this.getLevelDetails(),E);x&&(this.log(`LL-Part loading ON after seeking to ${m.toFixed(2)} with buffer @${E.toFixed(2)}`),this.loadingParts=x)}}this.hls.hasEnoughToStart||(this.log(`Setting ${y?"startPosition":"nextLoadPosition"} to ${m} for seek without enough to start`),this.nextLoadPosition=m,y&&(this.startPosition=m)),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=r,this.hls=e,this.fragmentLoader=new WA(e.config),this.keyLoader=i,this.fragmentTracker=t,this.config=e.config,this.decrypter=new pg(e.config)}registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===ie.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ie.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const i=e.end||0,s=this.config.timelineOffset||0;if(i<=s)return!1;const r=e.buffered;this.config.maxBufferHole&&r&&r.length>1&&(e=be.bufferedInfo(r,e.start,0));const o=e.nextStart;if(o&&o>s&&o<t.edge||this.media.currentTime<e.start)return!1;const d=t.partList;if(d!=null&&d.length){const h=d[d.length-1];return be.isBuffered(this.media,h.start+h.duration/2)}const f=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(f)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const i=this.media=this.mediaBuffer=t.media;i.removeEventListener("seeking",this.onMediaSeeking),i.removeEventListener("ended",this.onMediaEnded),i.addEventListener("seeking",this.onMediaSeeking),i.addEventListener("ended",this.onMediaEnded);const s=this.config;this.levels&&s.autoStartLoad&&this.state===ie.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(e,t){const i=!!t.transferMedia,s=this.media;if(s!==null){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),s.removeEventListener("seeking",this.onMediaSeeking),s.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=ie.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,i){this.startFragRequested=!0,this._loadFragForPlayback(e,t,i)}_loadFragForPlayback(e,t,i){const s=r=>{const o=r.frag;if(this.fragContextChanged(o)){this.warn(`${o.type} sn: ${o.sn}${r.part?" part: "+r.part.index:""} of ${this.fragInfo(o,!1,r.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(o);return}o.stats.chunkCount++,this._handleFragmentLoadProgress(r)};this._doFragLoad(e,t,i,s).then(r=>{if(!r)return;const o=this.state,u=r.frag;if(this.fragContextChanged(u)){(o===ie.FRAG_LOADING||!this.fragCurrent&&o===ie.PARSING)&&(this.fragmentTracker.removeFragment(u),this.state=ie.IDLE);return}"payload"in r&&(this.log(`Loaded ${u.type} sn: ${u.sn} of ${this.playlistLabel()} ${u.level}`),this.hls.trigger(b.FRAG_LOADED,r)),this._handleFragmentLoadComplete(r)}).catch(r=>{this.state===ie.STOPPED||this.state===ie.ERROR||(this.warn(`Frag error: ${r?.message||r}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:i}=this;if(i.getState(e)===Tt.APPENDING){const r=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,r),u=Math.max(e.duration,o?o.len:this.config.maxBufferLength),d=this.backtrackFragment;((d?e.sn-d.sn:0)===1||this.reduceMaxBufferLength(u,e.duration))&&i.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),i.getState(e)===Tt.PARTIAL&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return t?.live&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,i=null){if(!(e-t))return;const s={startOffset:e,endOffset:t,type:i};this.hls.trigger(b.BUFFER_FLUSHING,s)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(i=>{const s=i?.frag;if(!s||this.fragContextChanged(s)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:s}=this,{frag:r,payload:o}=i,u=r.decryptdata;if(o&&o.byteLength>0&&u!=null&&u.key&&u.iv&&aa(u.method)){const d=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),u.key.buffer,u.iv.buffer,yg(u.method)).catch(f=>{throw s.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.FRAG_DECRYPT_ERROR,fatal:!1,error:f,reason:f.message,frag:r}),f}).then(f=>{const h=self.performance.now();return s.trigger(b.FRAG_DECRYPTED,{frag:r,payload:f,stats:{tstart:d,tdecrypt:h}}),i.payload=f,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{this.state===ie.STOPPED||this.state===ie.ERROR||(this.warn(i),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const i=e.frag.stats;this.state!==ie.STOPPED&&(this.state=ie.IDLE),e.frag.data=new Uint8Array(e.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${i?bL.toString(be.getBuffered(i)):"(detached)"})`),pt(e)){var s;if(e.type!==ge.SUBTITLE){const o=e.elementaryStreams;if(!Object.keys(o).some(u=>!!o[u])){this.state=ie.IDLE;return}}const r=(s=this.levels)==null?void 0:s[e.level];r!=null&&r.fragmentError&&(this.log(`Resetting level fragment error count of ${r.fragmentError} on frag buffered`),r.fragmentError=0)}this.state=ie.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:i,part:s,partsLoaded:r}=e,o=!r||r.length===0||r.some(d=>!d),u=new vg(i.level,i.sn,i.stats.chunkCount+1,0,s?s.index:-1,!o);t.flush(u)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,i=null,s){var r;this.fragCurrent=e;const o=t?.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let u=null;e.encrypted&&!((r=e.decryptdata)!=null&&r.key)?(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=ie.KEY_LOADING,this.fragCurrent=e,u=this.keyLoader.load(e).then(m=>{if(!this.fragContextChanged(m.frag))return this.hls.trigger(b.KEY_LOADED,m),this.state===ie.KEY_LOADING&&(this.state=ie.IDLE),m}),this.hls.trigger(b.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(u=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):e.encrypted||(u=this.keyLoader.loadClear(e,o.encryptedFragments,this.startFragRequested),u&&this.log("[eme] blocking frag load until media-keys acquired"));const d=this.fragPrevious;if(pt(e)&&(!d||e.sn!==d.sn)){const m=this.shouldLoadParts(t.details,e.end);m!==this.loadingParts&&(this.log(`LL-Part loading ${m?"ON":"OFF"} loading sn ${d?.sn}->${e.sn}`),this.loadingParts=m)}if(i=Math.max(e.start,i||0),this.loadingParts&&pt(e)){const m=o.partList;if(m&&s){i>e.end&&o.fragmentHint&&(e=o.fragmentHint);const v=this.getNextPart(m,e,i);if(v>-1){const y=m[v];e=this.fragCurrent=y.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${y.index} (${v}/${m.length-1}) of ${this.fragInfo(e,!1,y)}) cc: ${e.cc} [${o.startSN}-${o.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=y.start+y.duration,this.state=ie.FRAG_LOADING;let S;return u?S=u.then(E=>!E||this.fragContextChanged(E.frag)?null:this.doFragPartsLoad(e,y,t,s)).catch(E=>this.handleFragLoadError(E)):S=this.doFragPartsLoad(e,y,t,s).catch(E=>this.handleFragLoadError(E)),this.hls.trigger(b.FRAG_LOADING,{frag:e,part:y,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):S}else if(!e.url||this.loadedEndOfParts(m,i))return Promise.resolve(null)}}if(pt(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${o?"["+o.startSN+"-"+o.endSN+"]":""}, target: ${parseFloat(i.toFixed(3))}`),de(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=ie.FRAG_LOADING;const f=this.config.progressive;let h;return f&&u?h=u.then(m=>!m||this.fragContextChanged(m?.frag)?null:this.fragmentLoader.load(e,s)).catch(m=>this.handleFragLoadError(m)):h=Promise.all([this.fragmentLoader.load(e,f?s:void 0),u]).then(([m])=>(!f&&m&&s&&s(m),m)).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(b.FRAG_LOADING,{frag:e,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):h}doFragPartsLoad(e,t,i,s){return new Promise((r,o)=>{var u;const d=[],f=(u=i.details)==null?void 0:u.partList,h=m=>{this.fragmentLoader.loadPart(e,m,s).then(v=>{d[m.index]=v;const y=v.part;this.hls.trigger(b.FRAG_LOADED,v);const S=My(i.details,e.sn,m.index+1)||QT(f,e.sn,m.index+1);if(S)h(S);else return r({frag:e,part:y,partsLoaded:d})}).catch(o)};h(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===X.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(b.ERROR,t)}else this.hls.trigger(b.ERROR,{type:pe.OTHER_ERROR,details:X.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==ie.PARSING){!this.fragCurrent&&this.state!==ie.STOPPED&&this.state!==ie.ERROR&&(this.state=ie.IDLE);return}const{frag:i,part:s,level:r}=t,o=self.performance.now();i.stats.parsing.end=o,s&&(s.stats.parsing.end=o);const u=this.getLevelDetails(),f=u&&i.sn>u.endSN||this.shouldLoadParts(u,i.end);f!==this.loadingParts&&(this.log(`LL-Part loading ${f?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=f),this.updateLevelTiming(i,s,r,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e!=null&&e.partList){var i;const r=e.partList[0],o=r.end+(((i=e.fragmentHint)==null?void 0:i.duration)||0);if(t>=o){var s;if((this.hls.hasEnoughToStart?((s=this.media)==null?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>r.start-r.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:i}=this,{level:s,sn:r,part:o}=e;if(!(t!=null&&t[s]))return this.warn(`Levels object was unset while buffering fragment ${r} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;const u=t[s],d=u.details,f=o>-1?My(d,r,o):null,h=f?f.fragment:XT(d,r,i);return h?(i&&i!==h&&(h.stats=i.stats),{frag:h,part:f,level:u}):null}bufferFragmentData(e,t,i,s,r){var o;if(!e||this.state!==ie.PARSING)return;const{data1:u,data2:d}=e;let f=u;if(u&&d&&(f=Ui(u,d)),!((o=f)!=null&&o.length))return;const h=this.initPTS[t.cc],m=h?-h.baseTime/h.timescale:void 0,v={type:e.type,frag:t,part:i,chunkMeta:s,offset:m,parent:t.type,data:f};if(this.hls.trigger(b.BUFFER_APPENDING,v),e.dropped&&e.independent&&!i){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!be.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const i=t.currentTime,s=be.bufferInfo(t,i,0),r=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,r*.25),u=Math.max(Math.min(e.start-o,s.end-o),i+o);e.start-u>o&&this.flushMainBuffer(u,e.start)}getFwdBufferInfo(e,t){var i;const s=this.getLoadPosition();if(!de(s))return null;const o=this.lastCurrentTime>s||(i=this.media)!=null&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,s,t,o)}getFwdBufferInfoAtPos(e,t,i,s){const r=be.bufferInfo(e,t,s);if(r.len===0&&r.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,i);if(o&&(r.nextStart<=o.end||o.gap)){const u=Math.max(Math.min(r.nextStart,o.end)-t,s);return be.bufferInfo(e,t,u)}}return r}getMaxBufferLength(e){const{config:t}=this;let i;return e?i=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):i=t.maxBufferLength,Math.min(i,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const i=this.config,s=Math.max(Math.min(e-t,i.maxBufferLength),t),r=Math.max(e-t*3,i.maxMaxBufferLength/2,s);return r>=s?(i.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0):!1}getAppendedFrag(e,t=ge.MAIN){var i;const s=(i=this.fragmentTracker)==null?void 0:i.getAppendedFrag(e,t);return s&&"fragment"in s?s.fragment:s}getNextFragment(e,t){const i=t.fragments,s=i.length;if(!s)return null;const{config:r}=this,o=i[0].start,u=r.lowLatencyMode&&!!t.partList;let d=null;if(t.live){const m=r.initialLiveManifestSize;if(s<m)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${m})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o){var f;u&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),d=this.getInitialLiveFragment(t);const v=this.hls.startPosition,y=this.hls.liveSyncPosition,S=d?(v!==-1&&v>=o?v:y)||d.start:e;this.log(`Setting startPosition to ${S} to match start frag at live edge. mainStart: ${v} liveSyncPosition: ${y} frag.start: ${(f=d)==null?void 0:f.start}`),this.startPosition=this.nextLoadPosition=S}}else e<=o&&(d=i[0]);if(!d){const m=this.loadingParts?t.partEnd:t.fragmentEnd;d=this.getFragmentAtPosition(e,m,t)}let h=this.filterReplacedPrimary(d,t);if(!h&&d){const m=d.sn-t.startSN;h=this.filterReplacedPrimary(i[m+1]||null,t)}return this.mapToInitFragWhenRequired(h)}isLoopLoading(e,t){const i=this.fragmentTracker.getState(e);return(i===Tt.OK||i===Tt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,i,s,r){let o=null;if(e.gap&&(o=this.getNextFragment(this.nextLoadPosition,t),o&&!o.gap&&i.nextStart)){const u=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,s,0);if(u!==null&&i.len+u.len>=r){const d=o.sn;return this.loopSn!==d&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${d}`),this.loopSn=d),null}}return this.loopSn=void 0,o}get primaryPrefetch(){if(ky(this.hls.config)){var e,t;if((e=this.hls.interstitialsManager)==null||(t=e.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(ky(this.hls.config)&&e.type!==ge.SUBTITLE){const i=this.hls.interstitialsManager,s=i?.bufferingItem;if(s){const o=s.event;if(o){if(o.appendInPlace||Math.abs(e.start-s.start)>1||s.start===0)return null}else if(e.end<=s.start&&t?.live===!1||e.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||e.start-s.end>1))return null}const r=i?.playerQueue;if(r)for(let o=r.length;o--;){const u=r[o].interstitial;if(u.appendInPlace&&e.start>=u.startTime&&e.end<=u.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,i){let s=-1,r=!1,o=!0;for(let u=0,d=e.length;u<d;u++){const f=e[u];if(o=o&&!f.independent,s>-1&&i<f.start)break;const h=f.loaded;h?s=-1:(r||f.independent||o)&&f.fragment===t&&(s=u),r=h}return s}loadedEndOfParts(e,t){const i=e[e.length-1];return i&&t>i.start&&i.loaded}getInitialLiveFragment(e){const t=e.fragments,i=this.fragPrevious;let s=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),s=UA(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const r=i.sn+1;if(r>=e.startSN&&r<=e.endSN){const o=t[r-e.startSN];i.cc===o.cc&&(s=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=UT(e,i.cc,i.end),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const r=this.hls.liveSyncPosition;r!==null&&(s=this.getFragmentAtPosition(r,this.bitrateTest?e.fragmentEnd:e.edge,e))}return s}getFragmentAtPosition(e,t,i){const{config:s}=this;let{fragPrevious:r}=this,{fragments:o,endSN:u}=i;const{fragmentHint:d}=i,{maxFragLookUpTolerance:f}=s,h=i.partList,m=!!(this.loadingParts&&h!=null&&h.length&&d);m&&d&&!this.bitrateTest&&h[h.length-1].fragment.sn===d.sn&&(o=o.concat(d),u=d.sn);let v;if(e<t){var y;const E=e<this.lastCurrentTime||e>t-f||(y=this.media)!=null&&y.paused||!this.startFragRequested?0:f;v=nr(r,o,e,E)}else v=o[o.length-1];if(v){const S=v.sn-i.startSN,E=this.fragmentTracker.getState(v);if((E===Tt.OK||E===Tt.PARTIAL&&v.gap)&&(r=v),r&&v.sn===r.sn&&(!m||h[0].fragment.sn>v.sn||!i.live&&!m)&&r&&v.level===r.level){const _=o[S+1];v.sn<u&&this.fragmentTracker.getState(_)!==Tt.OK?v=_:v=null}}return v}alignPlaylists(e,t,i){const s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const r=e.fragmentStart,o=!t,u=e.alignedSliding&&de(r);if(o||!u&&!r){_L(i,e);const d=e.fragmentStart;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${s}`),d}return r}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let i=this.startPosition;i<t&&(i=-1);const s=this.timelineOffset;if(i===-1){const r=this.startTimeOffset!==null,o=r?this.startTimeOffset:e.startTimeOffset;o!==null&&de(o)?(i=t+o,o<0&&(i+=e.edge),i=Math.min(Math.max(t,i),t+e.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${o} found in ${r?"multivariant":"media"} playlist`),this.startPosition=i):e.live?(i=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+s}this.nextLoadPosition=i+s}getLoadPosition(){var e;const{media:t}=this;let i=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?i=t.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&pt(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==ie.FRAG_LOADING_WAITING_RETRY)&&(this.state=ie.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const S=this.getCurrentContext(t.chunkMeta);S&&(t.frag=S.frag)}const i=t.frag;if(!i||i.type!==e||!this.levels)return;if(this.fragContextChanged(i)){var s;this.warn(`Frag load error must match current frag to retry ${i.url} > ${(s=this.fragCurrent)==null?void 0:s.url}`);return}const r=t.details===X.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(i,!0);const o=t.errorAction,{action:u,flags:d,retryCount:f=0,retryConfig:h}=o||{},m=!!o&&!!h,v=m&&u===Ft.RetryRequest,y=m&&!o.resolved&&d===Yi.MoveAllAlternatesMatchingHost;if(!v&&y&&pt(i)&&!i.endList)this.resetFragmentErrors(e),this.treatAsGap(i),o.resolved=!0;else if((v||y)&&f<h.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const S=mg(h,f);this.warn(`Fragment ${i.sn} of ${e} ${i.level} errored with ${t.details}, retrying loading ${f+1}/${h.maxNumRetry} in ${S}ms`),o.resolved=!0,this.retryDate=self.performance.now()+S,this.state=ie.FRAG_LOADING_WAITING_RETRY}else if(h&&o)if(this.resetFragmentErrors(e),f<h.maxNumRetry)!r&&u!==Ft.RemoveAlternatePermanently&&(o.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${f})`);return}else u===Ft.SendAlternateToPenaltyBox?this.state=ie.WAITING_LEVEL:this.state=ie.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===ie.PARSING||this.state===ie.PARSED){const t=e.frag,i=e.parent,s=this.getFwdBufferInfo(this.mediaBuffer,i),r=s&&s.len>.5;r&&this.reduceMaxBufferLength(s.len,t?.duration||10);const o=!r;return o&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${i} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===ge.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==ie.STOPPED&&(this.state=ie.IDLE)}afterBufferFlushed(e,t,i){if(!e)return;const s=be.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,s,i),this.state===ie.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==ie.STOPPED&&(this.state=ie.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,i,s){const r=i.details;if(!r){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((d,f)=>{const h=e.elementaryStreams[f];if(h){const m=h.endPTS-h.startPTS;if(m<=0)return this.warn(`Could not parse fragment ${e.sn} ${f} duration reliably (${m})`),d||!1;const v=s?0:YT(r,e,h.startPTS,h.endPTS,h.startDTS,h.endDTS);return this.hls.trigger(b.LEVEL_PTS_UPDATED,{details:r,level:i,drift:v,type:f,frag:e,start:h.startPTS,end:h.endPTS}),!0}return d},!1)){var u;if(i.fragmentError===0&&this.treatAsGap(e,i),((u=this.transmuxer)==null?void 0:u.error)===null){const d=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=ie.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(b.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===ge.MAIN?"level":"track"}fragInfo(e,t=!0,i){var s,r;return`${this.playlistLabel()} ${e.level} (${i?"part":"frag"}:[${((s=t&&!i?e.startPTS:(i||e).start)!=null?s:NaN).toFixed(3)}-${((r=t&&!i?e.endPTS:(i||e).end)!=null?r:NaN).toFixed(3)}]${i&&e.type==="main"?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function ky(l){return!!l.interstitialsController&&l.enableInterstitialPlayback!==!1}class eE{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let i;if(e.length)e.length===1?i=e[0]:i=AL(e,t);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}}function AL(l,e){const t=new Uint8Array(e);let i=0;for(let s=0;s<l.length;s++){const r=l[s];t.set(r,i),i+=r.length}return t}var Ud={exports:{}},Ny;function LL(){return Ny||(Ny=1,function(l){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function s(d,f,h){this.fn=d,this.context=f,this.once=h||!1}function r(d,f,h,m,v){if(typeof h!="function")throw new TypeError("The listener must be a function");var y=new s(h,m||d,v),S=t?t+f:f;return d._events[S]?d._events[S].fn?d._events[S]=[d._events[S],y]:d._events[S].push(y):(d._events[S]=y,d._eventsCount++),d}function o(d,f){--d._eventsCount===0?d._events=new i:delete d._events[f]}function u(){this._events=new i,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],h,m;if(this._eventsCount===0)return f;for(m in h=this._events)e.call(h,m)&&f.push(t?m.slice(1):m);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},u.prototype.listeners=function(f){var h=t?t+f:f,m=this._events[h];if(!m)return[];if(m.fn)return[m.fn];for(var v=0,y=m.length,S=new Array(y);v<y;v++)S[v]=m[v].fn;return S},u.prototype.listenerCount=function(f){var h=t?t+f:f,m=this._events[h];return m?m.fn?1:m.length:0},u.prototype.emit=function(f,h,m,v,y,S){var E=t?t+f:f;if(!this._events[E])return!1;var x=this._events[E],_=arguments.length,R,A;if(x.fn){switch(x.once&&this.removeListener(f,x.fn,void 0,!0),_){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,h),!0;case 3:return x.fn.call(x.context,h,m),!0;case 4:return x.fn.call(x.context,h,m,v),!0;case 5:return x.fn.call(x.context,h,m,v,y),!0;case 6:return x.fn.call(x.context,h,m,v,y,S),!0}for(A=1,R=new Array(_-1);A<_;A++)R[A-1]=arguments[A];x.fn.apply(x.context,R)}else{var I=x.length,D;for(A=0;A<I;A++)switch(x[A].once&&this.removeListener(f,x[A].fn,void 0,!0),_){case 1:x[A].fn.call(x[A].context);break;case 2:x[A].fn.call(x[A].context,h);break;case 3:x[A].fn.call(x[A].context,h,m);break;case 4:x[A].fn.call(x[A].context,h,m,v);break;default:if(!R)for(D=1,R=new Array(_-1);D<_;D++)R[D-1]=arguments[D];x[A].fn.apply(x[A].context,R)}}return!0},u.prototype.on=function(f,h,m){return r(this,f,h,m,!1)},u.prototype.once=function(f,h,m){return r(this,f,h,m,!0)},u.prototype.removeListener=function(f,h,m,v){var y=t?t+f:f;if(!this._events[y])return this;if(!h)return o(this,y),this;var S=this._events[y];if(S.fn)S.fn===h&&(!v||S.once)&&(!m||S.context===m)&&o(this,y);else{for(var E=0,x=[],_=S.length;E<_;E++)(S[E].fn!==h||v&&!S[E].once||m&&S[E].context!==m)&&x.push(S[E]);x.length?this._events[y]=x.length===1?x[0]:x:o(this,y)}return this},u.prototype.removeAllListeners=function(f){var h;return f?(h=t?t+f:f,this._events[h]&&o(this,h)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,l.exports=u}(Ud)),Ud.exports}var RL=LL(),Tg=tA(RL);const $l="1.6.7",va={};function DL(){return typeof __HLS_WORKER_BUNDLE__=="function"}function IL(){const l=va[$l];if(l)return l.clientCount++,l;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),s={worker:new self.Worker(t),objectURL:t,clientCount:1};return va[$l]=s,s}function wL(l){const e=va[l];if(e)return e.clientCount++,e;const t=new self.URL(l,self.location.href).href,s={worker:new self.Worker(t),scriptURL:t,clientCount:1};return va[l]=s,s}function CL(l){const e=va[l||$l];if(e&&e.clientCount--===1){const{worker:i,objectURL:s}=e;delete va[l||$l],s&&self.URL.revokeObjectURL(s),i.terminate()}}function tE(l,e){return e+10<=l.length&&l[e]===51&&l[e+1]===68&&l[e+2]===73&&l[e+3]<255&&l[e+4]<255&&l[e+6]<128&&l[e+7]<128&&l[e+8]<128&&l[e+9]<128}function Eg(l,e){return e+10<=l.length&&l[e]===73&&l[e+1]===68&&l[e+2]===51&&l[e+3]<255&&l[e+4]<255&&l[e+6]<128&&l[e+7]<128&&l[e+8]<128&&l[e+9]<128}function ac(l,e){let t=0;return t=(l[e]&127)<<21,t|=(l[e+1]&127)<<14,t|=(l[e+2]&127)<<7,t|=l[e+3]&127,t}function zl(l,e){const t=e;let i=0;for(;Eg(l,e);){i+=10;const s=ac(l,e+6);i+=s,tE(l,e+10)&&(i+=10),e+=i}if(i>0)return l.subarray(t,t+i)}function OL(l,e,t,i){const s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],r=e[t+2],o=r>>2&15;if(o>12){const y=new Error(`invalid ADTS sampling index:${o}`);l.emit(b.ERROR,b.ERROR,{type:pe.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!0,error:y,reason:y.message});return}const u=(r>>6&3)+1,d=e[t+3]>>6&3|(r&1)<<2,f="mp4a.40."+u,h=s[o];let m=o;(u===5||u===29)&&(m-=3);const v=[u<<3|(m&14)>>1,(m&1)<<7|d<<3];return Ne.log(`manifest codec:${i}, parsed codec:${f}, channels:${d}, rate:${h} (ADTS object type:${u} sampling index:${o})`),{config:v,samplerate:h,channelCount:d,codec:f,parsedCodec:f,manifestCodec:i}}function iE(l,e){return l[e]===255&&(l[e+1]&246)===240}function sE(l,e){return l[e+1]&1?7:9}function xg(l,e){return(l[e+3]&3)<<11|l[e+4]<<3|(l[e+5]&224)>>>5}function ML(l,e){return e+5<l.length}function Wu(l,e){return e+1<l.length&&iE(l,e)}function PL(l,e){return ML(l,e)&&iE(l,e)&&xg(l,e)<=l.length-e}function kL(l,e){if(Wu(l,e)){const t=sE(l,e);if(e+t>=l.length)return!1;const i=xg(l,e);if(i<=t)return!1;const s=e+i;return s===l.length||Wu(l,s)}return!1}function nE(l,e,t,i,s){if(!l.samplerate){const r=OL(e,t,i,s);if(!r)return;Ge(l,r)}}function rE(l){return 1024*9e4/l}function NL(l,e){const t=sE(l,e);if(e+t<=l.length){const i=xg(l,e)-t;if(i>0)return{headerLength:t,frameLength:i}}}function aE(l,e,t,i,s){const r=rE(l.samplerate),o=i+s*r,u=NL(e,t);let d;if(u){const{frameLength:m,headerLength:v}=u,y=v+m,S=Math.max(0,t+y-e.length);S?(d=new Uint8Array(y-v),d.set(e.subarray(t+v,e.length),0)):d=e.subarray(t+v,t+y);const E={unit:d,pts:o};return S||l.samples.push(E),{sample:E,length:y,missing:S}}const f=e.length-t;return d=new Uint8Array(f),d.set(e.subarray(t,e.length),0),{sample:{unit:d,pts:o},length:f,missing:-1}}function BL(l,e){return Eg(l,e)&&ac(l,e+6)+10<=l.length-e}function FL(l){return l instanceof ArrayBuffer?l:l.byteOffset==0&&l.byteLength==l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer}function Gd(l,e=0,t=1/0){return UL(l,e,t,Uint8Array)}function UL(l,e,t,i){const s=GL(l);let r=1;"BYTES_PER_ELEMENT"in i&&(r=i.BYTES_PER_ELEMENT);const o=$L(l)?l.byteOffset:0,u=(o+l.byteLength)/r,d=(o+e)/r,f=Math.floor(Math.max(0,Math.min(d,u))),h=Math.floor(Math.min(f+Math.max(t,0),u));return new i(s,f,h-f)}function GL(l){return l instanceof ArrayBuffer?l:l.buffer}function $L(l){return l&&l.buffer instanceof ArrayBuffer&&l.byteLength!==void 0&&l.byteOffset!==void 0}function zL(l){const e={key:l.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(l.size<2)return;if(l.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const i=l.data.subarray(1).indexOf(0);if(i===-1)return;const s=yi(Gd(l.data,1,i)),r=l.data[2+i],o=l.data.subarray(3+i).indexOf(0);if(o===-1)return;const u=yi(Gd(l.data,3+i,o));let d;return s==="-->"?d=yi(Gd(l.data,4+i+o)):d=FL(l.data.subarray(4+i+o)),e.mimeType=s,e.pictureType=r,e.description=u,e.data=d,e}function HL(l){if(l.size<2)return;const e=yi(l.data,!0),t=new Uint8Array(l.data.subarray(e.length+1));return{key:l.type,info:e,data:t.buffer}}function VL(l){if(l.size<2)return;if(l.type==="TXXX"){let t=1;const i=yi(l.data.subarray(t),!0);t+=i.length+1;const s=yi(l.data.subarray(t));return{key:l.type,info:i,data:s}}const e=yi(l.data.subarray(1));return{key:l.type,info:"",data:e}}function KL(l){if(l.type==="WXXX"){if(l.size<2)return;let t=1;const i=yi(l.data.subarray(t),!0);t+=i.length+1;const s=yi(l.data.subarray(t));return{key:l.type,info:i,data:s}}const e=yi(l.data);return{key:l.type,info:"",data:e}}function YL(l){return l.type==="PRIV"?HL(l):l.type[0]==="W"?KL(l):l.type==="APIC"?zL(l):VL(l)}function jL(l){const e=String.fromCharCode(l[0],l[1],l[2],l[3]),t=ac(l,4),i=10;return{type:e,size:t,data:l.subarray(i,i+t)}}const gu=10,qL=10;function lE(l){let e=0;const t=[];for(;Eg(l,e);){const i=ac(l,e+6);l[e+5]>>6&1&&(e+=gu),e+=gu;const s=e+i;for(;e+qL<s;){const r=jL(l.subarray(e)),o=YL(r);o&&t.push(o),e+=r.size+gu}tE(l,e)&&(e+=gu)}return t}function oE(l){return l&&l.key==="PRIV"&&l.info==="com.apple.streaming.transportStreamTimestamp"}function XL(l){if(l.data.byteLength===8){const e=new Uint8Array(l.data),t=e[3]&1;let i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,t&&(i+=4772185884e-2),Math.round(i)}}function _g(l){const e=lE(l);for(let t=0;t<e.length;t++){const i=e[t];if(oE(i))return XL(i)}}let hi=function(l){return l.audioId3="org.id3",l.dateRange="com.apple.quicktime.HLS",l.emsg="https://aomedia.org/emsg/ID3",l.misbklv="urn:misb:KLV:bin:1910.1",l}({});function rs(l="",e=9e4){return{type:l,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class bg{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,i,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,i){}demux(e,t){this.cachedData&&(e=Ui(this.cachedData,e),this.cachedData=null);let i=zl(e,0),s=i?i.length:0,r;const o=this._audioTrack,u=this._id3Track,d=i?_g(i):void 0,f=e.length;for((this.basePTS===null||this.frameIndex===0&&de(d))&&(this.basePTS=QL(d,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:hi.audioId3,duration:Number.POSITIVE_INFINITY});s<f;){if(this.canParse(e,s)){const h=this.appendFrame(o,e,s);h?(this.frameIndex++,this.lastPTS=h.sample.pts,s+=h.length,r=s):s=f}else BL(e,s)?(i=zl(e,s),u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:hi.audioId3,duration:Number.POSITIVE_INFINITY}),s+=i.length,r=s):s++;if(s===f&&r!==f){const h=e.slice(r);this.cachedData?this.cachedData=Ui(this.cachedData,h):this.cachedData=h}}return{audioTrack:o,videoTrack:rs(),id3Track:u,textTrack:rs()}}demuxSampleAes(e,t,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:rs(),id3Track:this._id3Track,textTrack:rs()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const QL=(l,e,t)=>{if(de(l))return l*90;const i=t?t.baseTime*9e4/t.timescale:0;return e*9e4+i};let mu=null;const WL=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],ZL=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],JL=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],eR=[0,1,1,4];function uE(l,e,t,i,s){if(t+24>e.length)return;const r=cE(e,t);if(r&&t+r.frameLength<=e.length){const o=r.samplesPerFrame*9e4/r.sampleRate,u=i+s*o,d={unit:e.subarray(t,t+r.frameLength),pts:u,dts:u};return l.config=[],l.channelCount=r.channelCount,l.samplerate=r.sampleRate,l.samples.push(d),{sample:d,length:r.frameLength,missing:0}}}function cE(l,e){const t=l[e+1]>>3&3,i=l[e+1]>>1&3,s=l[e+2]>>4&15,r=l[e+2]>>2&3;if(t!==1&&s!==0&&s!==15&&r!==3){const o=l[e+2]>>1&1,u=l[e+3]>>6,d=t===3?3-i:i===3?3:4,f=WL[d*14+s-1]*1e3,m=ZL[(t===3?0:t===2?1:2)*3+r],v=u===3?1:2,y=JL[t][i],S=eR[i],E=y*8*S,x=Math.floor(y*f/m+o)*S;if(mu===null){const A=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);mu=A?parseInt(A[1]):0}return!!mu&&mu<=87&&i===2&&f>=224e3&&u===0&&(l[e+3]=l[e+3]|128),{sampleRate:m,channelCount:v,frameLength:x,samplesPerFrame:E}}}function Ag(l,e){return l[e]===255&&(l[e+1]&224)===224&&(l[e+1]&6)!==0}function fE(l,e){return e+1<l.length&&Ag(l,e)}function tR(l,e){return Ag(l,e)&&4<=l.length-e}function dE(l,e){if(e+1<l.length&&Ag(l,e)){const i=cE(l,e);let s=4;i!=null&&i.frameLength&&(s=i.frameLength);const r=e+s;return r===l.length||fE(l,r)}return!1}class iR extends bg{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,i,s){super.resetInitSegment(e,t,i,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const i=zl(e,0);let s=i?.length||0;if(dE(e,s))return!1;for(let r=e.length;s<r;s++)if(kL(e,s))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return PL(e,t)}appendFrame(e,t,i){nE(e,this.observer,t,i,e.manifestCodec);const s=aE(e,t,i,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}}const hE=(l,e)=>{let t=0,i=5;e+=i;const s=new Uint32Array(1),r=new Uint32Array(1),o=new Uint8Array(1);for(;i>0;){o[0]=l[e];const u=Math.min(i,8),d=8-u;r[0]=4278190080>>>24+d<<d,s[0]=(o[0]&r[0])>>d,t=t?t<<u|s[0]:s[0],e+=1,i-=u}return t};class sR extends bg{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,i,s){super.resetInitSegment(e,t,i,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,i){const s=gE(e,t,i,this.basePTS,this.frameIndex);if(s!==-1)return{sample:e.samples[e.samples.length-1],length:s,missing:0}}static probe(e){if(!e)return!1;const t=zl(e,0);if(!t)return!1;const i=t.length;return e[i]===11&&e[i+1]===119&&_g(t)!==void 0&&hE(e,i)<16}}function gE(l,e,t,i,s){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const r=e[t+4]>>6;if(r>=3)return-1;const u=[48e3,44100,32e3][r],d=e[t+4]&63,h=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][d*3+r]*2;if(t+h>e.length)return-1;const m=e[t+6]>>5;let v=0;m===2?v+=2:(m&1&&m!==1&&(v+=2),m&4&&(v+=2));const y=(e[t+6]<<8|e[t+7])>>12-v&1,E=[2,1,2,3,3,4,4,5][m]+y,x=e[t+5]>>3,_=e[t+5]&7,R=new Uint8Array([r<<6|x<<1|_>>2,(_&3)<<6|m<<3|y<<2|d>>4,d<<4&224]),A=1536/u*9e4,I=i+s*A,D=e.subarray(t,t+h);return l.config=R,l.channelCount=E,l.samplerate=u,l.samples.push({unit:D,pts:I}),h}class nR extends bg{resetInitSegment(e,t,i,s){super.resetInitSegment(e,t,i,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=zl(e,0);let i=t?.length||0;if(t&&e[i]===11&&e[i+1]===119&&_g(t)!==void 0&&hE(e,i)<=16)return!1;for(let s=e.length;i<s;i++)if(dE(e,i))return Ne.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return tR(e,t)}appendFrame(e,t,i){if(this.basePTS!==null)return uE(e,t,i,this.basePTS,this.frameIndex)}}const rR=/\/emsg[-/]ID3/i;class aR{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,i,s){const r=this.videoTrack=rs("video",1),o=this.audioTrack=rs("audio",1),u=this.txtTrack=rs("text",1);if(this.id3Track=rs("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const d=wT(e);if(d.video){const{id:f,timescale:h,codec:m,supplemental:v}=d.video;r.id=f,r.timescale=u.timescale=h,r.codec=m,r.supplemental=v}if(d.audio){const{id:f,timescale:h,codec:m}=d.audio;o.id=f,o.timescale=h,o.codec=m}u.id=RT.text,r.sampleDuration=0,r.duration=o.duration=s}resetContiguity(){this.remainderData=null}static probe(e){return aA(e)}demux(e,t){this.timeOffset=t;let i=e;const s=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=Ui(this.remainderData,e));const u=hA(i);this.remainderData=u.remainder,s.samples=u.valid||new Uint8Array}else s.samples=i;const o=this.extractID3Track(s,t);return r.samples=iy(t,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(t,this.timeOffset);return i.samples=iy(e,t),{videoTrack:t,audioTrack:rs(),id3Track:s,textTrack:rs()}}extractID3Track(e,t){const i=this.id3Track;if(e.samples.length){const s=Re(e.samples,["emsg"]);s&&s.forEach(r=>{const o=mA(r);if(rR.test(o.schemeIdUri)){const u=By(o,t);let d=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const f=o.payload;i.samples.push({data:f,len:f.byteLength,dts:u,pts:u,type:hi.emsg,duration:d})}else if(this.config.enableEmsgKLVMetadata&&o.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const u=By(o,t);i.samples.push({data:o.payload,len:o.payload.byteLength,dts:u,pts:u,type:hi.misbklv,duration:Number.POSITIVE_INFINITY})}})}return i}demuxSampleAes(e,t,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function By(l,e){return de(l.presentationTime)?l.presentationTime/l.timeScale:e+l.presentationTimeDelta/l.timeScale}class lR{constructor(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new pg(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,En.cbc)}decryptAacSample(e,t,i){const s=e[t].unit;if(s.length<=16)return;const r=s.subarray(16,s.length-s.length%16),o=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(o).then(u=>{const d=new Uint8Array(u);s.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,i)})}decryptAacSamples(e,t,i){for(;;t++){if(t>=e.length){i();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,i=new Int8Array(t);let s=0;for(let r=32;r<e.length-16;r+=160,s+=16)i.set(e.subarray(r,r+16),s);return i}getAvcDecryptedUnit(e,t){const i=new Uint8Array(t);let s=0;for(let r=32;r<e.length-16;r+=160,s+=16)e.set(i.subarray(s,s+16),r);return e}decryptAvcSample(e,t,i,s,r){const o=CT(r.data),u=this.getAvcEncryptedData(o);this.decryptBuffer(u.buffer).then(d=>{r.data=this.getAvcDecryptedUnit(o,d),this.decrypter.isSync()||this.decryptAvcSamples(e,t,i+1,s)})}decryptAvcSamples(e,t,i,s){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length){s();return}const r=e[t].units;for(;!(i>=r.length);i++){const o=r[i];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,i,s,o),!this.decrypter.isSync()))return}}}}class mE{constructor(){this.VideoSample=null}createVideoSample(e,t,i){return{key:e,frame:!1,pts:t,dts:i,units:[],length:0}}getLastNalUnit(e){var t;let i=this.VideoSample,s;if((!i||i.units.length===0)&&(i=e[e.length-1]),(t=i)!=null&&t.units){const r=i.units;s=r[r.length-1]}return s}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const i=t.samples,s=i.length;if(s){const r=i[s-1];e.pts=r.pts,e.dts=r.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,i){const s=t.byteLength;let r=e.naluState||0;const o=r,u=[];let d=0,f,h,m,v=-1,y=0;for(r===-1&&(v=0,y=this.getNALuType(t,0),r=0,d=1);d<s;){if(f=t[d++],!r){r=f?0:1;continue}if(r===1){r=f?0:2;continue}if(!f)r=3;else if(f===1){if(h=d-r-1,v>=0){const S={data:t.subarray(v,h),type:y};u.push(S)}else{const S=this.getLastNalUnit(e.samples);S&&(o&&d<=4-o&&S.state&&(S.data=S.data.subarray(0,S.data.byteLength-o)),h>0&&(S.data=Ui(S.data,t.subarray(0,h)),S.state=0))}d<s?(m=this.getNALuType(t,d),v=d,y=m,r=0):r=-1}else r=0}if(v>=0&&r>=0){const S={data:t.subarray(v,s),type:y,state:r};u.push(S)}if(u.length===0){const S=this.getLastNalUnit(e.samples);S&&(S.data=Ui(S.data,t))}return e.naluState=r,u}}class Dl{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,i=e.byteLength-t,s=new Uint8Array(4),r=Math.min(4,t);if(r===0)throw new Error("no bytes available");s.set(e.subarray(i,i+r)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=r*8,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const i=this.word>>>32-t;if(e>32&&Ne.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?i<<t|this.readBits(t):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class Fy extends mE{parsePES(e,t,i,s){const r=this.parseNALu(e,i.data,s);let o=this.VideoSample,u,d=!1;i.data=null,o&&r.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),r.forEach(f=>{var h,m;switch(f.type){case 1:{let E=!1;u=!0;const x=f.data;if(d&&x.length>4){const _=this.readSliceType(x);(_===2||_===4||_===7||_===9)&&(E=!0)}if(E){var v;(v=o)!=null&&v.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.frame=!0,o.key=E;break}case 5:u=!0,(h=o)!=null&&h.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 6:{u=!0,dg(f.data,1,i.pts,t.samples);break}case 7:{var y,S;u=!0,d=!0;const E=f.data,x=this.readSPS(E);if(!e.sps||e.width!==x.width||e.height!==x.height||((y=e.pixelRatio)==null?void 0:y[0])!==x.pixelRatio[0]||((S=e.pixelRatio)==null?void 0:S[1])!==x.pixelRatio[1]){e.width=x.width,e.height=x.height,e.pixelRatio=x.pixelRatio,e.sps=[E];const _=E.subarray(1,4);let R="avc1.";for(let A=0;A<3;A++){let I=_[A].toString(16);I.length<2&&(I="0"+I),R+=I}e.codec=R}break}case 8:u=!0,e.pps=[f.data];break;case 9:u=!0,e.audFound=!0,(m=o)!=null&&m.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:u=!0;break;default:u=!1;break}o&&u&&o.units.push(f)}),s&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new Dl(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let i=8,s=8,r;for(let o=0;o<e;o++)s!==0&&(r=t.readEG(),s=(i+r+256)%256),i=s===0?i:s}readSPS(e){const t=new Dl(e);let i=0,s=0,r=0,o=0,u,d,f;const h=t.readUByte.bind(t),m=t.readBits.bind(t),v=t.readUEG.bind(t),y=t.readBoolean.bind(t),S=t.skipBits.bind(t),E=t.skipEG.bind(t),x=t.skipUEG.bind(t),_=this.skipScalingList.bind(this);h();const R=h();if(m(5),S(3),h(),x(),R===100||R===110||R===122||R===244||R===44||R===83||R===86||R===118||R===128){const M=v();if(M===3&&S(1),x(),x(),S(1),y())for(d=M!==3?8:12,f=0;f<d;f++)y()&&(f<6?_(16,t):_(64,t))}x();const A=v();if(A===0)v();else if(A===1)for(S(1),E(),E(),u=v(),f=0;f<u;f++)E();x(),S(1);const I=v(),D=v(),N=m(1);N===0&&S(1),S(1),y()&&(i=v(),s=v(),r=v(),o=v());let C=[1,1];if(y()&&y())switch(h()){case 1:C=[1,1];break;case 2:C=[12,11];break;case 3:C=[10,11];break;case 4:C=[16,11];break;case 5:C=[40,33];break;case 6:C=[24,11];break;case 7:C=[20,11];break;case 8:C=[32,11];break;case 9:C=[80,33];break;case 10:C=[18,11];break;case 11:C=[15,11];break;case 12:C=[64,33];break;case 13:C=[160,99];break;case 14:C=[4,3];break;case 15:C=[3,2];break;case 16:C=[2,1];break;case 255:{C=[h()<<8|h(),h()<<8|h()];break}}return{width:Math.ceil((I+1)*16-i*2-s*2),height:(2-N)*(D+1)*16-(N?2:4)*(r+o),pixelRatio:C}}}class Uy extends mE{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,i,s){const r=this.parseNALu(e,i.data,s);let o=this.VideoSample,u,d=!1;i.data=null,o&&r.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),r.forEach(f=>{var h,m;switch(f.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),o.frame=!0,u=!0;break;case 16:case 17:case 18:case 21:if(u=!0,d){var v;(v=o)!=null&&v.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 19:case 20:u=!0,(h=o)!=null&&h.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 39:u=!0,dg(f.data,2,i.pts,t.samples);break;case 32:u=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Ge(e.params,this.readVPS(f.data)),this.initVPS=f.data),e.vps=[f.data];break;case 33:if(u=!0,d=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],f.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const y=this.readSPS(f.data);e.width=y.width,e.height=y.height,e.pixelRatio=y.pixelRatio,e.codec=y.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const S in y.params)e.params[S]=y.params[S]}this.pushParameterSet(e.sps,f.data,e.vps),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0;break;case 34:if(u=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const y=this.readPPS(f.data);for(const S in y)e.params[S]=y[S]}this.pushParameterSet(e.pps,f.data,e.vps)}break;case 35:u=!0,e.audFound=!0,(m=o)!=null&&m.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:u=!1;break}o&&u&&o.units.push(f)}),s&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}pushParameterSet(e,t,i){(i&&i[0]===this.initVPS||!i&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let i=0;for(let s=0;s<e.byteLength;s++)s>=2&&e[s]===3&&e[s-1]===0&&e[s-2]===0||(t[i]=e[s],i++);return new Uint8Array(t.buffer,0,i)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new Dl(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const i=t.readBits(3),s=t.readBoolean();return{numTemporalLayers:i+1,temporalIdNested:s}}readSPS(e){const t=new Dl(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const i=t.readBits(3);t.readBoolean();const s=t.readBits(2),r=t.readBoolean(),o=t.readBits(5),u=t.readUByte(),d=t.readUByte(),f=t.readUByte(),h=t.readUByte(),m=t.readUByte(),v=t.readUByte(),y=t.readUByte(),S=t.readUByte(),E=t.readUByte(),x=t.readUByte(),_=t.readUByte(),R=[],A=[];for(let Me=0;Me<i;Me++)R.push(t.readBoolean()),A.push(t.readBoolean());if(i>0)for(let Me=i;Me<8;Me++)t.readBits(2);for(let Me=0;Me<i;Me++)R[Me]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),A[Me]&&t.readUByte();t.readUEG();const I=t.readUEG();I==3&&t.skipBits(1);const D=t.readUEG(),N=t.readUEG(),C=t.readBoolean();let M=0,O=0,P=0,U=0;C&&(M+=t.readUEG(),O+=t.readUEG(),P+=t.readUEG(),U+=t.readUEG());const H=t.readUEG(),se=t.readUEG(),ue=t.readUEG(),te=t.readBoolean();for(let Me=te?0:i;Me<=i;Me++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let Ye=0;Ye<4;Ye++)for(let Vt=0;Vt<(Ye===3?2:6);Vt++)if(!t.readBoolean())t.readUEG();else{const Kt=Math.min(64,1<<4+(Ye<<1));Ye>1&&t.readEG();for(let Gi=0;Gi<Kt;Gi++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const j=t.readUEG();let oe=0;for(let Me=0;Me<j;Me++){let Ye=!1;if(Me!==0&&(Ye=t.readBoolean()),Ye){Me===j&&t.readUEG(),t.readBoolean(),t.readUEG();let Vt=0;for(let Xi=0;Xi<=oe;Xi++){const Kt=t.readBoolean();let Gi=!1;Kt||(Gi=t.readBoolean()),(Kt||Gi)&&Vt++}oe=Vt}else{const Vt=t.readUEG(),Xi=t.readUEG();oe=Vt+Xi;for(let Kt=0;Kt<Vt;Kt++)t.readUEG(),t.readBoolean();for(let Kt=0;Kt<Xi;Kt++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const Me=t.readUEG();for(let Ye=0;Ye<Me;Ye++){for(let Vt=0;Vt<ue+4;Vt++)t.readBits(1);t.readBits(1)}}let $=0,q=1,ne=1,fe=!0,re=1,ce=0;t.readBoolean(),t.readBoolean();let ve=!1;if(t.readBoolean()){if(t.readBoolean()){const ds=t.readUByte(),Ta=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],or=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];ds>0&&ds<16?(q=Ta[ds-1],ne=or[ds-1]):ds===255&&(q=t.readBits(16),ne=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),ve=t.readBoolean(),ve&&(M+=t.readUEG(),O+=t.readUEG(),P+=t.readUEG(),U+=t.readUEG()),t.readBoolean()&&(re=t.readBits(32),ce=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const or=t.readBoolean(),Yl=t.readBoolean();let $i=!1;(or||Yl)&&($i=t.readBoolean(),$i&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),$i&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let Mt=0;Mt<=i;Mt++){fe=t.readBoolean();const Qi=fe||t.readBoolean();let Pt=!1;Qi?t.readEG():Pt=t.readBoolean();const jl=Pt?1:t.readUEG()+1;if(or)for(let An=0;An<jl;An++)t.readUEG(),t.readUEG(),$i&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Yl)for(let An=0;An<jl;An++)t.readUEG(),t.readUEG(),$i&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),$=t.readUEG())}let $e=D,Dt=N;if(C||ve){let Me=1,Ye=1;I===1?Me=Ye=2:I==2&&(Me=2),$e=D-Me*O-Me*M,Dt=N-Ye*U-Ye*P}const Ei=s?["A","B","C"][s]:"",Sa=u<<24|d<<16|f<<8|h;let _n=0;for(let Me=0;Me<32;Me++)_n=(_n|(Sa>>Me&1)<<31-Me)>>>0;let bn=_n.toString(16);return o===1&&bn==="2"&&(bn="6"),{codecString:`hvc1.${Ei}${o}.${bn}.${r?"H":"L"}${_}.B0`,params:{general_tier_flag:r,general_profile_idc:o,general_profile_space:s,general_profile_compatibility_flags:[u,d,f,h],general_constraint_indicator_flags:[m,v,y,S,E,x],general_level_idc:_,bit_depth:H+8,bit_depth_luma_minus8:H,bit_depth_chroma_minus8:se,min_spatial_segmentation_idc:$,chroma_format_idc:I,frame_rate:{fixed:fe,fps:ce/re}},width:$e,height:Dt,pixelRatio:[q,ne]}}readPPS(e){const t=new Dl(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const s=t.readBoolean(),r=t.readBoolean();let o=1;return r&&s?o=0:r?o=3:s&&(o=2),{parallelismType:o}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const At=188;class fn{constructor(e,t,i,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.logger=s,this.videoParser=null}static probe(e,t){const i=fn.syncOffset(e);return i>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),i!==-1}static syncOffset(e){const t=e.length;let i=Math.min(At*5,t-At)+1,s=0;for(;s<i;){let r=!1,o=-1,u=0;for(let d=s;d<t;d+=At)if(e[d]===71&&(t-d===At||e[d+At]===71)){if(u++,o===-1&&(o=d,o!==0&&(i=Math.min(o+At*99,e.length-At)+1)),r||(r=Mh(e,d)===0),r&&u>1&&(o===0&&u>2||d+At>i))return o}else{if(u)return-1;break}s++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:RT[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,i,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=fn.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=fn.createTrack("audio",s),this._id3Track=fn.createTrack("id3"),this._txtTrack=fn.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:i}=this;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,i=!1,s=!1){i||(this.sampleAes=null);let r;const o=this._videoTrack,u=this._audioTrack,d=this._id3Track,f=this._txtTrack;let h=o.pid,m=o.pesData,v=u.pid,y=d.pid,S=u.pesData,E=d.pesData,x=null,_=this.pmtParsed,R=this._pmtId,A=e.length;if(this.remainderData&&(e=Ui(this.remainderData,e),A=e.length,this.remainderData=null),A<At&&!s)return this.remainderData=e,{audioTrack:u,videoTrack:o,id3Track:d,textTrack:f};const I=Math.max(0,fn.syncOffset(e));A-=(A-I)%At,A<e.byteLength&&!s&&(this.remainderData=new Uint8Array(e.buffer,A,e.buffer.byteLength-A));let D=0;for(let C=I;C<A;C+=At)if(e[C]===71){const M=!!(e[C+1]&64),O=Mh(e,C),P=(e[C+3]&48)>>4;let U;if(P>1){if(U=C+5+e[C+4],U===C+At)continue}else U=C+4;switch(O){case h:if(M){if(m&&(r=Wr(m,this.logger))){if(this.videoParser===null)switch(o.segmentCodec){case"avc":this.videoParser=new Fy;break;case"hevc":this.videoParser=new Uy;break}this.videoParser!==null&&this.videoParser.parsePES(o,f,r,!1)}m={data:[],size:0}}m&&(m.data.push(e.subarray(U,C+At)),m.size+=C+At-U);break;case v:if(M){if(S&&(r=Wr(S,this.logger)))switch(u.segmentCodec){case"aac":this.parseAACPES(u,r);break;case"mp3":this.parseMPEGPES(u,r);break;case"ac3":this.parseAC3PES(u,r);break}S={data:[],size:0}}S&&(S.data.push(e.subarray(U,C+At)),S.size+=C+At-U);break;case y:M&&(E&&(r=Wr(E,this.logger))&&this.parseID3PES(d,r),E={data:[],size:0}),E&&(E.data.push(e.subarray(U,C+At)),E.size+=C+At-U);break;case 0:M&&(U+=e[U]+1),R=this._pmtId=oR(e,U);break;case R:{M&&(U+=e[U]+1);const H=uR(e,U,this.typeSupported,i,this.observer,this.logger);h=H.videoPid,h>0&&(o.pid=h,o.segmentCodec=H.segmentVideoCodec),v=H.audioPid,v>0&&(u.pid=v,u.segmentCodec=H.segmentAudioCodec),y=H.id3Pid,y>0&&(d.pid=y),x!==null&&!_&&(this.logger.warn(`MPEG-TS PMT found at ${C} after unknown PID '${x}'. Backtracking to sync byte @${I} to parse all TS packets.`),x=null,C=I-188),_=this.pmtParsed=!0;break}case 17:case 8191:break;default:x=O;break}}else D++;D>0&&Ph(this.observer,new Error(`Found ${D} TS packet/s that do not start with 0x47`),void 0,this.logger),o.pesData=m,u.pesData=S,d.pesData=E;const N={audioTrack:u,videoTrack:o,id3Track:d,textTrack:f};return s&&this.extractRemainingSamples(N),N}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:i,id3Track:s,textTrack:r}=e,o=i.pesData,u=t.pesData,d=s.pesData;let f;if(o&&(f=Wr(o,this.logger))){if(this.videoParser===null)switch(i.segmentCodec){case"avc":this.videoParser=new Fy;break;case"hevc":this.videoParser=new Uy;break}this.videoParser!==null&&(this.videoParser.parsePES(i,r,f,!0),i.pesData=null)}else i.pesData=o;if(u&&(f=Wr(u,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,f);break;case"mp3":this.parseMPEGPES(t,f);break;case"ac3":this.parseAC3PES(t,f);break}t.pesData=null}else u!=null&&u.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=u;d&&(f=Wr(d,this.logger))?(this.parseID3PES(s,f),s.pesData=null):s.pesData=d}demuxSampleAes(e,t,i){const s=this.demux(e,i,!0,!this.config.progressive),r=this.sampleAes=new lR(this.observer,this.config,t);return this.decrypt(s,r)}decrypt(e,t){return new Promise(i=>{const{audioTrack:s,videoTrack:r}=e;s.samples&&s.segmentCodec==="aac"?t.decryptAacSamples(s.samples,0,()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,()=>{i(e)}):i(e)}):r.samples&&t.decryptAvcSamples(r.samples,0,0,()=>{i(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let i=0;const s=this.aacOverFlow;let r=t.data;if(s){this.aacOverFlow=null;const m=s.missing,v=s.sample.unit.byteLength;if(m===-1)r=Ui(s.sample.unit,r);else{const y=v-m;s.sample.unit.set(r.subarray(0,m),y),e.samples.push(s.sample),i=s.missing}}let o,u;for(o=i,u=r.length;o<u-1&&!Wu(r,o);o++);if(o!==i){let m;const v=o<u-1;if(v?m=`AAC PES did not start with ADTS header,offset:${o}`:m="No ADTS header found in AAC PES",Ph(this.observer,new Error(m),v,this.logger),!v)return}nE(e,this.observer,r,o,this.audioCodec);let d;if(t.pts!==void 0)d=t.pts;else if(s){const m=rE(e.samplerate);d=s.sample.pts+m}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let f=0,h;for(;o<u;)if(h=aE(e,r,o,d,f),o+=h.length,h.missing){this.aacOverFlow=h;break}else for(f++;o<u-1&&!Wu(r,o);o++);}parseMPEGPES(e,t){const i=t.data,s=i.length;let r=0,o=0;const u=t.pts;if(u===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<s;)if(fE(i,o)){const d=uE(e,i,o,u,r);if(d)o+=d.length,r++;else break}else o++}parseAC3PES(e,t){{const i=t.data,s=t.pts;if(s===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const r=i.length;let o=0,u=0,d;for(;u<r&&(d=gE(e,i,u,s,o++))>0;)u+=d}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const i=Ge({},t,{type:this._videoTrack?hi.emsg:hi.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(i)}}function Mh(l,e){return((l[e+1]&31)<<8)+l[e+2]}function oR(l,e){return(l[e+10]&31)<<8|l[e+11]}function uR(l,e,t,i,s,r){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},u=(l[e+1]&15)<<8|l[e+2],d=e+3+u-4,f=(l[e+10]&15)<<8|l[e+11];for(e+=12+f;e<d;){const h=Mh(l,e),m=(l[e+3]&15)<<8|l[e+4];switch(l[e]){case 207:if(!i){$d("ADTS AAC",r);break}case 15:o.audioPid===-1&&(o.audioPid=h);break;case 21:o.id3Pid===-1&&(o.id3Pid=h);break;case 219:if(!i){$d("H.264",r);break}case 27:o.videoPid===-1&&(o.videoPid=h);break;case 3:case 4:!t.mpeg&&!t.mp3?r.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=h,o.segmentAudioCodec="mp3");break;case 193:if(!i){$d("AC-3",r);break}case 129:t.ac3?o.audioPid===-1&&(o.audioPid=h,o.segmentAudioCodec="ac3"):r.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&m>0){let v=e+5,y=m;for(;y>2;){switch(l[v]){case 106:t.ac3!==!0?r.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=h,o.segmentAudioCodec="ac3");break}const E=l[v+1]+2;v+=E,y-=E}}break;case 194:case 135:return Ph(s,new Error("Unsupported EC-3 in M2TS found"),void 0,r),o;case 36:o.videoPid===-1&&(o.videoPid=h,o.segmentVideoCodec="hevc",r.log("HEVC in M2TS found"));break}e+=m+5}return o}function Ph(l,e,t,i){i.warn(`parsing error: ${e.message}`),l.emit(b.ERROR,b.ERROR,{type:pe.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function $d(l,e){e.log(`${l} with AES-128-CBC encryption found in unencrypted stream`)}function Wr(l,e){let t=0,i,s,r,o,u;const d=l.data;if(!l||l.size===0)return null;for(;d[0].length<19&&d.length>1;)d[0]=Ui(d[0],d[1]),d.splice(1,1);if(i=d[0],(i[0]<<16)+(i[1]<<8)+i[2]===1){if(s=(i[4]<<8)+i[5],s&&s>l.size-6)return null;const h=i[7];h&192&&(o=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2,h&64?(u=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2,o-u>60*9e4&&(e.warn(`${Math.round((o-u)/9e4)}s delta between PTS and DTS, align them`),o=u)):u=o),r=i[8];let m=r+9;if(l.size<=m)return null;l.size-=m;const v=new Uint8Array(l.size);for(let y=0,S=d.length;y<S;y++){i=d[y];let E=i.byteLength;if(m)if(m>E){m-=E;continue}else i=i.subarray(m),E-=m,m=0;v.set(i,t),t+=E}return s&&(s-=r+3),{data:v,pts:o,dts:u,len:s}}return null}class cR{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const on=Math.pow(2,32)-1;class V{static init(){V.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in V.types)V.types.hasOwnProperty(e)&&(V.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);V.HDLR_TYPES={video:t,audio:i};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);V.STTS=V.STSC=V.STCO=r,V.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),V.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),V.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),V.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),u=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);V.FTYP=V.box(V.types.ftyp,o,d,o,u),V.DINF=V.box(V.types.dinf,V.box(V.types.dref,s))}static box(e,...t){let i=8,s=t.length;const r=s;for(;s--;)i+=t[s].byteLength;const o=new Uint8Array(i);for(o[0]=i>>24&255,o[1]=i>>16&255,o[2]=i>>8&255,o[3]=i&255,o.set(e,4),s=0,i=8;s<r;s++)o.set(t[s],i),i+=t[s].byteLength;return o}static hdlr(e){return V.box(V.types.hdlr,V.HDLR_TYPES[e])}static mdat(e){return V.box(V.types.mdat,e)}static mdhd(e,t){t*=e;const i=Math.floor(t/(on+1)),s=Math.floor(t%(on+1));return V.box(V.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(e){return V.box(V.types.mdia,V.mdhd(e.timescale||0,e.duration||0),V.hdlr(e.type),V.minf(e))}static mfhd(e){return V.box(V.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?V.box(V.types.minf,V.box(V.types.smhd,V.SMHD),V.DINF,V.stbl(e)):V.box(V.types.minf,V.box(V.types.vmhd,V.VMHD),V.DINF,V.stbl(e))}static moof(e,t,i){return V.box(V.types.moof,V.mfhd(e),V.traf(i,t))}static moov(e){let t=e.length;const i=[];for(;t--;)i[t]=V.trak(e[t]);return V.box.apply(null,[V.types.moov,V.mvhd(e[0].timescale||0,e[0].duration||0)].concat(i).concat(V.mvex(e)))}static mvex(e){let t=e.length;const i=[];for(;t--;)i[t]=V.trex(e[t]);return V.box.apply(null,[V.types.mvex,...i])}static mvhd(e,t){t*=e;const i=Math.floor(t/(on+1)),s=Math.floor(t%(on+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return V.box(V.types.mvhd,r)}static sdtp(e){const t=e.samples||[],i=new Uint8Array(4+t.length);let s,r;for(s=0;s<t.length;s++)r=t[s].flags,i[s+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return V.box(V.types.sdtp,i)}static stbl(e){return V.box(V.types.stbl,V.stsd(e),V.box(V.types.stts,V.STTS),V.box(V.types.stsc,V.STSC),V.box(V.types.stsz,V.STSZ),V.box(V.types.stco,V.STCO))}static avc1(e){let t=[],i=[],s,r,o;for(s=0;s<e.sps.length;s++)r=e.sps[s],o=r.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(r));for(s=0;s<e.pps.length;s++)r=e.pps[s],o=r.byteLength,i.push(o>>>8&255),i.push(o&255),i=i.concat(Array.prototype.slice.call(r));const u=V.box(V.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(i))),d=e.width,f=e.height,h=e.pixelRatio[0],m=e.pixelRatio[1];return V.box(V.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,f>>8&255,f&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,V.box(V.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),V.box(V.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,h&255,m>>24,m>>16&255,m>>8&255,m&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return V.box(V.types.mp4a,V.audioStsd(e),V.box(V.types.esds,V.esds(e)))}static mp3(e){return V.box(V.types[".mp3"],V.audioStsd(e))}static ac3(e){return V.box(V.types["ac-3"],V.audioStsd(e),V.box(V.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return V.box(V.types.stsd,V.STSD,V.mp4a(e));if(t==="ac3"&&e.config)return V.box(V.types.stsd,V.STSD,V.ac3(e));if(t==="mp3"&&e.codec==="mp3")return V.box(V.types.stsd,V.STSD,V.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return V.box(V.types.stsd,V.STSD,V.avc1(e));if(t==="hevc"&&e.vps)return V.box(V.types.stsd,V.STSD,V.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,i=(e.duration||0)*(e.timescale||0),s=e.width||0,r=e.height||0,o=Math.floor(i/(on+1)),u=Math.floor(i%(on+1));return V.box(V.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,r>>8&255,r&255,0,0]))}static traf(e,t){const i=V.sdtp(e),s=e.id,r=Math.floor(t/(on+1)),o=Math.floor(t%(on+1));return V.box(V.types.traf,V.box(V.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),V.box(V.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,r&255,o>>24,o>>16&255,o>>8&255,o&255])),V.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,V.box(V.types.trak,V.tkhd(e),V.mdia(e))}static trex(e){const t=e.id;return V.box(V.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const i=e.samples||[],s=i.length,r=12+16*s,o=new Uint8Array(r);let u,d,f,h,m,v;for(t+=8+r,o.set([e.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),u=0;u<s;u++)d=i[u],f=d.duration,h=d.size,m=d.flags,v=d.cts,o.set([f>>>24&255,f>>>16&255,f>>>8&255,f&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,m.isLeading<<2|m.dependsOn,m.isDependedOn<<6|m.hasRedundancy<<4|m.paddingValue<<1|m.isNonSync,m.degradPrio&61440,m.degradPrio&15,v>>>24&255,v>>>16&255,v>>>8&255,v&255],12+16*u);return V.box(V.types.trun,o)}static initSegment(e){V.types||V.init();const t=V.moov(e);return Ui(V.FTYP,t)}static hvc1(e){const t=e.params,i=[e.vps,e.sps,e.pps],s=4,r=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),s-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),i.length]);let o=r.length;for(let S=0;S<i.length;S+=1){o+=3;for(let E=0;E<i[S].length;E+=1)o+=2+i[S][E].length}const u=new Uint8Array(o);u.set(r,0),o=r.length;const d=i.length-1;for(let S=0;S<i.length;S+=1){u.set(new Uint8Array([32+S|(S===d?128:0),0,i[S].length]),o),o+=3;for(let E=0;E<i[S].length;E+=1)u.set(new Uint8Array([i[S][E].length>>8,i[S][E].length&255]),o),o+=2,u.set(i[S][E],o),o+=i[S][E].length}const f=V.box(V.types.hvcC,u),h=e.width,m=e.height,v=e.pixelRatio[0],y=e.pixelRatio[1];return V.box(V.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,m>>8&255,m&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f,V.box(V.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),V.box(V.types.pasp,new Uint8Array([v>>24,v>>16&255,v>>8&255,v&255,y>>24,y>>16&255,y>>8&255,y&255])))}}V.types=void 0;V.HDLR_TYPES=void 0;V.STTS=void 0;V.STSC=void 0;V.STCO=void 0;V.STSZ=void 0;V.VMHD=void 0;V.SMHD=void 0;V.STSD=void 0;V.FTYP=void 0;V.DINF=void 0;const pE=9e4;function Lg(l,e,t=1,i=!1){const s=l*e*t;return i?Math.round(s):s}function fR(l,e,t=1,i=!1){return Lg(l,e,1/t,i)}function Tl(l,e=!1){return Lg(l,1e3,1/pE,e)}function dR(l,e=1){return Lg(l,pE,1/e)}const hR=10*1e3,gR=1024,mR=1152,pR=1536;let Zr=null,zd=null;function Gy(l,e,t,i){return{duration:e,size:t,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:l?2:1,isNonSync:l?0:1}}}class wu extends qi{constructor(e,t,i,s){if(super("mp4-remuxer",s),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.ISGenerated=!1,Zr===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Zr=o?parseInt(o[1]):0}if(zd===null){const r=navigator.userAgent.match(/Safari\/(\d+)/i);zd=r?parseInt(r[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.log("initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const i=e[0].pts,s=e.reduce((r,o)=>{let u=o.pts,d=u-r;return d<-4294967296&&(t=!0,u=Mi(u,i),d=u-r),d>0?r:u},i);return t&&this.debug("PTS rollover detected"),s}remux(e,t,i,s,r,o,u,d){let f,h,m,v,y,S,E=r,x=r;const _=e.pid>-1,R=t.pid>-1,A=t.samples.length,I=e.samples.length>0,D=u&&A>0||A>1;if((!_||I)&&(!R||D)||this.ISGenerated||u){if(this.ISGenerated){var C,M,O,P;const ue=this.videoTrackConfig;(ue&&(t.width!==ue.width||t.height!==ue.height||((C=t.pixelRatio)==null?void 0:C[0])!==((M=ue.pixelRatio)==null?void 0:M[0])||((O=t.pixelRatio)==null?void 0:O[1])!==((P=ue.pixelRatio)==null?void 0:P[1]))||!ue&&D||this.nextAudioTs===null&&I)&&this.resetInitSegment()}this.ISGenerated||(m=this.generateIS(e,t,r,o));const U=this.isVideoContiguous;let H=-1,se;if(D&&(H=vR(t.samples),!U&&this.config.forceKeyFrameOnDiscontinuity))if(S=!0,H>0){this.warn(`Dropped ${H} out of ${A} video samples due to a missing keyframe`);const ue=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(H),t.dropped+=H,x+=(t.samples[0].pts-ue)/t.inputTimeScale,se=x}else H===-1&&(this.warn(`No keyframe found out of ${A} video samples`),S=!1);if(this.ISGenerated){if(I&&D){const ue=this.getVideoStartPts(t.samples),B=(Mi(e.samples[0].pts,ue)-ue)/t.inputTimeScale;E+=Math.max(0,B),x+=Math.max(0,-B)}if(I){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),m=this.generateIS(e,t,r,o)),h=this.remuxAudio(e,E,this.isAudioContiguous,o,R||D||d===ge.AUDIO?x:void 0),D){const ue=h?h.endPTS-h.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),m=this.generateIS(e,t,r,o)),f=this.remuxVideo(t,x,U,ue)}}else D&&(f=this.remuxVideo(t,x,U,0));f&&(f.firstKeyFrame=H,f.independent=H!==-1,f.firstKeyFramePTS=se)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(y=vE(i,r,this._initPTS,this._initDTS)),s.samples.length&&(v=yE(s,r,this._initPTS))),{audio:h,video:f,initSegment:m,independent:S,text:v,id3:y}}generateIS(e,t,i,s){const r=e.samples,o=t.samples,u=this.typeSupported,d={},f=this._initPTS;let h=!f||s,m="audio/mp4",v,y,S,E;if(h&&(v=y=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":u.mpeg?(m="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}d.audio={id:"audio",container:m,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&u.mpeg?new Uint8Array(0):V.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(E=e.id,S=e.inputTimeScale,!f||S!==f.timescale?v=y=r[0].pts-Math.round(S*i):h=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:V.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(E=t.id,S=t.inputTimeScale,!f||S!==f.timescale){const x=this.getVideoStartPts(o),_=Math.round(S*i);y=Math.min(y,Mi(o[0].dts,x)-_),v=Math.min(v,x-_)}else h=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(d).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:v,timescale:S},this._initDTS={baseTime:y,timescale:S}):v=S=void 0,{tracks:d,initPTS:v,timescale:S,trackId:E}}remuxVideo(e,t,i,s){const r=e.inputTimeScale,o=e.samples,u=[],d=o.length,f=this._initPTS,h=f.baseTime*r/f.timescale;let m=this.nextVideoTs,v=8,y=this.videoSampleDuration,S,E,x=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,R=!1;if(!i||m===null){const $=h+t*r,q=o[0].pts-Mi(o[0].dts,o[0].pts);Zr&&m!==null&&Math.abs($-q-(m+h))<15e3?i=!0:m=$-q-h}const A=m+h;for(let $=0;$<d;$++){const q=o[$];q.pts=Mi(q.pts,A),q.dts=Mi(q.dts,A),q.dts<o[$>0?$-1:$].dts&&(R=!0)}R&&o.sort(function($,q){const ne=$.dts-q.dts,fe=$.pts-q.pts;return ne||fe}),S=o[0].dts,E=o[o.length-1].dts;const I=E-S,D=I?Math.round(I/(d-1)):y||e.inputTimeScale/30;if(i){const $=S-A,q=$>D,ne=$<-1;if((q||ne)&&(q?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Tl($,!0)} ms (${$}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Tl(-$,!0)} ms (${$}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!ne||A>=o[0].pts||Zr)){S=A;const fe=o[0].pts-$;if(q)o[0].dts=S,o[0].pts=fe;else{let re=!0;for(let ce=0;ce<o.length&&!(o[ce].dts>fe&&re);ce++){const ve=o[ce].pts;if(o[ce].dts-=$,o[ce].pts-=$,ce<o.length-1){const _e=o[ce+1].pts,$e=o[ce].pts,Dt=_e<=$e,Ei=_e<=ve;re=Dt==Ei}}}this.log(`Video: Initial PTS/DTS adjusted: ${Tl(fe,!0)}/${Tl(S,!0)}, delta: ${Tl($,!0)} ms`)}}S=Math.max(0,S);let N=0,C=0,M=S;for(let $=0;$<d;$++){const q=o[$],ne=q.units,fe=ne.length;let re=0;for(let ce=0;ce<fe;ce++)re+=ne[ce].data.length;C+=re,N+=fe,q.length=re,q.dts<M?(q.dts=M,M+=D/4|0||1):M=q.dts,x=Math.min(q.pts,x),_=Math.max(q.pts,_)}E=o[d-1].dts;const O=C+4*N+8;let P;try{P=new Uint8Array(O)}catch($){this.observer.emit(b.ERROR,b.ERROR,{type:pe.MUX_ERROR,details:X.REMUX_ALLOC_ERROR,fatal:!1,error:$,bytes:O,reason:`fail allocating video mdat ${O}`});return}const U=new DataView(P.buffer);U.setUint32(0,O),P.set(V.types.mdat,4);let H=!1,se=Number.POSITIVE_INFINITY,ue=Number.POSITIVE_INFINITY,te=Number.NEGATIVE_INFINITY,B=Number.NEGATIVE_INFINITY;for(let $=0;$<d;$++){const q=o[$],ne=q.units;let fe=0;for(let ve=0,_e=ne.length;ve<_e;ve++){const $e=ne[ve],Dt=$e.data,Ei=$e.data.byteLength;U.setUint32(v,Ei),v+=4,P.set(Dt,v),v+=Ei,fe+=4+Ei}let re;if($<d-1)y=o[$+1].dts-q.dts,re=o[$+1].pts-q.pts;else{const ve=this.config,_e=$>0?q.dts-o[$-1].dts:D;if(re=$>0?q.pts-o[$-1].pts:D,ve.stretchShortVideoTrack&&this.nextAudioTs!==null){const $e=Math.floor(ve.maxBufferHole*r),Dt=(s?x+s*r:this.nextAudioTs+h)-q.pts;Dt>$e?(y=Dt-_e,y<0?y=_e:H=!0,this.log(`It is approximately ${Dt/90} ms to the next segment; using duration ${y/90} ms for the last video frame.`)):y=_e}else y=_e}const ce=Math.round(q.pts-q.dts);se=Math.min(se,y),te=Math.max(te,y),ue=Math.min(ue,re),B=Math.max(B,re),u.push(Gy(q.key,y,fe,ce))}if(u.length){if(Zr){if(Zr<70){const $=u[0].flags;$.dependsOn=2,$.isNonSync=0}}else if(zd&&B-ue<te-se&&D/te<.025&&u[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let $=S;for(let q=0,ne=u.length;q<ne;q++){const fe=$+u[q].duration,re=$+u[q].cts;if(q<ne-1){const ce=fe+u[q+1].cts;u[q].duration=ce-re}else u[q].duration=q?u[q-1].duration:D;u[q].cts=0,$=fe}}}y=H||!y?D:y;const K=E+y;this.nextVideoTs=m=K-h,this.videoSampleDuration=y,this.isVideoContiguous=!0;const k={data1:V.moof(e.sequenceNumber++,S,Ge(e,{samples:u})),data2:P,startPTS:(x-h)/r,endPTS:(_+y-h)/r,startDTS:(S-h)/r,endDTS:m/r,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:e.dropped};return e.samples=[],e.dropped=0,k}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return mR;case"ac3":return pR;default:return gR}}remuxAudio(e,t,i,s,r){const o=e.inputTimeScale,u=e.samplerate?e.samplerate:o,d=o/u,f=this.getSamplesPerFrame(e),h=f*d,m=this._initPTS,v=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,y=[],S=r!==void 0;let E=e.samples,x=v?0:8,_=this.nextAudioTs||-1;const R=m.baseTime*o/m.timescale,A=R+t*o;if(this.isAudioContiguous=i=i||E.length&&_>0&&(s&&Math.abs(A-(_+R))<9e3||Math.abs(Mi(E[0].pts,A)-(_+R))<20*h),E.forEach(function(B){B.pts=Mi(B.pts,A)}),!i||_<0){if(E=E.filter(B=>B.pts>=0),!E.length)return;r===0?_=0:s&&!S?_=Math.max(0,A-R):_=E[0].pts-R}if(e.segmentCodec==="aac"){const B=this.config.maxAudioFramesDrift;for(let K=0,j=_+R;K<E.length;K++){const oe=E[K],k=oe.pts,$=k-j,q=Math.abs(1e3*$/o);if($<=-B*h&&S)K===0&&(this.warn(`Audio frame @ ${(k/o).toFixed(3)}s overlaps marker by ${Math.round(1e3*$/o)} ms.`),this.nextAudioTs=_=k-R,j=k);else if($>=B*h&&q<hR&&S){let ne=Math.round($/h);for(j=k-ne*h;j<0&&ne&&h;)ne--,j+=h;K===0&&(this.nextAudioTs=_=j-R),this.warn(`Injecting ${ne} audio frames @ ${((j-R)/o).toFixed(3)}s due to ${Math.round(1e3*$/o)} ms gap.`);for(let fe=0;fe<ne;fe++){let re=cR.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);re||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),re=oe.unit.subarray()),E.splice(K,0,{unit:re,pts:j}),j+=h,K++}}oe.pts=j,j+=h}}let I=null,D=null,N,C=0,M=E.length;for(;M--;)C+=E[M].unit.byteLength;for(let B=0,K=E.length;B<K;B++){const j=E[B],oe=j.unit;let k=j.pts;if(D!==null){const q=y[B-1];q.duration=Math.round((k-D)/d)}else if(i&&e.segmentCodec==="aac"&&(k=_+R),I=k,C>0){C+=x;try{N=new Uint8Array(C)}catch(q){this.observer.emit(b.ERROR,b.ERROR,{type:pe.MUX_ERROR,details:X.REMUX_ALLOC_ERROR,fatal:!1,error:q,bytes:C,reason:`fail allocating audio mdat ${C}`});return}v||(new DataView(N.buffer).setUint32(0,C),N.set(V.types.mdat,4))}else return;N.set(oe,x);const $=oe.byteLength;x+=$,y.push(Gy(!0,f,$,0)),D=k}const O=y.length;if(!O)return;const P=y[y.length-1];_=D-R,this.nextAudioTs=_+d*P.duration;const U=v?new Uint8Array(0):V.moof(e.sequenceNumber++,I/d,Ge({},e,{samples:y}));e.samples=[];const H=(I-R)/o,se=_/o,te={data1:U,data2:N,startPTS:H,endPTS:se,startDTS:H,endDTS:se,type:"audio",hasAudio:!0,hasVideo:!1,nb:O};return this.isAudioContiguous=!0,te}}function Mi(l,e){let t;if(e===null)return l;for(e<l?t=-8589934592:t=8589934592;Math.abs(l-e)>4294967296;)l+=t;return l}function vR(l){for(let e=0;e<l.length;e++)if(l[e].key)return e;return-1}function vE(l,e,t,i){const s=l.samples.length;if(!s)return;const r=l.inputTimeScale;for(let u=0;u<s;u++){const d=l.samples[u];d.pts=Mi(d.pts-t.baseTime*r/t.timescale,e*r)/r,d.dts=Mi(d.dts-i.baseTime*r/i.timescale,e*r)/r}const o=l.samples;return l.samples=[],{samples:o}}function yE(l,e,t){const i=l.samples.length;if(!i)return;const s=l.inputTimeScale;for(let o=0;o<i;o++){const u=l.samples[o];u.pts=Mi(u.pts-t.baseTime*s/t.timescale,e*s)/s}l.samples.sort((o,u)=>o.pts-u.pts);const r=l.samples;return l.samples=[],{samples:r}}class yR extends qi{constructor(e,t,i,s){super("passthrough-remuxer",s),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,i,s){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(cA(e,s)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:i}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const s=this.initData=wT(e);s.audio&&(t=$y(s.audio,Qe.AUDIO,this)),s.video&&(i=$y(s.video,Qe.VIDEO,this));const r={};s.audio&&s.video?r.audiovideo={container:"video/mp4",codec:t+","+i,supplemental:s.video.supplemental,initSegment:e,id:"main"}:s.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:s.video?r.video={container:"video/mp4",codec:i,supplemental:s.video.supplemental,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,i,s,r,o){var u,d;let{initPTS:f,lastEndTime:h}=this;const m={audio:void 0,video:void 0,text:s,id3:i,initSegment:void 0};de(h)||(h=this.lastEndTime=r||0);const v=t.samples;if(!(v!=null&&v.length))return m;const y={initPTS:void 0,timescale:void 0,trackId:void 0};let S=this.initData;if((u=S)!=null&&u.length||(this.generateInitSegment(v),S=this.initData),!((d=S)!=null&&d.length))return this.warn("Failed to generate initSegment."),m;this.emitInitSegment&&(y.tracks=this.initTracks,this.emitInitSegment=!1);const E=dA(v,S,this),x=S.audio?E[S.audio.id]:null,_=S.video?E[S.video.id]:null,R=pu(_,1/0),A=pu(x,1/0),I=pu(_,0,!0),D=pu(x,0,!0);let N,C=r,M=0;if(x&&(!_||!f&&A<R||f&&f.trackId===S.audio.id)?(y.trackId=S.audio.id,N=x,M=D-A):_&&(y.trackId=S.video.id,N=_,M=I-R),N){const B=N.timescale;C=N.start/B,y.initPTS=N.start-r*B,y.timescale=B,f||(this.initPTS=f={baseTime:y.initPTS,timescale:B,trackId:y.trackId})}(o||!f)&&(SR(f,C,r,M)||y.timescale!==f.timescale)&&(y.initPTS=C-r,y.timescale=1,f&&f.timescale===1&&this.warn(`Adjusting initPTS @${r} from ${f.baseTime/f.timescale} to ${y.initPTS}`),this.initPTS=f={baseTime:y.initPTS,timescale:1});const O=e?C-f.baseTime/f.timescale:h,P=O+M;M>0?this.lastEndTime=P:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const U=!!S.audio,H=!!S.video;let se="";U&&(se+="audio"),H&&(se+="video");const ue={data1:v,startPTS:O,startDTS:O,endPTS:P,endDTS:P,type:se,hasAudio:U,hasVideo:H,nb:1,dropped:0};m.audio=U&&!H?ue:void 0,m.video=H?ue:void 0;const te=_?.sampleCount;if(te){const B=_.keyFrameIndex,K=B!==-1;ue.nb=te,ue.dropped=B===0||this.isVideoContiguous?0:K?B:te,ue.independent=K,ue.firstKeyFrame=B,K&&_.keyFrameStart&&(ue.firstKeyFramePTS=(_.keyFrameStart-f.baseTime)/f.timescale),this.isVideoContiguous||(m.independent=K),this.isVideoContiguous||(this.isVideoContiguous=K),ue.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${B}/${te} dropped: ${ue.dropped} start: ${ue.firstKeyFramePTS||"NA"}`)}return m.initSegment=y,m.id3=vE(i,r,f,f),s.samples.length&&(m.text=yE(s,r,f)),m}}function pu(l,e,t=!1){return l?.start!==void 0?(l.start+(t?l.duration:0))/l.timescale:e}function SR(l,e,t,i){if(l===null)return!0;const s=Math.max(i,1),r=e-l.baseTime/l.timescale;return Math.abs(r-t)>s}function $y(l,e,t){const i=l?.codec;return i&&i.length>4?i:e===Qe.AUDIO?i==="ec-3"||i==="ac-3"||i==="alac"?i:i==="fLaC"||i==="Opus"?Vu(i,!1):(t.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"):(t.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1")}let Ms;try{Ms=self.performance.now.bind(self.performance)}catch{Ms=Date.now}const Cu=[{demux:aR,remux:yR},{demux:fn,remux:wu},{demux:iR,remux:wu},{demux:nR,remux:wu}];Cu.splice(2,0,{demux:sR,remux:wu});class zy{constructor(e,t,i,s,r,o){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=i,this.id=r,this.logger=o}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,i,s){const r=i.transmuxing;r.executeStart=Ms();let o=new Uint8Array(e);const{currentTransmuxState:u,transmuxConfig:d}=this;s&&(this.currentTransmuxState=s);const{contiguous:f,discontinuity:h,trackSwitch:m,accurateTimeOffset:v,timeOffset:y,initSegmentChange:S}=s||u,{audioCodec:E,videoCodec:x,defaultInitPts:_,duration:R,initSegmentData:A}=d,I=TR(o,t);if(I&&aa(I.method)){const M=this.getDecrypter(),O=yg(I.method);if(M.isSync()){let P=M.softwareDecrypt(o,I.key.buffer,I.iv.buffer,O);if(i.part>-1){const H=M.flush();P=H&&H.buffer}if(!P)return r.executeEnd=Ms(),Hd(i);o=new Uint8Array(P)}else return this.asyncResult=!0,this.decryptionPromise=M.webCryptoDecrypt(o,I.key.buffer,I.iv.buffer,O).then(P=>{const U=this.push(P,null,i);return this.decryptionPromise=null,U}),this.decryptionPromise}const D=this.needsProbing(h,m);if(D){const M=this.configureTransmuxer(o);if(M)return this.logger.warn(`[transmuxer] ${M.message}`),this.observer.emit(b.ERROR,b.ERROR,{type:pe.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!1,error:M,reason:M.message}),r.executeEnd=Ms(),Hd(i)}(h||m||S||D)&&this.resetInitSegment(A,E,x,R,t),(h||S||D)&&this.resetInitialTimestamp(_),f||this.resetContiguity();const N=this.transmux(o,I,y,v,i);this.asyncResult=Hl(N);const C=this.currentTransmuxState;return C.contiguous=!0,C.discontinuity=!1,C.trackSwitch=!1,r.executeEnd=Ms(),N}flush(e){const t=e.transmuxing;t.executeStart=Ms();const{decrypter:i,currentTransmuxState:s,decryptionPromise:r}=this;if(r)return this.asyncResult=!0,r.then(()=>this.flush(e));const o=[],{timeOffset:u}=s;if(i){const m=i.flush();m&&o.push(this.push(m.buffer,null,e))}const{demuxer:d,remuxer:f}=this;if(!d||!f){t.executeEnd=Ms();const m=[Hd(e)];return this.asyncResult?Promise.resolve(m):m}const h=d.flush(u);return Hl(h)?(this.asyncResult=!0,h.then(m=>(this.flushRemux(o,m,e),o))):(this.flushRemux(o,h,e),this.asyncResult?Promise.resolve(o):o)}flushRemux(e,t,i){const{audioTrack:s,videoTrack:r,id3Track:o,textTrack:u}=t,{accurateTimeOffset:d,timeOffset:f}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${this.id===ge.MAIN?"level":"track"} ${i.level}`);const h=this.remuxer.remux(s,r,o,u,f,d,!0,this.id);e.push({remuxResult:h,chunkMeta:i}),i.transmuxing.executeEnd=Ms()}resetInitialTimestamp(e){const{demuxer:t,remuxer:i}=this;!t||!i||(t.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,i,s,r){const{demuxer:o,remuxer:u}=this;!o||!u||(o.resetInitSegment(e,t,i,s),u.resetInitSegment(e,t,i,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,i,s,r){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,i,s,r):o=this.transmuxUnencrypted(e,i,s,r),o}transmuxUnencrypted(e,t,i,s){const{audioTrack:r,videoTrack:o,id3Track:u,textTrack:d}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,o,u,d,t,i,!1,this.id),chunkMeta:s}}transmuxSampleAes(e,t,i,s,r){return this.demuxer.demuxSampleAes(e,t,i).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,i,s,!1,this.id),chunkMeta:r}))}configureTransmuxer(e){const{config:t,observer:i,typeSupported:s}=this;let r;for(let m=0,v=Cu.length;m<v;m++){var o;if((o=Cu[m].demux)!=null&&o.probe(e,this.logger)){r=Cu[m];break}}if(!r)return new Error("Failed to find demuxer by probing fragment data");const u=this.demuxer,d=this.remuxer,f=r.remux,h=r.demux;(!d||!(d instanceof f))&&(this.remuxer=new f(i,t,s,this.logger)),(!u||!(u instanceof h))&&(this.demuxer=new h(i,t,s,this.logger),this.probe=h.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new pg(this.config)),e}}function TR(l,e){let t=null;return l.byteLength>0&&e?.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Hd=l=>({remuxResult:{},chunkMeta:l});function Hl(l){return"then"in l&&l.then instanceof Function}class ER{constructor(e,t,i,s,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=s,this.defaultInitPts=r||null}}class xR{constructor(e,t,i,s,r,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=s,this.timeOffset=r,this.initSegmentChange=o}}let Hy=0;class SE{constructor(e,t,i,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Hy++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=d=>{const f=d.data,h=this.hls;if(!(!h||!(f!=null&&f.event)||f.instanceNo!==this.instanceNo))switch(f.event){case"init":{var m;const v=(m=this.workerContext)==null?void 0:m.objectURL;v&&self.URL.revokeObjectURL(v);break}case"transmuxComplete":{this.handleTransmuxComplete(f.data);break}case"flush":{this.onFlush(f.data);break}case"workerLog":{h.logger[f.data.logType]&&h.logger[f.data.logType](f.data.message);break}default:{f.data=f.data||{},f.data.frag=this.frag,f.data.part=this.part,f.data.id=this.id,h.trigger(f.event,f.data);break}}},this.onWorkerError=d=>{if(!this.hls)return;const f=new Error(`${d.message}  (${d.filename}:${d.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(b.ERROR,{type:pe.OTHER_ERROR,details:X.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:f})};const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=i,this.onFlush=s;const o=(d,f)=>{f=f||{},f.frag=this.frag||void 0,d===b.ERROR&&(f=f,f.parent=this.id,f.part=this.part,this.error=f.error),this.hls.trigger(d,f)};this.observer=new Tg,this.observer.on(b.FRAG_DECRYPTED,o),this.observer.on(b.ERROR,o);const u=ry(r.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const d=this.hls.logger;if(r.workerPath||DL()){try{r.workerPath?(d.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=wL(r.workerPath)):(d.log(`injecting Web Worker for "${t}"`),this.workerContext=IL());const{worker:h}=this.workerContext;h.addEventListener("message",this.onWorkerMessage),h.addEventListener("error",this.onWorkerError),h.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:u,id:t,config:Ze(r)})}catch(h){d.warn(`Error setting up "${t}" Web Worker, fallback to inline`,h),this.terminateWorker(),this.error=null,this.transmuxer=new zy(this.observer,u,r,"",t,e.logger)}return}}this.transmuxer=new zy(this.observer,u,r,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=Hy++;const t=this.hls.config,i=ry(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:i,id:this.id,config:Ze(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),CL(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,i,s,r,o,u,d,f,h){var m,v;f.transmuxing.start=self.performance.now();const{instanceNo:y,transmuxer:S}=this,E=o?o.start:r.start,x=r.decryptdata,_=this.frag,R=!(_&&r.cc===_.cc),A=!(_&&f.level===_.level),I=_?f.sn-_.sn:-1,D=this.part?f.part-this.part.index:-1,N=I===0&&f.id>1&&f.id===_?.stats.chunkCount,C=!A&&(I===1||I===0&&(D===1||N&&D<=0)),M=self.performance.now();(A||I||r.stats.parsing.start===0)&&(r.stats.parsing.start=M),o&&(D||!C)&&(o.stats.parsing.start=M);const O=!(_&&((m=r.initSegment)==null?void 0:m.url)===((v=_.initSegment)==null?void 0:v.url)),P=new xR(R,C,d,A,E,O);if(!C||R||O){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${r.type} sn: ${f.sn}${f.part>-1?" part: "+f.part:""} ${this.id===ge.MAIN?"level":"track"}: ${f.level} id: ${f.id}
        discontinuity: ${R}
        trackSwitch: ${A}
        contiguous: ${C}
        accurateTimeOffset: ${d}
        timeOffset: ${E}
        initSegmentChange: ${O}`);const U=new ER(i,s,t,u,h);this.configureTransmuxer(U)}if(this.frag=r,this.part=o,this.workerContext)this.workerContext.worker.postMessage({instanceNo:y,cmd:"demux",data:e,decryptdata:x,chunkMeta:f,state:P},e instanceof ArrayBuffer?[e]:[]);else if(S){const U=S.push(e,x,f,P);Hl(U)?U.then(H=>{this.handleTransmuxComplete(H)}).catch(H=>{this.transmuxerError(H,f,"transmuxer-interface push error")}):this.handleTransmuxComplete(U)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(i){const s=i.flush(e);Hl(s)?s.then(r=>{this.handleFlushResult(r,e)}).catch(r=>{this.transmuxerError(r,e,"transmuxer-interface flush error")}):this.handleFlushResult(s,e)}}transmuxerError(e,t,i){this.hls&&(this.error=e,this.hls.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,t){e.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):i&&i.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const Vy=100;class _R extends Sg{constructor(e,t,i){super(e,t,i,"audio-stream-controller",ge.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(b.BUFFER_RESET,this.onBufferReset,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(b.FRAG_LOADING,this.onFragLoading,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(b.BUFFER_RESET,this.onBufferReset,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:i,initPTS:s,timescale:r}){if(i===ge.MAIN){const o=t.cc,u=this.fragCurrent;if(this.initPTS[o]={baseTime:s,timescale:r},this.log(`InitPTS for cc: ${o} found from main: ${s}/${r}`),this.mainAnchor=t,this.state===ie.WAITING_INIT_PTS){const d=this.waitingData;(!d&&!this.loadingParts||d&&d.frag.cc!==o)&&this.syncWithAnchor(t,d?.frag)}else!this.hls.hasEnoughToStart&&u&&u.cc!==o?(u.abortRequests(),this.syncWithAnchor(t,u)):this.state===ie.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var i;const s=((i=this.mainFragLoading)==null?void 0:i.frag)||null;if(t&&s?.cc===t.cc)return;const r=(s||e).cc,o=this.getLevelDetails(),u=this.getLoadPosition(),d=UT(o,r,u);d&&(this.log(`Syncing with main frag at ${d.start} cc ${d.cc}`),this.startFragRequested=!1,this.nextLoadPosition=d.start,this.resetLoadingState(),this.state===ie.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=ie.STOPPED;return}const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(Vy),i>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i,this.state=ie.IDLE):this.state=ie.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case ie.IDLE:this.doTickIdle();break;case ie.WAITING_TRACK:{const{levels:t,trackId:i}=this,s=t?.[i],r=s?.details;if(r&&!this.waitForLive(s)){if(this.waitForCdnTuneIn(r))break;this.state=ie.WAITING_INIT_PTS}break}case ie.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),i=this.retryDate;if(!i||t>=i||(e=this.media)!=null&&e.seeking){const{levels:s,trackId:r}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(s?.[r]||null),this.state=ie.IDLE}break}case ie.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:i,part:s,cache:r,complete:o}=t,u=this.mainAnchor;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.state=ie.FRAG_LOADING;const d=r.flush().buffer,f={frag:i,part:s,payload:d,networkDetails:null};this._handleFragmentLoadProgress(f),o&&super._handleFragmentLoadComplete(f)}else u&&u.cc!==t.frag.cc&&this.syncWithAnchor(u,t.frag)}else this.state=ie.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:i,media:s,trackId:r}=this,o=t.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!o.startFragPrefetch)||!(i!=null&&i[r]))return;const u=i[r],d=u.details;if(!d||this.waitForLive(u)||this.waitForCdnTuneIn(d)){this.state=ie.WAITING_TRACK,this.startFragRequested=!1;return}const f=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&f&&(this.bufferFlushed=!1,this.afterBufferFlushed(f,Qe.AUDIO,ge.AUDIO));const h=this.getFwdBufferInfo(f,ge.AUDIO);if(h===null)return;if(!this.switchingTrack&&this._streamEnded(h,d)){t.trigger(b.BUFFER_EOS,{type:"audio"}),this.state=ie.ENDED;return}const m=h.len,v=t.maxBufferLength,y=d.fragments,S=y[0].start,E=this.getLoadPosition(),x=this.flushing?E:h.end;if(this.switchingTrack&&s){const A=E;d.PTSKnown&&A<S&&(h.end>S||h.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=S+.05)}if(m>=v&&!this.switchingTrack&&x<y[y.length-1].start)return;let _=this.getNextFragment(x,d);if(_&&this.isLoopLoading(_,x)&&(_=this.getNextFragmentLoopLoading(_,d,h,ge.MAIN,v)),!_){this.bufferFlushed=!0;return}let R=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&R&&pt(_)&&!_.endList&&(!d.live||!this.loadingParts&&x<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(R)===Tt.OK&&(this.mainFragLoading=R=null),R&&pt(R))){if(_.start>R.end){const I=this.fragmentTracker.getFragAtPos(x,ge.MAIN);I&&I.end>R.end&&(R=I,this.mainFragLoading={frag:I,targetBufferTime:null})}if(_.start>R.end)return}this.loadFragment(_,u,x)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(i=>new Ul(i))}onAudioTrackSwitching(e,t){const i=!!t.url;this.trackId=t.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),i?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==ie.STOPPED&&(this.setInterval(Vy),this.state=ie.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(b.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(e,t){var i;const{levels:s}=this,{details:r,id:o,groupId:u,track:d}=t;if(!s){this.warn(`Audio tracks reset while loading track ${o} "${d.name}" of "${u}"`);return}const f=this.mainDetails;if(!f||r.endCC>f.endCC||f.expired){this.cachedTrackLoadedData=t,this.state!==ie.STOPPED&&(this.state=ie.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${o} "${d.name}" of "${u}" loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const h=s[o];let m=0;if(r.live||(i=h.details)!=null&&i.live){if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;if(h.details){var v;m=this.alignPlaylists(r,h.details,(v=this.levelLastLoaded)==null?void 0:v.details)}r.alignedSliding||(JT(r,f),r.alignedSliding||Qu(r,f),m=r.fragmentStart)}h.details=r,this.levelLastLoaded=h,this.startFragRequested||this.setStartPosition(f,m),this.hls.trigger(b.AUDIO_TRACK_UPDATED,{details:r,id:o,groupId:t.groupId}),this.state===ie.WAITING_TRACK&&!this.waitForCdnTuneIn(r)&&(this.state=ie.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const i=e.frag,{part:s,payload:r}=e,{config:o,trackId:u,levels:d}=this;if(!d){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const f=d[u];if(!f){this.warn("Audio track is undefined on fragment load progress");return}const h=f.details;if(!h){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}const m=o.defaultAudioCodec||f.audioCodec||"mp4a.40.2";let v=this.transmuxer;v||(v=this.transmuxer=new SE(this.hls,ge.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const y=this.initPTS[i.cc],S=(t=i.initSegment)==null?void 0:t.data;if(y!==void 0){const x=s?s.index:-1,_=x!==-1,R=new vg(i.level,i.sn,i.stats.chunkCount,r.byteLength,x,_);v.push(r,S,m,"",i,s,h.totalduration,!1,R,y)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${h.startSN} ,${h.endSN}],track ${u}`);const{cache:E}=this.waitingData=this.waitingData||{frag:i,part:s,cache:new eE,complete:!1};E.push(new Uint8Array(r)),this.state!==ie.STOPPED&&(this.state=ie.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===ge.MAIN&&pt(t.frag)&&(this.mainFragLoading=t,this.state===ie.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:i,part:s}=t;if(i.type!==ge.AUDIO){!this.audioOnly&&i.type===ge.MAIN&&!i.elementaryStreams.video&&!i.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(pt(i)){this.fragPrevious=i;const r=this.switchingTrack;r&&(this.bufferedTrack=r,this.switchingTrack=null,this.hls.trigger(b.AUDIO_TRACK_SWITCHED,Ke({},r)))}this.fragBufferedComplete(i,s),this.media&&this.tick()}onError(e,t){var i;if(t.fatal){this.state=ie.ERROR;return}switch(t.details){case X.FRAG_GAP:case X.FRAG_PARSING_ERROR:case X.FRAG_DECRYPT_ERROR:case X.FRAG_LOAD_ERROR:case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_ERROR:case X.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ge.AUDIO,t);break;case X.AUDIO_TRACK_LOAD_ERROR:case X.AUDIO_TRACK_LOAD_TIMEOUT:case X.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ie.WAITING_TRACK&&((i=t.context)==null?void 0:i.type)===Ie.AUDIO_TRACK&&(this.state=ie.IDLE);break;case X.BUFFER_ADD_CODEC_ERROR:case X.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case X.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case X.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==Qe.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Qe.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===ie.ENDED&&(this.state=ie.IDLE);const i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,t,ge.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const i="audio",{hls:s}=this,{remuxResult:r,chunkMeta:o}=e,u=this.getCurrentContext(o);if(!u){this.resetWhenMissingContext(o);return}const{frag:d,part:f,level:h}=u,{details:m}=h,{audio:v,text:y,id3:S,initSegment:E}=r;if(this.fragContextChanged(d)||!m){this.fragmentTracker.removeFragment(d);return}if(this.state=ie.PARSING,this.switchingTrack&&v&&this.completeAudioSwitch(this.switchingTrack),E!=null&&E.tracks){const x=d.initSegment||d;this._bufferInitSegment(h,E.tracks,x,o),s.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:i,tracks:E.tracks})}if(v){const{startPTS:x,endPTS:_,startDTS:R,endDTS:A}=v;f&&(f.elementaryStreams[Qe.AUDIO]={startPTS:x,endPTS:_,startDTS:R,endDTS:A}),d.setElementaryStreamInfo(Qe.AUDIO,x,_,R,A),this.bufferFragmentData(v,d,f,o)}if(S!=null&&(t=S.samples)!=null&&t.length){const x=Ge({id:i,frag:d,details:m},S);s.trigger(b.FRAG_PARSING_METADATA,x)}if(y){const x=Ge({id:i,frag:d,details:m},y);s.trigger(b.FRAG_PARSING_USERDATA,x)}}_bufferInitSegment(e,t,i,s){if(this.state!==ie.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const r=t.audio;r.id=ge.AUDIO;const o=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${o}/${r.codec}]`),o&&o.split(",").length===1&&(r.levelCodec=o),this.hls.trigger(b.BUFFER_CODECS,t);const u=r.initSegment;if(u!=null&&u.byteLength){const d={type:"audio",frag:i,part:null,chunkMeta:s,parent:i.type,data:u};this.hls.trigger(b.BUFFER_APPENDING,d)}this.tickImmediate()}loadFragment(e,t,i){const s=this.fragmentTracker.getState(e);if(this.switchingTrack||s===Tt.NOT_LOADED||s===Tt.PARTIAL){var r;if(!pt(e))this._loadInitSegment(e,t);else if((r=t.details)!=null&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=ie.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragmentStart!==t.details.fragmentStart&&Qu(t.details,o)}else super.loadFragment(e,t,i)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:i,assocLang:s,characteristics:r,audioCodec:o,channels:u}=this.bufferedTrack;tr({name:t,lang:i,assocLang:s,characteristics:r,audioCodec:o,channels:u},e,qn)||(Yu(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(b.AUDIO_TRACK_SWITCHED,Ke({},e))}}class Rg extends qi{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,i){const s=t?.renditionReports;if(s){let r=-1;for(let o=0;o<s.length;o++){const u=s[o];let d;try{d=new self.URL(u.URI,t.url).href}catch(f){this.warn(`Could not construct new URL for Rendition Report: ${f}`),d=u.URI||""}if(d===e){r=o;break}else d===e.substring(0,d.length)&&(r=o)}if(r!==-1){const o=s[r],u=parseInt(o["LAST-MSN"])||t?.lastPartSn;let d=parseInt(o["LAST-PART"])||t?.lastPartIndex;if(this.hls.config.lowLatencyMode){const h=Math.min(t.age-t.partTarget,t.targetduration);d>=0&&h>t.partTarget&&(d+=1)}const f=i&&ay(i);return new ly(u,d>=0?d:void 0,f)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}return e}playlistLoaded(e,t,i){const{details:s,stats:r}=t,o=self.performance.now(),u=r.loading.first?Math.max(0,o-r.loading.first):0;s.advancedDateTime=Date.now()-u;const d=this.hls.config.timelineOffset;if(d!==s.appliedTimelineOffset){const h=Math.max(d||0,0);s.appliedTimelineOffset=h,s.fragments.forEach(m=>{m.start=m.playlistOffset+h})}if(s.live||i!=null&&i.live){const h="levelInfo"in t?t.levelInfo:t.track;if(s.reloaded(i),i&&s.fragments.length>0){yL(i,s);const R=s.playlistParsingError;if(R){this.warn(R);const A=this.hls;if(!A.config.ignorePlaylistParsingErrors){var f;const{networkDetails:I}=t;A.trigger(b.ERROR,{type:pe.NETWORK_ERROR,details:X.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:R,reason:R.message,level:t.level||void 0,parent:(f=s.fragments[0])==null?void 0:f.type,networkDetails:I,stats:r});return}s.playlistParsingError=null}}s.requestScheduled===-1&&(s.requestScheduled=r.loading.start);const m=this.hls.mainForwardBufferInfo,v=m?m.end-m.len:0,y=(s.edge-v)*1e3,S=qT(s,y);if(s.requestScheduled+S<o?s.requestScheduled=o:s.requestScheduled+=S,this.log(`live playlist ${e} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let E,x,_;if(s.canBlockReload&&s.endSN&&s.advanced){const R=this.hls.config.lowLatencyMode,A=s.lastPartSn,I=s.endSN,D=s.lastPartIndex,N=D!==-1,C=A===I;N?C?(x=I+1,_=R?0:D):(x=A,_=R?D+1:s.maxPartIndex):x=I+1;const M=s.age,O=M+s.ageHeader;let P=Math.min(O-s.partTarget,s.targetduration*1.5);if(P>0){if(O>s.targetduration*3)this.log(`Playlist last advanced ${M.toFixed(2)}s ago. Omitting segment and part directives.`),x=void 0,_=void 0;else if(i!=null&&i.tuneInGoal&&O-s.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${P} with playlist age: ${s.age}`),P=0;else{const U=Math.floor(P/s.targetduration);if(x+=U,_!==void 0){const H=Math.round(P%s.targetduration/s.partTarget);_+=H}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${M.toFixed(2)}s goal: ${P} skip sn ${U} to part ${_}`)}s.tuneInGoal=P}if(E=this.getDeliveryDirectives(s,t.deliveryDirectives,x,_),R||!C){s.requestScheduled=o,this.loadingPlaylist(h,E);return}}else(s.canBlockReload||s.canSkipUntil)&&(E=this.getDeliveryDirectives(s,t.deliveryDirectives,x,_));E&&x!==void 0&&s.canBlockReload&&(s.requestScheduled=r.loading.first+Math.max(S-u*2,S/2)),this.scheduleLoading(h,E,s)}else this.clearTimer()}scheduleLoading(e,t,i){const s=i||e.details;if(!s){this.loadingPlaylist(e,t);return}const r=self.performance.now(),o=s.requestScheduled;if(r>=o){this.loadingPlaylist(e,t);return}const u=o-r;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(u)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),u)}getDeliveryDirectives(e,t,i,s){let r=ay(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,s=t.part,r=Du.No),new ly(i,s,r)}checkRetry(e){const t=e.details,i=ju(e),s=e.errorAction,{action:r,retryCount:o=0,retryConfig:u}=s||{},d=!!s&&!!u&&(r===Ft.RetryRequest||!s.resolved&&r===Ft.SendAlternateToPenaltyBox);if(d){var f;if(o>=u.maxNumRetry)return!1;if(i&&(f=e.context)!=null&&f.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${u.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const h=mg(u,o);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),h),this.warn(`Retrying playlist loading ${o+1}/${u.maxNumRetry} after "${t}" in ${h}ms`)}e.levelRetry=!0,s.resolved=!0}return d}}function TE(l,e){if(l.length!==e.length)return!1;for(let t=0;t<l.length;t++)if(!Vl(l[t].attrs,e[t].attrs))return!1;return!0}function Vl(l,e,t){const i=l["STABLE-RENDITION-ID"];return i&&!t?i===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(s=>l[s]!==e[s])}function kh(l,e){return e.label.toLowerCase()===l.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(l.lang||"").toLowerCase())}class bR extends Rg{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(b.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:i,groupId:s,details:r}=t,o=this.tracksInGroup[i];if(!o||o.groupId!==s){this.warn(`Audio track with id:${i} and group:${s} not found in active group ${o?.groupId}`);return}const u=o.details;o.details=t.details,this.log(`Audio track ${i} "${o.name}" lang:${o.lang} group:${s} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,u)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.audioGroups||null,s=this.groupIds;let r=this.currentTrack;if(!i||s?.length!==i?.length||i!=null&&i.some(u=>s?.indexOf(u)===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const u=this.tracks.filter(v=>!i||i.indexOf(v.groupId)!==-1);if(u.length)this.selectDefaultTrack&&!u.some(v=>v.default)&&(this.selectDefaultTrack=!1),u.forEach((v,y)=>{v.id=y});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=u;const d=this.hls.config.audioPreference;if(!r&&d){const v=os(d,u,qn);if(v>-1)r=u[v];else{const y=os(d,this.tracks);r=this.tracks[y]}}let f=this.findTrackId(r);f===-1&&r&&(f=this.findTrackId(null));const h={audioTracks:u};this.log(`Updating audio tracks, ${u.length} track(s) found in group(s): ${i?.join(",")}`),this.hls.trigger(b.AUDIO_TRACKS_UPDATED,h);const m=this.trackId;if(f!==-1&&m===-1)this.setAudioTrack(f);else if(u.length&&m===-1){var o;const v=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${u.length}`);this.warn(v.message),this.hls.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:v})}}}onError(e,t){t.fatal||!t.context||t.context.type===Ie.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const s=this.currentTrack;if(s&&tr(e,s,qn))return s;const r=os(e,this.tracksInGroup,qn);if(r>-1){const o=this.tracksInGroup[r];return this.setAudioTrack(r),o}else if(s){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const u=BA(e,t.levels,i,o,qn);if(u===-1)return null;t.nextLoadLevel=u}if(e.channels||e.audioCodec){const o=os(e,i);if(o>-1)return i[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,s=t[e],r=s.details&&!s.details.live;if(e===this.trackId&&s===i&&r||(this.log(`Switching to audio-track ${e} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=e,this.currentTrack=s,this.hls.trigger(b.AUDIO_TRACK_SWITCHING,Ke({},s)),r))return;const o=this.switchParams(s.url,i?.details,s.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const s=t[i];if(!(this.selectDefaultTrack&&!s.default)&&(!e||tr(e,s,qn)))return i}if(e){const{name:i,lang:s,assocLang:r,characteristics:o,audioCodec:u,channels:d}=e;for(let f=0;f<t.length;f++){const h=t[f];if(tr({name:i,lang:s,assocLang:r,characteristics:o,audioCodec:u,channels:d},h,qn))return f}for(let f=0;f<t.length;f++){const h=t[f];if(Vl(e.attrs,h.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return f}for(let f=0;f<t.length;f++){const h=t[f];if(Vl(e.attrs,h.attrs,["LANGUAGE"]))return f}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Yu(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=e.id,s=e.groupId,r=this.getUrlWithDirectives(e.url,t),o=e.details,u=o?.age;this.log(`Loading audio-track ${i} "${e.name}" lang:${e.lang} group:${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${u&&o.live?" age "+u.toFixed(1)+(o.type&&" "+o.type||""):""} ${r}`),this.hls.trigger(b.AUDIO_TRACK_LOADING,{url:r,id:i,groupId:s,deliveryDirectives:t||null,track:e})}}class AR{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,i){if(this.queues===null||this.tracks===null)return;const s=this.queues[t];s.push(e),s.length===1&&!i&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const i={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(i,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const i={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(i)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const i=(t=e[0])==null?void 0:t.label;(i==="async-blocker"||i==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const s=t[0];try{s.execute()}catch(r){var i;if(s.onError(r),this.queues===null||this.tracks===null)return;const o=(i=this.tracks[e])==null?void 0:i.buffer;o!=null&&o.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,i;return(t=this.queues)!=null&&t[e]||(i=this.tracks)!=null&&i[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const i=(t=this.tracks)==null?void 0:t[e],s=i?.buffer;return s?`SourceBuffer${s.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(i=>i.label).join(", "))||""}}const Ky=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,EE="HlsJsTrackRemovedError";class LR extends Error{constructor(e){super(e),this.name=EE}}class RR extends qi{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=i=>{var s;this.hls&&((s=this.mediaSource)==null?void 0:s.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=i=>{const{media:s,mediaSource:r}=this;i&&this.log("Media source opened"),!(!s||!r)&&(r.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(b.MEDIA_ATTACHED,{media:s,mediaSource:r}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:i,_objectUrl:s}=this;i!==s&&this.error(`Media element src was set while attaching MediaSource (${s} > ${i})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=eA(Tn(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.BUFFER_RESET,this.onBufferReset,this),e.on(b.BUFFER_APPENDING,this.onBufferAppending,this),e.on(b.BUFFER_CODECS,this.onBufferCodecs,this),e.on(b.BUFFER_EOS,this.onBufferEos,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.FRAG_PARSED,this.onFragParsed,this),e.on(b.FRAG_CHANGED,this.onFragChanged,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.BUFFER_RESET,this.onBufferReset,this),e.off(b.BUFFER_APPENDING,this.onBufferAppending,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.BUFFER_EOS,this.onBufferEos,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.FRAG_PARSED,this.onFragParsed,this),e.off(b.FRAG_CHANGED,this.onFragChanged,this),e.off(b.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const i={};if(this.operationQueue){const r=this.isUpdating();r||this.operationQueue.removeBlockers();const o=this.isQueued();(r||o)&&this.warn(`Transfering MediaSource with${o?" operations in queue":""}${r?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===t?Ge(i,s.tracks):this.sourceBuffers.forEach(r=>{const[o]=r;o&&(i[o]=Ge({},this.tracks[o]),this.removeBuffer(o)),r[0]=r[1]=null}),{media:e,mediaSource:t,tracks:i}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var i;let s=2;(t.audio&&!t.video||!t.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),(i=this.transferData)!=null&&i.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(e,t){const i=this.media=t.media,s=Tn(this.appendSource);if(this.transferData=this.overrides=void 0,i&&s){const r=!!t.mediaSource;(r||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const o=this.mediaSource=t.mediaSource||new s;if(this.assignMediaSource(o),r)this._objectUrl=i.src,this.attachTransferred();else{const u=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{i.removeAttribute("src");const d=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||d&&o instanceof d,Yy(i),DR(i,u),i.load()}catch{i.src=u}else i.src=u}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,i;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(i=e.constructor)==null?void 0:i.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const i=this.tracks,s=t.tracks,r=s?Object.keys(s):null,o=r?r.length:0,u=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(s&&r&&o){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Ze(i,(d,f)=>d==="initSegment"?void 0:f)};
transfer tracks: ${Ze(s,(d,f)=>d==="initSegment"?void 0:f)}}`),!_T(s,i)){t.mediaSource=null,t.tracks=void 0;const d=e.currentTime,f=this.details,h=Math.max(d,f?.fragments[0].start||0);if(h-d>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${d} -> ${h}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(i)}") start time: ${h} currentTime: ${d}`),this.onMediaDetaching(b.MEDIA_DETACHING,{}),this.onMediaAttaching(b.MEDIA_ATTACHING,t),e.currentTime=h;return}this.transferData=void 0,r.forEach(d=>{const f=d,h=s[f];if(h){const m=h.buffer;if(m){const v=this.fragmentTracker,y=h.id;if(v.hasFragments(y)||v.hasParts(y)){const x=be.getBuffered(m);v.detectEvictedFragments(f,x,y,null,!0)}const S=Vd(f),E=[f,m];this.sourceBuffers[S]=E,m.updating&&this.operationQueue&&this.operationQueue.prependBlocker(f),this.trackSourceBuffer(f,h)}}}),u(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),u()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const i=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:s,mediaSource:r,_objectUrl:o}=this;if(r){if(this.log(`media source ${i?"transferring":"detaching"}`),i)this.sourceBuffers.forEach(([u])=>{u&&this.removeBuffer(u)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const u=r.readyState==="open";try{const d=r.sourceBuffers;for(let f=d.length;f--;)u&&d[f].abort(),r.removeSourceBuffer(d[f]);u&&r.endOfStream()}catch(d){this.warn(`onMediaDetaching: ${d.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),i||(o&&self.URL.revokeObjectURL(o),this.mediaSrc===o?(s.removeAttribute("src"),this.appendSource&&Yy(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(b.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const i=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),i)try{var s;(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(r){this.warn(`onBufferReset ${e}`,r)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Vd(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new AR(this.tracks)}onBufferCodecs(e,t){const i=this.tracks,s=Object.keys(t);this.log(`BUFFER_CODECS: "${s}" (current SB count ${this.sourceBufferCount})`);const r="audiovideo"in t&&(i.audio||i.video)||i.audiovideo&&("audio"in t||"video"in t),o=!r&&this.sourceBufferCount&&this.media&&s.some(u=>!i[u]);if(r||o){this.warn(`Unsupported transition between "${Object.keys(i)}" and "${s}" SourceBuffers`);return}s.forEach(u=>{var d,f,h;const m=t[u],{id:v,codec:y,levelCodec:S,container:E,metadata:x,supplemental:_}=m;let R=i[u];const A=(d=this.transferData)==null||(f=d.tracks)==null?void 0:f[u],I=A!=null&&A.buffer?A:R,D=I?.pendingCodec||I?.codec,N=I?.levelCodec;R||(R=i[u]={buffer:void 0,listeners:[],codec:y,supplemental:_,container:E,levelCodec:S,metadata:x,id:v});const C=Ru(D,N),M=C?.replace(Ky,"$1");let O=Ru(y,S);const P=(h=O)==null?void 0:h.replace(Ky,"$1");O&&C&&M!==P&&(u.slice(0,5)==="audio"&&(O=Vu(O,this.appendSource)),this.log(`switching codec ${D} to ${O}`),O!==(R.pendingCodec||R.codec)&&(R.pendingCodec=O),R.container=E,this.appendChangeType(u,E,O))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const i=this.tracks[t];return e[t]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},e},{})}appendChangeType(e,t,i){const s=`${t};codecs=${i}`,r={label:`change-type=${s}`,execute:()=>{const o=this.tracks[e];if(o){const u=o.buffer;u!=null&&u.changeType&&(this.log(`changing ${e} sourceBuffer type to ${s}`),u.changeType(s),o.codec=i,o.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${e} SourceBuffer type`,o)}};this.append(r,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const i=e.start,s=i+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(i,ge.MAIN))==null?void 0:t.gap)===!0)return;const o={label:"block-audio",execute:()=>{var u;const d=this.tracks.video;(this.lastVideoAppendEnd>s||d!=null&&d.buffer&&be.isBuffered(d.buffer,s)||((u=this.fragmentTracker.getAppendedFrag(s,ge.MAIN))==null?void 0:u.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:u=>{this.warn("Error executing block-audio operation",u)}};this.blockedAudioAppend={op:o,frag:e},this.append(o,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:i}=this,{data:s,type:r,parent:o,frag:u,part:d,chunkMeta:f,offset:h}=t,m=f.buffering[r],{sn:v,cc:y}=u,S=self.performance.now();m.start=S;const E=u.stats.buffering,x=d?d.stats.buffering:null;E.start===0&&(E.start=S),x&&x.start===0&&(x.start=S);const _=i.audio;let R=!1;r==="audio"&&_?.container==="audio/mpeg"&&(R=!this.lastMpegAudioChunk||f.id===1||this.lastMpegAudioChunk.sn!==f.sn,this.lastMpegAudioChunk=f);const A=i.video,I=A?.buffer;if(I&&v!=="initSegment"){const C=d||u,M=this.blockedAudioAppend;if(r==="audio"&&o!=="main"&&!this.blockedAudioAppend){const P=C.start+C.duration*.05,U=I.buffered,H=this.currentOp("video");!U.length&&!H?this.blockAudio(C):!H&&!be.isBuffered(I,P)&&this.lastVideoAppendEnd<P&&this.blockAudio(C)}else if(r==="video"){const O=C.end;if(M){const P=M.frag.start;(O>P||O<this.lastVideoAppendEnd||be.isBuffered(I,P))&&this.unblockAudio()}this.lastVideoAppendEnd=O}}const D=(d||u).start,N={label:`append-${r}`,execute:()=>{var C;m.executeStart=self.performance.now();const M=(C=this.tracks[r])==null?void 0:C.buffer;M&&(R?this.updateTimestampOffset(M,D,.1,r,v,y):h!==void 0&&de(h)&&this.updateTimestampOffset(M,h,1e-6,r,v,y)),this.appendExecutor(s,r)},onStart:()=>{},onComplete:()=>{const C=self.performance.now();m.executeEnd=m.end=C,E.first===0&&(E.first=C),x&&x.first===0&&(x.first=C);const M={};this.sourceBuffers.forEach(([O,P])=>{O&&(M[O]=be.getBuffered(P))}),this.appendErrors[r]=0,r==="audio"||r==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(b.BUFFER_APPENDED,{type:r,frag:u,part:d,chunkMeta:f,parent:u.type,timeRanges:M})},onError:C=>{var M;const O={type:pe.MEDIA_ERROR,parent:u.type,details:X.BUFFER_APPEND_ERROR,sourceBufferName:r,frag:u,part:d,chunkMeta:f,error:C,err:C,fatal:!1},P=(M=this.media)==null?void 0:M.error;if(C.code===DOMException.QUOTA_EXCEEDED_ERR||C.name=="QuotaExceededError"||"quota"in C)O.details=X.BUFFER_FULL_ERROR;else if(C.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!P)O.errorAction=Gl(!0);else if(C.name===EE&&this.sourceBufferCount===0)O.errorAction=Gl(!0);else{const U=++this.appendErrors[r];this.warn(`Failed ${U}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${r}" sourceBuffer (${P||"no media error"})`),(U>=this.hls.config.appendErrorMaxRetry||P)&&(O.fatal=!0)}this.hls.trigger(b.ERROR,O)}};this.append(N,r,this.isPending(this.tracks[r]))}getFlushOp(e,t,i){return this.log(`queuing "${e}" remove ${t}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(b.BUFFER_FLUSHED,{type:e})},onError:s=>{this.warn(`Failed to remove ${t}-${i} from "${e}" SourceBuffer`,s)}}}onBufferFlushing(e,t){const{type:i,startOffset:s,endOffset:r}=t;i?this.append(this.getFlushOp(i,s,r),i):this.sourceBuffers.forEach(([o])=>{o&&this.append(this.getFlushOp(o,s,r),o)})}onFragParsed(e,t){const{frag:i,part:s}=t,r=[],o=s?s.elementaryStreams:i.elementaryStreams;o[Qe.AUDIOVIDEO]?r.push("audiovideo"):(o[Qe.AUDIO]&&r.push("audio"),o[Qe.VIDEO]&&r.push("video"));const u=()=>{const d=self.performance.now();i.stats.buffering.end=d,s&&(s.stats.buffering.end=d);const f=s?s.stats:i.stats;this.hls.trigger(b.FRAG_BUFFERED,{frag:i,part:s,stats:f,id:i.type})};r.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(u,r).catch(d=>{this.warn(`Fragment buffered callback ${d}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,i;return e&&(!((t=this.tracks[e])!=null&&t.ended)||((i=this.tracks[e])==null?void 0:i.ending))})}onBufferEos(e,t){var i;this.sourceBuffers.forEach(([o])=>{if(o){const u=this.tracks[o];(!t.type||t.type===o)&&(u.ending=!0,u.ended||(u.ended=!0,this.log(`${o} buffer reached EOS`)))}});const s=((i=this.overrides)==null?void 0:i.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([o])=>{var u;return o&&!((u=this.tracks[o])!=null&&u.ended)})&&(s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:o}=this;if(!o||o.readyState!=="open"){o&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),o.endOfStream(),this.hls.trigger(b.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(b.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===X.BUFFER_APPEND_ERROR&&t.frag){var i;const s=(i=t.errorAction)==null?void 0:i.nextAutoLevel;de(s)&&s!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:i}=this;if(!i||t===null||!this.sourceBufferCount)return;const s=e.config,r=i.currentTime,o=t.levelTargetDuration,u=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(de(u)&&u>=0){const d=Math.max(u,o),f=Math.floor(r/o)*o-d;this.flushBackBuffer(r,o,f)}if(de(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){const d=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),f=Math.max(d,o),h=Math.floor(r/o)*o+f;this.flushFrontBuffer(r,o,h)}}flushBackBuffer(e,t,i){this.sourceBuffers.forEach(([s,r])=>{if(r){const u=be.getBuffered(r);if(u.length>0&&i>u.start(0)){var o;this.hls.trigger(b.BACK_BUFFER_REACHED,{bufferEnd:i});const d=this.tracks[s];if((o=this.details)!=null&&o.live)this.hls.trigger(b.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(d!=null&&d.ended){this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:s})}}})}flushFrontBuffer(e,t,i){this.sourceBuffers.forEach(([s,r])=>{if(r){const o=be.getBuffered(r),u=o.length;if(u<2)return;const d=o.start(u-1),f=o.end(u-1);if(i>d||e>=d&&e<=f)return;this.hls.trigger(b.BUFFER_FLUSHING,{startOffset:d,endOffset:1/0,type:s})}})}getDurationAndRange(){var e;const{details:t,mediaSource:i}=this;if(!t||!this.media||i?.readyState!=="open")return null;const s=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&t.live&&i.setLiveSeekableRange){const f=Math.max(0,t.fragmentStart),h=Math.max(f,s);return{duration:1/0,start:f,end:h}}return{duration:1/0}}const r=(e=this.overrides)==null?void 0:e.duration;if(r)return de(r)?{duration:r}:null;const o=this.media.duration,u=de(i.duration)?i.duration:0;return s>u&&s>o||!de(o)?{duration:s}:null}updateMediaSource({duration:e,start:t,end:i}){const s=this.mediaSource;!this.media||!s||s.readyState!=="open"||(s.duration!==e&&(de(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),s.duration=e),t!==void 0&&i!==void 0&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${t}-${i}.`),s.setLiveSeekableRange(t,i)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${Ze(i)}`),this.tracksReady){var s;const r=(s=this.transferData)==null?void 0:s.tracks;r&&Object.keys(r).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,i])=>{if(t){const s=this.tracks[t];e[t]={buffer:i,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(b.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(const r in e){const o=r,u=e[o];if(this.isPending(u)){const d=this.getTrackCodec(u,o),f=`${u.container};codecs=${d}`;u.codec=d,this.log(`creating sourceBuffer(${f})${this.currentOp(o)?" Queued":""} ${Ze(u)}`);try{const h=i.addSourceBuffer(f),m=Vd(o),v=[o,h];t[m]=v,u.buffer=h}catch(h){var s;this.error(`error while trying to add sourceBuffer: ${h.message}`),this.shiftAndExecuteNext(o),(s=this.operationQueue)==null||s.removeBlockers(),delete this.tracks[o],this.hls.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,sourceBufferName:o,mimeType:f,parent:u.id});return}this.trackSourceBuffer(o,u)}}this.bufferCreated()}getTrackCodec(e,t){const i=e.supplemental;let s=e.codec;i&&(t==="video"||t==="audiovideo")&&Ah(i,"video")&&(s=TA(s,i));const r=Ru(s,e.levelCodec);return r?t.slice(0,5)==="audio"?Vu(r,this.appendSource):r:""}trackSourceBuffer(e,t){const i=t.buffer;if(!i)return;const s=this.getTrackCodec(t,e);this.tracks[e]={buffer:i,codec:s,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(r,o)=>{const u=o.removedRanges;u!=null&&u.length&&this.hls.trigger(b.BUFFER_FLUSHED,{type:r})})}get mediaSrc(){var e,t;const i=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return i?.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const i=this.currentOp(e);i&&(i.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var i;const s=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(i=this.mediaSource)==null?void 0:i.readyState}`);this.error(`${s}`,t),this.hls.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:s,fatal:!1});const r=this.currentOp(e);r&&r.onError(s)}updateTimestampOffset(e,t,i,s,r,o){const u=t-e.timestampOffset;Math.abs(u)>=i&&(this.log(`Updating ${s} SourceBuffer timestampOffset to ${t} (sn: ${r} cc: ${o})`),e.timestampOffset=t)}removeExecutor(e,t,i){const{media:s,mediaSource:r}=this,o=this.tracks[e],u=o?.buffer;if(!s||!r||!u){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const d=de(s.duration)?s.duration:1/0,f=de(r.duration)?r.duration:1/0,h=Math.max(0,t),m=Math.min(i,d,f);m>h&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${h},${m}] from the ${e} SourceBuffer`),u.remove(h,m)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const i=this.tracks[t],s=i?.buffer;if(!s)throw new LR(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,s.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:i}=this,s=t.map(o=>this.appendBlocker(o));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(o=>{i===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var i;const s=(i=this.tracks[t])==null?void 0:i.buffer;!s||s.updating||this.shiftAndExecuteNext(t)})}append(e,t,i){this.operationQueue&&this.operationQueue.append(e,t,i)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,i){const s=this.tracks[e];if(!s)return;const r=s.buffer;if(!r)return;const o=i.bind(this,e);s.listeners.push({event:t,listener:o}),r.addEventListener(t,o)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const i=t.buffer;i&&(t.listeners.forEach(s=>{i.removeEventListener(s.event,s.listener)}),t.listeners.length=0)}}function Yy(l){const e=l.querySelectorAll("source");[].slice.call(e).forEach(t=>{l.removeChild(t)})}function DR(l,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,l.appendChild(t)}function Vd(l){return l==="audio"?1:0}class Dg{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.BUFFER_CODECS,this.onBufferCodecs,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const i=this.hls.levels[t.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&de(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,i=this.getMaxLevel(e.length-1);i!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${i}: ${e[i].height}p@${e[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=i,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const i=t.filter((s,r)=>this.isLevelAllowed(s)&&r<=e);return this.clientRect=null,Dg.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,!t.width&&!t.height&&(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(i=>e.bitrate===i.bitrate&&e.width===i.width&&e.height===i.height)}static getMaxLevelByMediaSize(e,t,i){if(!(e!=null&&e.length))return-1;const s=(u,d)=>d?u.width!==d.width||u.height!==d.height:!0;let r=e.length-1;const o=Math.max(t,i);for(let u=0;u<e.length;u+=1){const d=e[u];if((d.width>=o||d.height>=o)&&s(d,e[u+1])){r=u;break}}return r}}const IR={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},Wt=IR,wR={HLS:"h"},CR=wR,OR="CMCD-Object",MR="CMCD-Request",PR="CMCD-Session",kR="CMCD-Status",_l={OBJECT:OR,REQUEST:MR,SESSION:PR,STATUS:kR},NR={[_l.OBJECT]:["br","ab","d","ot","tb","tpb","lb","tab","lab","url"],[_l.REQUEST]:["pb","bl","tbl","dl","ltc","mtp","nor","nrr","rc","sn","sta","su","ttfb","ttfbb","ttlb","cmsdd","cmsds","smrt","df","cs"],[_l.SESSION]:["cid","pr","sf","sid","st","v","msd"],[_l.STATUS]:["bs","bsd","cdn","rtp","bg","pt","ec","e"]};class ya{constructor(e,t){Array.isArray(e)&&(e=e.map(i=>i instanceof ya?i:new ya(i))),this.value=e,this.params=t}}const BR="Dict";function FR(l){return Array.isArray(l)?JSON.stringify(l):l instanceof Map?"Map{}":l instanceof Set?"Set{}":typeof l=="object"?JSON.stringify(l):String(l)}function UR(l,e,t,i){return new Error(`failed to ${l} "${FR(e)}" as ${t}`,{cause:i})}function fs(l,e,t){return UR("serialize",l,e,t)}class xE{constructor(e){this.description=e}}const jy="Bare Item",GR="Boolean";function $R(l){if(typeof l!="boolean")throw fs(l,GR);return l?"?1":"?0"}function zR(l){return btoa(String.fromCharCode(...l))}const HR="Byte Sequence";function VR(l){if(ArrayBuffer.isView(l)===!1)throw fs(l,HR);return`:${zR(l)}:`}const KR="Integer";function YR(l){return l<-999999999999999||999999999999999<l}function _E(l){if(YR(l))throw fs(l,KR);return l.toString()}function jR(l){return`@${_E(l.getTime()/1e3)}`}function bE(l,e){if(l<0)return-bE(-l,e);const t=Math.pow(10,e);if(Math.abs(l*t%1-.5)<Number.EPSILON){const s=Math.floor(l*t);return(s%2===0?s:s+1)/t}else return Math.round(l*t)/t}const qR="Decimal";function XR(l){const e=bE(l,3);if(Math.floor(Math.abs(e)).toString().length>12)throw fs(l,qR);const t=e.toString();return t.includes(".")?t:`${t}.0`}const QR="String",WR=/[\x00-\x1f\x7f]+/;function ZR(l){if(WR.test(l))throw fs(l,QR);return`"${l.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function JR(l){return l.description||l.toString().slice(7,-1)}const eD="Token";function qy(l){const e=JR(l);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw fs(e,eD);return e}function Nh(l){switch(typeof l){case"number":if(!de(l))throw fs(l,jy);return Number.isInteger(l)?_E(l):XR(l);case"string":return ZR(l);case"symbol":return qy(l);case"boolean":return $R(l);case"object":if(l instanceof Date)return jR(l);if(l instanceof Uint8Array)return VR(l);if(l instanceof xE)return qy(l);default:throw fs(l,jy)}}const tD="Key";function Bh(l){if(/^[a-z*][a-z0-9\-_.*]*$/.test(l)===!1)throw fs(l,tD);return l}function Ig(l){return l==null?"":Object.entries(l).map(([e,t])=>t===!0?`;${Bh(e)}`:`;${Bh(e)}=${Nh(t)}`).join("")}function AE(l){return l instanceof ya?`${Nh(l.value)}${Ig(l.params)}`:Nh(l)}function iD(l){return`(${l.value.map(AE).join(" ")})${Ig(l.params)}`}function sD(l,e={whitespace:!0}){if(typeof l!="object")throw fs(l,BR);const t=l instanceof Map?l.entries():Object.entries(l),i=e?.whitespace?" ":"";return Array.from(t).map(([s,r])=>{r instanceof ya||(r=new ya(r));let o=Bh(s);return r.value===!0?o+=Ig(r.params):(o+="=",Array.isArray(r.value)?o+=iD(r):o+=AE(r)),o}).join(`,${i}`)}function nD(l,e){return sD(l,e)}function rD(l){return["ot","sf","st","e","sta"].includes(l)}function aD(l){return typeof l=="number"?de(l):l!=null&&l!==""&&l!==!1}function lD(l,e){const t=new URL(l),i=new URL(e);if(t.origin!==i.origin)return l;const s=t.pathname.split("/").slice(1),r=i.pathname.split("/").slice(1,-1);for(;s[0]===r[0];)s.shift(),r.shift();for(;r.length;)r.shift(),s.unshift("..");return s.join("/")}const Ou=l=>Math.round(l),oD=(l,e)=>(e?.baseUrl&&(l=lD(l,e.baseUrl)),encodeURIComponent(l)),vu=l=>Ou(l/100)*100,uD={br:Ou,d:Ou,bl:vu,dl:vu,mtp:vu,nor:oD,rtp:vu,tb:Ou};function cD(l,e){const t={};if(l==null||typeof l!="object")return t;const i=Object.keys(l).sort(),s=Ge({},uD,e?.formatters),r=e?.filter;return i.forEach(o=>{if(r?.(o)===!1)return;let u=l[o];const d=s[o];d&&(u=d(u,e)),!(o==="v"&&u===1)&&(o=="pr"&&u===1||aD(u)&&(rD(o)&&typeof u=="string"&&(u=new xE(u)),t[o]=u))}),t}function LE(l,e={}){return l?nD(cD(l,e),Ge({whitespace:!1},e)):""}function fD(l,e={}){const t={};if(!l)return t;const i=Object.entries(l),s=Object.entries(NR).concat(Object.entries(e?.customHeaderMap||{})),r=i.reduce((o,u)=>{var d,f;const[h,m]=u,v=((d=s.find(y=>y[1].includes(h)))===null||d===void 0?void 0:d[0])||_l.REQUEST;return(f=o[v])!==null&&f!==void 0||(o[v]={}),o[v][h]=m,o},{});return Object.entries(r).reduce((o,[u,d])=>(o[u]=LE(d,e),o),t)}function dD(l,e,t){return Ge(l,fD(e,t))}const hD="CMCD";function gD(l,e={}){if(!l)return"";const t=LE(l,e);return`${hD}=${encodeURIComponent(t)}`}const Xy=/CMCD=[^&#]+/;function mD(l,e,t){const i=gD(e,t);if(!i)return l;if(Xy.test(l))return l.replace(Xy,i);const s=l.includes("?")?"&":"?";return`${l}${s}${i}`}class pD{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:Wt.MANIFEST,su:!this.initialized})}catch(r){this.hls.logger.warn("Could not generate manifest CMCD data.",r)}},this.applyFragmentData=s=>{try{const{frag:r,part:o}=s,u=this.hls.levels[r.level],d=this.getObjectType(r),f={d:(o||r).duration*1e3,ot:d};(d===Wt.VIDEO||d===Wt.AUDIO||d==Wt.MUXED)&&(f.br=u.bitrate/1e3,f.tb=this.getTopBandwidth(d)/1e3,f.bl=this.getBufferLength(d));const h=o?this.getNextPart(o):this.getNextFrag(r);h!=null&&h.url&&h.url!==r.url&&(f.nor=h.url),this.apply(s,f)}catch(r){this.hls.logger.warn("Could not generate segment CMCD data.",r)}},this.hls=e;const t=this.config=e.config,{cmcd:i}=t;i!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||e.sessionId,this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHED,this.onMediaDetached,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHED,this.onMediaDetached,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var i,s;this.audioBuffer=(i=t.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(s=t.tracks.video)==null?void 0:s.buffer}createData(){var e;return{v:1,sf:CR.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Ge(t,this.createData());const i=t.ot===Wt.INIT||t.ot===Wt.VIDEO||t.ot===Wt.MUXED;this.starved&&i&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:s}=this;s&&(t=Object.keys(t).reduce((o,u)=>(s.includes(u)&&(o[u]=t[u]),o),{}));const r={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),dD(e.headers,t,r)):e.url=mD(e.url,t,r)}getNextFrag(e){var t;const i=(t=this.hls.levels[e.level])==null?void 0:t.details;if(i){const s=e.sn-i.startSN;return i.fragments[s+1]}}getNextPart(e){var t,i;const{index:s,fragment:r}=e,o=(t=this.hls.levels[r.level])==null||(i=t.details)==null?void 0:i.partList;if(o){const{sn:u}=r;for(let d=o.length-1;d>=0;d--){const f=o[d];if(f.index===s&&f.fragment.sn===u)return o[d+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Wt.TIMED_TEXT;if(e.sn==="initSegment")return Wt.INIT;if(t==="audio")return Wt.AUDIO;if(t==="main")return this.hls.audioTracks.length?Wt.VIDEO:Wt.MUXED}getTopBandwidth(e){let t=0,i;const s=this.hls;if(e===Wt.AUDIO)i=s.audioTracks;else{const r=s.maxAutoLevel,o=r>-1?r+1:s.levels.length;i=s.levels.slice(0,o)}return i.forEach(r=>{r.bitrate>t&&(t=r.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,i=e===Wt.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!t?NaN:be.bufferInfo(i,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,i=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new i(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,o,u){t(r),this.loader.load(r,o,u)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,i=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new i(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,o,u){t(r),this.loader.load(r,o,u)}}}}const vD=3e5;class yD extends qi{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(i=>i!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:i}=t;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:i}=t;if(i?.action===Ft.SendAlternateToPenaltyBox&&i.flags===Yi.MoveAllAlternatesMatchingHost){const s=this.levels;let r=this._pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:u,pathwayId:d,type:f}=t.context;u&&s?o=this.getPathwayForGroupId(u,f,o):d&&(o=d)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!r&&s&&(r=this.pathways()),r&&r.length>1&&(this.updatePathwayPriority(r),i.resolved=this.pathwayId!==o),t.details===X.BUFFER_APPEND_ERROR&&!t.fatal?i.resolved=!0:i.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${s&&s.length} priorities: ${Ze(r)} penalized: ${Ze(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),t=this.getLevelsForPathway(i),this.pathwayId=i}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const i=this.penalizedPathways,s=performance.now();Object.keys(i).forEach(r=>{s-i[r]>vD&&delete i[r]});for(let r=0;r<e.length;r++){const o=e[r];if(o in i)continue;if(o===this.pathwayId)return;const u=this.hls.nextLoadLevel,d=this.hls.levels[u];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,WT(t),this.hls.trigger(b.LEVELS_UPDATED,{levels:t});const f=this.hls.levels[u];d&&f&&this.levels&&(f.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&f.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${f.bitrate}`),this.hls.nextLoadLevel=u);break}}}getPathwayForGroupId(e,t,i){const s=this.getLevelsForPathway(i).concat(this.levels||[]);for(let r=0;r<s.length;r++)if(t===Ie.AUDIO_TRACK&&s[r].hasAudioGroup(e)||t===Ie.SUBTITLE_TRACK&&s[r].hasSubtitleGroup(e))return s[r].pathwayId;return i}clonePathways(e){const t=this.levels;if(!t)return;const i={},s={};e.forEach(r=>{const{ID:o,"BASE-ID":u,"URI-REPLACEMENT":d}=r;if(t.some(h=>h.pathwayId===o))return;const f=this.getLevelsForPathway(u).map(h=>{const m=new it(h.attrs);m["PATHWAY-ID"]=o;const v=m.AUDIO&&`${m.AUDIO}_clone_${o}`,y=m.SUBTITLES&&`${m.SUBTITLES}_clone_${o}`;v&&(i[m.AUDIO]=v,m.AUDIO=v),y&&(s[m.SUBTITLES]=y,m.SUBTITLES=y);const S=RE(h.uri,m["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d),E=new Ul({attrs:m,audioCodec:h.audioCodec,bitrate:h.bitrate,height:h.height,name:h.name,url:S,videoCodec:h.videoCodec,width:h.width});if(h.audioGroups)for(let x=1;x<h.audioGroups.length;x++)E.addGroupId("audio",`${h.audioGroups[x]}_clone_${o}`);if(h.subtitleGroups)for(let x=1;x<h.subtitleGroups.length;x++)E.addGroupId("text",`${h.subtitleGroups[x]}_clone_${o}`);return E});t.push(...f),Qy(this.audioTracks,i,d,o),Qy(this.subtitleTracks,s,d,o)})}loadSteeringManifest(e){const t=this.hls.config,i=t.loader;this.loader&&this.loader.destroy(),this.loader=new i(t);let s;try{s=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(s.protocol!=="data:"){const h=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+h)}const r={responseType:"json",url:s.href},o=t.steeringManifestLoadPolicy.default,u=o.errorRetry||o.timeoutRetry||{},d={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:u.maxNumRetry||0,retryDelay:u.retryDelayMs||0,maxRetryDelay:u.maxRetryDelayMs||0},f={onSuccess:(h,m,v,y)=>{this.log(`Loaded steering manifest: "${s}"`);const S=h.data;if(S?.VERSION!==1){this.log(`Steering VERSION ${S.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=S.TTL;const{"RELOAD-URI":E,"PATHWAY-CLONES":x,"PATHWAY-PRIORITY":_}=S;if(E)try{this.uri=new self.URL(E,s).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${E}`);return}this.scheduleRefresh(this.uri||v.url),x&&this.clonePathways(x);const R={steeringManifest:S,url:s.toString()};this.hls.trigger(b.STEERING_MANIFEST_LOADED,R),_&&this.updatePathwayPriority(_)},onError:(h,m,v,y)=>{if(this.log(`Error loading steering manifest: ${h.code} ${h.text} (${m.url})`),this.stopLoad(),h.code===410){this.enabled=!1,this.log(`Steering manifest ${m.url} no longer available`);return}let S=this.timeToLoad*1e3;if(h.code===429){const E=this.loader;if(typeof E?.getResponseHeader=="function"){const x=E.getResponseHeader("Retry-After");x&&(S=parseFloat(x)*1e3)}this.log(`Steering manifest ${m.url} rate limited`);return}this.scheduleRefresh(this.uri||m.url,S)},onTimeout:(h,m,v)=>{this.log(`Timeout loading steering manifest (${m.url})`),this.scheduleRefresh(this.uri||m.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(r,d,f)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;const s=(i=this.hls)==null?void 0:i.media;if(s&&!s.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function Qy(l,e,t,i){l&&Object.keys(e).forEach(s=>{const r=l.filter(o=>o.groupId===s).map(o=>{const u=Ge({},o);return u.details=void 0,u.attrs=new it(u.attrs),u.url=u.attrs.URI=RE(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),u.groupId=u.attrs["GROUP-ID"]=e[s],u.attrs["PATHWAY-ID"]=i,u});l.push(...r)})}function RE(l,e,t,i){const{HOST:s,PARAMS:r,[t]:o}=i;let u;e&&(u=o?.[e],u&&(l=u));const d=new self.URL(l);return s&&!u&&(d.host=s),r&&Object.keys(r).sort().forEach(f=>{f&&d.searchParams.set(f,r[f])}),d.href}function Fi(l,e,t){ji(l,e,t),l.addEventListener(e,t)}function ji(l,e,t){l.removeEventListener(e,t)}class la extends qi{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=la.CDMCleanupPromise?[la.CDMCleanupPromise]:[],this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onWaitingForKey=null}registerListeners(){this.hls.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(b.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(b.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:i}=this.config,s=t[e];if(s)return s.licenseUrl;if(e===ft.WIDEVINE&&i)return i}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,i=t[e];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,i=(o,u,d)=>!!o&&d.indexOf(o)===u,s=t.map(o=>o.audioCodec).filter(i),r=t.map(o=>o.videoCodec).filter(i);return s.length+r.length===0&&r.push("avc1.42e01e"),new Promise((o,u)=>{const d=f=>{const h=f.shift();this.getMediaKeysPromise(h,s,r).then(m=>o({keySystem:h,mediaKeys:m})).catch(m=>{f.length?d(f):m instanceof Ci?u(m):u(new Ci({type:pe.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_ACCESS,error:m,fatal:!0},m.message))})};d(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${i}`;return VT===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return i(e,t)}getMediaKeysPromise(e,t,i){const s=uL(e,t,i,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let o=r?.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${Ze(s)}`),o=this.requestMediaKeySystemAccess(e,s);const u=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),o.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const f=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),u.mediaKeys=d.createMediaKeys().then(h=>(this.log(`Media-keys created for "${e}"`),u.hasMediaKeys=!0,f.then(m=>m?this.setMediaKeysServerCertificate(h,e,m):h))),u.mediaKeys.catch(h=>{this.error(`Failed to create media-keys for "${e}"}: ${h}`)}),u.mediaKeys})}return o.then(()=>r.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:i}){this.log(`Creating key-system session "${t}" keyId: ${Xn.hexDump(e.keyId||[])}`);const s=i.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:i,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const i=this.createMediaKeySessionContext(e),s=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(i,r,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Xn.hexDump(e.keyId)}updateKeySession(e,t){var i;const s=e.mediaKeysSession;return this.log(`Updating key-session "${s.sessionId}" for keyID ${Xn.hexDump(((i=e.decryptdata)==null?void 0:i.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),s.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>xy(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:i})=>this.attemptSetMediaKeys(t,i))}selectKeySystem(e){return new Promise((t,i)=>this.getKeySystemSelectionPromise(e).then(({keySystem:s})=>{const r=xy(s);r?t(r):i(new Error(`Unable to find format for key-system "${s}"`))}).catch(i))}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Iu(this.config),i=e.map(wh).filter(s=>!!s&&t.indexOf(s)!==-1);return this.selectKeySystem(i)}loadKey(e){const t=e.keyInfo.decryptdata,i=this.getKeyIdString(t),s=`(keyId: ${i} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${s}`);let r=this.keyIdToKeySessionPromise[i];return r||(r=this.getKeySystemForKeyPromise(t).then(({keySystem:u,mediaKeys:d})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${s}`),this.attemptSetMediaKeys(u,d).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:u,mediaKeys:d,decryptdata:t}))))),(this.keyIdToKeySessionPromise[i]=r.then(u=>{const d="cenc",f=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(u,d,f,"playlist-key")})).catch(u=>this.handleError(u))),r}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Ci?this.hls.trigger(b.ERROR,e.data):this.hls.trigger(b.ERROR,{type:pe.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),i=this.keyIdToKeySessionPromise[t];if(!i){const s=wh(e.keyFormat),r=s?[s]:Iu(this.config);return this.attemptKeySystemAccess(r)}return i}getKeySystemSelectionPromise(e){if(e.length||(e=Iu(this.config)),e.length===0)throw new Ci({type:pe.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Ze({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(i).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${e}"`),i.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(r=>i.indexOf(r)===-1)})}generateRequestWithPreferredKeySession(e,t,i,s){var r,o;const u=(r=this.config.drmSystems)==null||(o=r[e.keySystem])==null?void 0:o.generateRequest;if(u)try{const S=u.call(this.hls,t,i,e);if(!S)throw new Error("Invalid response from configured generateRequest filter");t=S.initDataType,i=S.initData?S.initData:null,e.decryptdata.pssh=i?new Uint8Array(i):null}catch(S){var d;if(this.warn(S.message),(d=this.hls)!=null&&d.config.debug)throw S}if(i===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const f=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${s}": ${f} (init data type: ${t} length: ${i?i.byteLength:null})`);const h=new Tg,m=e._onmessage=S=>{const E=e.mediaKeysSession;if(!E){h.emit("error",new Error("invalid state"));return}const{messageType:x,message:_}=S;this.log(`"${x}" message event for session "${E.sessionId}" message size: ${_.byteLength}`),x==="license-request"||x==="license-renewal"?this.renewLicense(e,_).catch(R=>{h.eventNames().length?h.emit("error",R):this.handleError(R)}):x==="license-release"?e.keySystem===ft.FAIRPLAY&&(this.updateKeySession(e,Ih("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${x}"`)},v=e._onkeystatuseschange=S=>{if(!e.mediaKeysSession){h.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const x=e.keyStatus;h.emit("keyStatus",x),x==="expired"&&(this.warn(`${e.keySystem} expired for key ${f}`),this.renewKeySession(e))};Fi(e.mediaKeysSession,"message",m),Fi(e.mediaKeysSession,"keystatuseschange",v);const y=new Promise((S,E)=>{h.on("error",E),h.on("keyStatus",x=>{x.startsWith("usable")?S():x==="output-restricted"?E(new Ci({type:pe.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):x==="internal-error"?E(new Ci({type:pe.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${x}"`)):x==="expired"?E(new Error("key expired while generating request")):this.warn(`unhandled key status change "${x}"`)})});return e.mediaKeysSession.generateRequest(t,i).then(()=>{var S;this.log(`Request generated for key-session "${(S=e.mediaKeysSession)==null?void 0:S.sessionId}" keyId: ${f}`)}).catch(S=>{throw new Ci({type:pe.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_SESSION,error:S,fatal:!1},`Error generating key-session request: ${S}`)}).then(()=>y).catch(S=>{throw h.removeAllListeners(),this.removeSession(e),S}).then(()=>(h.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,i)=>{if(typeof i=="string"&&typeof t=="object"){const s=i;i=t,t=s}this.log(`key status change "${t}" for keyStatuses keyId: ${Xn.hexDump("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))} session keyId: ${Xn.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,i=t.loader,s=new i(t),r=this.getServerCertificateUrl(e);return r?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,u)=>{const d={responseType:"arraybuffer",url:r},f=t.certLoadPolicy.default,h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(v,y,S,E)=>{o(v.data)},onError:(v,y,S,E)=>{u(new Ci({type:pe.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:S,response:Ke({url:d.url,data:void 0},v)},`"${e}" certificate request failed (${r}). Status: ${v.code} (${v.text})`))},onTimeout:(v,y,S)=>{u(new Ci({type:pe.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:S,response:{url:d.url,data:void 0}},`"${e}" certificate request timed out (${r})`))},onAbort:(v,y,S)=>{u(new Error("aborted"))}};s.load(d,h,m)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,i){return new Promise((s,r)=>{e.setServerCertificate(i).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${i?.byteLength}) on "${t}"`),s(e)}).catch(o=>{r(new Ci({type:pe.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(i=>this.updateKeySession(e,new Uint8Array(i)).catch(s=>{throw new Ci({type:pe.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:s,fatal:!0},s.message)}))}unpackPlayReadyKeyMessage(e,t){const i=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!i.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const s=new DOMParser().parseFromString(i,"application/xml"),r=s.querySelectorAll("HttpHeader");if(r.length>0){let h;for(let m=0,v=r.length;m<v;m++){var o,u;h=r[m];const y=(o=h.querySelector("name"))==null?void 0:o.textContent,S=(u=h.querySelector("value"))==null?void 0:u.textContent;y&&S&&e.setRequestHeader(y,S)}}const d=s.querySelector("Challenge"),f=d?.textContent;if(!f)throw new Error("Cannot find <Challenge> in key message");return Ih(atob(f))}setupLicenseXHR(e,t,i,s){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,i,s)}).catch(o=>{if(!i.decryptdata)throw o;return e.open("POST",t,!0),r.call(this.hls,e,t,i,s)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||s})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,t){const i=this.config.keyLoadPolicy.default;return new Promise((s,r)=>{const o=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${o}`);const u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(u.readyState===4)if(u.status===200){this._requestLicenseFailureCount=0;let d=u.response;this.log(`License received ${d instanceof ArrayBuffer?d.byteLength:d}`);const f=this.config.licenseResponseCallback;if(f)try{d=f.call(this.hls,u,o,e)}catch(h){this.error(h)}s(d)}else{const d=i.errorRetry,f=d?d.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>f||u.status>=400&&u.status<500)r(new Ci({type:pe.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:u,response:{url:o,data:void 0,code:u.status,text:u.statusText}},`License Request XHR failed (${o}). Status: ${u.status} (${u.statusText})`));else{const h=f-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${h} attempts left`),this.requestLicense(e,t).then(s,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=u,this.setupLicenseXHR(u,o,e,t).then(({xhr:d,licenseChallenge:f})=>{e.keySystem==ft.PLAYREADY&&(f=this.unpackPlayReadyKeyMessage(d,f)),d.send(f)})})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const i=t.media;this.media=i,Fi(i,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(ji(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,i=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,rc.clearKeyUriToKeyIdMap();const s=i.length;la.CDMCleanupPromise=Promise.all(i.map(r=>this.removeSession(r)).concat(t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(r=>{var o;this.log(`Could not clear media keys: ${r}`),(o=this.hls)==null||o.trigger(b.ERROR,{type:pe.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${r}`)})}))).catch(r=>{var o;this.log(`Could not close sessions and clear media keys: ${r}`),(o=this.hls)==null||o.trigger(b.ERROR,{type:pe.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${r}`)})}).then(()=>{s&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const i=t.reduce((s,r)=>(s.indexOf(r.keyFormat)===-1&&s.push(r.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:i}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const s=this.mediaKeySessions.indexOf(e);s>-1&&this.mediaKeySessions.splice(s,1);const{drmSystemOptions:r}=this.config;return(fL(r)?new Promise((u,d)=>{self.setTimeout(()=>d(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(u)}):Promise.resolve()).catch(u=>{var d;this.log(`Could not remove session: ${u}`),(d=this.hls)==null||d.trigger(b.ERROR,{type:pe.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${u}`)})}).then(()=>t.close()).catch(u=>{var d;this.log(`Could not close session: ${u}`),(d=this.hls)==null||d.trigger(b.ERROR,{type:pe.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${u}`)})})}}}la.CDMCleanupPromise=void 0;class Ci extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class SD{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(b.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(b.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const i=this.hls.config;if(i.capLevelOnFPSDrop){const s=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,i){const s=performance.now();if(t){if(this.lastTime){const r=s-this.lastTime,o=i-this.lastDroppedFrames,u=t-this.lastDecodedFrames,d=1e3*o/r,f=this.hls;if(f.trigger(b.FPS_DROP,{currentDropped:o,currentDecoded:u,totalDroppedFrames:i}),d>0&&o>f.config.fpsDroppedMonitoringThreshold*u){let h=f.currentLevel;f.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(f.autoLevelCapping===-1||f.autoLevelCapping>=h)&&(h=h-1,f.trigger(b.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:f.currentLevel}),f.autoLevelCapping=h,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function DE(l,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=l,e.dispatchEvent(t)}function IE(l,e){const t=l.mode;if(t==="disabled"&&(l.mode="hidden"),l.cues&&!l.cues.getCueById(e.id))try{if(l.addCue(e),!l.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(i){Ne.debug(`[texttrack-utils]: ${i}`);try{const s=new self.TextTrackCue(e.startTime,e.endTime,e.text);s.id=e.id,l.addCue(s)}catch(s){Ne.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${s}`)}}t==="disabled"&&(l.mode=t)}function ia(l,e){const t=l.mode;if(t==="disabled"&&(l.mode="hidden"),l.cues)for(let i=l.cues.length;i--;)e&&l.cues[i].removeEventListener("enter",e),l.removeCue(l.cues[i]);t==="disabled"&&(l.mode=t)}function Fh(l,e,t,i){const s=l.mode;if(s==="disabled"&&(l.mode="hidden"),l.cues&&l.cues.length>0){const r=ED(l.cues,e,t);for(let o=0;o<r.length;o++)(!i||i(r[o]))&&l.removeCue(r[o])}s==="disabled"&&(l.mode=s)}function TD(l,e){if(e<=l[0].startTime)return 0;const t=l.length-1;if(e>l[t].endTime)return-1;let i=0,s=t,r;for(;i<=s;)if(r=Math.floor((s+i)/2),e<l[r].startTime)s=r-1;else if(e>l[r].startTime&&i<t)i=r+1;else return r;return l[i].startTime-e<e-l[s].startTime?i:s}function ED(l,e,t){const i=[],s=TD(l,e);if(s>-1)for(let r=s,o=l.length;r<o;r++){const u=l[r];if(u.startTime>=e&&u.endTime<=t)i.push(u);else if(u.startTime>t)return i}return i}function Mu(l){const e=[];for(let t=0;t<l.length;t++){const i=l[t];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&e.push(l[t])}return e}class xD extends Rg{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const i=Mu(this.media.textTracks);for(let r=0;r<i.length;r++)if(i[r].mode==="hidden")t=i[r];else if(i[r].mode==="showing"){t=i[r];break}const s=this.findTrackForTextTrack(t);this.subtitleTrack!==s&&this.setSubtitleTrack(s)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(b.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const i=this.media;if(!i)return;const s=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;Mu(i.textTracks).forEach(o=>{ia(o)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:i,groupId:s,details:r}=t,o=this.tracksInGroup[i];if(!o||o.groupId!==s){this.warn(`Subtitle track with id:${i} and group:${s} not found in active group ${o?.groupId}`);return}const u=o.details;o.details=t.details,this.log(`Subtitle track ${i} "${o.name}" lang:${o.lang} group:${s} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,u)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.subtitleGroups||null,s=this.groupIds;let r=this.currentTrack;if(!i||s?.length!==i?.length||i!=null&&i.some(o=>s?.indexOf(o)===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(h=>!i||i.indexOf(h.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(h=>h.default)&&(this.selectDefaultTrack=!1),o.forEach((h,m)=>{h.id=m});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const u=this.hls.config.subtitlePreference;if(!r&&u){this.selectDefaultTrack=!1;const h=os(u,o);if(h>-1)r=o[h];else{const m=os(u,this.tracks);r=this.tracks[m]}}let d=this.findTrackId(r);d===-1&&r&&(d=this.findTrackId(null));const f={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${i?.join(",")}" group-id`),this.hls.trigger(b.SUBTITLE_TRACKS_UPDATED,f),d!==-1&&this.trackId===-1&&this.setSubtitleTrack(d)}}findTrackId(e){const t=this.tracksInGroup,i=this.selectDefaultTrack;for(let s=0;s<t.length;s++){const r=t[s];if(!(i&&!r.default||!i&&!e)&&(!e||tr(r,e)))return s}if(e){for(let s=0;s<t.length;s++){const r=t[s];if(Vl(e.attrs,r.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return s}for(let s=0;s<t.length;s++){const r=t[s];if(Vl(e.attrs,r.attrs,["LANGUAGE"]))return s}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const s=t[i];if(kh(s,e))return i}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Ie.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const i=this.currentTrack;if(i&&tr(e,i))return i;const s=os(e,this.tracksInGroup);if(s>-1){const r=this.tracksInGroup[s];return this.setSubtitleTrack(s),r}else{if(i)return null;{const r=os(e,t);if(r>-1)return t[r]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=e.id,s=e.groupId,r=this.getUrlWithDirectives(e.url,t),o=e.details,u=o?.age;this.log(`Loading subtitle ${i} "${e.name}" lang:${e.lang} group:${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${u&&o.live?" age "+u.toFixed(1)+(o.type&&" "+o.type||""):""} ${r}`),this.hls.trigger(b.SUBTITLE_TRACK_LOADING,{url:r,id:i,groupId:s,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Mu(e.textTracks),i=this.currentTrack;let s;if(i&&(s=t.filter(r=>kh(i,r))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(t).forEach(r=>{r.mode!=="disabled"&&r!==s&&(r.mode="disabled")}),s){const r=this.subtitleDisplay?"showing":"hidden";s.mode!==r&&(s.mode=r)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!de(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,s=t[e]||null;if(this.trackId=e,this.currentTrack=s,this.toggleTrackModes(),!s){this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:e});return}const r=!!s.details&&!s.details.live;if(e===this.trackId&&s===i&&r)return;this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:o,groupId:u="",name:d,type:f,url:h}=s;this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:o,groupId:u,name:d,type:f,url:h});const m=this.switchParams(s.url,i?.details,s.details);this.loadPlaylist(m)}}function _D(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s=="x"?r:r&3|8).toString(16)})}}}function Il(l){let e=5381,t=l.length;for(;t;)e=e*33^l.charCodeAt(--t);return(e>>>0).toString()}const oa=.025;let Zu=function(l){return l[l.Point=0]="Point",l[l.Range=1]="Range",l}({});function bD(l,e,t){return`${l.identifier}-${t+1}-${Il(e)}`}class AD{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const i=this.playoutLimit;return e<=0||isNaN(i)?!1:i===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>i}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Kd(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,i=Kd(t,e);return t-i<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=de(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Kd(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<oa))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Zu.Range:Zu.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return LD(this)}}function Kd(l,e){return l-e.start<e.duration/2&&!(Math.abs(l-(e.start+e.duration))<oa)?e.start:e.start+e.duration}function wE(l,e,t){const i=new self.URL(l,t);return i.protocol!=="data:"&&i.searchParams.set("_HLS_primary_id",e),i}function Yd(l,e){for(;(t=l.assetList[++e])!=null&&t.error;)var t;return e}function LD(l){return`["${l.identifier}" ${l.cue.pre?"<pre>":l.cue.post?"<post>":""}${l.timelineStart.toFixed(2)}-${l.resumeTime.toFixed(2)}]`}function Jr(l){const e=l.timelineStart,t=l.duration||0;return`["${l.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class RD{constructor(e,t,i,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls.trigger(b.PLAYOUT_LIMIT_REACHED,{})};const r=this.hls=new e(t);this.interstitial=i,this.assetItem=s;let o=s.uri;try{o=wE(o,t.primarySessionId).href}catch{}r.loadSource(o);const u=()=>{this.hasDetails=!0};r.once(b.LEVEL_LOADED,u),r.once(b.AUDIO_TRACK_LOADED,u),r.once(b.SUBTITLE_TRACK_LOADED,u),r.on(b.MEDIA_ATTACHING,(d,{media:f})=>{this.removeMediaListeners(),this.mediaAttached=f,this.interstitial.playoutLimit&&(f.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&r.on(b.BUFFER_APPENDED,()=>{const m=this.bufferedEnd;this.reachedPlayout(m)&&(this._bufferedEosTime=m,r.trigger(b.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){var e;return((e=this.interstitial)==null?void 0:e.appendInPlace)||!1}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const i=this.timelineOffset,s=be.bufferInfo(e,i,0);return this.getAssetTime(s.end)>=this._bufferedEosTime-.02}reachedPlayout(e){const i=this.interstitial.playoutLimit;return this.startOffset+e>=i}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=be.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const i=e-t;if(Math.abs(i)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,i=this.duration;return Math.min(Math.max(0,e-t),i)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}resetDetails(){const e=this.hls;if(this.hasDetails){e.stopLoad();const t=i=>delete i.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,i){this.hls.on(e,t)}once(e,t,i){this.hls.once(e,t)}off(e,t,i){this.hls.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${Jr(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const Wy=.033;class DD extends qi{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((i,s)=>e<=s.startOffset&&t>s.startOffset?(delete s.error,i+1):i,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let i=-1;e.nextEvent?i=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(i=this.findEventIndex(e.previousEvent.identifier)+1);const s=this.items;if(s)for(s[i]||(t===void 0&&(t=e.start),i=this.findItemIndexAtTime(t));i>=0&&(r=s[i])!=null&&r.event;){var r;i--}return i}findItemIndexAtTime(e,t){const i=this.items;if(i)for(let s=0;s<i.length;s++){let r=i[s];if(t&&t!=="primary"&&(r=r[t]),e===r.start||e>r.start&&e<r.end)return s}return-1}findJumpRestrictedIndex(e,t){const i=this.items;if(i)for(let s=e;s<=t&&i[s];s++){const r=i[s].event;if(r!=null&&r.restrictions.jump&&!r.appendInPlace)return s}return-1}findEventIndex(e){const t=this.items;if(t)for(let s=t.length;s--;){var i;if(((i=t[s].event)==null?void 0:i.identifier)===e)return s}return-1}findAssetIndex(e,t){const i=e.assetList,s=i.length;if(s>1)for(let r=0;r<s;r++){const o=i[r];if(!o.error){const u=o.timelineStart;if(t===u||t>u&&t<u+(o.duration||0))return r}}return 0}get assetIdAtEnd(){var e,t;const i=(e=this.items)==null||(t=e[this.length-1])==null?void 0:t.event;if(i){const s=i.assetList,r=s[s.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(e,t){const i=e.main.details,{dateRanges:s}=i,r=this.events,o=this.parseDateRanges(s,{url:i.url},t),u=Object.keys(s),d=r?r.filter(f=>!u.includes(f.identifier)):[];o.length&&o.sort((f,h)=>{const m=f.cue.pre,v=f.cue.post,y=h.cue.pre,S=h.cue.post;if(m&&!y)return-1;if(y&&!m||v&&!S)return 1;if(S&&!v)return-1;if(!m&&!y&&!v&&!S){const E=f.startTime,x=h.startTime;if(E!==x)return E-x}return f.dateRange.tagOrder-h.dateRange.tagOrder}),this.events=o,d.forEach(f=>{this.removeEvent(f)}),this.updateSchedule(e,d)}updateSchedule(e,t=[]){const i=this.events||[];if(i.length||t.length||this.length<2){const s=this.items,r=this.parseSchedule(i,e);(t.length||s?.length!==r.length||r.some((u,d)=>Math.abs(u.playout.start-s[d].playout.start)>.005||Math.abs(u.playout.end-s[d].playout.end)>.005))&&(this.items=r,this.onScheduleUpdate(t,s))}}parseDateRanges(e,t,i){const s=[],r=Object.keys(e);for(let o=0;o<r.length;o++){const u=r[o],d=e[u];if(d.isInterstitial){let f=this.eventMap[u];f?f.setDateRange(d):(f=new AD(d,t),this.eventMap[u]=f,i===!1&&(f.appendInPlace=i)),s.push(f)}}return s}parseSchedule(e,t){const i=[],s=t.main.details,r=s.live?1/0:s.edge;let o=0;if(e=e.filter(d=>!d.error&&!(d.cue.once&&d.hasPlayed)),e.length){this.resolveOffsets(e,t);let d=0,f=0;if(e.forEach((h,m)=>{const v=h.cue.pre,y=h.cue.post,S=e[m-1]||null,E=h.appendInPlace,x=y?r:h.startOffset,_=h.duration,R=h.timelineOccupancy===Zu.Range?_:0,A=h.resumptionOffset,I=S?.startTime===x,D=x+h.cumulativeDuration;let N=E?D+_:x+A;if(v||!y&&x<=0){const M=f;f+=R,h.timelineStart=D;const O=o;o+=_,i.push({event:h,start:D,end:N,playout:{start:O,end:o},integrated:{start:M,end:f}})}else if(x<=r){if(!I){const P=x-d;if(P>Wy){const U=d,H=f;f+=P;const se=o;o+=P;const ue={previousEvent:e[m-1]||null,nextEvent:h,start:U,end:U+P,playout:{start:se,end:o},integrated:{start:H,end:f}};i.push(ue)}else P>0&&S&&(S.cumulativeDuration+=P,i[i.length-1].end=x)}y&&(N=D),h.timelineStart=D;const M=f;f+=R;const O=o;o+=_,i.push({event:h,start:D,end:N,playout:{start:O,end:o},integrated:{start:M,end:f}})}else return;const C=h.resumeTime;y||C>r?d=r:d=C}),d<r){var u;const h=d,m=f,v=r-d;f+=v;const y=o;o+=v,i.push({previousEvent:((u=i[i.length-1])==null?void 0:u.event)||null,nextEvent:null,start:d,end:h+v,playout:{start:y,end:o},integrated:{start:m,end:f}})}this.setDurations(r,o,f)}else i.push({previousEvent:null,nextEvent:null,start:0,end:r,playout:{start:0,end:r},integrated:{start:0,end:r}}),this.setDurations(r,r,r);return i}setDurations(e,t,i){this.durations={primary:e,playout:t,integrated:i}}resolveOffsets(e,t){const i=t.main.details,s=i.live?1/0:i.edge;let r=0,o=-1;e.forEach((u,d)=>{const f=u.cue.pre,h=u.cue.post,m=f?0:h?s:u.startTime;this.updateAssetDurations(u),o===m?u.cumulativeDuration=r:(r=0,o=m),!h&&u.snapOptions.in&&(u.resumeAnchor=nr(null,i.fragments,u.startOffset+u.resumptionOffset,0,0)||void 0),u.appendInPlace&&!u.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(u,t)||(u.appendInPlace=!1)),!u.appendInPlace&&d+1<e.length&&e[d+1].startTime-e[d].resumeTime<Wy&&(e[d+1].appendInPlace=!1,e[d+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${u}`));const y=de(u.resumeOffset)?u.resumeOffset:u.duration;r+=y})}primaryCanResumeInPlaceAt(e,t){const i=e.resumeTime,s=e.startTime+e.resumptionOffset;return Math.abs(i-s)>oa?(this.log(`"${e.identifier}" resumption ${i} not aligned with estimated timeline end ${s}`),!1):t?!Object.keys(t).some(o=>{const u=t[o].details,d=u.edge;if(i>=d)return this.log(`"${e.identifier}" resumption ${i} past ${o} playlist end ${d}`),!1;const f=nr(null,u.fragments,i);if(!f)return this.log(`"${e.identifier}" resumption ${i} does not align with any fragments in ${o} playlist (${u.fragStart}-${u.fragmentEnd})`),!0;const h=o==="audio"?.175:0;return Math.abs(f.start-i)<oa+h||Math.abs(f.end-i)<oa+h?!1:(this.log(`"${e.identifier}" resumption ${i} not aligned with ${o} fragment bounds (${f.start}-${f.end} sn: ${f.sn} cc: ${f.cc})`),!0)}):(this.log(`"${e.identifier}" resumption ${i} can not be aligned with media (none selected)`),!1)}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let i=0,s=!1,r=!1;e.assetList.forEach((o,u)=>{const d=t+i;o.startOffset=i,o.timelineStart=d,s||(s=o.duration===null),r||(r=!!o.error);const f=o.error?0:o.duration||0;i+=f}),s&&!r?e.duration=Math.max(i,e.duration):e.duration=i}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function un(l){return`[${l.event?'"'+l.event.identifier+'"':"primary"}: ${l.start.toFixed(2)}-${l.end.toFixed(2)}]`}class ID{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const i=e.assetListUrl;let s;try{s=wE(i,this.hls.sessionId,e.baseUrl)}catch(v){const y=this.assignAssetListError(e,X.ASSET_LIST_LOAD_ERROR,v,i);this.hls.trigger(b.ERROR,y);return}t&&s.protocol!=="data:"&&s.searchParams.set("_HLS_start_offset",""+t);const r=this.hls.config,o=r.loader,u=new o(r),d={responseType:"json",url:s.href},f=r.interstitialAssetListLoadPolicy.default,h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(v,y,S,E)=>{const x=v.data,_=x?.ASSETS;if(!Array.isArray(_)){const R=this.assignAssetListError(e,X.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),S.url,y,E);this.hls.trigger(b.ERROR,R);return}e.assetListResponse=x,this.hls.trigger(b.ASSET_LIST_LOADED,{event:e,assetListResponse:x,networkDetails:E})},onError:(v,y,S,E)=>{const x=this.assignAssetListError(e,X.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${v.code} ${v.text} (${y.url})`),y.url,E,S);this.hls.trigger(b.ERROR,x)},onTimeout:(v,y,S)=>{const E=this.assignAssetListError(e,X.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${y.url})`),y.url,v,S);this.hls.trigger(b.ERROR,E)}};return u.load(d,h,m),this.hls.trigger(b.ASSET_LIST_LOADING,{event:e}),u}assignAssetListError(e,t,i,s,r,o){return e.error=i,{type:pe.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:s,error:i,networkDetails:o,stats:r}}}function Zy(l){l?.play().catch(()=>{})}class wD extends qi{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled)return;const s=i-this.timelinePos;if(Math.abs(s)<1/7056e5)return;const o=s<=-.01;this.timelinePos=i,this.bufferedPos=i;const u=this.playingItem;if(!u){this.checkBuffer();return}if(o&&this.schedule.resetErrorsInRange(i,i-s)&&this.updateSchedule(),this.checkBuffer(),o&&i<u.start||i>=u.end){var d;const v=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(u)&&(d=this.media)!=null&&d.paused&&(this.shouldPlay=!1),!o){const y=this.findItemIndex(u);if(v>y){const S=this.schedule.findJumpRestrictedIndex(y+1,v);if(S>y){this.setSchedulePosition(S);return}}}this.setSchedulePosition(v);return}const f=this.playingAsset;if(!f){if(this.playingLastItem&&this.isInterstitial(u)){const v=u.event.assetList[0];v&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(i,v))}return}const h=f.timelineStart,m=f.duration||0;(o&&i<h||i>=h+m)&&this.setScheduleToAssetAtTime(i,f)},this.onTimeupdate=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled)return;if(i>this.timelinePos)this.timelinePos=i,i>this.bufferedPos&&this.checkBuffer();else return;const s=this.playingItem;if(!s||this.playingLastItem)return;if(i>=s.end){this.timelinePos=s.end;const u=this.findItemIndex(s);this.setSchedulePosition(u+1)}const r=this.playingAsset;if(!r)return;const o=r.timelineStart+(r.duration||0);i>=o&&this.setScheduleToAssetAtTime(i,r)},this.onScheduleUpdate=(i,s)=>{const r=this.schedule,o=this.playingItem,u=r.events||[],d=r.items||[],f=r.durations,h=i.map(S=>S.identifier),m=!!(u.length||h.length);(m||s)&&this.log(`INTERSTITIALS_UPDATED (${u.length}): ${u}
Schedule: ${d.map(S=>un(S))} pos: ${this.timelinePos}`),h.length&&this.log(`Removed events ${h}`),this.playerQueue.forEach(S=>{if(S.interstitial.appendInPlace){const E=S.assetItem.timelineStart,x=S.timelineOffset-E;if(x)try{S.timelineOffset=E}catch(_){Math.abs(x)>oa&&this.warn(`${_} ("${S.assetId}" ${S.timelineOffset}->${E})`)}}});let v=null;if(o){const S=this.updateItem(o,this.timelinePos);this.itemsMatch(o,S)&&(this.playingItem=S,this.waitingItem=this.endedItem=null,v=()=>this.trimInPlace(S,o))}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const y=this.bufferingItem;if(y){const S=this.updateItem(y,this.bufferedPos);this.itemsMatch(y,S)?(this.bufferingItem=S,v||(v=()=>this.trimInPlace(S,y))):y.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(y.event,null))}if(i.forEach(S=>{S.assetList.forEach(E=>{this.clearAssetPlayer(E.identifier,null)})}),m||s){if(this.hls.trigger(b.INTERSTITIALS_UPDATED,{events:u.slice(0),schedule:d.slice(0),durations:f,removedIds:h}),this.isInterstitial(o)&&h.includes(o.event.identifier)){this.warn(`Interstitial "${o.event.identifier}" removed while playing`),this.primaryFallback(o.event);return}v&&v(),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new ID(e),this.schedule=new DD(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(b.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(b.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(b.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(b.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(b.BUFFER_APPENDED,this.onBufferAppended,this),e.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(b.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(b.MEDIA_ENDED,this.onMediaEnded,this),e.on(b.ERROR,this.onError,this),e.on(b.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(b.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(b.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(b.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(b.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.BUFFER_APPENDED,this.onBufferAppended,this),e.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(b.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(b.MEDIA_ENDED,this.onMediaEnded,this),e.off(b.ERROR,this.onError,this),e.off(b.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){ji(e,"play",this.onPlay),ji(e,"pause",this.onPause),ji(e,"seeking",this.onSeeking),ji(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const i=this.media=t.media;Fi(i,"seeking",this.onSeeking),Fi(i,"timeupdate",this.onTimeupdate),Fi(i,"play",this.onPlay),Fi(i,"pause",this.onPause)}onMediaAttached(e,t){const i=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,i===null)this.checkStart();else if(!s){this.clearScheduleState();const r=this.findItemIndex(i);this.setSchedulePosition(r)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const i=!!t.transferMedia,s=this.media;if(this.media=null,!i&&(s&&this.removeMediaListeners(s),this.detachedData)){const r=this.getBufferingPlayer();r&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,r.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,i=m=>m&&e.getAssetPlayer(m.identifier),s=(m,v,y,S,E)=>{if(m){let x=m[v].start;const _=m.event;if(_){if(v==="playout"||_.timelineOccupancy!==Zu.Point){const R=i(y);R?.interstitial===_&&(x+=R.assetItem.startOffset+R[E])}}else{const R=S==="bufferedPos"?o():e[S];x+=R-m.start}return x}return 0},r=(m,v)=>{if(m!==0&&v!=="primary"&&e.schedule.length){var y;const S=e.schedule.findItemIndexAtTime(m),E=(y=e.schedule.items)==null?void 0:y[S];if(E){const x=E[v].start-E.start;return m+x}}return m},o=()=>{const m=e.bufferedPos;return m===Number.MAX_VALUE?u("primary"):Math.max(m,0)},u=m=>{var v;return(v=e.primaryDetails)!=null&&v.live?e.primaryDetails.edge:e.schedule.durations[m]},d=(m,v)=>{var y,S;const E=e.effectivePlayingItem;if(E!=null&&(y=E.event)!=null&&y.restrictions.skip)return;e.log(`seek to ${m} "${v}"`);const x=e.effectivePlayingItem,_=e.schedule.findItemIndexAtTime(m,v),R=(S=e.schedule.items)==null?void 0:S[_],A=e.getBufferingPlayer(),I=A?.interstitial,D=I?.appendInPlace,N=x&&e.itemsMatch(x,R);if(x&&(D||N)){const M=i(e.playingAsset),O=M?.media||e.primaryMedia;if(O){const P=v==="primary"?O.currentTime:s(x,v,e.playingAsset,"timelinePos","currentTime"),U=m-P,H=(D?P:O.currentTime)+U;if(H>=0&&(!M||D||H<=M.duration)){O.currentTime=H;return}}}if(R){let M=m;if(v!=="primary"){const P=R[v].start,U=m-P;M=R.start+U}const O=!e.isInterstitial(R);if((!e.isInterstitial(x)||x.event.appendInPlace)&&(O||R.event.appendInPlace)){const P=e.media||(D?A?.media:null);P&&(P.currentTime=M)}else if(x){const P=e.findItemIndex(x);if(_>P){const H=e.schedule.findJumpRestrictedIndex(P+1,_);if(H>P){e.setSchedulePosition(H);return}}let U=0;if(O)e.timelinePos=M,e.checkBuffer();else{var C;const H=R==null||(C=R.event)==null?void 0:C.assetList;if(H){const se=m-(R[v]||R).start;for(let ue=H.length;ue--;){const te=H[ue];if(te.duration&&se>=te.startOffset&&se<te.startOffset+te.duration){U=ue;break}}}}e.setSchedulePosition(_,U)}}},f=()=>{const m=e.effectivePlayingItem;if(e.isInterstitial(m))return m;const v=t();return e.isInterstitial(v)?v:null},h={get currentTime(){const m=f(),v=e.effectivePlayingItem;return v&&v===m?s(v,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-v.playout.start:0},set currentTime(m){const v=f(),y=e.effectivePlayingItem;y&&y===v&&d(m+y.playout.start,"playout")},get duration(){const m=f();return m?m.playout.end-m.playout.start:0},get assetPlayers(){var m;const v=(m=f())==null?void 0:m.event.assetList;return v?v.map(y=>e.getAssetPlayer(y.identifier)):[]},get playingIndex(){var m;const v=(m=f())==null?void 0:m.event;return v&&e.effectivePlayingAsset?v.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return f()}};this.manager={get events(){var m,v;return((m=e.schedule)==null||(v=m.events)==null?void 0:v.slice(0))||[]},get schedule(){var m,v;return((m=e.schedule)==null||(v=m.items)==null?void 0:v.slice(0))||[]},get interstitialPlayer(){return f()?h:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const m=t();return e.findItemIndex(m)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const m=e.effectivePlayingItem;return e.findItemIndex(m)},primary:{get bufferedEnd(){return o()},get currentTime(){const m=e.timelinePos;return m>0?m:0},set currentTime(m){d(m,"primary")},get duration(){return u("primary")},get seekableStart(){var m;return((m=e.primaryDetails)==null?void 0:m.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(m){d(m,"integrated")},get duration(){return u("integrated")},get seekableStart(){var m;return r(((m=e.primaryDetails)==null?void 0:m.fragmentStart)||0,"integrated")}},skip:()=>{const m=e.effectivePlayingItem,v=m?.event;if(v&&!v.restrictions.skip){const y=e.findItemIndex(m);if(v.appendInPlace){const S=m.playout.start+m.event.duration;d(S+.001,"playout")}else e.advanceAfterAssetEnded(v,y,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,i=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!i?!1:this.findItemIndex(t)===i.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t,i;if(this.mediaSelection===null)return;const s=this.waitingItem||this.playingItem;if(this.isInterstitial(s)&&!s.event.appendInPlace)return;let r=this.media;!r&&(e=this.bufferingItem)!=null&&(t=e.event)!=null&&t.appendInPlace&&(r=this.primaryMedia);const o=(i=r)==null?void 0:i.currentTime;if(!(o===void 0||!de(o)))return o}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const i=this.getAssetPlayer(e);i&&this.transferMediaFromPlayer(i,t)}transferMediaFromPlayer(e,t){const i=e.interstitial.appendInPlace,s=e.media;if(i&&s===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&s){this.detachedData={media:s};return}const r=e.transferMedia();this.log(`transfer MediaSource from ${e} ${Ze(r)}`),this.detachedData=r}else t&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(e,t){var i,s;if(e.media===t)return;let r=null;const o=this.hls,u=e!==o,d=u&&e.interstitial.appendInPlace,f=(i=this.detachedData)==null?void 0:i.mediaSource;let h;if(o.media)d&&(r=o.transferMedia(),this.detachedData=r),h="Primary";else if(f){const y=this.getBufferingPlayer();y?(r=y.transferMedia(),h=`${y}`):h="detached MediaSource"}else h="detached media";if(!r){if(f)r=this.detachedData,this.log(`using detachedData: MediaSource ${Ze(r)}`);else if(!this.detachedData||o.media===t){const y=this.playerQueue;y.length>1&&y.forEach(S=>{if(u&&S.interstitial.appendInPlace!==d){const E=S.interstitial;this.clearInterstitial(S.interstitial,null),E.appendInPlace=!1,E.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${E}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const m=r&&"mediaSource"in r&&((s=r.mediaSource)==null?void 0:s.readyState)!=="closed",v=m&&r?r:t;if(this.log(`${m?"transfering MediaSource":"attaching media"} to ${u?e:"Primary"} from ${h}`),v===r){const y=u&&e.assetId===this.schedule.assetIdAtEnd;v.overrides={duration:this.schedule.duration,endOfStream:!u||y,cueRemoval:!u}}e.attachMedia(v)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const i=this.timelinePos,s=this.effectivePlayingItem;if(i===-1){const r=this.hls.startPosition;if(this.timelinePos=r,t.length&&t[0].cue.pre){const o=e.findEventIndex(t[0].identifier);this.setSchedulePosition(o)}else if(r>=0||!this.primaryLive){const o=this.timelinePos=r>0?r:0,u=e.findItemIndexAtTime(o);this.setSchedulePosition(u)}}else if(s&&!this.playingItem){const r=e.findItemIndex(s);this.setSchedulePosition(r)}}advanceAfterAssetEnded(e,t,i){const s=Yd(e,i);if(!e.isAssetPastPlayoutLimit(s))this.setSchedulePosition(t,s);else{const r=this.schedule.items;if(r){const o=t+1,u=r.length;if(o>=u){this.setSchedulePosition(-1);return}const d=e.resumeTime;this.timelinePos<d&&(this.timelinePos=d,this.checkBuffer()),this.setSchedulePosition(o)}}}setScheduleToAssetAtTime(e,t){const i=this.schedule,s=t.parentIdentifier,r=i.getEvent(s);if(r){const o=i.findEventIndex(s),u=i.findAssetIndex(r,e);this.advanceAfterAssetEnded(r,o,u-1)}}setSchedulePosition(e,t){const i=this.schedule.items;if(!i||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const s=e>=0?i[e]:null,r=this.playingItem,o=this.playingLastItem;if(this.isInterstitial(r)){var u;const f=r.event,h=this.playingAsset,m=h?.identifier,v=m?this.getAssetPlayer(m):null;if(v&&m&&(!this.eventItemsMatch(r,s)||t!==void 0&&m!==((u=f.assetList)==null?void 0:u[t].identifier))){var d;const y=f.findAssetIndex(h);if(this.log(`INTERSTITIAL_ASSET_ENDED ${y+1}/${f.assetList.length} ${Jr(h)}`),this.endedAsset=h,this.playingAsset=null,this.hls.trigger(b.INTERSTITIAL_ASSET_ENDED,{asset:h,assetListIndex:y,event:f,schedule:i.slice(0),scheduleIndex:e,player:v}),r!==this.playingItem){this.itemsMatch(r,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(f,this.findItemIndex(this.playingItem),y);return}this.retreiveMediaSource(m,s),v.media&&!((d=this.detachedData)!=null&&d.mediaSource)&&v.detachMedia()}if(!this.eventItemsMatch(r,s)&&(this.endedItem=r,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${f} ${un(r)}`),f.hasPlayed=!0,this.hls.trigger(b.INTERSTITIAL_ENDED,{event:f,schedule:i.slice(0),scheduleIndex:e}),f.cue.once)){this.updateSchedule();const y=this.schedule.items;if(s&&y){const S=this.findItemIndex(s);this.advanceSchedule(S,y,t,r,o)}return}}this.advanceSchedule(e,i,t,r,o)}advanceSchedule(e,t,i,s,r){const o=e>=0?t[e]:null,u=this.primaryMedia,d=this.playerQueue;if(d.length&&d.forEach(f=>{const h=f.interstitial,m=this.schedule.findEventIndex(h.identifier);(m<e||m>e+1)&&this.clearInterstitial(h,o)}),this.isInterstitial(o)){this.timelinePos=Math.min(Math.max(this.timelinePos,o.start),o.end);const f=o.event;if(i===void 0){i=this.schedule.findAssetIndex(f,this.timelinePos);const y=Yd(f,i-1);if(f.isAssetPastPlayoutLimit(y)){this.advanceAfterAssetEnded(f,e,i);return}i=y}const h=this.waitingItem;this.assetsBuffered(o,u)||this.setBufferingItem(o);let m=this.preloadAssets(f,i);if(this.eventItemsMatch(o,h||s)||(this.waitingItem=o,this.log(`INTERSTITIAL_STARTED ${un(o)} ${f.appendInPlace?"append in place":""}`),this.hls.trigger(b.INTERSTITIAL_STARTED,{event:f,schedule:t.slice(0),scheduleIndex:e})),!f.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${f}`);return}if(f.assetListLoader&&(f.assetListLoader.destroy(),f.assetListLoader=void 0),!u){this.log(`Waiting for attachMedia to start Interstitial ${f}`);return}this.waitingItem=this.endedItem=null,this.playingItem=o;const v=f.assetList[i];if(!v){const y=t[e+1],S=this.media;y&&S&&!this.isInterstitial(y)&&S.currentTime<y.start&&(S.currentTime=this.timelinePos=y.start),this.advanceAfterAssetEnded(f,e,i||0);return}if(m||(m=this.getAssetPlayer(v.identifier)),m===null||m.destroyed){const y=f.assetList.length;this.warn(`asset ${i+1}/${y} player destroyed ${f}`),m=this.createAssetPlayer(f,v,i)}if(!this.eventItemsMatch(o,this.bufferingItem)&&f.appendInPlace&&this.isAssetBuffered(v))return;this.startAssetPlayer(m,i,t,e,u),this.shouldPlay&&Zy(m.media)}else o!==null?(this.resumePrimary(o,e,s),this.shouldPlay&&Zy(this.hls.media)):r&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e,t;return(e=this.mediaSelection)==null||(t=e.main)==null?void 0:t.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,i){var s;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${un(e)}`),!((s=this.detachedData)!=null&&s.mediaSource)){let o=this.timelinePos;(o<e.start||o>=e.end)&&(o=this.getPrimaryResumption(e,t),this.timelinePos=o),this.attachPrimary(o,e)}if(!i)return;const r=this.schedule.items;r&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${un(e)}`),this.hls.trigger(b.INTERSTITIALS_PRIMARY_RESUMED,{schedule:r.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const i=e.start;if(this.primaryLive){const s=this.primaryDetails;if(t===0)return this.hls.startPosition;if(s&&(i<s.fragmentStart||i>s.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:be.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,i){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const s=this.primaryMedia;if(!s)return;const r=this.hls;r.media?this.checkBuffer():(this.transferMediaTo(r,s),i&&this.startLoadingPrimaryAt(e,i)),i||(this.timelinePos=e,this.startLoadingPrimaryAt(e,i))}startLoadingPrimaryAt(e,t){var i;const s=this.hls;!s.loadingEnabled||!s.media||Math.abs((((i=s.mainForwardBufferInfo)==null?void 0:i.start)||s.media.currentTime)-e)>.5?s.startLoad(e,t):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(b.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(b.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1)return;const i=this.hls.levels[t.level],s=Ke(Ke({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const i=this.hls.audioTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=Ke(Ke({},this.altSelection),{},{audio:i});return}const r=Ke(Ke({},s),{},{audio:i});this.mediaSelection=r}onSubtitleTrackUpdated(e,t){const i=this.hls.subtitleTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=Ke(Ke({},this.altSelection),{},{subtitles:i});return}const r=Ke(Ke({},s),{},{subtitles:i});this.mediaSelection=r}onAudioTrackSwitching(e,t){const i=uy(t);this.playerQueue.forEach(s=>s.hls.setAudioOption(t)||s.hls.setAudioOption(i))}onSubtitleTrackSwitch(e,t){const i=uy(t);this.playerQueue.forEach(s=>s.hls.setSubtitleOption(t)||t.id!==-1&&s.hls.setSubtitleOption(i))}onBufferCodecs(e,t){const i=t.tracks;i&&(this.requiredTracks=i)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const i=this.playingItem;if(i&&!this.itemsMatch(i,this.bufferingItem)&&!this.isInterstitial(i)){const s=this.timelinePos;this.bufferedPos=s,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let s=0;s<t.length;s++){const r=t[s];if(r.cue.post){var i;const o=this.schedule.findEventIndex(r.identifier),u=(i=this.schedule.items)==null?void 0:i[o];this.isInterstitial(u)&&this.eventItemsMatch(u,this.bufferingItem)&&this.bufferedToItem(u,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const i=this.findItemIndex(t);this.setSchedulePosition(i+1)}else this.shouldPlay=!1}updateItem(e,t){const i=this.schedule.items;if(e&&i){const s=this.findItemIndex(e,t);return i[s]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((r,o)=>{e.event.isAssetPastPlayoutLimit(o)&&this.clearAssetPlayer(r.identifier,null)});const i=e.end+.25,s=be.bufferInfo(this.primaryMedia,i,0);(s.end>i||(s.nextStart||0)>i)&&(this.attachPrimary(i,null),this.flushFrontBuffer(i))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var i;return!!t&&(e===t||e.event.identifier===((i=t.event)==null?void 0:i.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const i=be.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=i.len<1),this.updateBufferedPos(i.end,t,e)}updateBufferedPos(e,t,i){const s=this.schedule,r=this.bufferingItem;if(this.bufferedPos>e)return;if(t.length===1&&this.itemsMatch(t[0],r)){this.bufferedPos=e;return}const o=this.playingItem,u=this.findItemIndex(o);let d=s.findItemIndexAtTime(e);if(this.bufferedPos<e){var f,h;const m=this.findItemIndex(r),v=Math.min(m+1,t.length-1),y=t[v];if((d===-1&&r&&e>=r.end||(f=y.event)!=null&&f.appendInPlace&&e+.01>=y.start)&&(d=v),v-u>1&&(r==null||(h=r.event)==null?void 0:h.appendInPlace)===!1)return;if(this.bufferedPos=e,d>m&&d>u)this.bufferedToItem(y);else{const S=this.primaryDetails;this.primaryLive&&S&&e>S.edge-S.targetduration&&y.start<S.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(y)&&this.preloadAssets(y.event,0)}}else i&&o&&!this.itemsMatch(o,r)&&(d===u?this.bufferedToItem(o):d===u+1&&this.bufferedToItem(t[d]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(s=>{const r=this.getAssetPlayer(s.identifier);return!(r!=null&&r.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,i=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:s,events:r}=i;if(!s||!r)return t;const o=this.isInterstitial(e),u=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const d=u?u.remaining:t?t.end-this.timelinePos:0;this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${un(e)}`+(t?` (${d.toFixed(2)} remaining)`:"")),this.playbackDisabled||(o?e.event.assetList.forEach(f=>{const h=this.getAssetPlayer(f.identifier);h&&h.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(f=>f.pauseBuffering()))),this.hls.trigger(b.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:r.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const i=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(i!==null){this.bufferingAsset=null;const s=this.detachedData;s?s.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),i=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(i)}bufferedToEvent(e,t){const i=e.event,s=i.assetList.length===0&&!i.assetListLoader,r=i.cue.once;if(s||!r){const o=this.preloadAssets(i,t);if(o!=null&&o.interstitial.appendInPlace){const u=i.assetList[t],d=this.primaryMedia;u&&d&&this.bufferAssetPlayer(o,d)}}}preloadAssets(e,t){const i=e.assetUrl,s=e.assetList.length,r=s===0&&!e.assetListLoader,o=e.cue.once;if(r){const d=e.timelineStart;if(e.appendInPlace){var u;const v=this.playingItem;!this.isInterstitial(v)&&(v==null||(u=v.nextEvent)==null?void 0:u.identifier)===e.identifier&&this.flushFrontBuffer(d+.25)}let f,h=0;if(!this.playingItem&&this.primaryLive&&(h=this.hls.startPosition,h===-1&&(h=this.hls.liveSyncPosition||0)),h&&!(e.cue.pre||e.cue.post)){const v=h-d;v>0&&(f=Math.round(v*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${i?1:s} ${e}${f?` live-start: ${h} start-offset: ${f}`:""}`),i)return this.createAsset(e,0,0,d,e.duration,i);const m=this.assetListLoader.loadAssetList(e,f);m&&(e.assetListLoader=m)}else if(!o&&s){for(let d=t;d<s;d++){const f=e.assetList[d],h=this.getAssetPlayerQueueIndex(f.identifier);(h===-1||this.playerQueue[h].destroyed)&&!f.error&&this.createAssetPlayer(e,f,d)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(s=>{this.hls.trigger(b.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:s})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let i=0;i<t.length;i++)if(e===t[i].assetId)return i;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let i=0;i<e.length;i++)if(e[i].media===t)return e[i]}return null}createAsset(e,t,i,s,r,o){const u={parentIdentifier:e.identifier,identifier:bD(e,o,t),duration:r,startOffset:i,timelineStart:s,uri:o};return this.createAssetPlayer(e,u,t)}createAssetPlayer(e,t,i){const s=this.hls,r=s.userConfig;let o=r.videoPreference;const u=s.loadLevelObj||s.levels[s.currentLevel];(o||u)&&(o=Ge({},o),u.videoCodec&&(o.videoCodec=u.videoCodec),u.videoRange&&(o.allowedVideoRanges=[u.videoRange]));const d=s.audioTracks[s.audioTrack],f=s.subtitleTracks[s.subtitleTrack];let h=0;if(this.primaryLive||e.appendInPlace){const A=this.timelinePos-t.timelineStart;if(A>1){const I=t.duration;I&&A<I&&(h=A)}}const m=t.identifier,v=Ke(Ke({},r),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:m,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:h,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:d||r.audioPreference,subtitlePreference:f||r.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(v.timelineOffset=t.timelineStart));const y=v.cmcd;y!=null&&y.sessionId&&y.contentId&&(v.cmcd=Ge({},y,{contentId:Il(t.uri)})),this.getAssetPlayer(m)&&this.warn(`Duplicate date range identifier ${e} and asset ${m}`);const S=new RD(this.HlsPlayerClass,v,e,t);this.playerQueue.push(S),e.assetList[i]=t;const E=A=>{if(A.live){const N=new Error(`Interstitials MUST be VOD assets ${e}`),C={fatal:!0,type:pe.OTHER_ERROR,details:X.INTERSTITIAL_ASSET_ITEM_ERROR,error:N};this.handleAssetItemError(C,e,this.schedule.findEventIndex(e.identifier),i,N.message);return}const I=A.edge-A.fragmentStart,D=t.duration;(D===null||I>D)&&(this.log(`Interstitial asset "${m}" duration change ${D} > ${I}`),t.duration=I,this.updateSchedule())};S.on(b.LEVEL_UPDATED,(A,{details:I})=>E(I)),S.on(b.LEVEL_PTS_UPDATED,(A,{details:I})=>E(I));const x=(A,I)=>{const D=this.getAssetPlayer(m);if(D&&I.tracks){D.off(b.BUFFER_CODECS,x),D.tracks=I.tracks;const N=this.primaryMedia;this.bufferingAsset===D.assetItem&&N&&!D.media&&this.bufferAssetPlayer(D,N)}};S.on(b.BUFFER_CODECS,x);const _=()=>{var A;const I=this.getAssetPlayer(m);if(this.log(`buffered to end of asset ${I}`),!I)return;const D=this.schedule.findEventIndex(e.identifier),N=(A=this.schedule.items)==null?void 0:A[D];if(this.isInterstitial(N)){const M=e.findAssetIndex(t),O=Yd(e,M);if(!e.isAssetPastPlayoutLimit(O))this.bufferedToItem(N,O);else{var C;const P=(C=this.schedule.items)==null?void 0:C[D+1];P&&this.bufferedToItem(P)}}};S.on(b.BUFFERED_TO_END,_);const R=A=>()=>{if(!this.getAssetPlayer(m))return;this.shouldPlay=!0;const D=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,D,A)};return S.once(b.MEDIA_ENDED,R(i)),S.once(b.PLAYOUT_LIMIT_REACHED,R(1/0)),S.on(b.ERROR,(A,I)=>{const D=this.getAssetPlayer(m);if(I.details===X.BUFFER_STALLED_ERROR){if(D!=null&&D.media){const N=D.currentTime,C=D.duration-N;N&&e.appendInPlace&&C/D.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${m} ${e} at ${D.media.currentTime}`),_()):(this.warn(`Stalled at ${N} of ${N+C} in asset ${m} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}return}this.handleAssetItemError(I,e,this.schedule.findEventIndex(e.identifier),i,`Asset player error ${I.error} ${e}`)}),S.on(b.DESTROYING,()=>{if(!this.getAssetPlayer(m))return;const I=new Error(`Asset player destroyed unexpectedly ${m}`),D={fatal:!0,type:pe.OTHER_ERROR,details:X.INTERSTITIAL_ASSET_ITEM_ERROR,error:I};this.handleAssetItemError(D,e,this.schedule.findEventIndex(e.identifier),i,I.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Jr(t)}`),this.hls.trigger(b.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:i,event:e,player:S}),S}clearInterstitial(e,t){e.assetList.forEach(i=>{this.clearAssetPlayer(i.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const i=this.playerQueue[t];this.transferMediaFromPlayer(i,null),i.resetDetails()}}clearAssetPlayer(e,t){const i=this.getAssetPlayerQueueIndex(e);if(i!==-1){this.log(`clear asset player "${e}" toSegment: ${t&&un(t)}`);const s=this.playerQueue[i];this.transferMediaFromPlayer(s,t),this.playerQueue.splice(i,1),s.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,i,s,r){const{interstitial:o,assetItem:u,assetId:d}=e,f=o.assetList.length,h=this.playingAsset;this.endedAsset=null,this.playingAsset=u,(!h||h.identifier!==d)&&(h&&(this.clearAssetPlayer(h.identifier,i[s]),delete h.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${f} ${Jr(u)}`),this.hls.trigger(b.INTERSTITIAL_ASSET_STARTED,{asset:u,assetListIndex:t,event:o,schedule:i.slice(0),scheduleIndex:s,player:e})),this.bufferAssetPlayer(e,r)}bufferAssetPlayer(e,t){var i,s;const{interstitial:r,assetItem:o}=e,u=this.schedule.findEventIndex(r.identifier),d=(i=this.schedule.items)==null?void 0:i[u];if(!d)return;this.setBufferingItem(d),this.bufferingAsset=o;const f=this.getBufferingPlayer();if(f===e)return;const h=r.appendInPlace;if(h&&f?.interstitial.appendInPlace===!1)return;const m=f?.tracks||((s=this.detachedData)==null?void 0:s.tracks)||this.requiredTracks;if(h&&o!==this.playingAsset){if(!e.tracks)return;if(m&&!_T(m,e.tracks)){const v=new Error(`Asset ${Jr(o)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(m)}')`),y={fatal:!0,type:pe.OTHER_ERROR,details:X.INTERSTITIAL_ASSET_ITEM_ERROR,error:v},S=r.findAssetIndex(o);this.handleAssetItemError(y,r,u,S,v.message);return}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,i,s,r){if(e.details===X.BUFFER_STALLED_ERROR)return;const o=t.assetList[s];this.warn(`INTERSTITIAL_ASSET_ERROR ${o&&Jr(o)} ${e.error}`);const u=o?.identifier,d=this.getAssetPlayerQueueIndex(u),f=this.playerQueue[d]||null,h=this.schedule.items,m=Ge({},e,{fatal:!1,errorAction:Gl(!0),asset:o,assetListIndex:s,event:t,schedule:h,scheduleIndex:i,player:f});if(this.hls.trigger(b.INTERSTITIAL_ASSET_ERROR,m),!e.fatal)return;const v=this.playingAsset,y=new Error(r);if(o&&(this.clearAssetPlayer(u,null),o.error=y),!t.assetList.some(S=>!S.error))t.error=y;else{for(let S=s;S<t.assetList.length;S++)this.resetAssetPlayer(t.assetList[S].identifier);this.updateSchedule()}t.error?this.primaryFallback(t):v&&v.identifier===u&&this.advanceAfterAssetEnded(t,i,s)}primaryFallback(e){const t=e.timelineStart,i=this.effectivePlayingItem;if(this.updateSchedule(),i){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${i?un(i):"<none>"} error: ${e.error}`);let s=this.timelinePos;s===-1&&(s=this.hls.startPosition);const r=this.updateItem(i,s);this.itemsMatch(i,r)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));const o=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(o)}else this.checkStart()}onAssetListLoaded(e,t){var i;const s=t.event,r=s.identifier,o=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(r))return;const u=s.timelineStart,d=s.duration;let f=0;o.forEach((S,E)=>{const x=parseFloat(S.DURATION);this.createAsset(s,E,f,u+f,x,S.URI),f+=x}),s.duration=f,this.log(`Loaded asset-list with duration: ${f} (was: ${d}) ${s}`);const h=this.waitingItem,m=h?.event.identifier===r;this.updateSchedule();const v=(i=this.bufferingItem)==null?void 0:i.event;if(m){var y;const S=this.schedule.findEventIndex(r),E=(y=this.schedule.items)==null?void 0:y[S];if(E){if(!this.playingItem&&this.timelinePos>E.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==S){s.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${s}`),this.primaryFallback(s);return}this.setBufferingItem(E)}this.setSchedulePosition(S)}else if(v?.identifier===r&&v.appendInPlace){const S=s.assetList[0],E=this.getAssetPlayer(S.identifier),x=this.primaryMedia;S&&E&&x&&this.bufferAssetPlayer(E,x)}}onError(e,t){switch(t.details){case X.ASSET_LIST_PARSING_ERROR:case X.ASSET_LIST_LOAD_ERROR:case X.ASSET_LIST_LOAD_TIMEOUT:{const i=t.interstitial;i&&this.primaryFallback(i);break}case X.BUFFER_STALLED_ERROR:{this.onTimeupdate(),this.checkBuffer(!0);break}}}}const Jy=500;class CD extends Sg{constructor(e,t,i){super(e,t,i,"subtitle-stream-controller",ge.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=ie.IDLE,this.setInterval(Jy),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:i,success:s}=t;if(this.fragContextChanged(i)||(pt(i)&&(this.fragPrevious=i),this.state=ie.IDLE),!s)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let o;const u=i.start;for(let f=0;f<r.length;f++)if(u>=r[f].start&&u<=r[f].end){o=r[f];break}const d=i.start+i.duration;o?o.end=d:(o={start:u,end:d},r.push(o)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:i,endOffset:s}=t;if(i===0&&s!==Number.POSITIVE_INFINITY){const r=s-1;if(r<=0)return;t.endOffsetSubtitles=Math.max(0,r),this.tracksBuffered.forEach(o=>{for(let u=0;u<o.length;){if(o[u].end<=r){o.shift();continue}else if(o[u].start<r)o[u].start=r;else break;u++}}),this.fragmentTracker.removeFragmentsInRange(i,r,ge.SUBTITLE)}}onError(e,t){const i=t.frag;i?.type===ge.SUBTITLE&&(t.details===X.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==ie.STOPPED&&(this.state=ie.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&TE(this.levels,t)){this.levels=t.map(i=>new Ul(i));return}this.tracksBuffered=[],this.levels=t.map(i=>{const s=new Ul(i);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ge.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var i;if(this.currentTrackId=t.id,!((i=this.levels)!=null&&i.length)||this.currentTrackId===-1){this.clearInterval();return}const s=this.levels[this.currentTrackId];s!=null&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==ie.STOPPED&&this.setInterval(Jy)}onSubtitleTrackLoaded(e,t){var i;const{currentTrackId:s,levels:r}=this,{details:o,id:u}=t;if(!r){this.warn(`Subtitle tracks were reset while loading level ${u}`);return}const d=r[u];if(u>=r.length||!d)return;this.log(`Subtitle track ${u} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let f=0;if(o.live||(i=d.details)!=null&&i.live){if(o.deltaUpdateFailed)return;const m=this.mainDetails;if(!m){this.startFragRequested=!1;return}const v=m.fragments[0];if(!d.details)o.hasProgramDateTime&&m.hasProgramDateTime?(Qu(o,m),f=o.fragmentStart):v&&(f=v.start,Oh(o,f));else{var h;f=this.alignPlaylists(o,d.details,(h=this.levelLastLoaded)==null?void 0:h.details),f===0&&v&&(f=v.start,Oh(o,f))}m&&!this.startFragRequested&&this.setStartPosition(m,f)}d.details=o,this.levelLastLoaded=d,u===s&&(this.hls.trigger(b.SUBTITLE_TRACK_UPDATED,{details:o,id:u,groupId:t.groupId}),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===ie.IDLE&&(nr(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:i}=e,s=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&i&&i.byteLength>0&&s!=null&&s.key&&s.iv&&aa(s.method)){const o=performance.now();this.decrypter.decrypt(new Uint8Array(i),s.key.buffer,s.iv.buffer,yg(s.method)).catch(u=>{throw r.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:t}),u}).then(u=>{const d=performance.now();r.trigger(b.FRAG_DECRYPTED,{frag:t,payload:u,stats:{tstart:o,tdecrypt:d}})}).catch(u=>{this.warn(`${u.name}: ${u.message}`),this.state=ie.IDLE})}}doTick(){if(!this.media){this.state=ie.IDLE;return}if(this.state===ie.IDLE){const{currentTrackId:e,levels:t}=this,i=t?.[e];if(!i||!t.length||!i.details||this.waitForLive(i))return;const{config:s}=this,r=this.getLoadPosition(),o=be.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,s.maxBufferHole),{end:u,len:d}=o,f=i.details,h=this.hls.maxBufferLength+f.levelTargetDuration;if(d>h)return;const m=f.fragments,v=m.length,y=f.edge;let S=null;const E=this.fragPrevious;if(u<y){const R=s.maxFragLookUpTolerance,A=u>y-R?0:R;S=nr(E,m,Math.max(m[0].start,u),A),!S&&E&&E.start<m[0].start&&(S=m[0])}else S=m[v-1];if(S=this.filterReplacedPrimary(S,i.details),!S)return;const x=S.sn-f.startSN,_=m[x-1];if(_&&_.cc===S.cc&&this.fragmentTracker.getState(_)===Tt.NOT_LOADED&&(S=_),this.fragmentTracker.getState(S)===Tt.NOT_LOADED){const R=this.mapToInitFragWhenRequired(S);R&&this.loadFragment(R,i,u)}}}loadFragment(e,t,i){pt(e)?super.loadFragment(e,t,i):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new OD(this.tracksBuffered[this.currentTrackId]||[])}}class OD{constructor(e){this.buffered=void 0;const t=(i,s,r)=>{if(s=s>>>0,s>r-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${r})`);return e[s][i]};this.buffered={get length(){return e.length},end(i){return t("end",i,e.length)},start(i){return t("start",i,e.length)}}}}const MD={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},CE=l=>String.fromCharCode(MD[l]||l),Ki=15,Is=100,PD={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},kD={17:2,18:4,21:6,22:8,23:10,19:13,20:15},ND={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},BD={25:2,26:4,29:6,30:8,31:10,27:13,28:15},FD=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class UD{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const i=typeof t=="function"?t():t;Ne.log(`${this.time} [${e}] ${i}`)}}}const Yn=function(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].toString(16));return t};class OE{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let i=0;i<t.length;i++){const s=t[i];e.hasOwnProperty(s)&&(this[s]=e[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class GD{constructor(){this.uchar=" ",this.penState=new OE}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class $D{constructor(e){this.chars=[],this.pos=0,this.currPenState=new OE,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Is;t++)this.chars.push(new GD);this.logger=e}equals(e){for(let t=0;t<Is;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Is;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Is;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Is&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Is)}moveCursor(e){const t=this.pos+e;if(e>1)for(let i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=CE(e);if(this.pos>=Is){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Is;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let i=0;i<Is;i++){const s=this.chars[i].uchar;s!==" "&&(t=!1),e.push(s)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class jd{constructor(e){this.rows=[],this.currRow=Ki-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Ki;t++)this.rows.push(new $D(e));this.logger=e}reset(){for(let e=0;e<Ki;e++)this.rows[e].clear();this.currRow=Ki-1}equals(e){let t=!0;for(let i=0;i<Ki;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}copy(e){for(let t=0;t<Ki;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Ki;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+Ze(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let u=0;u<Ki;u++)this.rows[u].clear();const r=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const u=o.rows[r].cueStartTime,d=this.logger.time;if(u!==null&&d!==null&&u<d)for(let f=0;f<this.nrRollUpRows;f++)this.rows[t-this.nrRollUpRows+f+1].copy(o.rows[r+f])}}this.currRow=t;const i=this.rows[this.currRow];if(e.indent!==null){const r=e.indent,o=Math.max(r-1,0);i.setCursor(e.indent),e.color=i.chars[o].penState.foreground}const s={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+Ze(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let i="",s=-1;for(let r=0;r<Ki;r++){const o=this.rows[r].getTextString();o&&(s=r+1,e?t.push("Row "+s+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?i="["+t.join(" | ")+"]":i=t.join(`
`)),i}getTextAndFormat(){return this.rows}}class eS{constructor(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new jd(i),this.nonDisplayedMemory=new jd(i),this.lastOutputScreen=new jd(i),this.currRollUpRow=this.displayedMemory.rows[Ki-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Ki-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let i=0;i<e.length;i++)this.writeScreen.insertChar(e[i]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const i=Math.floor(e/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=s[i]}this.logger.log(2,"MIDROW: "+Ze(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class tS{constructor(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=HD(),this.logger=void 0;const s=this.logger=new UD;this.channels=[null,new eS(e,t,s),new eS(e+1,i,s)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let i=0;i<t.length;i+=2){const s=t[i]&127,r=t[i+1]&127;let o=!1,u=null;if(s===0&&r===0)continue;this.logger.log(3,()=>"["+Yn([t[i],t[i+1]])+"] -> ("+Yn([s,r])+")");const d=this.cmdHistory;if(s>=16&&s<=31){if(zD(s,r,d)){yu(null,null,d),this.logger.log(3,()=>"Repeated command ("+Yn([s,r])+") is dropped");continue}yu(s,r,this.cmdHistory),o=this.parseCmd(s,r),o||(o=this.parseMidrow(s,r)),o||(o=this.parsePAC(s,r)),o||(o=this.parseBackgroundAttributes(s,r))}else yu(null,null,d);if(!o&&(u=this.parseChars(s,r),u)){const h=this.currentChannel;h&&h>0?this.channels[h].insertChars(u):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!u&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Yn([s,r])+" orig: "+Yn([t[i],t[i+1]]))}}parseCmd(e,t){const i=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=33&&t<=35;if(!(i||s))return!1;const r=e===20||e===21||e===23?1:2,o=this.channels[r];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=r,!0}parseMidrow(e,t){let i=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[i];return s?(s.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Yn([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let i;const s=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,r=(e===16||e===24)&&t>=64&&t<=95;if(!(s||r))return!1;const o=e<=23?1:2;t>=64&&t<=95?i=o===1?PD[e]:ND[e]:i=o===1?kD[e]:BD[e];const u=this.channels[o];return u?(u.setPAC(this.interpretPAC(i,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let i;const s={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?i=t-96:i=t-64,s.underline=(i&1)===1,i<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((i-16)/2)*4,s}parseChars(e,t){let i,s=null,r=null;if(e>=25?(i=2,r=e-8):(i=1,r=e),r>=17&&r<=19){let o;r===17?o=t+80:r===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+CE(o)+"' in channel "+i),s=[o]}else e>=32&&e<=127&&(s=t===0?[e]:[e,t]);return s&&this.logger.log(3,()=>"Char codes =  "+Yn(s).join(",")),s}parseBackgroundAttributes(e,t){const i=(e===16||e===24)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=45&&t<=47;if(!(i||s))return!1;let r;const o={};e===16||e===24?(r=Math.floor((t-32)/2),o.background=FD[r],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const u=e<=23?1:2;return this.channels[u].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}yu(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const i=this.channels[t];i&&i.cueSplitAtTime(e)}}}function yu(l,e,t){t.a=l,t.b=e}function zD(l,e,t){return t.a===l&&t.b===e}function HD(){return{a:null,b:null}}var wg=function(){if(Xu!=null&&Xu.VTTCue)return self.VTTCue;const l=["","lr","rl"],e=["start","middle","end","left","right"];function t(u,d){if(typeof d!="string"||!Array.isArray(u))return!1;const f=d.toLowerCase();return~u.indexOf(f)?f:!1}function i(u){return t(l,u)}function s(u){return t(e,u)}function r(u,...d){let f=1;for(;f<arguments.length;f++){const h=arguments[f];for(const m in h)u[m]=h[m]}return u}function o(u,d,f){const h=this,m={enumerable:!0};h.hasBeenReset=!1;let v="",y=!1,S=u,E=d,x=f,_=null,R="",A=!0,I="auto",D="start",N=50,C="middle",M=50,O="middle";Object.defineProperty(h,"id",r({},m,{get:function(){return v},set:function(P){v=""+P}})),Object.defineProperty(h,"pauseOnExit",r({},m,{get:function(){return y},set:function(P){y=!!P}})),Object.defineProperty(h,"startTime",r({},m,{get:function(){return S},set:function(P){if(typeof P!="number")throw new TypeError("Start time must be set to a number.");S=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",r({},m,{get:function(){return E},set:function(P){if(typeof P!="number")throw new TypeError("End time must be set to a number.");E=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",r({},m,{get:function(){return x},set:function(P){x=""+P,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",r({},m,{get:function(){return _},set:function(P){_=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",r({},m,{get:function(){return R},set:function(P){const U=i(P);if(U===!1)throw new SyntaxError("An invalid or illegal string was specified.");R=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",r({},m,{get:function(){return A},set:function(P){A=!!P,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",r({},m,{get:function(){return I},set:function(P){if(typeof P!="number"&&P!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");I=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",r({},m,{get:function(){return D},set:function(P){const U=s(P);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");D=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",r({},m,{get:function(){return N},set:function(P){if(P<0||P>100)throw new Error("Position must be between 0 and 100.");N=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",r({},m,{get:function(){return C},set:function(P){const U=s(P);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");C=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",r({},m,{get:function(){return M},set:function(P){if(P<0||P>100)throw new Error("Size must be between 0 and 100.");M=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",r({},m,{get:function(){return O},set:function(P){const U=s(P);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");O=U,this.hasBeenReset=!0}})),h.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class VD{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function ME(l){function e(i,s,r,o){return(i|0)*3600+(s|0)*60+(r|0)+parseFloat(o||0)}const t=l.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class KD{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,i){for(let s=0;s<i.length;++s)if(t===i[s]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const i=parseFloat(t);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}}function PE(l,e,t,i){const s=i?l.split(i):[l];for(const r in s){if(typeof s[r]!="string")continue;const o=s[r].split(t);if(o.length!==2)continue;const u=o[0],d=o[1];e(u,d)}}const Uh=new wg(0,0,""),Su=Uh.align==="middle"?"middle":"center";function YD(l,e,t){const i=l;function s(){const u=ME(l);if(u===null)throw new Error("Malformed timestamp: "+i);return l=l.replace(/^[^\sa-zA-Z-]+/,""),u}function r(u,d){const f=new KD;PE(u,function(v,y){let S;switch(v){case"region":for(let E=t.length-1;E>=0;E--)if(t[E].id===y){f.set(v,t[E].region);break}break;case"vertical":f.alt(v,y,["rl","lr"]);break;case"line":S=y.split(","),f.integer(v,S[0]),f.percent(v,S[0])&&f.set("snapToLines",!1),f.alt(v,S[0],["auto"]),S.length===2&&f.alt("lineAlign",S[1],["start",Su,"end"]);break;case"position":S=y.split(","),f.percent(v,S[0]),S.length===2&&f.alt("positionAlign",S[1],["start",Su,"end","line-left","line-right","auto"]);break;case"size":f.percent(v,y);break;case"align":f.alt(v,y,["start",Su,"end","left","right"]);break}},/:/,/\s/),d.region=f.get("region",null),d.vertical=f.get("vertical","");let h=f.get("line","auto");h==="auto"&&Uh.line===-1&&(h=-1),d.line=h,d.lineAlign=f.get("lineAlign","start"),d.snapToLines=f.get("snapToLines",!0),d.size=f.get("size",100),d.align=f.get("align",Su);let m=f.get("position","auto");m==="auto"&&Uh.position===50&&(m=d.align==="start"||d.align==="left"?0:d.align==="end"||d.align==="right"?100:50),d.position=m}function o(){l=l.replace(/^\s+/,"")}if(o(),e.startTime=s(),o(),l.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);l=l.slice(3),o(),e.endTime=s(),o(),r(l,e)}function kE(l){return l.replace(/<br(?: \/)?>/gi,`
`)}class jD{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new VD,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function i(){let r=t.buffer,o=0;for(r=kE(r);o<r.length&&r[o]!=="\r"&&r[o]!==`
`;)++o;const u=r.slice(0,o);return r[o]==="\r"&&++o,r[o]===`
`&&++o,t.buffer=r.slice(o),u}function s(r){PE(r,function(o,u){},/:/)}try{let r="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;r=i();const u=r.match(/^()?WEBVTT([ \t].*)?$/);if(!(u!=null&&u[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:r=i(),t.state){case"HEADER":/:/.test(r)?s(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new wg(0,0,""),t.state="CUE",r.indexOf("-->")===-1){t.cue.id=r;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{YD(r,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const u=r.indexOf("-->")!==-1;if(!r||u&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=r}continue;case"BADCUE":r||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const qD=/\r\n|\n\r|\n|\r/g,qd=function(e,t,i=0){return e.slice(i,i+t.length)===t},XD=function(e){let t=parseInt(e.slice(-3));const i=parseInt(e.slice(-6,-4)),s=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!de(t)||!de(i)||!de(s)||!de(r))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*i,t+=60*1e3*s,t+=3600*1e3*r,t};function Cg(l,e,t){return Il(l.toString())+Il(e.toString())+Il(t)}const QD=function(e,t,i){let s=e[t],r=e[s.prevCC];if(!r||!r.new&&s.new){e.ccOffset=e.presentationOffset=s.start,s.new=!1;return}for(;(o=r)!=null&&o.new;){var o;e.ccOffset+=s.start-r.start,s.new=!1,s=r,r=e[s.prevCC]}e.presentationOffset=i};function WD(l,e,t,i,s,r,o){const u=new jD,d=yi(new Uint8Array(l)).trim().replace(qD,`
`).split(`
`),f=[],h=e?dR(e.baseTime,e.timescale):0;let m="00:00.000",v=0,y=0,S,E=!0;u.oncue=function(x){const _=t[i];let R=t.ccOffset;const A=(v-h)/9e4;if(_!=null&&_.new&&(y!==void 0?R=t.ccOffset=_.start:QD(t,i,A)),A){if(!e){S=new Error("Missing initPTS for VTT MPEGTS");return}R=A-t.presentationOffset}const I=x.endTime-x.startTime,D=Mi((x.startTime+R-y)*9e4,s*9e4)/9e4;x.startTime=Math.max(D,0),x.endTime=Math.max(D+I,0);const N=x.text.trim();x.text=decodeURIComponent(encodeURIComponent(N)),x.id||(x.id=Cg(x.startTime,x.endTime,N)),x.endTime>0&&f.push(x)},u.onparsingerror=function(x){S=x},u.onflush=function(){if(S){o(S);return}r(f)},d.forEach(x=>{if(E)if(qd(x,"X-TIMESTAMP-MAP=")){E=!1,x.slice(16).split(",").forEach(_=>{qd(_,"LOCAL:")?m=_.slice(6):qd(_,"MPEGTS:")&&(v=parseInt(_.slice(7)))});try{y=XD(m)/1e3}catch(_){S=_}return}else x===""&&(E=!1);u.parse(x+`
`)}),u.flush()}const Xd="stpp.ttml.im1t",NE=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,BE=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,ZD={left:"start",center:"center",right:"end",start:"start",end:"end"};function iS(l,e,t,i){const s=Re(new Uint8Array(l),["mdat"]);if(s.length===0){i(new Error("Could not parse IMSC1 mdat"));return}const r=s.map(u=>yi(u)),o=fR(e.baseTime,1,e.timescale);try{r.forEach(u=>t(JD(u,o)))}catch(u){i(u)}}function JD(l,e){const s=new DOMParser().parseFromString(l,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(r).reduce((m,v)=>(m[v]=s.getAttribute(`ttp:${v}`)||r[v],m),{}),u=s.getAttribute("xml:space")!=="preserve",d=sS(Qd(s,"styling","style")),f=sS(Qd(s,"layout","region")),h=Qd(s,"body","[begin]");return[].map.call(h,m=>{const v=FE(m,u);if(!v||!m.hasAttribute("begin"))return null;const y=Zd(m.getAttribute("begin"),o),S=Zd(m.getAttribute("dur"),o);let E=Zd(m.getAttribute("end"),o);if(y===null)throw nS(m);if(E===null){if(S===null)throw nS(m);E=y+S}const x=new wg(y-e,E-e,v);x.id=Cg(x.startTime,x.endTime,x.text);const _=f[m.getAttribute("region")],R=d[m.getAttribute("style")],A=eI(_,R,d),{textAlign:I}=A;if(I){const D=ZD[I];D&&(x.lineAlign=D),x.align=I}return Ge(x,A),x}).filter(m=>m!==null)}function Qd(l,e,t){const i=l.getElementsByTagName(e)[0];return i?[].slice.call(i.querySelectorAll(t)):[]}function sS(l){return l.reduce((e,t)=>{const i=t.getAttribute("xml:id");return i&&(e[i]=t),e},{})}function FE(l,e){return[].slice.call(l.childNodes).reduce((t,i,s)=>{var r;return i.nodeName==="br"&&s?t+`
`:(r=i.childNodes)!=null&&r.length?FE(i,e):e?t+i.textContent.trim().replace(/\s+/g," "):t+i.textContent},"")}function eI(l,e,t){const i="http://www.w3.org/ns/ttml#styling";let s=null;const r=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=l!=null&&l.hasAttribute("style")?l.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(s=t[o]),r.reduce((u,d)=>{const f=Wd(e,i,d)||Wd(l,i,d)||Wd(s,i,d);return f&&(u[d]=f),u},{})}function Wd(l,e,t){return l&&l.hasAttributeNS(e,t)?l.getAttributeNS(e,t):null}function nS(l){return new Error(`Could not parse ttml timestamp ${l}`)}function Zd(l,e){if(!l)return null;let t=ME(l);return t===null&&(NE.test(l)?t=tI(l,e):BE.test(l)&&(t=iI(l,e))),t}function tI(l,e){const t=NE.exec(l),i=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+i/e.frameRate}function iI(l,e){const t=BE.exec(l),i=Number(t[1]);switch(t[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/e.frameRate;case"t":return i/e.tickRate}return i}class Tu{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,i){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class sI{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=aS(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(b.FRAG_LOADING,this.onFragLoading,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this),e.on(b.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(b.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(b.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this),e.off(b.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(b.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(b.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Tu(this,"textTrack1"),t=new Tu(this,"textTrack2"),i=new Tu(this,"textTrack3"),s=new Tu(this,"textTrack4");this.cea608Parser1=new tS(1,e,t),this.cea608Parser2=new tS(3,i,s)}addCues(e,t,i,s,r){let o=!1;for(let u=r.length;u--;){const d=r[u],f=nI(d[0],d[1],t,i);if(f>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],i),o=!0,f/(i-t)>.5))return}if(o||r.push([t,i]),this.config.renderTextTracksNatively){const u=this.captionsTracks[e];this.Cues.newCue(u,t,i,s)}else{const u=this.Cues.newCue(null,t,i,s);this.hls.trigger(b.CUES_PARSED,{type:"captions",cues:u,track:e})}}onInitPtsFound(e,{frag:t,id:i,initPTS:s,timescale:r}){const{unparsedVttFrags:o}=this;i===ge.MAIN&&(this.initPTS[t.cc]={baseTime:s,timescale:r}),o.length&&(this.unparsedVttFrags=[],o.forEach(u=>{this.initPTS[u.frag.cc]?this.onFragLoaded(b.FRAG_LOADED,u):this.hls.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:u.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:i}=this;if(i)for(let s=0;s<i.textTracks.length;s++){const r=i.textTracks[s];if(rS(r,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:i,media:s}=this,{label:r,languageCode:o}=t[e],u=this.getExistingTrack(r,o);if(u)i[e]=u,ia(i[e]),DE(i[e],s);else{const d=this.createTextTrack("captions",r,o);d&&(d[e]=!0,i[e]=d)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const i=t.label,s={_id:e,label:i,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=s,this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(e,t,i){const s=this.media;if(s)return s.addTextTrack(e,t,i)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const i=!!t.transferMedia;if(this.media=null,i)return;const{captionsTracks:s}=this;Object.keys(s).forEach(r=>{ia(s[r]),delete s[r]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=aS(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let i=0;i<t.length;i++)ia(t[i])}onSubtitleTracksUpdated(e,t){const i=t.subtitleTracks||[],s=i.some(r=>r.textCodec===Xd);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(TE(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const o=this.media,u=o?Mu(o.textTracks):null;if(this.tracks.forEach((d,f)=>{let h;if(u){let m=null;for(let v=0;v<u.length;v++)if(u[v]&&rS(u[v],d)){m=u[v],u[v]=null;break}m&&(h=m)}if(h)ia(h);else{const m=UE(d);h=this.createTextTrack(m,d.name,d.lang),h&&(h.mode="disabled")}h&&this.textTracks.push(h)}),u!=null&&u.length){const d=u.filter(f=>f!==null).map(f=>f.label);d.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${d.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(u=>({label:u.name,kind:u.type.toLowerCase(),default:u.default,subtitleTrack:u}));this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(i=>{const s=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!s)return;const r=`textTrack${s[1]}`,o=this.captionsProperties[r];o&&(o.label=i.name,i.lang&&(o.languageCode=i.lang),o.media=i)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===ge.MAIN){var i,s;const{cea608Parser1:r,cea608Parser2:o,lastSn:u}=this,{cc:d,sn:f}=t.frag,h=(i=(s=t.part)==null?void 0:s.index)!=null?i:-1;r&&o&&(f!==u+1||f===u&&h!==this.lastPartIndex+1||d!==this.lastCc)&&(r.reset(),o.reset()),this.lastCc=d,this.lastSn=f,this.lastPartIndex=h}}onFragLoaded(e,t){const{frag:i,payload:s}=t;if(i.type===ge.SUBTITLE)if(s.byteLength){const r=i.decryptdata,o="stats"in t;if(r==null||!r.encrypted||o){const u=this.tracks[i.level],d=this.vttCCs;d[i.cc]||(d[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),u&&u.textCodec===Xd?this._parseIMSC1(i,s):this._parseVTTs(t)}}else this.hls.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const i=this.hls;iS(t,this.initPTS[e.cc],s=>{this._appendCues(s,e.level),i.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},s=>{i.logger.log(`Failed to parse IMSC1: ${s}`),i.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:s})})}_parseVTTs(e){var t;const{frag:i,payload:s}=e,{initPTS:r,unparsedVttFrags:o}=this,u=r.length-1;if(!r[i.cc]&&u===-1){o.push(e);return}const d=this.hls,f=(t=i.initSegment)!=null&&t.data?Ui(i.initSegment.data,new Uint8Array(s)).buffer:s;WD(f,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,h=>{this._appendCues(h,i.level),d.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},h=>{const m=h.message==="Missing initPTS for VTT MPEGTS";m?o.push(e):this._fallbackToIMSC1(i,s),d.logger.log(`Failed to parse VTT cue: ${h}`),!(m&&u>i.cc)&&d.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:h})})}_fallbackToIMSC1(e,t){const i=this.tracks[e.level];i.textCodec||iS(t,this.initPTS[e.cc],()=>{i.textCodec=Xd,this._parseIMSC1(e,t)},()=>{i.textCodec="wvtt"})}_appendCues(e,t){const i=this.hls;if(this.config.renderTextTracksNatively){const s=this.textTracks[t];if(!s||s.mode==="disabled")return;e.forEach(r=>IE(s,r))}else{const s=this.tracks[t];if(!s)return;const r=s.default?"default":"subtitles"+t;i.trigger(b.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:i}=t;i.type===ge.SUBTITLE&&this.onFragLoaded(b.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:i,samples:s}=t;if(!(i.type===ge.MAIN&&this.closedCaptionsForLevel(i)==="NONE"))for(let r=0;r<s.length;r++){const o=s[r].bytes;if(o){this.cea608Parser1||this.initCea608Parsers();const u=this.extractCea608Data(o);this.cea608Parser1.addData(s[r].pts,u[0]),this.cea608Parser2.addData(s[r].pts,u[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:i,endOffsetSubtitles:s,type:r}){const{media:o}=this;if(!(!o||o.currentTime<i)){if(!r||r==="video"){const{captionsTracks:u}=this;Object.keys(u).forEach(d=>Fh(u[d],t,i))}if(this.config.renderTextTracksNatively&&t===0&&s!==void 0){const{textTracks:u}=this;Object.keys(u).forEach(d=>Fh(u[d],t,s))}}}extractCea608Data(e){const t=[[],[]],i=e[0]&31;let s=2;for(let r=0;r<i;r++){const o=e[s++],u=127&e[s++],d=127&e[s++];if(u===0&&d===0)continue;if((4&o)!==0){const h=3&o;(h===0||h===1)&&(t[h].push(u),t[h].push(d))}}return t}}function UE(l){return l.characteristics&&/transcribes-spoken-dialog/gi.test(l.characteristics)&&/describes-music-and-sound/gi.test(l.characteristics)?"captions":"subtitles"}function rS(l,e){return!!l&&l.kind===UE(e)&&kh(e,l)}function nI(l,e,t,i){return Math.min(e,i)-Math.max(l,t)}function aS(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const rI=/\s/,aI={newCue(l,e,t,i){const s=[];let r,o,u,d,f;const h=self.VTTCue||self.TextTrackCue;for(let v=0;v<i.rows.length;v++)if(r=i.rows[v],u=!0,d=0,f="",!r.isEmpty()){var m;for(let E=0;E<r.chars.length;E++)rI.test(r.chars[E].uchar)&&u?d++:(f+=r.chars[E].uchar,u=!1);r.cueStartTime=e,e===t&&(t+=1e-4),d>=16?d--:d++;const y=kE(f.trim()),S=Cg(e,t,y);l!=null&&(m=l.cues)!=null&&m.getCueById(S)||(o=new h(e,t,y),o.id=S,o.line=v+1,o.align="left",o.position=10+Math.min(80,Math.floor(d*8/32)*10),s.push(o))}return l&&s.length&&(s.sort((v,y)=>v.line==="auto"||y.line==="auto"?0:v.line>8&&y.line>8?y.line-v.line:v.line-y.line),s.forEach(v=>IE(l,v))),s}};function lI(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const oI=/(\d+)-(\d+)\/(\d+)/;class lS{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||dI,this.controller=new self.AbortController,this.stats=new fg}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,i){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const r=uI(e,this.controller.signal),o=e.responseType==="arraybuffer",u=o?"byteLength":"length",{maxTimeToFirstByteMs:d,maxLoadTimeMs:f}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=d&&de(d)?d:f,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},t.timeout),(Hl(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(m=>{var v;this.response=this.loader=m;const y=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=f,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},f-(y-s.loading.start)),!m.ok){const{status:E,statusText:x}=m;throw new hI(x||"fetch, bad network response",E,m)}s.loading.first=y,s.total=fI(m.headers)||s.total;const S=(v=this.callbacks)==null?void 0:v.onProgress;return S&&de(t.highWaterMark)?this.loadProgressively(m,s,e,t.highWaterMark,S):o?m.arrayBuffer():e.responseType==="json"?m.json():m.text()}).then(m=>{var v,y;const S=this.response;if(!S)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const E=m[u];E&&(s.loaded=s.total=E);const x={url:S.url,data:m,code:S.status},_=(v=this.callbacks)==null?void 0:v.onProgress;_&&!de(t.highWaterMark)&&_(s,e,m,S),(y=this.callbacks)==null||y.onSuccess(x,s,e,S)}).catch(m=>{var v;if(self.clearTimeout(this.requestTimeout),s.aborted)return;const y=m&&m.code||0,S=m?m.message:null;(v=this.callbacks)==null||v.onError({code:y,text:S},e,m?m.details:null,s)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,i,s=0,r){const o=new eE,u=e.body.getReader(),d=()=>u.read().then(f=>{if(f.done)return o.dataLength&&r(t,i,o.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const h=f.value,m=h.length;return t.loaded+=m,m<s||o.dataLength?(o.push(h),o.dataLength>=s&&r(t,i,o.flush().buffer,e)):r(t,i,h.buffer,e),d()}).catch(()=>Promise.reject());return d()}}function uI(l,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Ge({},l.headers))};return l.rangeEnd&&t.headers.set("Range","bytes="+l.rangeStart+"-"+String(l.rangeEnd-1)),t}function cI(l){const e=oI.exec(l);if(e)return parseInt(e[2])-parseInt(e[1])+1}function fI(l){const e=l.get("Content-Range");if(e){const i=cI(e);if(de(i))return i}const t=l.get("Content-Length");if(t)return parseInt(t)}function dI(l,e){return new self.Request(l.url,e)}class hI extends Error{constructor(e,t,i){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=i}}const gI=/^age:\s*[\d.]+\s*$/im;class GE{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new fg,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const i=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then(()=>{if(!(this.loader!==i||this.stats.aborted))return r(i,t.url)}).catch(o=>{if(!(this.loader!==i||this.stats.aborted))return i.open("GET",t.url,!0),r(i,t.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,t,e)}).catch(o=>{var u;(u=this.callbacks)==null||u.onError({code:i.status,text:o.message},t,i,s)}):this.openAndSendXhr(i,t,e)}openAndSendXhr(e,t,i){e.readyState||e.open("GET",t.url,!0);const s=t.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:o}=i.loadPolicy;if(s)for(const u in s)e.setRequestHeader(u,s[u]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),i.timeout=r&&de(r)?r:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:i}=this;if(!e||!t)return;const s=t.readyState,r=this.config;if(!i.aborted&&s>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const f=t.status,h=t.responseType==="text"?t.responseText:null;if(f>=200&&f<300){const S=h??t.response;if(S!=null){var o,u;i.loading.end=Math.max(self.performance.now(),i.loading.first);const E=t.responseType==="arraybuffer"?S.byteLength:S.length;i.loaded=i.total=E,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first);const x=(o=this.callbacks)==null?void 0:o.onProgress;x&&x(i,e,S,t);const _={url:t.responseURL,data:S,code:f};(u=this.callbacks)==null||u.onSuccess(_,i,e,t);return}}const m=r.loadPolicy.errorRetry,v=i.retry,y={url:e.url,data:void 0,code:f};if(qu(m,v,!1,y))this.retry(m);else{var d;Ne.error(`${f} while loading ${e.url}`),(d=this.callbacks)==null||d.onError({code:f,text:t.statusText},e,t,i)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(qu(e,t,!0))this.retry(e);else{var i;Ne.warn(`timeout while loading ${(i=this.context)==null?void 0:i.url}`);const s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:i}=this;this.retryDelay=mg(e,i.retry),i.retry++,Ne.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t?.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&gI.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const mI={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},pI=Ke(Ke({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:GE,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:FA,bufferController:RR,capLevelController:Dg,errorController:HA,fpsController:SD,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:VT,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:mI},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},vI()),{},{subtitleStreamController:CD,subtitleTrackController:xD,timelineController:sI,audioStreamController:_R,audioTrackController:bR,emeController:la,cmcdController:pD,contentSteeringController:yD,interstitialsController:wD});function vI(){return{cueHandler:aI,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function yI(l,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=Gh(l),s=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(o=>{const u=`${o==="level"?"playlist":o}LoadPolicy`,d=e[u]===void 0,f=[];r.forEach(h=>{const m=`${o}Loading${h}`,v=e[m];if(v!==void 0&&d){f.push(m);const y=i[u].default;switch(e[u]={default:y},h){case"TimeOut":y.maxLoadTimeMs=v,y.maxTimeToFirstByteMs=v;break;case"MaxRetry":y.errorRetry.maxNumRetry=v,y.timeoutRetry.maxNumRetry=v;break;case"RetryDelay":y.errorRetry.retryDelayMs=v,y.timeoutRetry.retryDelayMs=v;break;case"MaxRetryTimeout":y.errorRetry.maxRetryDelayMs=v,y.timeoutRetry.maxRetryDelayMs=v;break}}}),f.length&&t.warn(`hls.js config: "${f.join('", "')}" setting(s) are deprecated, use "${u}": ${Ze(e[u])}`)}),Ke(Ke({},i),e)}function Gh(l){return l&&typeof l=="object"?Array.isArray(l)?l.map(Gh):Object.keys(l).reduce((e,t)=>(e[t]=Gh(l[t]),e),{}):l}function SI(l,e){const t=l.loader;t!==lS&&t!==GE?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),l.progressive=!1):lI()&&(l.loader=lS,l.progressive=!0,l.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const Pu=2,TI=.1,EI=.05,xI=100;class _I extends GT{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var i;(i=this.media)!=null&&i.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var i;this.ended=((i=this.media)==null?void 0:i.currentTime)||1,this.hls.trigger(b.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(xI),this.mediaSource=t.mediaSource;const i=this.media=t.media;Fi(i,"playing",this.onMediaPlaying),Fi(i,"waiting",this.onMediaWaiting),Fi(i,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:i}=this;i&&(ji(i,"playing",this.onMediaPlaying),ji(i,"waiting",this.onMediaWaiting),ji(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var i,s;const r=(i=this.hls)==null?void 0:i.config;if(!r)return;const o=this.media;if(!o)return;const{seeking:u}=o,d=this.seeking&&!u,f=!this.seeking&&u,h=o.paused&&!u||o.ended||o.playbackRate===0;if(this.seeking=u,e!==t){t&&(this.ended=0),this.moved=!0,u||(this.nudgeRetry=0,r.nudgeOnVideoHole&&!h&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(f||d){d&&this.stallResolved(e);return}if(h){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&o.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(b.MEDIA_ENDED,{stalled:!1}));return}if(!be.getBuffered(o).length){this.nudgeRetry=0;return}const m=be.bufferInfo(o,e,0),v=m.nextStart||0,y=this.fragmentTracker;if(u&&y&&this.hls){const N=oS(this.hls.inFlightFragments,e),C=m.len>Pu,M=!v||N||v-e>Pu&&!y.getPartialFragment(e);if(C||M)return;this.moved=!1}const S=(s=this.hls)==null?void 0:s.latestLevelDetails;if(!this.moved&&this.stalled!==null&&y){if(!(m.len>0)&&!v)return;const C=Math.max(v,m.start||0)-e,O=!!(S!=null&&S.live)?S.targetduration*2:Pu,P=y.getPartialFragment(e);if(C>0&&(C<=O||P)){o.paused||this._trySkipBufferHole(P);return}}const E=r.detectStallWithCurrentTimeMs,x=self.performance.now(),_=this.waiting;let R=this.stalled;if(R===null)if(_>0&&x-_<E)R=this.stalled=_;else{this.stalled=x;return}const A=x-R;if(!u&&(A>=E||_)&&this.hls){var I;if(((I=this.mediaSource)==null?void 0:I.readyState)==="ended"&&!(S!=null&&S.live)&&Math.abs(e-(S?.edge||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(b.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(m),!this.media||!this.hls)return}const D=be.bufferInfo(o,e,r.maxBufferHole);this._tryFixBufferStall(D,A,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const i=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(b.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var i;const s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(i=this.buffered.audio)!=null&&i.length&&s&&s.length>1&&e>s.end(0)){const r=be.bufferedInfo(be.timeRangesToArray(this.buffered.audio),e,0);if(r.len>1&&t>=r.start){const o=be.timeRangesToArray(s),u=be.bufferedInfo(o,t,0).bufferedIndex;if(u>-1&&u<o.length-1){const d=be.bufferedInfo(o,e,0).bufferedIndex,f=o[u].end,h=o[u+1].start;if((d===-1||d>u)&&h-f<1&&e-f<2){const m=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${f} -> ${h} buffered index: ${d}`);this.warn(m.message),this.media.currentTime+=1e-6;const v=this.fragmentTracker.getPartialFragment(e)||void 0,y=be.bufferInfo(this.media,e,0);this.hls.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:m,reason:m.message,frag:v,buffer:y.len,bufferInfo:y})}}}}}_tryFixBufferStall(e,t,i){var s,r;const{fragmentTracker:o,media:u}=this,d=(s=this.hls)==null?void 0:s.config;if(!u||!o||!d)return;const f=(r=this.hls)==null?void 0:r.latestLevelDetails,h=o.getPartialFragment(i);if((h||f!=null&&f.live&&i<f.fragmentStart)&&(this._trySkipBufferHole(h)||!this.media))return;const m=e.buffered,v=this.adjacentTraversal(e,i);(m&&m.length>1&&e.len>d.maxBufferHole||e.nextStart&&(e.nextStart-i<d.maxBufferHole||v))&&(t>d.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const i=this.fragmentTracker,s=e.nextStart;if(i&&s){const r=i.getFragAtPos(t,ge.MAIN),o=i.getFragAtPos(s,ge.MAIN);if(r&&o)return o.sn-r.sn<2}return!1}_reportStall(e){const{hls:t,media:i,stallReported:s,stalled:r}=this;if(!s&&r!==null&&i&&t){this.stallReported=!0;const o=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${Ze(e)})`);this.warn(o.message),t.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:e.len,bufferInfo:e,stalled:{start:r}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:i,media:s}=this,r=(t=this.hls)==null?void 0:t.config;if(!s||!i||!r)return 0;const o=s.currentTime,u=be.bufferInfo(s,o,0),d=o<u.start?u.start:u.nextStart;if(d&&this.hls){const h=u.len<=r.maxBufferHole,m=u.len>0&&u.len<1&&s.readyState<3,v=d-o;if(v>0&&(h||m)){if(v>r.maxBufferHole){let S=!1;if(o===0){const E=i.getAppendedFrag(0,ge.MAIN);E&&d<E.end&&(S=!0)}if(!S){const E=e||i.getAppendedFrag(o,ge.MAIN);if(E){var f;if(!((f=this.hls.loadLevelObj)!=null&&f.details)||oS(this.hls.inFlightFragments,d))return 0;let _=!1,R=E.end;for(;R<d;){const A=i.getAppendedFrag(R,ge.MAIN)||i.getPartialFragment(R);if(A)R+=A.duration;else{_=!0;break}}if(_)return 0}}}const y=Math.max(d+EI,o+TI);if(this.warn(`skipping hole, adjusting currentTime from ${o} to ${y}`),this.moved=!0,s.currentTime=y,!(e!=null&&e.gap)){const S=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${y}`);this.hls.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:S,reason:S.message,frag:e||void 0,buffer:u.len,bufferInfo:u})}return y}}return 0}_tryNudgeBuffer(e){const{hls:t,media:i,nudgeRetry:s}=this,r=t?.config;if(!i||!r)return 0;const o=i.currentTime;if(this.nudgeRetry++,s<r.nudgeMaxRetry){const u=o+(s+1)*r.nudgeOffset,d=new Error(`Nudging 'currentTime' from ${o} to ${u}`);this.warn(d.message),i.currentTime=u,t.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.BUFFER_NUDGE_ON_STALL,error:d,fatal:!1,buffer:e.len,bufferInfo:e})}else{const u=new Error(`Playhead still not moving while enough data buffered @${o} after ${r.nudgeMaxRetry} nudges`);this.error(u.message),t.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.BUFFER_STALLED_ERROR,error:u,fatal:!0,buffer:e.len,bufferInfo:e})}}}function oS(l,e){const t=uS(l.main);if(t&&t.start<=e)return t;const i=uS(l.audio);return i&&i.start<=e?i:null}function uS(l){if(!l)return null;switch(l.state){case ie.IDLE:case ie.STOPPED:case ie.ENDED:case ie.ERROR:return null}return l.frag}const bI=.25;function $h(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function cS(l,e,t,i,s){let r=new l(e,t,"");try{r.value=i,s&&(r.type=s)}catch{r=new l(e,t,Ze(s?Ke({type:s},i):i))}return r}const Eu=(()=>{const l=$h();try{l&&new l(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class AI{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(b.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var i;this.media=t.media,((i=t.overrides)==null?void 0:i.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&ia(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const i=e[t];if(i.kind==="metadata"&&i.label==="id3")return DE(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:s}}}=this;if(!i&&!s)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=$h();if(o)for(let u=0;u<r.length;u++){const d=r[u].type;if(d===hi.emsg&&!i||!s)continue;const f=lE(r[u].data);if(f){const h=r[u].pts;let m=h+r[u].duration;m>Eu&&(m=Eu),m-h<=0&&(m=h+bI);for(let y=0;y<f.length;y++){const S=f[y];if(!oE(S)){this.updateId3CueEnds(h,d);const E=cS(o,h,m,S,d);E&&this.id3Track.addCue(E)}}}}}updateId3CueEnds(e,t){var i;const s=(i=this.id3Track)==null?void 0:i.cues;if(s)for(let r=s.length;r--;){const o=s[r];o.type===t&&o.startTime<e&&o.endTime===Eu&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:i,type:s}){const{id3Track:r,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:u,enableID3MetadataCues:d}}=o;if(r&&(u||d)){let f;s==="audio"?f=h=>h.type===hi.audioId3&&d:s==="video"?f=h=>h.type===hi.emsg&&u:f=h=>h.type===hi.audioId3&&d||h.type===hi.emsg&&u,Fh(r,t,i,f)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:i}=this,{dateRanges:s}=e,r=Object.keys(s);let o=this.dateRangeCuesAppended;if(i&&t){var u;if((u=i.cues)!=null&&u.length){const h=Object.keys(o).filter(m=>!r.includes(m));for(let m=h.length;m--;){const v=h[m],y=o[v].cues;delete o[v],Object.keys(y).forEach(S=>{try{const E=y[S];E.removeEventListener("enter",this.onEventCueEnter),i.removeCue(E)}catch{}})}}else o=this.dateRangeCuesAppended={}}const d=e.fragments[e.fragments.length-1];if(r.length===0||!de(d?.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const f=$h();for(let h=0;h<r.length;h++){const m=r[h],v=s[m],y=v.startTime,S=o[m],E=S?.cues||{};let x=S?.durationKnown||!1,_=Eu;const{duration:R,endDate:A}=v;if(A&&R!==null)_=y+R,x=!0;else if(v.endOnNext&&!x){const D=r.reduce((N,C)=>{if(C!==v.id){const M=s[C];if(M.class===v.class&&M.startDate>v.startDate&&(!N||v.startDate<N.startDate))return M}return N},null);D&&(_=D.startTime,x=!0)}const I=Object.keys(v.attr);for(let D=0;D<I.length;D++){const N=I[D];if(!iL(N))continue;const C=E[N];if(C)x&&!S.durationKnown?C.endTime=_:Math.abs(C.startTime-y)>.01&&(C.startTime=y,C.endTime=_);else if(f){let M=v.attr[N];sL(N)&&(M=bT(M));const P=cS(f,y,_,{key:N,data:M},hi.dateRange);P&&(P.id=m,this.id3Track.addCue(P),E[N]=P,this.hls.config.interstitialsController&&(N==="X-ASSET-LIST"||N==="X-ASSET-URL")&&P.addEventListener("enter",this.onEventCueEnter))}}o[m]={cues:E,dateRange:v,durationKnown:x}}}}class LI{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,i=this.levelDetails;if(!t||!i)return;this.currentTime=t.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:o}=this.config;if(!r||o===1||!i.live)return;const u=this.targetLatency;if(u===null)return;const d=s-u,f=Math.min(this.maxLatency,u+i.targetduration);if(d<f&&d>.05&&this.forwardBufferLength>1){const m=Math.min(2,Math.max(1,o)),v=Math.round(2/(1+Math.exp(-.75*d-this.edgeStalled))*20)/20,y=Math.min(m,Math.max(1,v));this.changeMediaPlaybackRate(t,y)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:i,targetduration:s}=e,{liveSyncDuration:r,liveSyncDurationCount:o,lowLatencyMode:u}=this.config,d=this.hls.userConfig;let f=u&&i||t;(this._targetLatencyUpdated||d.liveSyncDuration||d.liveSyncDurationCount||f===0)&&(f=r!==void 0?r:o*s);const h=s;return f+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,h)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const i=this.levelDetails;if(i===null)return null;const s=i.edge,r=e-t-this.edgeStalled,o=s-i.totalduration,u=s-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(o,r),u)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var i;t.details===X.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(i=this.levelDetails)!=null&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var i,s;e.playbackRate!==t&&((i=this.hls)==null||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(s=this.targetLatency)==null?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class RI extends Rg{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const i=this.hls.config.preferManagedMediaSource,s=[],r={},o={};let u=!1,d=!1,f=!1;t.levels.forEach(h=>{const m=h.attrs;let{audioCodec:v,videoCodec:y}=h;v&&(h.audioCodec=v=Vu(v,i)||void 0),y&&(y=h.videoCodec=EA(y));const{width:S,height:E,unknownCodecs:x}=h;let _=x?x.length:0;if(x)for(let P=_;P--;){const U=x[P];this.isAudioSupported(U)?(h.audioCodec=v=v?`${v},${U}`:U,_--,pa.audio[v.substring(0,4)]=2):this.isVideoSupported(U)&&(h.videoCodec=y=y?`${y},${U}`:U,_--,pa.video[y.substring(0,4)]=2)}if(u||(u=!!(S&&E)),d||(d=!!y),f||(f=!!v),_||v&&!this.isAudioSupported(v)||y&&!this.isVideoSupported(y)){this.log(`Some or all CODECS not supported "${m.CODECS}"`);return}const{CODECS:R,"FRAME-RATE":A,"HDCP-LEVEL":I,"PATHWAY-ID":D,RESOLUTION:N,"VIDEO-RANGE":C}=m,O=`${`${D||"."}-`}${h.bitrate}-${N}-${A}-${R}-${C}-${I}`;if(r[O])if(r[O].uri!==h.url&&!h.attrs["PATHWAY-ID"]){const P=o[O]+=1;h.attrs["PATHWAY-ID"]=new Array(P+1).join(".");const U=this.createLevel(h);r[O]=U,s.push(U)}else r[O].addGroupId("audio",m.AUDIO),r[O].addGroupId("text",m.SUBTITLES);else{const P=this.createLevel(h);r[O]=P,o[O]=1,s.push(P)}}),this.filterAndSortMediaOptions(s,t,u,d,f)}createLevel(e){const t=new Ul(e),i=e.supplemental;if(i!=null&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){const s=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(s.message),t.supportedResult=PT(s,[])}return t}isAudioSupported(e){return Ah(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Ah(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,i,s,r){let o=[],u=[],d=e;if((i||s)&&r&&(d=d.filter(({videoCodec:x,videoRange:_,width:R,height:A})=>(!!x||!!(R&&A))&&IA(_))),d.length===0){Promise.resolve().then(()=>{if(this.hls){let x="no level with compatible codecs found in manifest",_=x;t.levels.length&&(_=`one or more CODECS in variant not supported: ${Ze(t.levels.map(A=>A.attrs.CODECS).filter((A,I,D)=>D.indexOf(A)===I))}`,this.warn(_),x+=` (${_})`);const R=new Error(x);this.hls.trigger(b.ERROR,{type:pe.MEDIA_ERROR,details:X.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:R,reason:_})}});return}t.audioTracks&&(o=t.audioTracks.filter(x=>!x.audioCodec||this.isAudioSupported(x.audioCodec)),fS(o)),t.subtitles&&(u=t.subtitles,fS(u));const f=d.slice(0);d.sort((x,_)=>{if(x.attrs["HDCP-LEVEL"]!==_.attrs["HDCP-LEVEL"])return(x.attrs["HDCP-LEVEL"]||"")>(_.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&x.height!==_.height)return x.height-_.height;if(x.frameRate!==_.frameRate)return x.frameRate-_.frameRate;if(x.videoRange!==_.videoRange)return Ku.indexOf(x.videoRange)-Ku.indexOf(_.videoRange);if(x.videoCodec!==_.videoCodec){const R=sy(x.videoCodec),A=sy(_.videoCodec);if(R!==A)return A-R}if(x.uri===_.uri&&x.codecSet!==_.codecSet){const R=Hu(x.codecSet),A=Hu(_.codecSet);if(R!==A)return A-R}return x.averageBitrate!==_.averageBitrate?x.averageBitrate-_.averageBitrate:0});let h=f[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==f.length)){for(let x=0;x<f.length;x++)if(f[x].pathwayId===d[0].pathwayId){h=f[x];break}}this._levels=d;for(let x=0;x<d.length;x++)if(d[x]===h){var m;this._firstLevel=x;const _=h.bitrate,R=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${_}`),((m=this.hls.userConfig)==null?void 0:m.abrEwmaDefaultEstimate)===void 0){const A=Math.min(_,this.hls.config.abrEwmaDefaultEstimateMax);A>R&&R===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=A)}break}const v=r&&!s,y=this.hls.config,S=!!(y.audioStreamController&&y.audioTrackController),E={levels:d,audioTracks:o,subtitleTracks:u,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:s,altAudio:S&&!v&&o.some(x=>!!x.url)};this.hls.trigger(b.MANIFEST_PARSED,E)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const h=new Error("invalid level idx"),m=e<0;if(this.hls.trigger(b.ERROR,{type:pe.OTHER_ERROR,details:X.LEVEL_SWITCH_ERROR,level:e,fatal:m,error:h,reason:h.message}),m)return;e=Math.min(e,t.length-1)}const i=this.currentLevelIndex,s=this.currentLevel,r=s?s.attrs["PATHWAY-ID"]:void 0,o=t[e],u=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,i===e&&s&&r===u)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${u?" with Pathway "+u:""} from level ${i}${r?" with Pathway "+r:""}`);const d={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(b.LEVEL_SWITCHING,d);const f=o.details;if(!f||f.live){const h=this.switchParams(o.uri,s?.details,f);this.loadPlaylist(h)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),i=e.filter(s=>t.indexOf(s)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=i}}onError(e,t){t.fatal||!t.context||t.context.type===Ie.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===ge.MAIN){const i=t.elementaryStreams;if(!Object.keys(i).some(r=>!!i[r]))return;const s=this._levels[t.level];s!=null&&s.loadError&&(this.log(`Resetting level error count of ${s.loadError} on frag buffered`),s.loadError=0)}}onLevelLoaded(e,t){var i;const{level:s,details:r}=t,o=t.levelInfo;if(!o){var u;this.warn(`Invalid level index ${s}`),(u=t.deliveryDirectives)!=null&&u.skip&&(r.deltaUpdateFailed=!0);return}if(o===this.currentLevel||t.withoutMultiVariant){o.fragmentError===0&&(o.loadError=0);let d=o.details;d===t.details&&d.advanced&&(d=void 0),this.playlistLoaded(s,t,d)}else(i=t.deliveryDirectives)!=null&&i.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=this.getUrlWithDirectives(e.uri,t),s=this.currentLevelIndex,r=e.attrs["PATHWAY-ID"],o=e.details,u=o?.age;this.log(`Loading level index ${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${r?" Pathway "+r:""}${u&&o.live?" age "+u.toFixed(1)+(o.type&&" "+o.type||""):""} ${i}`),this.hls.trigger(b.LEVEL_LOADING,{url:i,level:s,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const i=this._levels.filter((r,o)=>o!==e?!0:(this.steering&&this.steering.removeLevel(r),r===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,r.details&&r.details.fragments.forEach(u=>u.level=-1)),!1));WT(i),this._levels=i,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const s=i.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(b.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(b.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function fS(l){const e={};l.forEach(t=>{const i=t.groupId||"";t.id=e[i]=e[i]||0,e[i]++})}function $E(){return self.SourceBuffer||self.WebKitSourceBuffer}function zE(){if(!Tn())return!1;const e=$E();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function DI(){if(!zE())return!1;const l=Tn();return typeof l?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>l.isTypeSupported(Fl(e,"video")))||["mp4a.40.2","fLaC"].some(e=>l.isTypeSupported(Fl(e,"audio"))))}function II(){var l;const e=$E();return typeof(e==null||(l=e.prototype)==null?void 0:l.changeType)=="function"}const wI=100;class CI extends Sg{constructor(e,t,i){super(e,t,i,"stream-controller",ge.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const s=this.media,r=s?s.currentTime:null;if(r===null||!de(r)||(this.log(`Media seeked to ${r.toFixed(3)}`),!this.getBufferedFrag(r)))return;const o=this.getFwdBufferInfoAtPos(s,r,ge.MAIN,0);if(o===null||o.len===0){this.warn(`Main forward buffer length at ${r} on "seeked" event ${o?o.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this),e.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this),e.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:i,hls:s}=this;if(this.stopLoad(),this.setInterval(wI),this.level=-1,!this.startFragRequested){let r=s.startLevel;r===-1&&(s.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=s.firstAutoLevel),s.nextLoadLevel=r,this.level=s.loadLevel,this._hasEnoughToStart=!!t}i>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i),this.state=ie.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=ie.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case ie.WAITING_LEVEL:{const{levels:t,level:i}=this,s=t?.[i],r=s?.details;if(r&&(!r.live||this.levelLastLoaded===s&&!this.waitForLive(s))){if(this.waitForCdnTuneIn(r))break;this.state=ie.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=ie.IDLE;break}break}case ie.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),i=this.retryDate;if(!i||t>=i||(e=this.media)!=null&&e.seeking){const{levels:s,level:r}=this,o=s?.[r];this.resetStartWhenNotLoaded(o||null),this.state=ie.IDLE}}break}this.state===ie.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:i,media:s}=this;if(t===null||!s&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const r=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(i!=null&&i[r]))return;const o=i[r],u=this.getMainFwdBufferInfo();if(u===null)return;const d=this.getLevelDetails();if(d&&this._streamEnded(u,d)){const E={};this.altAudio===2&&(E.type="video"),this.hls.trigger(b.BUFFER_EOS,E),this.state=ie.ENDED;return}if(!this.buffering)return;e.loadLevel!==r&&e.manualLevel===-1&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=e.nextLoadLevel=r;const f=o.details;if(!f||this.state===ie.WAITING_LEVEL||this.waitForLive(o)){this.level=r,this.state=ie.WAITING_LEVEL,this.startFragRequested=!1;return}const h=u.len,m=this.getMaxBufferLength(o.maxBitrate);if(h>=m)return;this.backtrackFragment&&this.backtrackFragment.start>u.end&&(this.backtrackFragment=null);const v=this.backtrackFragment?this.backtrackFragment.start:u.end;let y=this.getNextFragment(v,f);if(this.couldBacktrack&&!this.fragPrevious&&y&&pt(y)&&this.fragmentTracker.getState(y)!==Tt.OK){var S;const x=((S=this.backtrackFragment)!=null?S:y).sn-f.startSN,_=f.fragments[x-1];_&&y.cc===_.cc&&(y=_,this.fragmentTracker.removeFragment(_))}else this.backtrackFragment&&u.len&&(this.backtrackFragment=null);if(y&&this.isLoopLoading(y,v)){if(!y.gap){const x=this.audioOnly&&!this.altAudio?Qe.AUDIO:Qe.VIDEO,_=(x===Qe.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;_&&this.afterBufferFlushed(_,x,ge.MAIN)}y=this.getNextFragmentLoopLoading(y,f,u,ge.MAIN,m)}y&&(y.initSegment&&!y.initSegment.data&&!this.bitrateTest&&(y=y.initSegment),this.loadFragment(y,o,v))}loadFragment(e,t,i){const s=this.fragmentTracker.getState(e);s===Tt.NOT_LOADED||s===Tt.PARTIAL?pt(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,i):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ge.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let i;const s=this.getAppendedFrag(t.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const r=this.getLevelDetails();if(r!=null&&r.live){const u=this.getMainFwdBufferInfo();if(!u||u.len<r.targetduration*2)return}if(!t.paused&&e){const u=this.hls.nextLoadLevel,d=e[u],f=this.fragLastKbps;f&&this.fragCurrent?i=this.fragCurrent.duration*d.maxBitrate/(1e3*f)+1:i=0}else i=0;const o=this.getBufferedFrag(t.currentTime+i);if(o){const u=this.followingBufferedFrag(o);if(u){this.abortCurrentFrag();const d=u.maxStartPTS?u.maxStartPTS:u.start,f=u.duration,h=Math.max(o.end,d+Math.min(Math.max(f-this.config.maxFragLookUpTolerance,f*(this.couldBacktrack?.5:.125)),f*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(h,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case ie.KEY_LOADING:case ie.FRAG_LOADING:case ie.FRAG_LOADING_WAITING_RETRY:case ie.PARSING:case ie.PARSED:this.state=ie.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const i=t.media;Fi(i,"playing",this.onMediaPlaying),Fi(i,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:i}=this;i&&(ji(i,"playing",this.onMediaPlaying),ji(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(b.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let i=!1,s=!1;t.levels.forEach(r=>{const o=r.audioCodec;o&&(i=i||o.indexOf("mp4a.40.2")!==-1,s=s||o.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=i&&s&&!II(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:i}=this;if(!i||this.state!==ie.IDLE)return;const s=t.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=ie.WAITING_LEVEL)}onLevelLoaded(e,t){var i;const{levels:s,startFragRequested:r}=this,o=t.level,u=t.details,d=u.totalduration;if(!s){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""}, cc [${u.startCC}, ${u.endCC}] duration:${d}`);const f=t.levelInfo,h=this.fragCurrent;h&&(this.state===ie.FRAG_LOADING||this.state===ie.FRAG_LOADING_WAITING_RETRY)&&h.level!==t.level&&h.loader&&this.abortCurrentFrag();let m=0;if(u.live||(i=f.details)!=null&&i.live){var v;if(this.checkLiveUpdate(u),u.deltaUpdateFailed)return;m=this.alignPlaylists(u,f.details,(v=this.levelLastLoaded)==null?void 0:v.details)}if(f.details=u,this.levelLastLoaded=f,r||this.setStartPosition(u,m),this.hls.trigger(b.LEVEL_UPDATED,{details:u,level:o}),this.state===ie.WAITING_LEVEL){if(this.waitForCdnTuneIn(u))return;this.state=ie.IDLE}r&&u.live&&this.synchronizeToLiveEdge(u),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:i}=this;if(!i)return;const s=this.hls.liveSyncPosition,r=this.getLoadPosition(),o=e.fragmentStart,u=e.edge,d=r>=o-t.maxFragLookUpTolerance&&r<=u;if(s!==null&&i.duration>s&&(r<s||!d)){const h=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!d&&i.readyState<4||r<u-h)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),i.readyState))if(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${u}, reset currentTime to : ${s.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var f;const m=be.bufferInfo(i,s,0);if(!(m!=null&&(f=m.buffered)!=null&&f.length)){i.currentTime=s;return}if(m.start<=r){i.currentTime=s;return}const{nextStart:y}=be.bufferedInfo(m.buffered,r,0);y&&(i.currentTime=y)}else i.currentTime=s}}_handleFragmentLoadProgress(e){var t;const i=e.frag,{part:s,payload:r}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const u=o[i.level];if(!u){this.warn(`Level ${i.level} not found on progress`);return}const d=u.details;if(!d){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}const f=u.videoCodec,h=d.PTSKnown||!d.live,m=(t=i.initSegment)==null?void 0:t.data,v=this._getAudioCodec(u),y=this.transmuxer=this.transmuxer||new SE(this.hls,ge.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),S=s?s.index:-1,E=S!==-1,x=new vg(i.level,i.sn,i.stats.chunkCount,r.byteLength,S,E),_=this.initPTS[i.cc];y.push(r,m,v,f,i,s,d.totalduration,h,x,_)}onAudioTrackSwitching(e,t){const i=this.hls,s=this.altAudio===2;if(Yu(t.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s){this.fragmentTracker.removeAllFragments(),i.once(b.BUFFER_FLUSHED,()=>{var o;(o=this.hls)==null||o.trigger(b.AUDIO_TRACK_SWITCHED,t)}),i.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}i.trigger(b.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const i=Yu(t.url,this.hls);if(i){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=i?2:0,this.tick()}onBufferCreated(e,t){const i=t.tracks;let s,r,o=!1;for(const u in i){const d=i[u];if(d.id==="main"){if(r=u,s=d,u==="video"){const f=i[u];f&&(this.videoBuffer=f.buffer)}}else o=!0}o&&s?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:i,part:s}=t,r=i.type===ge.MAIN;if(r){if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===ie.PARSED&&(this.state=ie.IDLE);return}const u=s?s.stats:i.stats;this.fragLastKbps=Math.round(8*u.total/(u.buffering.end-u.loading.first)),pt(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,s)}const o=this.media;o&&(!this._hasEnoughToStart&&be.getBuffered(o).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),r&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var i;if(t.fatal){this.state=ie.ERROR;return}switch(t.details){case X.FRAG_GAP:case X.FRAG_PARSING_ERROR:case X.FRAG_DECRYPT_ERROR:case X.FRAG_LOAD_ERROR:case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_ERROR:case X.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ge.MAIN,t);break;case X.LEVEL_LOAD_ERROR:case X.LEVEL_LOAD_TIMEOUT:case X.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ie.WAITING_LEVEL&&((i=t.context)==null?void 0:i.type)===Ie.LEVEL&&(this.state=ie.IDLE);break;case X.BUFFER_ADD_CODEC_ERROR:case X.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case X.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case X.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=ie.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Qe.AUDIO||!this.altAudio){const i=(t===Qe.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;i&&(this.afterBufferFlushed(i,t,ge.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let i=this.startPosition;if(i>=0&&t<i){if(e.seeking){this.log(`could not seek to ${i}, already seeking at ${t}`);return}const s=this.timelineOffset;s&&i&&(i+=s);const r=this.getLevelDetails(),o=be.getBuffered(e),u=o.length?o.start(0):0,d=u-i,f=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||d>0&&(d<f||this.loadingParts&&d<2*(r?.partTarget||0)))&&(this.log(`adjusting start position by ${d} to match buffer start`),i+=d,this.startPosition=i),t<i&&(this.log(`seek to target start position ${i} from current time ${t} buffer start ${u}`),e.currentTime=i)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(i=>{const{hls:s}=this,r=i?.frag;if(!r||this.fragContextChanged(r))return;t.fragmentError=0,this.state=ie.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=r.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),s.trigger(b.FRAG_LOADED,i),r.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const i=this.playlistType,{hls:s}=this,{remuxResult:r,chunkMeta:o}=e,u=this.getCurrentContext(o);if(!u){this.resetWhenMissingContext(o);return}const{frag:d,part:f,level:h}=u,{video:m,text:v,id3:y,initSegment:S}=r,{details:E}=h,x=this.altAudio?void 0:r.audio;if(this.fragContextChanged(d)){this.fragmentTracker.removeFragment(d);return}if(this.state=ie.PARSING,S){if(S!=null&&S.tracks){const I=d.initSegment||d;this._bufferInitSegment(h,S.tracks,I,o),s.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:I,id:i,tracks:S.tracks})}const _=S.initPTS,R=S.timescale,A=this.initPTS[d.cc];de(_)&&(!A||A.baseTime!==_||A.timescale!==R)&&(this.initPTS[d.cc]={baseTime:_,timescale:R},s.trigger(b.INIT_PTS_FOUND,{frag:d,id:i,initPTS:_,timescale:R}))}if(m&&E){x&&m.type==="audiovideo"&&this.logMuxedErr(d);const _=E.fragments[d.sn-1-E.startSN],R=d.sn===E.startSN,A=!_||d.cc>_.cc;if(r.independent!==!1){const{startPTS:I,endPTS:D,startDTS:N,endDTS:C}=m;if(f)f.elementaryStreams[m.type]={startPTS:I,endPTS:D,startDTS:N,endDTS:C};else if(m.firstKeyFrame&&m.independent&&o.id===1&&!A&&(this.couldBacktrack=!0),m.dropped&&m.independent){const M=this.getMainFwdBufferInfo(),O=(M?M.end:this.getLoadPosition())+this.config.maxBufferHole,P=m.firstKeyFramePTS?m.firstKeyFramePTS:I;if(!R&&O<P-this.config.maxBufferHole&&!A){this.backtrack(d);return}else A&&(d.gap=!0);d.setElementaryStreamInfo(m.type,d.start,D,d.start,C,!0)}else R&&I-(E.appliedTimelineOffset||0)>Pu&&(d.gap=!0);d.setElementaryStreamInfo(m.type,I,D,N,C),this.backtrackFragment&&(this.backtrackFragment=d),this.bufferFragmentData(m,d,f,o,R||A)}else if(R||A)d.gap=!0;else{this.backtrack(d);return}}if(x){const{startPTS:_,endPTS:R,startDTS:A,endDTS:I}=x;f&&(f.elementaryStreams[Qe.AUDIO]={startPTS:_,endPTS:R,startDTS:A,endDTS:I}),d.setElementaryStreamInfo(Qe.AUDIO,_,R,A,I),this.bufferFragmentData(x,d,f,o)}if(E&&y!=null&&(t=y.samples)!=null&&t.length){const _={id:i,frag:d,details:E,samples:y.samples};s.trigger(b.FRAG_PARSING_METADATA,_)}if(E&&v){const _={id:i,frag:d,details:E,samples:v.samples};s.trigger(b.FRAG_PARSING_USERDATA,_)}}logMuxedErr(e){this.warn(`${pt(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,i,s){if(this.state!==ie.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(i));const{audio:r,video:o,audiovideo:u}=t;if(r){const f=e.audioCodec;let h=Ru(r.codec,f);h==="mp4a"&&(h="mp4a.40.5");const m=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){h&&(h.indexOf("mp4a.40.5")!==-1?h="mp4a.40.2":h="mp4a.40.5");const v=r.metadata;v&&"channelCount"in v&&(v.channelCount||1)!==1&&m.indexOf("firefox")===-1&&(h="mp4a.40.5")}h&&h.indexOf("mp4a.40.5")!==-1&&m.indexOf("android")!==-1&&r.container!=="audio/mpeg"&&(h="mp4a.40.2",this.log(`Android: force audio codec to ${h}`)),f&&f!==h&&this.log(`Swapping manifest audio codec "${f}" for "${h}"`),r.levelCodec=h,r.id=ge.MAIN,this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${h||""}/${f||""}/${r.codec}]`),delete t.audiovideo}if(o){o.levelCodec=e.videoCodec,o.id=ge.MAIN;const f=o.codec;if(f?.length===4)switch(f){case"hvc1":case"hev1":o.codec="hvc1.1.6.L120.90";break;case"av01":o.codec="av01.0.04M.08";break;case"avc1":o.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${f}]${o.codec!==f?" parsed-corrected="+o.codec:""}${o.supplemental?" supplemental="+o.supplemental:""}`),delete t.audiovideo}u&&(this.log(`Init audiovideo buffer, container:${u.container}, codecs[level/parsed]=[${e.codecs}/${u.codec}]`),delete t.video,delete t.audio);const d=Object.keys(t);if(d.length){if(this.hls.trigger(b.BUFFER_CODECS,t),!this.hls)return;d.forEach(f=>{const m=t[f].initSegment;m!=null&&m.byteLength&&this.hls.trigger(b.BUFFER_APPENDING,{type:f,data:m,frag:i,part:null,chunkMeta:s,parent:i.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,ge.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,i=e?.[t];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ie.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const i=e.currentTime;if(be.isBuffered(e,i)?t=this.getAppendedFrag(i):be.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){this.backtrackFragment=null;const s=this.fragPlaying,r=t.level;(!s||t.sn!==s.sn||s.level!==r)&&(this.fragPlaying=t,this.hls.trigger(b.FRAG_CHANGED,{frag:t}),(!s||s.level!==r)&&this.hls.trigger(b.LEVEL_SWITCHED,{level:r}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return de(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(de(t)){const i=this.getLevelDetails(),s=this.currentFrag||(i?nr(null,i.fragments,t):null);if(s){const r=s.programDateTime;if(r!==null){const o=r+(t-s.start)*1e3;return new Date(o)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class OI{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const i in this.keyUriToKeyInfo){const s=this.keyUriToKeyInfo[i].loader;if(s){var t;if(e&&e!==((t=s.context)==null?void 0:t.frag.type))return;s.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=X.KEY_LOAD_ERROR,i,s,r){return new Os({type:pe.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:i,networkDetails:s})}loadClear(e,t,i){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let s=0,r=t.length;s<r;s++){const o=t[s];if(e.cc<=o.cc&&(!pt(e)||!pt(o)||e.sn<o.sn)||!i&&s==r-1)return this.emeController.selectKeySystemFormat(o).then(u=>{if(!this.emeController)return;o.setKeyFormat(u);const d=wh(u);if(d)return this.emeController.getKeySystemAccess([d])})}if(this.config.requireKeySystemAccessOnStart){const s=Iu(this.config);if(s.length)return this.emeController.getKeySystemAccess(s)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var i,s;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const f=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,X.KEY_LOAD_ERROR,f))}const o=r.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,X.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let u=this.keyUriToKeyInfo[o];if((i=u)!=null&&i.decryptdata.key)return r.key=u.decryptdata.key,Promise.resolve({frag:e,keyInfo:u});if((s=u)!=null&&s.keyLoadPromise){var d;switch((d=u.mediaKeySessionContext)==null?void 0:d.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return u.keyLoadPromise.then(f=>(r.key=f.keyInfo.decryptdata.key,{frag:e,keyInfo:u}))}}switch(u=this.keyUriToKeyInfo[o]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return r.keyFormat==="identity"?this.loadKeyHTTP(u,e):this.loadKeyEME(u,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(u,e);default:return Promise.reject(this.createKeyLoadError(e,X.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const i={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const s=this.emeController.loadKey(i);if(s)return(e.keyLoadPromise=s.then(r=>(e.mediaKeySessionContext=r,i))).catch(r=>{throw e.keyLoadPromise=null,r})}return Promise.resolve(i)}loadKeyHTTP(e,t){const i=this.config,s=i.loader,r=new s(i);return t.keyLoader=e.loader=r,e.keyLoadPromise=new Promise((o,u)=>{const d={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},f=i.keyLoadPolicy.default,h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(v,y,S,E)=>{const{frag:x,keyInfo:_,url:R}=S;if(!x.decryptdata||_!==this.keyUriToKeyInfo[R])return u(this.createKeyLoadError(x,X.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),E));_.decryptdata.key=x.decryptdata.key=new Uint8Array(v.data),x.keyLoader=null,_.loader=null,o({frag:x,keyInfo:_})},onError:(v,y,S,E)=>{this.resetLoader(y),u(this.createKeyLoadError(t,X.KEY_LOAD_ERROR,new Error(`HTTP Error ${v.code} loading key ${v.text}`),S,Ke({url:d.url,data:void 0},v)))},onTimeout:(v,y,S)=>{this.resetLoader(y),u(this.createKeyLoadError(t,X.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),S))},onAbort:(v,y,S)=>{this.resetLoader(y),u(this.createKeyLoadError(t,X.INTERNAL_ABORTED,new Error("key loading aborted"),S))}};r.load(d,h,m)})}resetLoader(e){const{frag:t,keyInfo:i,url:s}=e,r=i.loader;t.keyLoader===r&&(t.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[s],r&&r.destroy()}}function dS(l){const{type:e}=l;switch(e){case Ie.AUDIO_TRACK:return ge.AUDIO;case Ie.SUBTITLE_TRACK:return ge.SUBTITLE;default:return ge.MAIN}}function Jd(l,e){let t=l.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class MI{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,i=t.pLoader,s=t.loader,r=i||s,o=new r(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:i}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ie.MANIFEST,url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:i,level:s,pathwayId:r,url:o,deliveryDirectives:u,levelInfo:d}=t;this.load({id:i,level:s,pathwayId:r,responseType:"text",type:Ie.LEVEL,url:o,deliveryDirectives:u,levelOrTrack:d})}onAudioTrackLoading(e,t){const{id:i,groupId:s,url:r,deliveryDirectives:o,track:u}=t;this.load({id:i,groupId:s,level:null,responseType:"text",type:Ie.AUDIO_TRACK,url:r,deliveryDirectives:o,levelOrTrack:u})}onSubtitleTrackLoading(e,t){const{id:i,groupId:s,url:r,deliveryDirectives:o,track:u}=t;this.load({id:i,groupId:s,level:null,responseType:"text",type:Ie.SUBTITLE_TRACK,url:r,deliveryDirectives:o,levelOrTrack:u})}onLevelsUpdated(e,t){const i=this.loaders[Ie.LEVEL];if(i){const s=i.context;s&&!t.levels.some(r=>r===s.levelOrTrack)&&(i.abort(),delete this.loaders[Ie.LEVEL])}}load(e){var t;const i=this.hls.config;let s=this.getInternalLoader(e);if(s){const f=this.hls.logger,h=s.context;if(h&&h.levelOrTrack===e.levelOrTrack&&(h.url===e.url||h.deliveryDirectives&&!e.deliveryDirectives)){h.url===e.url?f.log(`[playlist-loader]: ignore ${e.url} ongoing request`):f.log(`[playlist-loader]: ignore ${e.url} in favor of ${h.url}`);return}f.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),s.abort()}let r;if(e.type===Ie.MANIFEST?r=i.manifestLoadPolicy.default:r=Ge({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),de((t=e.deliveryDirectives)==null?void 0:t.part)){let f;if(e.type===Ie.LEVEL&&e.level!==null?f=this.hls.levels[e.level].details:e.type===Ie.AUDIO_TRACK&&e.id!==null?f=this.hls.audioTracks[e.id].details:e.type===Ie.SUBTITLE_TRACK&&e.id!==null&&(f=this.hls.subtitleTracks[e.id].details),f){const h=f.partTarget,m=f.targetduration;if(h&&m){const v=Math.max(h*3,m*.8)*1e3;r=Ge({},r,{maxTimeToFirstByteMs:Math.min(v,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(v,r.maxTimeToFirstByteMs)})}}}const o=r.errorRetry||r.timeoutRetry||{},u={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},d={onSuccess:(f,h,m,v)=>{const y=this.getInternalLoader(m);this.resetInternalLoader(m.type);const S=f.data;if(S.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(f,m,new Error("no EXTM3U delimiter"),v||null,h);return}h.parsing.start=performance.now(),us.isMediaPlaylist(S)||m.type!==Ie.MANIFEST?this.handleTrackOrLevelPlaylist(f,h,m,v||null,y):this.handleMasterPlaylist(f,h,m,v)},onError:(f,h,m,v)=>{this.handleNetworkError(h,m,!1,f,v)},onTimeout:(f,h,m)=>{this.handleNetworkError(h,m,!0,void 0,f)}};s.load(e,u,d)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:i}=this.hls;(e||i)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,i,s){const r=this.hls,o=e.data,u=Jd(e,i),d=us.parseMasterPlaylist(o,u);if(d.playlistParsingError){this.handleManifestParsingError(e,i,d.playlistParsingError,s,t);return}const{contentSteering:f,levels:h,sessionData:m,sessionKeys:v,startTimeOffset:y,variableList:S}=d;this.variableList=S;const{AUDIO:E=[],SUBTITLES:x,"CLOSED-CAPTIONS":_}=us.parseMasterPlaylistMedia(o,u,d);E.length&&!E.some(A=>!A.url)&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),E.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new it({}),bitrate:0,url:""})),r.trigger(b.MANIFEST_LOADED,{levels:h,audioTracks:E,subtitles:x,captions:_,contentSteering:f,url:u,stats:t,networkDetails:s,sessionData:m,sessionKeys:v,startTimeOffset:y,variableList:S})}handleTrackOrLevelPlaylist(e,t,i,s,r){const o=this.hls,{id:u,level:d,type:f}=i,h=Jd(e,i),m=de(d)?d:de(u)?u:0,v=dS(i),y=us.parseLevelPlaylist(e.data,h,m,v,0,this.variableList);if(f===Ie.MANIFEST){const S={attrs:new it({}),bitrate:0,details:y,name:"",url:h};y.requestScheduled=t.loading.start+qT(y,0),o.trigger(b.MANIFEST_LOADED,{levels:[S],audioTracks:[],url:h,stats:t,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),i.levelDetails=y,this.handlePlaylistLoaded(y,e,t,i,s,r)}handleManifestParsingError(e,t,i,s,r){this.hls.trigger(b.ERROR,{type:pe.NETWORK_ERROR,details:X.MANIFEST_PARSING_ERROR,fatal:t.type===Ie.MANIFEST,url:e.url,err:i,error:i,reason:i.message,response:e,context:t,networkDetails:s,stats:r})}handleNetworkError(e,t,i=!1,s,r){let o=`A network ${i?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${e.type}`;e.type===Ie.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===Ie.AUDIO_TRACK||e.type===Ie.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const u=new Error(o);this.hls.logger.warn(`[playlist-loader]: ${o}`);let d=X.UNKNOWN,f=!1;const h=this.getInternalLoader(e);switch(e.type){case Ie.MANIFEST:d=i?X.MANIFEST_LOAD_TIMEOUT:X.MANIFEST_LOAD_ERROR,f=!0;break;case Ie.LEVEL:d=i?X.LEVEL_LOAD_TIMEOUT:X.LEVEL_LOAD_ERROR,f=!1;break;case Ie.AUDIO_TRACK:d=i?X.AUDIO_TRACK_LOAD_TIMEOUT:X.AUDIO_TRACK_LOAD_ERROR,f=!1;break;case Ie.SUBTITLE_TRACK:d=i?X.SUBTITLE_TRACK_LOAD_TIMEOUT:X.SUBTITLE_LOAD_ERROR,f=!1;break}h&&this.resetInternalLoader(e.type);const m={type:pe.NETWORK_ERROR,details:d,fatal:f,url:e.url,loader:h,context:e,error:u,networkDetails:t,stats:r};if(s){const v=t?.url||e.url;m.response=Ke({url:v,data:void 0},s)}this.hls.trigger(b.ERROR,m)}handlePlaylistLoaded(e,t,i,s,r,o){const u=this.hls,{type:d,level:f,id:h,groupId:m,deliveryDirectives:v}=s,y=Jd(t,s),S=dS(s),E=typeof s.level=="number"&&S===ge.MAIN?f:void 0;if(!e.fragments.length){const _=e.playlistParsingError=new Error("No Segments found in Playlist");u.trigger(b.ERROR,{type:pe.NETWORK_ERROR,details:X.LEVEL_EMPTY_ERROR,fatal:!1,url:y,error:_,reason:_.message,response:t,context:s,level:E,parent:S,networkDetails:r,stats:i});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const x=e.playlistParsingError;if(x){if(this.hls.logger.warn(x),!u.config.ignorePlaylistParsingErrors){u.trigger(b.ERROR,{type:pe.NETWORK_ERROR,details:X.LEVEL_PARSING_ERROR,fatal:!1,url:y,error:x,reason:x.message,response:t,context:s,level:E,parent:S,networkDetails:r,stats:i});return}e.playlistParsingError=null}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),d){case Ie.MANIFEST:case Ie.LEVEL:u.trigger(b.LEVEL_LOADED,{details:e,levelInfo:s.levelOrTrack||u.levels[0],level:E||0,id:h||0,stats:i,networkDetails:r,deliveryDirectives:v,withoutMultiVariant:d===Ie.MANIFEST});break;case Ie.AUDIO_TRACK:u.trigger(b.AUDIO_TRACK_LOADED,{details:e,track:s.levelOrTrack,id:h||0,groupId:m||"",stats:i,networkDetails:r,deliveryDirectives:v});break;case Ie.SUBTITLE_TRACK:u.trigger(b.SUBTITLE_TRACK_LOADED,{details:e,track:s.levelOrTrack,id:h||0,groupId:m||"",stats:i,networkDetails:r,deliveryDirectives:v});break}}}class mi{static get version(){return $l}static isMSESupported(){return zE()}static isSupported(){return DI()}static getMediaSource(){return Tn()}static get Events(){return b}static get MetadataSchema(){return hi}static get ErrorTypes(){return pe}static get ErrorDetails(){return X}static get DefaultConfig(){return mi.defaultConfig?mi.defaultConfig:pI}static set DefaultConfig(e){mi.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Tg,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=Jb(e.debug||!1,"Hls instance",e.assetPlayerId),i=this.config=yI(mi.DefaultConfig,e,t);this.userConfig=e,i.progressive&&SI(i,t);const{abrController:s,bufferController:r,capLevelController:o,errorController:u,fpsController:d}=i,f=new u(this),h=this.abrController=new s(this),m=new VA(this),v=i.interstitialsController,y=v?this.interstitialsController=new v(this,mi):null,S=this.bufferController=new r(this,m),E=this.capLevelController=new o(this),x=new d(this),_=new MI(this),R=i.contentSteeringController,A=R?new R(this):null,I=this.levelController=new RI(this,A),D=new AI(this),N=new OI(this.config),C=this.streamController=new CI(this,m,N),M=this.gapController=new _I(this,m);E.setStreamController(C),x.setStreamController(C);const O=[_,I,C];y&&O.splice(1,0,y),A&&O.splice(1,0,A),this.networkControllers=O;const P=[h,S,M,E,x,D,m];this.audioTrackController=this.createController(i.audioTrackController,O);const U=i.audioStreamController;U&&O.push(this.audioStreamController=new U(this,m,N)),this.subtitleTrackController=this.createController(i.subtitleTrackController,O);const H=i.subtitleStreamController;H&&O.push(this.subtititleStreamController=new H(this,m,N)),this.createController(i.timelineController,P),N.emeController=this.emeController=this.createController(i.emeController,P),this.cmcdController=this.createController(i.cmcdController,P),this.latencyController=this.createController(LI,P),this.coreComponents=P,O.push(f);const se=f.onErrorOut;typeof se=="function"&&this.on(b.ERROR,se,f),this.on(b.MANIFEST_LOADED,_.onManifestLoaded,_)}createController(e,t){if(e){const i=new e(this);return t&&t.push(i),i}return null}on(e,t,i=this){this._emitter.on(e,t,i)}once(e,t,i=this){this._emitter.once(e,t,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,i=this,s){this._emitter.off(e,t,i,s)}listeners(e){return this._emitter.listeners(e)}emit(e,t,i){return this._emitter.emit(e,t,i)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(i){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;const s=e===b.ERROR;this.trigger(b.ERROR,{type:pe.OTHER_ERROR,details:X.INTERNAL_EXCEPTION,fatal:s,event:e,error:i}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(b.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const r=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(b.ERROR,{type:pe.OTHER_ERROR,details:X.ATTACH_MEDIA_ERROR,fatal:!0,error:r});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,i=t?e.media:e,s=t?e:{media:i};this._media=i,this.trigger(b.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(b.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(b.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,i=this._url,s=this._url=cg.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),t&&i&&(i!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(b.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(e,t),!(!this.started||!this.networkControllers));i++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[ge.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[ge.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[ge.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e?.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=_D()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){DA(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const i=e.length;for(let s=0;s<i;s++)if(e[s].maxBitrate>=t)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:i}=this;let s;if(t===-1&&e!=null&&e.length?s=e.length-1:s=t,i)for(let r=s;r--;){const o=e[r].attrs["HDCP-LEVEL"];if(o&&o<=i)return r}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const i=BT(t);return kT(e,i,navigator.mediaCapabilities)}}mi.defaultConfig=void 0;const PI=({src:l})=>{const e=he.useRef(null);return he.useEffect(()=>{const t=e.current;if(t)if(mi.isSupported()){const i=new mi;return i.loadSource(l),i.attachMedia(t),i.on(mi.Events.MANIFEST_PARSED,()=>{i.currentLevel=i.levels.length-1,t.play().catch(()=>console.warn("Autoplay blocked by browser"))}),()=>i.destroy()}else t.canPlayType("application/vnd.apple.mpegurl")&&(t.src=l,t.addEventListener("loadedmetadata",()=>{t.play().catch(()=>console.warn("Autoplay blocked by browser"))}))},[l]),J.jsx("video",{ref:e,autoPlay:!0,muted:!0,playsInline:!0,className:"object-cover sm:h-screen block w-full"})};function kI({setIsActive:l}){const[e,t]=he.useState(!1);return J.jsxs("button",{className:" cursor-pointer relative group bg-white text-black border-r-[#da291c] border-r-[3px] sm:max-w-[465px] w-full overflow-hidden   px-6 py-4 flex items-center justify-between gap-4","data-event-module-slug":"powertrain","data-event-type":"OPEN_FOCUSON","data-event-label":"Explore the Powertrain","data-event-focuson-type":"HorizontalSlider","aria-label":"discover more",onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),onClick:()=>l(!0),children:[J.jsx("span",{className:`absolute inset-0 bg-white/10 transition-all duration-300 pointer-events-none w-10 h-10 ${e?"bg-white/20":""}`,style:{borderRadius:"2px"}}),J.jsx("span",{className:"relative text-wrap max-[360px]:text-xs text-sm min-[400px]:text-base sm:text-lg font-semibold z-10 transition-all duration-300 SansRegular",children:"Explore the Powertrain"}),J.jsxs("span",{className:"relative min-w-10 h-10 flex items-center justify-center z-10",children:[J.jsxs("svg",{viewBox:"0 0 40 40",width:"40",height:"40",className:`absolute inset-0 transition-transform duration-1000 ${e?"-rotate-360":""} ${e?"scale-110":""}`,children:[J.jsxs("defs",{children:[J.jsxs("radialGradient",{cy:"0%",fx:"50%",fy:"0%",r:"37.592%",gradientTransform:"matrix(0 1 -1.50994 0 .5 -.5)",id:"circle-grey-radial",children:[J.jsx("stop",{stopColor:"#303030",offset:"0%"}),J.jsx("stop",{stopColor:"#303030",stopOpacity:0,offset:"100%"})]}),J.jsx("path",{d:"M20 40C8.954 40 0 31.046 0 20S8.954 0 20 0s20 8.954 20 20-8.954 20-20 20zm0-2c9.941 0 18-8.059 18-18S29.941 2 20 2 2 10.059 2 20s8.059 18 18 18z",id:"circle-grey"})]}),J.jsxs("g",{fill:"none",fillRule:"evenodd",children:[J.jsx("use",{fill:"#D4D2D2",xlinkHref:"#circle-grey"}),J.jsx("use",{fillOpacity:".6",fill:"url(#circle-grey-radial)",xlinkHref:"#circle-grey"})]})]}),J.jsx("svg",{viewBox:"0 0 8 16",width:"8",height:"16",className:"relative z-10 text-black transition-transform duration-300",fill:"currentColor",children:J.jsx("path",{d:"M7.268 9.547L0 16l4-8-4-8 7.268 6.453C7.715 6.82 8 7.377 8 8c0 .623-.285 1.18-.732 1.547z"})})]})]})}function hS(l){return l!==null&&typeof l=="object"&&"constructor"in l&&l.constructor===Object}function Og(l,e){l===void 0&&(l={}),e===void 0&&(e={});const t=["__proto__","constructor","prototype"];Object.keys(e).filter(i=>t.indexOf(i)<0).forEach(i=>{typeof l[i]>"u"?l[i]=e[i]:hS(e[i])&&hS(l[i])&&Object.keys(e[i]).length>0&&Og(l[i],e[i])})}const HE={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function lr(){const l=typeof document<"u"?document:{};return Og(l,HE),l}const NI={document:HE,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(l){return typeof setTimeout>"u"?(l(),null):setTimeout(l,0)},cancelAnimationFrame(l){typeof setTimeout>"u"||clearTimeout(l)}};function Ht(){const l=typeof window<"u"?window:{};return Og(l,NI),l}function BI(l){return l===void 0&&(l=""),l.trim().split(" ").filter(e=>!!e.trim())}function FI(l){const e=l;Object.keys(e).forEach(t=>{try{e[t]=null}catch{}try{delete e[t]}catch{}})}function VE(l,e){return e===void 0&&(e=0),setTimeout(l,e)}function ir(){return Date.now()}function UI(l){const e=Ht();let t;return e.getComputedStyle&&(t=e.getComputedStyle(l,null)),!t&&l.currentStyle&&(t=l.currentStyle),t||(t=l.style),t}function GI(l,e){e===void 0&&(e="x");const t=Ht();let i,s,r;const o=UI(l);return t.WebKitCSSMatrix?(s=o.transform||o.webkitTransform,s.split(",").length>6&&(s=s.split(", ").map(u=>u.replace(",",".")).join(", ")),r=new t.WebKitCSSMatrix(s==="none"?"":s)):(r=o.MozTransform||o.OTransform||o.MsTransform||o.msTransform||o.transform||o.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),i=r.toString().split(",")),e==="x"&&(t.WebKitCSSMatrix?s=r.m41:i.length===16?s=parseFloat(i[12]):s=parseFloat(i[4])),e==="y"&&(t.WebKitCSSMatrix?s=r.m42:i.length===16?s=parseFloat(i[13]):s=parseFloat(i[5])),s||0}function xu(l){return typeof l=="object"&&l!==null&&l.constructor&&Object.prototype.toString.call(l).slice(8,-1)==="Object"}function $I(l){return typeof window<"u"&&typeof window.HTMLElement<"u"?l instanceof HTMLElement:l&&(l.nodeType===1||l.nodeType===11)}function di(){const l=Object(arguments.length<=0?void 0:arguments[0]),e=["__proto__","constructor","prototype"];for(let t=1;t<arguments.length;t+=1){const i=t<0||arguments.length<=t?void 0:arguments[t];if(i!=null&&!$I(i)){const s=Object.keys(Object(i)).filter(r=>e.indexOf(r)<0);for(let r=0,o=s.length;r<o;r+=1){const u=s[r],d=Object.getOwnPropertyDescriptor(i,u);d!==void 0&&d.enumerable&&(xu(l[u])&&xu(i[u])?i[u].__swiper__?l[u]=i[u]:di(l[u],i[u]):!xu(l[u])&&xu(i[u])?(l[u]={},i[u].__swiper__?l[u]=i[u]:di(l[u],i[u])):l[u]=i[u])}}}return l}function _u(l,e,t){l.style.setProperty(e,t)}function KE(l){let{swiper:e,targetPosition:t,side:i}=l;const s=Ht(),r=-e.translate;let o=null,u;const d=e.params.speed;e.wrapperEl.style.scrollSnapType="none",s.cancelAnimationFrame(e.cssModeFrameID);const f=t>r?"next":"prev",h=(v,y)=>f==="next"&&v>=y||f==="prev"&&v<=y,m=()=>{u=new Date().getTime(),o===null&&(o=u);const v=Math.max(Math.min((u-o)/d,1),0),y=.5-Math.cos(v*Math.PI)/2;let S=r+y*(t-r);if(h(S,t)&&(S=t),e.wrapperEl.scrollTo({[i]:S}),h(S,t)){e.wrapperEl.style.overflow="hidden",e.wrapperEl.style.scrollSnapType="",setTimeout(()=>{e.wrapperEl.style.overflow="",e.wrapperEl.scrollTo({[i]:S})}),s.cancelAnimationFrame(e.cssModeFrameID);return}e.cssModeFrameID=s.requestAnimationFrame(m)};m()}function ks(l,e){e===void 0&&(e="");const t=Ht(),i=[...l.children];return t.HTMLSlotElement&&l instanceof HTMLSlotElement&&i.push(...l.assignedElements()),e?i.filter(s=>s.matches(e)):i}function zI(l,e){const t=[e];for(;t.length>0;){const i=t.shift();if(l===i)return!0;t.push(...i.children,...i.shadowRoot?i.shadowRoot.children:[],...i.assignedElements?i.assignedElements():[])}}function HI(l,e){const t=Ht();let i=e.contains(l);return!i&&t.HTMLSlotElement&&e instanceof HTMLSlotElement&&(i=[...e.assignedElements()].includes(l),i||(i=zI(l,e))),i}function Ju(l){try{console.warn(l);return}catch{}}function zh(l,e){e===void 0&&(e=[]);const t=document.createElement(l);return t.classList.add(...Array.isArray(e)?e:BI(e)),t}function VI(l,e){const t=[];for(;l.previousElementSibling;){const i=l.previousElementSibling;e?i.matches(e)&&t.push(i):t.push(i),l=i}return t}function KI(l,e){const t=[];for(;l.nextElementSibling;){const i=l.nextElementSibling;e?i.matches(e)&&t.push(i):t.push(i),l=i}return t}function mn(l,e){return Ht().getComputedStyle(l,null).getPropertyValue(e)}function gS(l){let e=l,t;if(e){for(t=0;(e=e.previousSibling)!==null;)e.nodeType===1&&(t+=1);return t}}function YI(l,e){const t=[];let i=l.parentElement;for(;i;)t.push(i),i=i.parentElement;return t}function eh(l,e){function t(i){i.target===l&&(e.call(l,i),l.removeEventListener("transitionend",t))}e&&l.addEventListener("transitionend",t)}function mS(l,e,t){const i=Ht();return l[e==="width"?"offsetWidth":"offsetHeight"]+parseFloat(i.getComputedStyle(l,null).getPropertyValue(e==="width"?"margin-right":"margin-top"))+parseFloat(i.getComputedStyle(l,null).getPropertyValue(e==="width"?"margin-left":"margin-bottom"))}function pS(l,e){e===void 0&&(e=""),typeof trustedTypes<"u"?l.innerHTML=trustedTypes.createPolicy("html",{createHTML:t=>t}).createHTML(e):l.innerHTML=e}let th;function jI(){const l=Ht(),e=lr();return{smoothScroll:e.documentElement&&e.documentElement.style&&"scrollBehavior"in e.documentElement.style,touch:!!("ontouchstart"in l||l.DocumentTouch&&e instanceof l.DocumentTouch)}}function YE(){return th||(th=jI()),th}let ih;function qI(l){let{userAgent:e}=l===void 0?{}:l;const t=YE(),i=Ht(),s=i.navigator.platform,r=e||i.navigator.userAgent,o={ios:!1,android:!1},u=i.screen.width,d=i.screen.height,f=r.match(/(Android);?[\s\/]+([\d.]+)?/);let h=r.match(/(iPad).*OS\s([\d_]+)/);const m=r.match(/(iPod)(.*OS\s([\d_]+))?/),v=!h&&r.match(/(iPhone\sOS|iOS)\s([\d_]+)/),y=s==="Win32";let S=s==="MacIntel";const E=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!h&&S&&t.touch&&E.indexOf(`${u}x${d}`)>=0&&(h=r.match(/(Version)\/([\d.]+)/),h||(h=[0,1,"13_0_0"]),S=!1),f&&!y&&(o.os="android",o.android=!0),(h||v||m)&&(o.os="ios",o.ios=!0),o}function jE(l){return l===void 0&&(l={}),ih||(ih=qI(l)),ih}let sh;function XI(){const l=Ht(),e=jE();let t=!1;function i(){const u=l.navigator.userAgent.toLowerCase();return u.indexOf("safari")>=0&&u.indexOf("chrome")<0&&u.indexOf("android")<0}if(i()){const u=String(l.navigator.userAgent);if(u.includes("Version/")){const[d,f]=u.split("Version/")[1].split(" ")[0].split(".").map(h=>Number(h));t=d<16||d===16&&f<2}}const s=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(l.navigator.userAgent),r=i(),o=r||s&&e.ios;return{isSafari:t||r,needPerspectiveFix:t,need3dFix:o,isWebView:s}}function qE(){return sh||(sh=XI()),sh}function QI(l){let{swiper:e,on:t,emit:i}=l;const s=Ht();let r=null,o=null;const u=()=>{!e||e.destroyed||!e.initialized||(i("beforeResize"),i("resize"))},d=()=>{!e||e.destroyed||!e.initialized||(r=new ResizeObserver(m=>{o=s.requestAnimationFrame(()=>{const{width:v,height:y}=e;let S=v,E=y;m.forEach(x=>{let{contentBoxSize:_,contentRect:R,target:A}=x;A&&A!==e.el||(S=R?R.width:(_[0]||_).inlineSize,E=R?R.height:(_[0]||_).blockSize)}),(S!==v||E!==y)&&u()})}),r.observe(e.el))},f=()=>{o&&s.cancelAnimationFrame(o),r&&r.unobserve&&e.el&&(r.unobserve(e.el),r=null)},h=()=>{!e||e.destroyed||!e.initialized||i("orientationchange")};t("init",()=>{if(e.params.resizeObserver&&typeof s.ResizeObserver<"u"){d();return}s.addEventListener("resize",u),s.addEventListener("orientationchange",h)}),t("destroy",()=>{f(),s.removeEventListener("resize",u),s.removeEventListener("orientationchange",h)})}function WI(l){let{swiper:e,extendParams:t,on:i,emit:s}=l;const r=[],o=Ht(),u=function(h,m){m===void 0&&(m={});const v=o.MutationObserver||o.WebkitMutationObserver,y=new v(S=>{if(e.__preventObserver__)return;if(S.length===1){s("observerUpdate",S[0]);return}const E=function(){s("observerUpdate",S[0])};o.requestAnimationFrame?o.requestAnimationFrame(E):o.setTimeout(E,0)});y.observe(h,{attributes:typeof m.attributes>"u"?!0:m.attributes,childList:e.isElement||(typeof m.childList>"u"?!0:m).childList,characterData:typeof m.characterData>"u"?!0:m.characterData}),r.push(y)},d=()=>{if(e.params.observer){if(e.params.observeParents){const h=YI(e.hostEl);for(let m=0;m<h.length;m+=1)u(h[m])}u(e.hostEl,{childList:e.params.observeSlideChildren}),u(e.wrapperEl,{attributes:!1})}},f=()=>{r.forEach(h=>{h.disconnect()}),r.splice(0,r.length)};t({observer:!1,observeParents:!1,observeSlideChildren:!1}),i("init",d),i("destroy",f)}var ZI={on(l,e,t){const i=this;if(!i.eventsListeners||i.destroyed||typeof e!="function")return i;const s=t?"unshift":"push";return l.split(" ").forEach(r=>{i.eventsListeners[r]||(i.eventsListeners[r]=[]),i.eventsListeners[r][s](e)}),i},once(l,e,t){const i=this;if(!i.eventsListeners||i.destroyed||typeof e!="function")return i;function s(){i.off(l,s),s.__emitterProxy&&delete s.__emitterProxy;for(var r=arguments.length,o=new Array(r),u=0;u<r;u++)o[u]=arguments[u];e.apply(i,o)}return s.__emitterProxy=e,i.on(l,s,t)},onAny(l,e){const t=this;if(!t.eventsListeners||t.destroyed||typeof l!="function")return t;const i=e?"unshift":"push";return t.eventsAnyListeners.indexOf(l)<0&&t.eventsAnyListeners[i](l),t},offAny(l){const e=this;if(!e.eventsListeners||e.destroyed||!e.eventsAnyListeners)return e;const t=e.eventsAnyListeners.indexOf(l);return t>=0&&e.eventsAnyListeners.splice(t,1),e},off(l,e){const t=this;return!t.eventsListeners||t.destroyed||!t.eventsListeners||l.split(" ").forEach(i=>{typeof e>"u"?t.eventsListeners[i]=[]:t.eventsListeners[i]&&t.eventsListeners[i].forEach((s,r)=>{(s===e||s.__emitterProxy&&s.__emitterProxy===e)&&t.eventsListeners[i].splice(r,1)})}),t},emit(){const l=this;if(!l.eventsListeners||l.destroyed||!l.eventsListeners)return l;let e,t,i;for(var s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];return typeof r[0]=="string"||Array.isArray(r[0])?(e=r[0],t=r.slice(1,r.length),i=l):(e=r[0].events,t=r[0].data,i=r[0].context||l),t.unshift(i),(Array.isArray(e)?e:e.split(" ")).forEach(d=>{l.eventsAnyListeners&&l.eventsAnyListeners.length&&l.eventsAnyListeners.forEach(f=>{f.apply(i,[d,...t])}),l.eventsListeners&&l.eventsListeners[d]&&l.eventsListeners[d].forEach(f=>{f.apply(i,t)})}),l}};function JI(){const l=this;let e,t;const i=l.el;typeof l.params.width<"u"&&l.params.width!==null?e=l.params.width:e=i.clientWidth,typeof l.params.height<"u"&&l.params.height!==null?t=l.params.height:t=i.clientHeight,!(e===0&&l.isHorizontal()||t===0&&l.isVertical())&&(e=e-parseInt(mn(i,"padding-left")||0,10)-parseInt(mn(i,"padding-right")||0,10),t=t-parseInt(mn(i,"padding-top")||0,10)-parseInt(mn(i,"padding-bottom")||0,10),Number.isNaN(e)&&(e=0),Number.isNaN(t)&&(t=0),Object.assign(l,{width:e,height:t,size:l.isHorizontal()?e:t}))}function ew(){const l=this;function e(P,U){return parseFloat(P.getPropertyValue(l.getDirectionLabel(U))||0)}const t=l.params,{wrapperEl:i,slidesEl:s,size:r,rtlTranslate:o,wrongRTL:u}=l,d=l.virtual&&t.virtual.enabled,f=d?l.virtual.slides.length:l.slides.length,h=ks(s,`.${l.params.slideClass}, swiper-slide`),m=d?l.virtual.slides.length:h.length;let v=[];const y=[],S=[];let E=t.slidesOffsetBefore;typeof E=="function"&&(E=t.slidesOffsetBefore.call(l));let x=t.slidesOffsetAfter;typeof x=="function"&&(x=t.slidesOffsetAfter.call(l));const _=l.snapGrid.length,R=l.slidesGrid.length;let A=t.spaceBetween,I=-E,D=0,N=0;if(typeof r>"u")return;typeof A=="string"&&A.indexOf("%")>=0?A=parseFloat(A.replace("%",""))/100*r:typeof A=="string"&&(A=parseFloat(A)),l.virtualSize=-A,h.forEach(P=>{o?P.style.marginLeft="":P.style.marginRight="",P.style.marginBottom="",P.style.marginTop=""}),t.centeredSlides&&t.cssMode&&(_u(i,"--swiper-centered-offset-before",""),_u(i,"--swiper-centered-offset-after",""));const C=t.grid&&t.grid.rows>1&&l.grid;C?l.grid.initSlides(h):l.grid&&l.grid.unsetSlides();let M;const O=t.slidesPerView==="auto"&&t.breakpoints&&Object.keys(t.breakpoints).filter(P=>typeof t.breakpoints[P].slidesPerView<"u").length>0;for(let P=0;P<m;P+=1){M=0;let U;if(h[P]&&(U=h[P]),C&&l.grid.updateSlide(P,U,h),!(h[P]&&mn(U,"display")==="none")){if(t.slidesPerView==="auto"){O&&(h[P].style[l.getDirectionLabel("width")]="");const H=getComputedStyle(U),se=U.style.transform,ue=U.style.webkitTransform;if(se&&(U.style.transform="none"),ue&&(U.style.webkitTransform="none"),t.roundLengths)M=l.isHorizontal()?mS(U,"width"):mS(U,"height");else{const te=e(H,"width"),B=e(H,"padding-left"),K=e(H,"padding-right"),j=e(H,"margin-left"),oe=e(H,"margin-right"),k=H.getPropertyValue("box-sizing");if(k&&k==="border-box")M=te+j+oe;else{const{clientWidth:$,offsetWidth:q}=U;M=te+B+K+j+oe+(q-$)}}se&&(U.style.transform=se),ue&&(U.style.webkitTransform=ue),t.roundLengths&&(M=Math.floor(M))}else M=(r-(t.slidesPerView-1)*A)/t.slidesPerView,t.roundLengths&&(M=Math.floor(M)),h[P]&&(h[P].style[l.getDirectionLabel("width")]=`${M}px`);h[P]&&(h[P].swiperSlideSize=M),S.push(M),t.centeredSlides?(I=I+M/2+D/2+A,D===0&&P!==0&&(I=I-r/2-A),P===0&&(I=I-r/2-A),Math.abs(I)<1/1e3&&(I=0),t.roundLengths&&(I=Math.floor(I)),N%t.slidesPerGroup===0&&v.push(I),y.push(I)):(t.roundLengths&&(I=Math.floor(I)),(N-Math.min(l.params.slidesPerGroupSkip,N))%l.params.slidesPerGroup===0&&v.push(I),y.push(I),I=I+M+A),l.virtualSize+=M+A,D=M,N+=1}}if(l.virtualSize=Math.max(l.virtualSize,r)+x,o&&u&&(t.effect==="slide"||t.effect==="coverflow")&&(i.style.width=`${l.virtualSize+A}px`),t.setWrapperSize&&(i.style[l.getDirectionLabel("width")]=`${l.virtualSize+A}px`),C&&l.grid.updateWrapperSize(M,v),!t.centeredSlides){const P=[];for(let U=0;U<v.length;U+=1){let H=v[U];t.roundLengths&&(H=Math.floor(H)),v[U]<=l.virtualSize-r&&P.push(H)}v=P,Math.floor(l.virtualSize-r)-Math.floor(v[v.length-1])>1&&v.push(l.virtualSize-r)}if(d&&t.loop){const P=S[0]+A;if(t.slidesPerGroup>1){const U=Math.ceil((l.virtual.slidesBefore+l.virtual.slidesAfter)/t.slidesPerGroup),H=P*t.slidesPerGroup;for(let se=0;se<U;se+=1)v.push(v[v.length-1]+H)}for(let U=0;U<l.virtual.slidesBefore+l.virtual.slidesAfter;U+=1)t.slidesPerGroup===1&&v.push(v[v.length-1]+P),y.push(y[y.length-1]+P),l.virtualSize+=P}if(v.length===0&&(v=[0]),A!==0){const P=l.isHorizontal()&&o?"marginLeft":l.getDirectionLabel("marginRight");h.filter((U,H)=>!t.cssMode||t.loop?!0:H!==h.length-1).forEach(U=>{U.style[P]=`${A}px`})}if(t.centeredSlides&&t.centeredSlidesBounds){let P=0;S.forEach(H=>{P+=H+(A||0)}),P-=A;const U=P>r?P-r:0;v=v.map(H=>H<=0?-E:H>U?U+x:H)}if(t.centerInsufficientSlides){let P=0;S.forEach(H=>{P+=H+(A||0)}),P-=A;const U=(t.slidesOffsetBefore||0)+(t.slidesOffsetAfter||0);if(P+U<r){const H=(r-P-U)/2;v.forEach((se,ue)=>{v[ue]=se-H}),y.forEach((se,ue)=>{y[ue]=se+H})}}if(Object.assign(l,{slides:h,snapGrid:v,slidesGrid:y,slidesSizesGrid:S}),t.centeredSlides&&t.cssMode&&!t.centeredSlidesBounds){_u(i,"--swiper-centered-offset-before",`${-v[0]}px`),_u(i,"--swiper-centered-offset-after",`${l.size/2-S[S.length-1]/2}px`);const P=-l.snapGrid[0],U=-l.slidesGrid[0];l.snapGrid=l.snapGrid.map(H=>H+P),l.slidesGrid=l.slidesGrid.map(H=>H+U)}if(m!==f&&l.emit("slidesLengthChange"),v.length!==_&&(l.params.watchOverflow&&l.checkOverflow(),l.emit("snapGridLengthChange")),y.length!==R&&l.emit("slidesGridLengthChange"),t.watchSlidesProgress&&l.updateSlidesOffset(),l.emit("slidesUpdated"),!d&&!t.cssMode&&(t.effect==="slide"||t.effect==="fade")){const P=`${t.containerModifierClass}backface-hidden`,U=l.el.classList.contains(P);m<=t.maxBackfaceHiddenSlides?U||l.el.classList.add(P):U&&l.el.classList.remove(P)}}function tw(l){const e=this,t=[],i=e.virtual&&e.params.virtual.enabled;let s=0,r;typeof l=="number"?e.setTransition(l):l===!0&&e.setTransition(e.params.speed);const o=u=>i?e.slides[e.getSlideIndexByData(u)]:e.slides[u];if(e.params.slidesPerView!=="auto"&&e.params.slidesPerView>1)if(e.params.centeredSlides)(e.visibleSlides||[]).forEach(u=>{t.push(u)});else for(r=0;r<Math.ceil(e.params.slidesPerView);r+=1){const u=e.activeIndex+r;if(u>e.slides.length&&!i)break;t.push(o(u))}else t.push(o(e.activeIndex));for(r=0;r<t.length;r+=1)if(typeof t[r]<"u"){const u=t[r].offsetHeight;s=u>s?u:s}(s||s===0)&&(e.wrapperEl.style.height=`${s}px`)}function iw(){const l=this,e=l.slides,t=l.isElement?l.isHorizontal()?l.wrapperEl.offsetLeft:l.wrapperEl.offsetTop:0;for(let i=0;i<e.length;i+=1)e[i].swiperSlideOffset=(l.isHorizontal()?e[i].offsetLeft:e[i].offsetTop)-t-l.cssOverflowAdjustment()}const vS=(l,e,t)=>{e&&!l.classList.contains(t)?l.classList.add(t):!e&&l.classList.contains(t)&&l.classList.remove(t)};function sw(l){l===void 0&&(l=this&&this.translate||0);const e=this,t=e.params,{slides:i,rtlTranslate:s,snapGrid:r}=e;if(i.length===0)return;typeof i[0].swiperSlideOffset>"u"&&e.updateSlidesOffset();let o=-l;s&&(o=l),e.visibleSlidesIndexes=[],e.visibleSlides=[];let u=t.spaceBetween;typeof u=="string"&&u.indexOf("%")>=0?u=parseFloat(u.replace("%",""))/100*e.size:typeof u=="string"&&(u=parseFloat(u));for(let d=0;d<i.length;d+=1){const f=i[d];let h=f.swiperSlideOffset;t.cssMode&&t.centeredSlides&&(h-=i[0].swiperSlideOffset);const m=(o+(t.centeredSlides?e.minTranslate():0)-h)/(f.swiperSlideSize+u),v=(o-r[0]+(t.centeredSlides?e.minTranslate():0)-h)/(f.swiperSlideSize+u),y=-(o-h),S=y+e.slidesSizesGrid[d],E=y>=0&&y<=e.size-e.slidesSizesGrid[d],x=y>=0&&y<e.size-1||S>1&&S<=e.size||y<=0&&S>=e.size;x&&(e.visibleSlides.push(f),e.visibleSlidesIndexes.push(d)),vS(f,x,t.slideVisibleClass),vS(f,E,t.slideFullyVisibleClass),f.progress=s?-m:m,f.originalProgress=s?-v:v}}function nw(l){const e=this;if(typeof l>"u"){const h=e.rtlTranslate?-1:1;l=e&&e.translate&&e.translate*h||0}const t=e.params,i=e.maxTranslate()-e.minTranslate();let{progress:s,isBeginning:r,isEnd:o,progressLoop:u}=e;const d=r,f=o;if(i===0)s=0,r=!0,o=!0;else{s=(l-e.minTranslate())/i;const h=Math.abs(l-e.minTranslate())<1,m=Math.abs(l-e.maxTranslate())<1;r=h||s<=0,o=m||s>=1,h&&(s=0),m&&(s=1)}if(t.loop){const h=e.getSlideIndexByData(0),m=e.getSlideIndexByData(e.slides.length-1),v=e.slidesGrid[h],y=e.slidesGrid[m],S=e.slidesGrid[e.slidesGrid.length-1],E=Math.abs(l);E>=v?u=(E-v)/S:u=(E+S-y)/S,u>1&&(u-=1)}Object.assign(e,{progress:s,progressLoop:u,isBeginning:r,isEnd:o}),(t.watchSlidesProgress||t.centeredSlides&&t.autoHeight)&&e.updateSlidesProgress(l),r&&!d&&e.emit("reachBeginning toEdge"),o&&!f&&e.emit("reachEnd toEdge"),(d&&!r||f&&!o)&&e.emit("fromEdge"),e.emit("progress",s)}const nh=(l,e,t)=>{e&&!l.classList.contains(t)?l.classList.add(t):!e&&l.classList.contains(t)&&l.classList.remove(t)};function rw(){const l=this,{slides:e,params:t,slidesEl:i,activeIndex:s}=l,r=l.virtual&&t.virtual.enabled,o=l.grid&&t.grid&&t.grid.rows>1,u=m=>ks(i,`.${t.slideClass}${m}, swiper-slide${m}`)[0];let d,f,h;if(r)if(t.loop){let m=s-l.virtual.slidesBefore;m<0&&(m=l.virtual.slides.length+m),m>=l.virtual.slides.length&&(m-=l.virtual.slides.length),d=u(`[data-swiper-slide-index="${m}"]`)}else d=u(`[data-swiper-slide-index="${s}"]`);else o?(d=e.find(m=>m.column===s),h=e.find(m=>m.column===s+1),f=e.find(m=>m.column===s-1)):d=e[s];d&&(o||(h=KI(d,`.${t.slideClass}, swiper-slide`)[0],t.loop&&!h&&(h=e[0]),f=VI(d,`.${t.slideClass}, swiper-slide`)[0],t.loop&&!f===0&&(f=e[e.length-1]))),e.forEach(m=>{nh(m,m===d,t.slideActiveClass),nh(m,m===h,t.slideNextClass),nh(m,m===f,t.slidePrevClass)}),l.emitSlidesClasses()}const ku=(l,e)=>{if(!l||l.destroyed||!l.params)return;const t=()=>l.isElement?"swiper-slide":`.${l.params.slideClass}`,i=e.closest(t());if(i){let s=i.querySelector(`.${l.params.lazyPreloaderClass}`);!s&&l.isElement&&(i.shadowRoot?s=i.shadowRoot.querySelector(`.${l.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{i.shadowRoot&&(s=i.shadowRoot.querySelector(`.${l.params.lazyPreloaderClass}`),s&&s.remove())})),s&&s.remove()}},rh=(l,e)=>{if(!l.slides[e])return;const t=l.slides[e].querySelector('[loading="lazy"]');t&&t.removeAttribute("loading")},Hh=l=>{if(!l||l.destroyed||!l.params)return;let e=l.params.lazyPreloadPrevNext;const t=l.slides.length;if(!t||!e||e<0)return;e=Math.min(e,t);const i=l.params.slidesPerView==="auto"?l.slidesPerViewDynamic():Math.ceil(l.params.slidesPerView),s=l.activeIndex;if(l.params.grid&&l.params.grid.rows>1){const o=s,u=[o-e];u.push(...Array.from({length:e}).map((d,f)=>o+i+f)),l.slides.forEach((d,f)=>{u.includes(d.column)&&rh(l,f)});return}const r=s+i-1;if(l.params.rewind||l.params.loop)for(let o=s-e;o<=r+e;o+=1){const u=(o%t+t)%t;(u<s||u>r)&&rh(l,u)}else for(let o=Math.max(s-e,0);o<=Math.min(r+e,t-1);o+=1)o!==s&&(o>r||o<s)&&rh(l,o)};function aw(l){const{slidesGrid:e,params:t}=l,i=l.rtlTranslate?l.translate:-l.translate;let s;for(let r=0;r<e.length;r+=1)typeof e[r+1]<"u"?i>=e[r]&&i<e[r+1]-(e[r+1]-e[r])/2?s=r:i>=e[r]&&i<e[r+1]&&(s=r+1):i>=e[r]&&(s=r);return t.normalizeSlideIndex&&(s<0||typeof s>"u")&&(s=0),s}function lw(l){const e=this,t=e.rtlTranslate?e.translate:-e.translate,{snapGrid:i,params:s,activeIndex:r,realIndex:o,snapIndex:u}=e;let d=l,f;const h=y=>{let S=y-e.virtual.slidesBefore;return S<0&&(S=e.virtual.slides.length+S),S>=e.virtual.slides.length&&(S-=e.virtual.slides.length),S};if(typeof d>"u"&&(d=aw(e)),i.indexOf(t)>=0)f=i.indexOf(t);else{const y=Math.min(s.slidesPerGroupSkip,d);f=y+Math.floor((d-y)/s.slidesPerGroup)}if(f>=i.length&&(f=i.length-1),d===r&&!e.params.loop){f!==u&&(e.snapIndex=f,e.emit("snapIndexChange"));return}if(d===r&&e.params.loop&&e.virtual&&e.params.virtual.enabled){e.realIndex=h(d);return}const m=e.grid&&s.grid&&s.grid.rows>1;let v;if(e.virtual&&s.virtual.enabled&&s.loop)v=h(d);else if(m){const y=e.slides.find(E=>E.column===d);let S=parseInt(y.getAttribute("data-swiper-slide-index"),10);Number.isNaN(S)&&(S=Math.max(e.slides.indexOf(y),0)),v=Math.floor(S/s.grid.rows)}else if(e.slides[d]){const y=e.slides[d].getAttribute("data-swiper-slide-index");y?v=parseInt(y,10):v=d}else v=d;Object.assign(e,{previousSnapIndex:u,snapIndex:f,previousRealIndex:o,realIndex:v,previousIndex:r,activeIndex:d}),e.initialized&&Hh(e),e.emit("activeIndexChange"),e.emit("snapIndexChange"),(e.initialized||e.params.runCallbacksOnInit)&&(o!==v&&e.emit("realIndexChange"),e.emit("slideChange"))}function ow(l,e){const t=this,i=t.params;let s=l.closest(`.${i.slideClass}, swiper-slide`);!s&&t.isElement&&e&&e.length>1&&e.includes(l)&&[...e.slice(e.indexOf(l)+1,e.length)].forEach(u=>{!s&&u.matches&&u.matches(`.${i.slideClass}, swiper-slide`)&&(s=u)});let r=!1,o;if(s){for(let u=0;u<t.slides.length;u+=1)if(t.slides[u]===s){r=!0,o=u;break}}if(s&&r)t.clickedSlide=s,t.virtual&&t.params.virtual.enabled?t.clickedIndex=parseInt(s.getAttribute("data-swiper-slide-index"),10):t.clickedIndex=o;else{t.clickedSlide=void 0,t.clickedIndex=void 0;return}i.slideToClickedSlide&&t.clickedIndex!==void 0&&t.clickedIndex!==t.activeIndex&&t.slideToClickedSlide()}var uw={updateSize:JI,updateSlides:ew,updateAutoHeight:tw,updateSlidesOffset:iw,updateSlidesProgress:sw,updateProgress:nw,updateSlidesClasses:rw,updateActiveIndex:lw,updateClickedSlide:ow};function cw(l){l===void 0&&(l=this.isHorizontal()?"x":"y");const e=this,{params:t,rtlTranslate:i,translate:s,wrapperEl:r}=e;if(t.virtualTranslate)return i?-s:s;if(t.cssMode)return s;let o=GI(r,l);return o+=e.cssOverflowAdjustment(),i&&(o=-o),o||0}function fw(l,e){const t=this,{rtlTranslate:i,params:s,wrapperEl:r,progress:o}=t;let u=0,d=0;const f=0;t.isHorizontal()?u=i?-l:l:d=l,s.roundLengths&&(u=Math.floor(u),d=Math.floor(d)),t.previousTranslate=t.translate,t.translate=t.isHorizontal()?u:d,s.cssMode?r[t.isHorizontal()?"scrollLeft":"scrollTop"]=t.isHorizontal()?-u:-d:s.virtualTranslate||(t.isHorizontal()?u-=t.cssOverflowAdjustment():d-=t.cssOverflowAdjustment(),r.style.transform=`translate3d(${u}px, ${d}px, ${f}px)`);let h;const m=t.maxTranslate()-t.minTranslate();m===0?h=0:h=(l-t.minTranslate())/m,h!==o&&t.updateProgress(l),t.emit("setTranslate",t.translate,e)}function dw(){return-this.snapGrid[0]}function hw(){return-this.snapGrid[this.snapGrid.length-1]}function gw(l,e,t,i,s){l===void 0&&(l=0),e===void 0&&(e=this.params.speed),t===void 0&&(t=!0),i===void 0&&(i=!0);const r=this,{params:o,wrapperEl:u}=r;if(r.animating&&o.preventInteractionOnTransition)return!1;const d=r.minTranslate(),f=r.maxTranslate();let h;if(i&&l>d?h=d:i&&l<f?h=f:h=l,r.updateProgress(h),o.cssMode){const m=r.isHorizontal();if(e===0)u[m?"scrollLeft":"scrollTop"]=-h;else{if(!r.support.smoothScroll)return KE({swiper:r,targetPosition:-h,side:m?"left":"top"}),!0;u.scrollTo({[m?"left":"top"]:-h,behavior:"smooth"})}return!0}return e===0?(r.setTransition(0),r.setTranslate(h),t&&(r.emit("beforeTransitionStart",e,s),r.emit("transitionEnd"))):(r.setTransition(e),r.setTranslate(h),t&&(r.emit("beforeTransitionStart",e,s),r.emit("transitionStart")),r.animating||(r.animating=!0,r.onTranslateToWrapperTransitionEnd||(r.onTranslateToWrapperTransitionEnd=function(v){!r||r.destroyed||v.target===this&&(r.wrapperEl.removeEventListener("transitionend",r.onTranslateToWrapperTransitionEnd),r.onTranslateToWrapperTransitionEnd=null,delete r.onTranslateToWrapperTransitionEnd,r.animating=!1,t&&r.emit("transitionEnd"))}),r.wrapperEl.addEventListener("transitionend",r.onTranslateToWrapperTransitionEnd))),!0}var mw={getTranslate:cw,setTranslate:fw,minTranslate:dw,maxTranslate:hw,translateTo:gw};function pw(l,e){const t=this;t.params.cssMode||(t.wrapperEl.style.transitionDuration=`${l}ms`,t.wrapperEl.style.transitionDelay=l===0?"0ms":""),t.emit("setTransition",l,e)}function XE(l){let{swiper:e,runCallbacks:t,direction:i,step:s}=l;const{activeIndex:r,previousIndex:o}=e;let u=i;u||(r>o?u="next":r<o?u="prev":u="reset"),e.emit(`transition${s}`),t&&u==="reset"?e.emit(`slideResetTransition${s}`):t&&r!==o&&(e.emit(`slideChangeTransition${s}`),u==="next"?e.emit(`slideNextTransition${s}`):e.emit(`slidePrevTransition${s}`))}function vw(l,e){l===void 0&&(l=!0);const t=this,{params:i}=t;i.cssMode||(i.autoHeight&&t.updateAutoHeight(),XE({swiper:t,runCallbacks:l,direction:e,step:"Start"}))}function yw(l,e){l===void 0&&(l=!0);const t=this,{params:i}=t;t.animating=!1,!i.cssMode&&(t.setTransition(0),XE({swiper:t,runCallbacks:l,direction:e,step:"End"}))}var Sw={setTransition:pw,transitionStart:vw,transitionEnd:yw};function Tw(l,e,t,i,s){l===void 0&&(l=0),t===void 0&&(t=!0),typeof l=="string"&&(l=parseInt(l,10));const r=this;let o=l;o<0&&(o=0);const{params:u,snapGrid:d,slidesGrid:f,previousIndex:h,activeIndex:m,rtlTranslate:v,wrapperEl:y,enabled:S}=r;if(!S&&!i&&!s||r.destroyed||r.animating&&u.preventInteractionOnTransition)return!1;typeof e>"u"&&(e=r.params.speed);const E=Math.min(r.params.slidesPerGroupSkip,o);let x=E+Math.floor((o-E)/r.params.slidesPerGroup);x>=d.length&&(x=d.length-1);const _=-d[x];if(u.normalizeSlideIndex)for(let C=0;C<f.length;C+=1){const M=-Math.floor(_*100),O=Math.floor(f[C]*100),P=Math.floor(f[C+1]*100);typeof f[C+1]<"u"?M>=O&&M<P-(P-O)/2?o=C:M>=O&&M<P&&(o=C+1):M>=O&&(o=C)}if(r.initialized&&o!==m&&(!r.allowSlideNext&&(v?_>r.translate&&_>r.minTranslate():_<r.translate&&_<r.minTranslate())||!r.allowSlidePrev&&_>r.translate&&_>r.maxTranslate()&&(m||0)!==o))return!1;o!==(h||0)&&t&&r.emit("beforeSlideChangeStart"),r.updateProgress(_);let R;o>m?R="next":o<m?R="prev":R="reset";const A=r.virtual&&r.params.virtual.enabled;if(!(A&&s)&&(v&&-_===r.translate||!v&&_===r.translate))return r.updateActiveIndex(o),u.autoHeight&&r.updateAutoHeight(),r.updateSlidesClasses(),u.effect!=="slide"&&r.setTranslate(_),R!=="reset"&&(r.transitionStart(t,R),r.transitionEnd(t,R)),!1;if(u.cssMode){const C=r.isHorizontal(),M=v?_:-_;if(e===0)A&&(r.wrapperEl.style.scrollSnapType="none",r._immediateVirtual=!0),A&&!r._cssModeVirtualInitialSet&&r.params.initialSlide>0?(r._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{y[C?"scrollLeft":"scrollTop"]=M})):y[C?"scrollLeft":"scrollTop"]=M,A&&requestAnimationFrame(()=>{r.wrapperEl.style.scrollSnapType="",r._immediateVirtual=!1});else{if(!r.support.smoothScroll)return KE({swiper:r,targetPosition:M,side:C?"left":"top"}),!0;y.scrollTo({[C?"left":"top"]:M,behavior:"smooth"})}return!0}const N=qE().isSafari;return A&&!s&&N&&r.isElement&&r.virtual.update(!1,!1,o),r.setTransition(e),r.setTranslate(_),r.updateActiveIndex(o),r.updateSlidesClasses(),r.emit("beforeTransitionStart",e,i),r.transitionStart(t,R),e===0?r.transitionEnd(t,R):r.animating||(r.animating=!0,r.onSlideToWrapperTransitionEnd||(r.onSlideToWrapperTransitionEnd=function(M){!r||r.destroyed||M.target===this&&(r.wrapperEl.removeEventListener("transitionend",r.onSlideToWrapperTransitionEnd),r.onSlideToWrapperTransitionEnd=null,delete r.onSlideToWrapperTransitionEnd,r.transitionEnd(t,R))}),r.wrapperEl.addEventListener("transitionend",r.onSlideToWrapperTransitionEnd)),!0}function Ew(l,e,t,i){l===void 0&&(l=0),t===void 0&&(t=!0),typeof l=="string"&&(l=parseInt(l,10));const s=this;if(s.destroyed)return;typeof e>"u"&&(e=s.params.speed);const r=s.grid&&s.params.grid&&s.params.grid.rows>1;let o=l;if(s.params.loop)if(s.virtual&&s.params.virtual.enabled)o=o+s.virtual.slidesBefore;else{let u;if(r){const v=o*s.params.grid.rows;u=s.slides.find(y=>y.getAttribute("data-swiper-slide-index")*1===v).column}else u=s.getSlideIndexByData(o);const d=r?Math.ceil(s.slides.length/s.params.grid.rows):s.slides.length,{centeredSlides:f}=s.params;let h=s.params.slidesPerView;h==="auto"?h=s.slidesPerViewDynamic():(h=Math.ceil(parseFloat(s.params.slidesPerView,10)),f&&h%2===0&&(h=h+1));let m=d-u<h;if(f&&(m=m||u<Math.ceil(h/2)),i&&f&&s.params.slidesPerView!=="auto"&&!r&&(m=!1),m){const v=f?u<s.activeIndex?"prev":"next":u-s.activeIndex-1<s.params.slidesPerView?"next":"prev";s.loopFix({direction:v,slideTo:!0,activeSlideIndex:v==="next"?u+1:u-d+1,slideRealIndex:v==="next"?s.realIndex:void 0})}if(r){const v=o*s.params.grid.rows;o=s.slides.find(y=>y.getAttribute("data-swiper-slide-index")*1===v).column}else o=s.getSlideIndexByData(o)}return requestAnimationFrame(()=>{s.slideTo(o,e,t,i)}),s}function xw(l,e,t){e===void 0&&(e=!0);const i=this,{enabled:s,params:r,animating:o}=i;if(!s||i.destroyed)return i;typeof l>"u"&&(l=i.params.speed);let u=r.slidesPerGroup;r.slidesPerView==="auto"&&r.slidesPerGroup===1&&r.slidesPerGroupAuto&&(u=Math.max(i.slidesPerViewDynamic("current",!0),1));const d=i.activeIndex<r.slidesPerGroupSkip?1:u,f=i.virtual&&r.virtual.enabled;if(r.loop){if(o&&!f&&r.loopPreventsSliding)return!1;if(i.loopFix({direction:"next"}),i._clientLeft=i.wrapperEl.clientLeft,i.activeIndex===i.slides.length-1&&r.cssMode)return requestAnimationFrame(()=>{i.slideTo(i.activeIndex+d,l,e,t)}),!0}return r.rewind&&i.isEnd?i.slideTo(0,l,e,t):i.slideTo(i.activeIndex+d,l,e,t)}function _w(l,e,t){e===void 0&&(e=!0);const i=this,{params:s,snapGrid:r,slidesGrid:o,rtlTranslate:u,enabled:d,animating:f}=i;if(!d||i.destroyed)return i;typeof l>"u"&&(l=i.params.speed);const h=i.virtual&&s.virtual.enabled;if(s.loop){if(f&&!h&&s.loopPreventsSliding)return!1;i.loopFix({direction:"prev"}),i._clientLeft=i.wrapperEl.clientLeft}const m=u?i.translate:-i.translate;function v(R){return R<0?-Math.floor(Math.abs(R)):Math.floor(R)}const y=v(m),S=r.map(R=>v(R)),E=s.freeMode&&s.freeMode.enabled;let x=r[S.indexOf(y)-1];if(typeof x>"u"&&(s.cssMode||E)){let R;r.forEach((A,I)=>{y>=A&&(R=I)}),typeof R<"u"&&(x=E?r[R]:r[R>0?R-1:R])}let _=0;if(typeof x<"u"&&(_=o.indexOf(x),_<0&&(_=i.activeIndex-1),s.slidesPerView==="auto"&&s.slidesPerGroup===1&&s.slidesPerGroupAuto&&(_=_-i.slidesPerViewDynamic("previous",!0)+1,_=Math.max(_,0))),s.rewind&&i.isBeginning){const R=i.params.virtual&&i.params.virtual.enabled&&i.virtual?i.virtual.slides.length-1:i.slides.length-1;return i.slideTo(R,l,e,t)}else if(s.loop&&i.activeIndex===0&&s.cssMode)return requestAnimationFrame(()=>{i.slideTo(_,l,e,t)}),!0;return i.slideTo(_,l,e,t)}function bw(l,e,t){e===void 0&&(e=!0);const i=this;if(!i.destroyed)return typeof l>"u"&&(l=i.params.speed),i.slideTo(i.activeIndex,l,e,t)}function Aw(l,e,t,i){e===void 0&&(e=!0),i===void 0&&(i=.5);const s=this;if(s.destroyed)return;typeof l>"u"&&(l=s.params.speed);let r=s.activeIndex;const o=Math.min(s.params.slidesPerGroupSkip,r),u=o+Math.floor((r-o)/s.params.slidesPerGroup),d=s.rtlTranslate?s.translate:-s.translate;if(d>=s.snapGrid[u]){const f=s.snapGrid[u],h=s.snapGrid[u+1];d-f>(h-f)*i&&(r+=s.params.slidesPerGroup)}else{const f=s.snapGrid[u-1],h=s.snapGrid[u];d-f<=(h-f)*i&&(r-=s.params.slidesPerGroup)}return r=Math.max(r,0),r=Math.min(r,s.slidesGrid.length-1),s.slideTo(r,l,e,t)}function Lw(){const l=this;if(l.destroyed)return;const{params:e,slidesEl:t}=l,i=e.slidesPerView==="auto"?l.slidesPerViewDynamic():e.slidesPerView;let s=l.getSlideIndexWhenGrid(l.clickedIndex),r;const o=l.isElement?"swiper-slide":`.${e.slideClass}`,u=l.grid&&l.params.grid&&l.params.grid.rows>1;if(e.loop){if(l.animating)return;r=parseInt(l.clickedSlide.getAttribute("data-swiper-slide-index"),10),e.centeredSlides?l.slideToLoop(r):s>(u?(l.slides.length-i)/2-(l.params.grid.rows-1):l.slides.length-i)?(l.loopFix(),s=l.getSlideIndex(ks(t,`${o}[data-swiper-slide-index="${r}"]`)[0]),VE(()=>{l.slideTo(s)})):l.slideTo(s)}else l.slideTo(s)}var Rw={slideTo:Tw,slideToLoop:Ew,slideNext:xw,slidePrev:_w,slideReset:bw,slideToClosest:Aw,slideToClickedSlide:Lw};function Dw(l,e){const t=this,{params:i,slidesEl:s}=t;if(!i.loop||t.virtual&&t.params.virtual.enabled)return;const r=()=>{ks(s,`.${i.slideClass}, swiper-slide`).forEach((y,S)=>{y.setAttribute("data-swiper-slide-index",S)})},o=()=>{const v=ks(s,`.${i.slideBlankClass}`);v.forEach(y=>{y.remove()}),v.length>0&&(t.recalcSlides(),t.updateSlides())},u=t.grid&&i.grid&&i.grid.rows>1;i.loopAddBlankSlides&&(i.slidesPerGroup>1||u)&&o();const d=i.slidesPerGroup*(u?i.grid.rows:1),f=t.slides.length%d!==0,h=u&&t.slides.length%i.grid.rows!==0,m=v=>{for(let y=0;y<v;y+=1){const S=t.isElement?zh("swiper-slide",[i.slideBlankClass]):zh("div",[i.slideClass,i.slideBlankClass]);t.slidesEl.append(S)}};if(f){if(i.loopAddBlankSlides){const v=d-t.slides.length%d;m(v),t.recalcSlides(),t.updateSlides()}else Ju("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else if(h){if(i.loopAddBlankSlides){const v=i.grid.rows-t.slides.length%i.grid.rows;m(v),t.recalcSlides(),t.updateSlides()}else Ju("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else r();t.loopFix({slideRealIndex:l,direction:i.centeredSlides?void 0:"next",initial:e})}function Iw(l){let{slideRealIndex:e,slideTo:t=!0,direction:i,setTranslate:s,activeSlideIndex:r,initial:o,byController:u,byMousewheel:d}=l===void 0?{}:l;const f=this;if(!f.params.loop)return;f.emit("beforeLoopFix");const{slides:h,allowSlidePrev:m,allowSlideNext:v,slidesEl:y,params:S}=f,{centeredSlides:E,initialSlide:x}=S;if(f.allowSlidePrev=!0,f.allowSlideNext=!0,f.virtual&&S.virtual.enabled){t&&(!S.centeredSlides&&f.snapIndex===0?f.slideTo(f.virtual.slides.length,0,!1,!0):S.centeredSlides&&f.snapIndex<S.slidesPerView?f.slideTo(f.virtual.slides.length+f.snapIndex,0,!1,!0):f.snapIndex===f.snapGrid.length-1&&f.slideTo(f.virtual.slidesBefore,0,!1,!0)),f.allowSlidePrev=m,f.allowSlideNext=v,f.emit("loopFix");return}let _=S.slidesPerView;_==="auto"?_=f.slidesPerViewDynamic():(_=Math.ceil(parseFloat(S.slidesPerView,10)),E&&_%2===0&&(_=_+1));const R=S.slidesPerGroupAuto?_:S.slidesPerGroup;let A=E?Math.max(R,Math.ceil(_/2)):R;A%R!==0&&(A+=R-A%R),A+=S.loopAdditionalSlides,f.loopedSlides=A;const I=f.grid&&S.grid&&S.grid.rows>1;h.length<_+A||f.params.effect==="cards"&&h.length<_+A*2?Ju("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled or not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):I&&S.grid.fill==="row"&&Ju("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const D=[],N=[],C=I?Math.ceil(h.length/S.grid.rows):h.length,M=o&&C-x<_&&!E;let O=M?x:f.activeIndex;typeof r>"u"?r=f.getSlideIndex(h.find(B=>B.classList.contains(S.slideActiveClass))):O=r;const P=i==="next"||!i,U=i==="prev"||!i;let H=0,se=0;const te=(I?h[r].column:r)+(E&&typeof s>"u"?-_/2+.5:0);if(te<A){H=Math.max(A-te,R);for(let B=0;B<A-te;B+=1){const K=B-Math.floor(B/C)*C;if(I){const j=C-K-1;for(let oe=h.length-1;oe>=0;oe-=1)h[oe].column===j&&D.push(oe)}else D.push(C-K-1)}}else if(te+_>C-A){se=Math.max(te-(C-A*2),R),M&&(se=Math.max(se,_-C+x+1));for(let B=0;B<se;B+=1){const K=B-Math.floor(B/C)*C;I?h.forEach((j,oe)=>{j.column===K&&N.push(oe)}):N.push(K)}}if(f.__preventObserver__=!0,requestAnimationFrame(()=>{f.__preventObserver__=!1}),f.params.effect==="cards"&&h.length<_+A*2&&(N.includes(r)&&N.splice(N.indexOf(r),1),D.includes(r)&&D.splice(D.indexOf(r),1)),U&&D.forEach(B=>{h[B].swiperLoopMoveDOM=!0,y.prepend(h[B]),h[B].swiperLoopMoveDOM=!1}),P&&N.forEach(B=>{h[B].swiperLoopMoveDOM=!0,y.append(h[B]),h[B].swiperLoopMoveDOM=!1}),f.recalcSlides(),S.slidesPerView==="auto"?f.updateSlides():I&&(D.length>0&&U||N.length>0&&P)&&f.slides.forEach((B,K)=>{f.grid.updateSlide(K,B,f.slides)}),S.watchSlidesProgress&&f.updateSlidesOffset(),t){if(D.length>0&&U){if(typeof e>"u"){const B=f.slidesGrid[O],j=f.slidesGrid[O+H]-B;d?f.setTranslate(f.translate-j):(f.slideTo(O+Math.ceil(H),0,!1,!0),s&&(f.touchEventsData.startTranslate=f.touchEventsData.startTranslate-j,f.touchEventsData.currentTranslate=f.touchEventsData.currentTranslate-j))}else if(s){const B=I?D.length/S.grid.rows:D.length;f.slideTo(f.activeIndex+B,0,!1,!0),f.touchEventsData.currentTranslate=f.translate}}else if(N.length>0&&P)if(typeof e>"u"){const B=f.slidesGrid[O],j=f.slidesGrid[O-se]-B;d?f.setTranslate(f.translate-j):(f.slideTo(O-se,0,!1,!0),s&&(f.touchEventsData.startTranslate=f.touchEventsData.startTranslate-j,f.touchEventsData.currentTranslate=f.touchEventsData.currentTranslate-j))}else{const B=I?N.length/S.grid.rows:N.length;f.slideTo(f.activeIndex-B,0,!1,!0)}}if(f.allowSlidePrev=m,f.allowSlideNext=v,f.controller&&f.controller.control&&!u){const B={slideRealIndex:e,direction:i,setTranslate:s,activeSlideIndex:r,byController:!0};Array.isArray(f.controller.control)?f.controller.control.forEach(K=>{!K.destroyed&&K.params.loop&&K.loopFix({...B,slideTo:K.params.slidesPerView===S.slidesPerView?t:!1})}):f.controller.control instanceof f.constructor&&f.controller.control.params.loop&&f.controller.control.loopFix({...B,slideTo:f.controller.control.params.slidesPerView===S.slidesPerView?t:!1})}f.emit("loopFix")}function ww(){const l=this,{params:e,slidesEl:t}=l;if(!e.loop||!t||l.virtual&&l.params.virtual.enabled)return;l.recalcSlides();const i=[];l.slides.forEach(s=>{const r=typeof s.swiperSlideIndex>"u"?s.getAttribute("data-swiper-slide-index")*1:s.swiperSlideIndex;i[r]=s}),l.slides.forEach(s=>{s.removeAttribute("data-swiper-slide-index")}),i.forEach(s=>{t.append(s)}),l.recalcSlides(),l.slideTo(l.realIndex,0)}var Cw={loopCreate:Dw,loopFix:Iw,loopDestroy:ww};function Ow(l){const e=this;if(!e.params.simulateTouch||e.params.watchOverflow&&e.isLocked||e.params.cssMode)return;const t=e.params.touchEventsTarget==="container"?e.el:e.wrapperEl;e.isElement&&(e.__preventObserver__=!0),t.style.cursor="move",t.style.cursor=l?"grabbing":"grab",e.isElement&&requestAnimationFrame(()=>{e.__preventObserver__=!1})}function Mw(){const l=this;l.params.watchOverflow&&l.isLocked||l.params.cssMode||(l.isElement&&(l.__preventObserver__=!0),l[l.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",l.isElement&&requestAnimationFrame(()=>{l.__preventObserver__=!1}))}var Pw={setGrabCursor:Ow,unsetGrabCursor:Mw};function kw(l,e){e===void 0&&(e=this);function t(i){if(!i||i===lr()||i===Ht())return null;i.assignedSlot&&(i=i.assignedSlot);const s=i.closest(l);return!s&&!i.getRootNode?null:s||t(i.getRootNode().host)}return t(e)}function yS(l,e,t){const i=Ht(),{params:s}=l,r=s.edgeSwipeDetection,o=s.edgeSwipeThreshold;return r&&(t<=o||t>=i.innerWidth-o)?r==="prevent"?(e.preventDefault(),!0):!1:!0}function Nw(l){const e=this,t=lr();let i=l;i.originalEvent&&(i=i.originalEvent);const s=e.touchEventsData;if(i.type==="pointerdown"){if(s.pointerId!==null&&s.pointerId!==i.pointerId)return;s.pointerId=i.pointerId}else i.type==="touchstart"&&i.targetTouches.length===1&&(s.touchId=i.targetTouches[0].identifier);if(i.type==="touchstart"){yS(e,i,i.targetTouches[0].pageX);return}const{params:r,touches:o,enabled:u}=e;if(!u||!r.simulateTouch&&i.pointerType==="mouse"||e.animating&&r.preventInteractionOnTransition)return;!e.animating&&r.cssMode&&r.loop&&e.loopFix();let d=i.target;if(r.touchEventsTarget==="wrapper"&&!HI(d,e.wrapperEl)||"which"in i&&i.which===3||"button"in i&&i.button>0||s.isTouched&&s.isMoved)return;const f=!!r.noSwipingClass&&r.noSwipingClass!=="",h=i.composedPath?i.composedPath():i.path;f&&i.target&&i.target.shadowRoot&&h&&(d=h[0]);const m=r.noSwipingSelector?r.noSwipingSelector:`.${r.noSwipingClass}`,v=!!(i.target&&i.target.shadowRoot);if(r.noSwiping&&(v?kw(m,d):d.closest(m))){e.allowClick=!0;return}if(r.swipeHandler&&!d.closest(r.swipeHandler))return;o.currentX=i.pageX,o.currentY=i.pageY;const y=o.currentX,S=o.currentY;if(!yS(e,i,y))return;Object.assign(s,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),o.startX=y,o.startY=S,s.touchStartTime=ir(),e.allowClick=!0,e.updateSize(),e.swipeDirection=void 0,r.threshold>0&&(s.allowThresholdMove=!1);let E=!0;d.matches(s.focusableElements)&&(E=!1,d.nodeName==="SELECT"&&(s.isTouched=!1)),t.activeElement&&t.activeElement.matches(s.focusableElements)&&t.activeElement!==d&&(i.pointerType==="mouse"||i.pointerType!=="mouse"&&!d.matches(s.focusableElements))&&t.activeElement.blur();const x=E&&e.allowTouchMove&&r.touchStartPreventDefault;(r.touchStartForcePreventDefault||x)&&!d.isContentEditable&&i.preventDefault(),r.freeMode&&r.freeMode.enabled&&e.freeMode&&e.animating&&!r.cssMode&&e.freeMode.onTouchStart(),e.emit("touchStart",i)}function Bw(l){const e=lr(),t=this,i=t.touchEventsData,{params:s,touches:r,rtlTranslate:o,enabled:u}=t;if(!u||!s.simulateTouch&&l.pointerType==="mouse")return;let d=l;if(d.originalEvent&&(d=d.originalEvent),d.type==="pointermove"&&(i.touchId!==null||d.pointerId!==i.pointerId))return;let f;if(d.type==="touchmove"){if(f=[...d.changedTouches].find(D=>D.identifier===i.touchId),!f||f.identifier!==i.touchId)return}else f=d;if(!i.isTouched){i.startMoving&&i.isScrolling&&t.emit("touchMoveOpposite",d);return}const h=f.pageX,m=f.pageY;if(d.preventedByNestedSwiper){r.startX=h,r.startY=m;return}if(!t.allowTouchMove){d.target.matches(i.focusableElements)||(t.allowClick=!1),i.isTouched&&(Object.assign(r,{startX:h,startY:m,currentX:h,currentY:m}),i.touchStartTime=ir());return}if(s.touchReleaseOnEdges&&!s.loop)if(t.isVertical()){if(m<r.startY&&t.translate<=t.maxTranslate()||m>r.startY&&t.translate>=t.minTranslate()){i.isTouched=!1,i.isMoved=!1;return}}else{if(o&&(h>r.startX&&-t.translate<=t.maxTranslate()||h<r.startX&&-t.translate>=t.minTranslate()))return;if(!o&&(h<r.startX&&t.translate<=t.maxTranslate()||h>r.startX&&t.translate>=t.minTranslate()))return}if(e.activeElement&&e.activeElement.matches(i.focusableElements)&&e.activeElement!==d.target&&d.pointerType!=="mouse"&&e.activeElement.blur(),e.activeElement&&d.target===e.activeElement&&d.target.matches(i.focusableElements)){i.isMoved=!0,t.allowClick=!1;return}i.allowTouchCallbacks&&t.emit("touchMove",d),r.previousX=r.currentX,r.previousY=r.currentY,r.currentX=h,r.currentY=m;const v=r.currentX-r.startX,y=r.currentY-r.startY;if(t.params.threshold&&Math.sqrt(v**2+y**2)<t.params.threshold)return;if(typeof i.isScrolling>"u"){let D;t.isHorizontal()&&r.currentY===r.startY||t.isVertical()&&r.currentX===r.startX?i.isScrolling=!1:v*v+y*y>=25&&(D=Math.atan2(Math.abs(y),Math.abs(v))*180/Math.PI,i.isScrolling=t.isHorizontal()?D>s.touchAngle:90-D>s.touchAngle)}if(i.isScrolling&&t.emit("touchMoveOpposite",d),typeof i.startMoving>"u"&&(r.currentX!==r.startX||r.currentY!==r.startY)&&(i.startMoving=!0),i.isScrolling||d.type==="touchmove"&&i.preventTouchMoveFromPointerMove){i.isTouched=!1;return}if(!i.startMoving)return;t.allowClick=!1,!s.cssMode&&d.cancelable&&d.preventDefault(),s.touchMoveStopPropagation&&!s.nested&&d.stopPropagation();let S=t.isHorizontal()?v:y,E=t.isHorizontal()?r.currentX-r.previousX:r.currentY-r.previousY;s.oneWayMovement&&(S=Math.abs(S)*(o?1:-1),E=Math.abs(E)*(o?1:-1)),r.diff=S,S*=s.touchRatio,o&&(S=-S,E=-E);const x=t.touchesDirection;t.swipeDirection=S>0?"prev":"next",t.touchesDirection=E>0?"prev":"next";const _=t.params.loop&&!s.cssMode,R=t.touchesDirection==="next"&&t.allowSlideNext||t.touchesDirection==="prev"&&t.allowSlidePrev;if(!i.isMoved){if(_&&R&&t.loopFix({direction:t.swipeDirection}),i.startTranslate=t.getTranslate(),t.setTransition(0),t.animating){const D=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});t.wrapperEl.dispatchEvent(D)}i.allowMomentumBounce=!1,s.grabCursor&&(t.allowSlideNext===!0||t.allowSlidePrev===!0)&&t.setGrabCursor(!0),t.emit("sliderFirstMove",d)}if(new Date().getTime(),s._loopSwapReset!==!1&&i.isMoved&&i.allowThresholdMove&&x!==t.touchesDirection&&_&&R&&Math.abs(S)>=1){Object.assign(r,{startX:h,startY:m,currentX:h,currentY:m,startTranslate:i.currentTranslate}),i.loopSwapReset=!0,i.startTranslate=i.currentTranslate;return}t.emit("sliderMove",d),i.isMoved=!0,i.currentTranslate=S+i.startTranslate;let A=!0,I=s.resistanceRatio;if(s.touchReleaseOnEdges&&(I=0),S>0?(_&&R&&i.allowThresholdMove&&i.currentTranslate>(s.centeredSlides?t.minTranslate()-t.slidesSizesGrid[t.activeIndex+1]-(s.slidesPerView!=="auto"&&t.slides.length-s.slidesPerView>=2?t.slidesSizesGrid[t.activeIndex+1]+t.params.spaceBetween:0)-t.params.spaceBetween:t.minTranslate())&&t.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),i.currentTranslate>t.minTranslate()&&(A=!1,s.resistance&&(i.currentTranslate=t.minTranslate()-1+(-t.minTranslate()+i.startTranslate+S)**I))):S<0&&(_&&R&&i.allowThresholdMove&&i.currentTranslate<(s.centeredSlides?t.maxTranslate()+t.slidesSizesGrid[t.slidesSizesGrid.length-1]+t.params.spaceBetween+(s.slidesPerView!=="auto"&&t.slides.length-s.slidesPerView>=2?t.slidesSizesGrid[t.slidesSizesGrid.length-1]+t.params.spaceBetween:0):t.maxTranslate())&&t.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:t.slides.length-(s.slidesPerView==="auto"?t.slidesPerViewDynamic():Math.ceil(parseFloat(s.slidesPerView,10)))}),i.currentTranslate<t.maxTranslate()&&(A=!1,s.resistance&&(i.currentTranslate=t.maxTranslate()+1-(t.maxTranslate()-i.startTranslate-S)**I))),A&&(d.preventedByNestedSwiper=!0),!t.allowSlideNext&&t.swipeDirection==="next"&&i.currentTranslate<i.startTranslate&&(i.currentTranslate=i.startTranslate),!t.allowSlidePrev&&t.swipeDirection==="prev"&&i.currentTranslate>i.startTranslate&&(i.currentTranslate=i.startTranslate),!t.allowSlidePrev&&!t.allowSlideNext&&(i.currentTranslate=i.startTranslate),s.threshold>0)if(Math.abs(S)>s.threshold||i.allowThresholdMove){if(!i.allowThresholdMove){i.allowThresholdMove=!0,r.startX=r.currentX,r.startY=r.currentY,i.currentTranslate=i.startTranslate,r.diff=t.isHorizontal()?r.currentX-r.startX:r.currentY-r.startY;return}}else{i.currentTranslate=i.startTranslate;return}!s.followFinger||s.cssMode||((s.freeMode&&s.freeMode.enabled&&t.freeMode||s.watchSlidesProgress)&&(t.updateActiveIndex(),t.updateSlidesClasses()),s.freeMode&&s.freeMode.enabled&&t.freeMode&&t.freeMode.onTouchMove(),t.updateProgress(i.currentTranslate),t.setTranslate(i.currentTranslate))}function Fw(l){const e=this,t=e.touchEventsData;let i=l;i.originalEvent&&(i=i.originalEvent);let s;if(i.type==="touchend"||i.type==="touchcancel"){if(s=[...i.changedTouches].find(D=>D.identifier===t.touchId),!s||s.identifier!==t.touchId)return}else{if(t.touchId!==null||i.pointerId!==t.pointerId)return;s=i}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(i.type)&&!(["pointercancel","contextmenu"].includes(i.type)&&(e.browser.isSafari||e.browser.isWebView)))return;t.pointerId=null,t.touchId=null;const{params:o,touches:u,rtlTranslate:d,slidesGrid:f,enabled:h}=e;if(!h||!o.simulateTouch&&i.pointerType==="mouse")return;if(t.allowTouchCallbacks&&e.emit("touchEnd",i),t.allowTouchCallbacks=!1,!t.isTouched){t.isMoved&&o.grabCursor&&e.setGrabCursor(!1),t.isMoved=!1,t.startMoving=!1;return}o.grabCursor&&t.isMoved&&t.isTouched&&(e.allowSlideNext===!0||e.allowSlidePrev===!0)&&e.setGrabCursor(!1);const m=ir(),v=m-t.touchStartTime;if(e.allowClick){const D=i.path||i.composedPath&&i.composedPath();e.updateClickedSlide(D&&D[0]||i.target,D),e.emit("tap click",i),v<300&&m-t.lastClickTime<300&&e.emit("doubleTap doubleClick",i)}if(t.lastClickTime=ir(),VE(()=>{e.destroyed||(e.allowClick=!0)}),!t.isTouched||!t.isMoved||!e.swipeDirection||u.diff===0&&!t.loopSwapReset||t.currentTranslate===t.startTranslate&&!t.loopSwapReset){t.isTouched=!1,t.isMoved=!1,t.startMoving=!1;return}t.isTouched=!1,t.isMoved=!1,t.startMoving=!1;let y;if(o.followFinger?y=d?e.translate:-e.translate:y=-t.currentTranslate,o.cssMode)return;if(o.freeMode&&o.freeMode.enabled){e.freeMode.onTouchEnd({currentPos:y});return}const S=y>=-e.maxTranslate()&&!e.params.loop;let E=0,x=e.slidesSizesGrid[0];for(let D=0;D<f.length;D+=D<o.slidesPerGroupSkip?1:o.slidesPerGroup){const N=D<o.slidesPerGroupSkip-1?1:o.slidesPerGroup;typeof f[D+N]<"u"?(S||y>=f[D]&&y<f[D+N])&&(E=D,x=f[D+N]-f[D]):(S||y>=f[D])&&(E=D,x=f[f.length-1]-f[f.length-2])}let _=null,R=null;o.rewind&&(e.isBeginning?R=o.virtual&&o.virtual.enabled&&e.virtual?e.virtual.slides.length-1:e.slides.length-1:e.isEnd&&(_=0));const A=(y-f[E])/x,I=E<o.slidesPerGroupSkip-1?1:o.slidesPerGroup;if(v>o.longSwipesMs){if(!o.longSwipes){e.slideTo(e.activeIndex);return}e.swipeDirection==="next"&&(A>=o.longSwipesRatio?e.slideTo(o.rewind&&e.isEnd?_:E+I):e.slideTo(E)),e.swipeDirection==="prev"&&(A>1-o.longSwipesRatio?e.slideTo(E+I):R!==null&&A<0&&Math.abs(A)>o.longSwipesRatio?e.slideTo(R):e.slideTo(E))}else{if(!o.shortSwipes){e.slideTo(e.activeIndex);return}e.navigation&&(i.target===e.navigation.nextEl||i.target===e.navigation.prevEl)?i.target===e.navigation.nextEl?e.slideTo(E+I):e.slideTo(E):(e.swipeDirection==="next"&&e.slideTo(_!==null?_:E+I),e.swipeDirection==="prev"&&e.slideTo(R!==null?R:E))}}function SS(){const l=this,{params:e,el:t}=l;if(t&&t.offsetWidth===0)return;e.breakpoints&&l.setBreakpoint();const{allowSlideNext:i,allowSlidePrev:s,snapGrid:r}=l,o=l.virtual&&l.params.virtual.enabled;l.allowSlideNext=!0,l.allowSlidePrev=!0,l.updateSize(),l.updateSlides(),l.updateSlidesClasses();const u=o&&e.loop;(e.slidesPerView==="auto"||e.slidesPerView>1)&&l.isEnd&&!l.isBeginning&&!l.params.centeredSlides&&!u?l.slideTo(l.slides.length-1,0,!1,!0):l.params.loop&&!o?l.slideToLoop(l.realIndex,0,!1,!0):l.slideTo(l.activeIndex,0,!1,!0),l.autoplay&&l.autoplay.running&&l.autoplay.paused&&(clearTimeout(l.autoplay.resizeTimeout),l.autoplay.resizeTimeout=setTimeout(()=>{l.autoplay&&l.autoplay.running&&l.autoplay.paused&&l.autoplay.resume()},500)),l.allowSlidePrev=s,l.allowSlideNext=i,l.params.watchOverflow&&r!==l.snapGrid&&l.checkOverflow()}function Uw(l){const e=this;e.enabled&&(e.allowClick||(e.params.preventClicks&&l.preventDefault(),e.params.preventClicksPropagation&&e.animating&&(l.stopPropagation(),l.stopImmediatePropagation())))}function Gw(){const l=this,{wrapperEl:e,rtlTranslate:t,enabled:i}=l;if(!i)return;l.previousTranslate=l.translate,l.isHorizontal()?l.translate=-e.scrollLeft:l.translate=-e.scrollTop,l.translate===0&&(l.translate=0),l.updateActiveIndex(),l.updateSlidesClasses();let s;const r=l.maxTranslate()-l.minTranslate();r===0?s=0:s=(l.translate-l.minTranslate())/r,s!==l.progress&&l.updateProgress(t?-l.translate:l.translate),l.emit("setTranslate",l.translate,!1)}function $w(l){const e=this;ku(e,l.target),!(e.params.cssMode||e.params.slidesPerView!=="auto"&&!e.params.autoHeight)&&e.update()}function zw(){const l=this;l.documentTouchHandlerProceeded||(l.documentTouchHandlerProceeded=!0,l.params.touchReleaseOnEdges&&(l.el.style.touchAction="auto"))}const QE=(l,e)=>{const t=lr(),{params:i,el:s,wrapperEl:r,device:o}=l,u=!!i.nested,d=e==="on"?"addEventListener":"removeEventListener",f=e;!s||typeof s=="string"||(t[d]("touchstart",l.onDocumentTouchStart,{passive:!1,capture:u}),s[d]("touchstart",l.onTouchStart,{passive:!1}),s[d]("pointerdown",l.onTouchStart,{passive:!1}),t[d]("touchmove",l.onTouchMove,{passive:!1,capture:u}),t[d]("pointermove",l.onTouchMove,{passive:!1,capture:u}),t[d]("touchend",l.onTouchEnd,{passive:!0}),t[d]("pointerup",l.onTouchEnd,{passive:!0}),t[d]("pointercancel",l.onTouchEnd,{passive:!0}),t[d]("touchcancel",l.onTouchEnd,{passive:!0}),t[d]("pointerout",l.onTouchEnd,{passive:!0}),t[d]("pointerleave",l.onTouchEnd,{passive:!0}),t[d]("contextmenu",l.onTouchEnd,{passive:!0}),(i.preventClicks||i.preventClicksPropagation)&&s[d]("click",l.onClick,!0),i.cssMode&&r[d]("scroll",l.onScroll),i.updateOnWindowResize?l[f](o.ios||o.android?"resize orientationchange observerUpdate":"resize observerUpdate",SS,!0):l[f]("observerUpdate",SS,!0),s[d]("load",l.onLoad,{capture:!0}))};function Hw(){const l=this,{params:e}=l;l.onTouchStart=Nw.bind(l),l.onTouchMove=Bw.bind(l),l.onTouchEnd=Fw.bind(l),l.onDocumentTouchStart=zw.bind(l),e.cssMode&&(l.onScroll=Gw.bind(l)),l.onClick=Uw.bind(l),l.onLoad=$w.bind(l),QE(l,"on")}function Vw(){QE(this,"off")}var Kw={attachEvents:Hw,detachEvents:Vw};const TS=(l,e)=>l.grid&&e.grid&&e.grid.rows>1;function Yw(){const l=this,{realIndex:e,initialized:t,params:i,el:s}=l,r=i.breakpoints;if(!r||r&&Object.keys(r).length===0)return;const o=lr(),u=i.breakpointsBase==="window"||!i.breakpointsBase?i.breakpointsBase:"container",d=["window","container"].includes(i.breakpointsBase)||!i.breakpointsBase?l.el:o.querySelector(i.breakpointsBase),f=l.getBreakpoint(r,u,d);if(!f||l.currentBreakpoint===f)return;const m=(f in r?r[f]:void 0)||l.originalParams,v=TS(l,i),y=TS(l,m),S=l.params.grabCursor,E=m.grabCursor,x=i.enabled;v&&!y?(s.classList.remove(`${i.containerModifierClass}grid`,`${i.containerModifierClass}grid-column`),l.emitContainerClasses()):!v&&y&&(s.classList.add(`${i.containerModifierClass}grid`),(m.grid.fill&&m.grid.fill==="column"||!m.grid.fill&&i.grid.fill==="column")&&s.classList.add(`${i.containerModifierClass}grid-column`),l.emitContainerClasses()),S&&!E?l.unsetGrabCursor():!S&&E&&l.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(N=>{if(typeof m[N]>"u")return;const C=i[N]&&i[N].enabled,M=m[N]&&m[N].enabled;C&&!M&&l[N].disable(),!C&&M&&l[N].enable()});const _=m.direction&&m.direction!==i.direction,R=i.loop&&(m.slidesPerView!==i.slidesPerView||_),A=i.loop;_&&t&&l.changeDirection(),di(l.params,m);const I=l.params.enabled,D=l.params.loop;Object.assign(l,{allowTouchMove:l.params.allowTouchMove,allowSlideNext:l.params.allowSlideNext,allowSlidePrev:l.params.allowSlidePrev}),x&&!I?l.disable():!x&&I&&l.enable(),l.currentBreakpoint=f,l.emit("_beforeBreakpoint",m),t&&(R?(l.loopDestroy(),l.loopCreate(e),l.updateSlides()):!A&&D?(l.loopCreate(e),l.updateSlides()):A&&!D&&l.loopDestroy()),l.emit("breakpoint",m)}function jw(l,e,t){if(e===void 0&&(e="window"),!l||e==="container"&&!t)return;let i=!1;const s=Ht(),r=e==="window"?s.innerHeight:t.clientHeight,o=Object.keys(l).map(u=>{if(typeof u=="string"&&u.indexOf("@")===0){const d=parseFloat(u.substr(1));return{value:r*d,point:u}}return{value:u,point:u}});o.sort((u,d)=>parseInt(u.value,10)-parseInt(d.value,10));for(let u=0;u<o.length;u+=1){const{point:d,value:f}=o[u];e==="window"?s.matchMedia(`(min-width: ${f}px)`).matches&&(i=d):f<=t.clientWidth&&(i=d)}return i||"max"}var qw={setBreakpoint:Yw,getBreakpoint:jw};function Xw(l,e){const t=[];return l.forEach(i=>{typeof i=="object"?Object.keys(i).forEach(s=>{i[s]&&t.push(e+s)}):typeof i=="string"&&t.push(e+i)}),t}function Qw(){const l=this,{classNames:e,params:t,rtl:i,el:s,device:r}=l,o=Xw(["initialized",t.direction,{"free-mode":l.params.freeMode&&t.freeMode.enabled},{autoheight:t.autoHeight},{rtl:i},{grid:t.grid&&t.grid.rows>1},{"grid-column":t.grid&&t.grid.rows>1&&t.grid.fill==="column"},{android:r.android},{ios:r.ios},{"css-mode":t.cssMode},{centered:t.cssMode&&t.centeredSlides},{"watch-progress":t.watchSlidesProgress}],t.containerModifierClass);e.push(...o),s.classList.add(...e),l.emitContainerClasses()}function Ww(){const l=this,{el:e,classNames:t}=l;!e||typeof e=="string"||(e.classList.remove(...t),l.emitContainerClasses())}var Zw={addClasses:Qw,removeClasses:Ww};function Jw(){const l=this,{isLocked:e,params:t}=l,{slidesOffsetBefore:i}=t;if(i){const s=l.slides.length-1,r=l.slidesGrid[s]+l.slidesSizesGrid[s]+i*2;l.isLocked=l.size>r}else l.isLocked=l.snapGrid.length===1;t.allowSlideNext===!0&&(l.allowSlideNext=!l.isLocked),t.allowSlidePrev===!0&&(l.allowSlidePrev=!l.isLocked),e&&e!==l.isLocked&&(l.isEnd=!1),e!==l.isLocked&&l.emit(l.isLocked?"lock":"unlock")}var eC={checkOverflow:Jw},Vh={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function tC(l,e){return function(i){i===void 0&&(i={});const s=Object.keys(i)[0],r=i[s];if(typeof r!="object"||r===null){di(e,i);return}if(l[s]===!0&&(l[s]={enabled:!0}),s==="navigation"&&l[s]&&l[s].enabled&&!l[s].prevEl&&!l[s].nextEl&&(l[s].auto=!0),["pagination","scrollbar"].indexOf(s)>=0&&l[s]&&l[s].enabled&&!l[s].el&&(l[s].auto=!0),!(s in l&&"enabled"in r)){di(e,i);return}typeof l[s]=="object"&&!("enabled"in l[s])&&(l[s].enabled=!0),l[s]||(l[s]={enabled:!1}),di(e,i)}}const ah={eventsEmitter:ZI,update:uw,translate:mw,transition:Sw,slide:Rw,loop:Cw,grabCursor:Pw,events:Kw,breakpoints:qw,checkOverflow:eC,classes:Zw},lh={};let Mg=class ws{constructor(){let e,t;for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];s.length===1&&s[0].constructor&&Object.prototype.toString.call(s[0]).slice(8,-1)==="Object"?t=s[0]:[e,t]=s,t||(t={}),t=di({},t),e&&!t.el&&(t.el=e);const o=lr();if(t.el&&typeof t.el=="string"&&o.querySelectorAll(t.el).length>1){const h=[];return o.querySelectorAll(t.el).forEach(m=>{const v=di({},t,{el:m});h.push(new ws(v))}),h}const u=this;u.__swiper__=!0,u.support=YE(),u.device=jE({userAgent:t.userAgent}),u.browser=qE(),u.eventsListeners={},u.eventsAnyListeners=[],u.modules=[...u.__modules__],t.modules&&Array.isArray(t.modules)&&u.modules.push(...t.modules);const d={};u.modules.forEach(h=>{h({params:t,swiper:u,extendParams:tC(t,d),on:u.on.bind(u),once:u.once.bind(u),off:u.off.bind(u),emit:u.emit.bind(u)})});const f=di({},Vh,d);return u.params=di({},f,lh,t),u.originalParams=di({},u.params),u.passedParams=di({},t),u.params&&u.params.on&&Object.keys(u.params.on).forEach(h=>{u.on(h,u.params.on[h])}),u.params&&u.params.onAny&&u.onAny(u.params.onAny),Object.assign(u,{enabled:u.params.enabled,el:e,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return u.params.direction==="horizontal"},isVertical(){return u.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:u.params.allowSlideNext,allowSlidePrev:u.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:u.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:u.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),u.emit("_swiper"),u.params.init&&u.init(),u}getDirectionLabel(e){return this.isHorizontal()?e:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[e]}getSlideIndex(e){const{slidesEl:t,params:i}=this,s=ks(t,`.${i.slideClass}, swiper-slide`),r=gS(s[0]);return gS(e)-r}getSlideIndexByData(e){return this.getSlideIndex(this.slides.find(t=>t.getAttribute("data-swiper-slide-index")*1===e))}getSlideIndexWhenGrid(e){return this.grid&&this.params.grid&&this.params.grid.rows>1&&(this.params.grid.fill==="column"?e=Math.floor(e/this.params.grid.rows):this.params.grid.fill==="row"&&(e=e%Math.ceil(this.slides.length/this.params.grid.rows))),e}recalcSlides(){const e=this,{slidesEl:t,params:i}=e;e.slides=ks(t,`.${i.slideClass}, swiper-slide`)}enable(){const e=this;e.enabled||(e.enabled=!0,e.params.grabCursor&&e.setGrabCursor(),e.emit("enable"))}disable(){const e=this;e.enabled&&(e.enabled=!1,e.params.grabCursor&&e.unsetGrabCursor(),e.emit("disable"))}setProgress(e,t){const i=this;e=Math.min(Math.max(e,0),1);const s=i.minTranslate(),o=(i.maxTranslate()-s)*e+s;i.translateTo(o,typeof t>"u"?0:t),i.updateActiveIndex(),i.updateSlidesClasses()}emitContainerClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=e.el.className.split(" ").filter(i=>i.indexOf("swiper")===0||i.indexOf(e.params.containerModifierClass)===0);e.emit("_containerClasses",t.join(" "))}getSlideClasses(e){const t=this;return t.destroyed?"":e.className.split(" ").filter(i=>i.indexOf("swiper-slide")===0||i.indexOf(t.params.slideClass)===0).join(" ")}emitSlidesClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=[];e.slides.forEach(i=>{const s=e.getSlideClasses(i);t.push({slideEl:i,classNames:s}),e.emit("_slideClass",i,s)}),e.emit("_slideClasses",t)}slidesPerViewDynamic(e,t){e===void 0&&(e="current"),t===void 0&&(t=!1);const i=this,{params:s,slides:r,slidesGrid:o,slidesSizesGrid:u,size:d,activeIndex:f}=i;let h=1;if(typeof s.slidesPerView=="number")return s.slidesPerView;if(s.centeredSlides){let m=r[f]?Math.ceil(r[f].swiperSlideSize):0,v;for(let y=f+1;y<r.length;y+=1)r[y]&&!v&&(m+=Math.ceil(r[y].swiperSlideSize),h+=1,m>d&&(v=!0));for(let y=f-1;y>=0;y-=1)r[y]&&!v&&(m+=r[y].swiperSlideSize,h+=1,m>d&&(v=!0))}else if(e==="current")for(let m=f+1;m<r.length;m+=1)(t?o[m]+u[m]-o[f]<d:o[m]-o[f]<d)&&(h+=1);else for(let m=f-1;m>=0;m-=1)o[f]-o[m]<d&&(h+=1);return h}update(){const e=this;if(!e||e.destroyed)return;const{snapGrid:t,params:i}=e;i.breakpoints&&e.setBreakpoint(),[...e.el.querySelectorAll('[loading="lazy"]')].forEach(o=>{o.complete&&ku(e,o)}),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses();function s(){const o=e.rtlTranslate?e.translate*-1:e.translate,u=Math.min(Math.max(o,e.maxTranslate()),e.minTranslate());e.setTranslate(u),e.updateActiveIndex(),e.updateSlidesClasses()}let r;if(i.freeMode&&i.freeMode.enabled&&!i.cssMode)s(),i.autoHeight&&e.updateAutoHeight();else{if((i.slidesPerView==="auto"||i.slidesPerView>1)&&e.isEnd&&!i.centeredSlides){const o=e.virtual&&i.virtual.enabled?e.virtual.slides:e.slides;r=e.slideTo(o.length-1,0,!1,!0)}else r=e.slideTo(e.activeIndex,0,!1,!0);r||s()}i.watchOverflow&&t!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,t){t===void 0&&(t=!0);const i=this,s=i.params.direction;return e||(e=s==="horizontal"?"vertical":"horizontal"),e===s||e!=="horizontal"&&e!=="vertical"||(i.el.classList.remove(`${i.params.containerModifierClass}${s}`),i.el.classList.add(`${i.params.containerModifierClass}${e}`),i.emitContainerClasses(),i.params.direction=e,i.slides.forEach(r=>{e==="vertical"?r.style.width="":r.style.height=""}),i.emit("changeDirection"),t&&i.update()),i}changeLanguageDirection(e){const t=this;t.rtl&&e==="rtl"||!t.rtl&&e==="ltr"||(t.rtl=e==="rtl",t.rtlTranslate=t.params.direction==="horizontal"&&t.rtl,t.rtl?(t.el.classList.add(`${t.params.containerModifierClass}rtl`),t.el.dir="rtl"):(t.el.classList.remove(`${t.params.containerModifierClass}rtl`),t.el.dir="ltr"),t.update())}mount(e){const t=this;if(t.mounted)return!0;let i=e||t.params.el;if(typeof i=="string"&&(i=document.querySelector(i)),!i)return!1;i.swiper=t,i.parentNode&&i.parentNode.host&&i.parentNode.host.nodeName===t.params.swiperElementNodeName.toUpperCase()&&(t.isElement=!0);const s=()=>`.${(t.params.wrapperClass||"").trim().split(" ").join(".")}`;let o=i&&i.shadowRoot&&i.shadowRoot.querySelector?i.shadowRoot.querySelector(s()):ks(i,s())[0];return!o&&t.params.createElements&&(o=zh("div",t.params.wrapperClass),i.append(o),ks(i,`.${t.params.slideClass}`).forEach(u=>{o.append(u)})),Object.assign(t,{el:i,wrapperEl:o,slidesEl:t.isElement&&!i.parentNode.host.slideSlots?i.parentNode.host:o,hostEl:t.isElement?i.parentNode.host:i,mounted:!0,rtl:i.dir.toLowerCase()==="rtl"||mn(i,"direction")==="rtl",rtlTranslate:t.params.direction==="horizontal"&&(i.dir.toLowerCase()==="rtl"||mn(i,"direction")==="rtl"),wrongRTL:mn(o,"display")==="-webkit-box"}),!0}init(e){const t=this;if(t.initialized||t.mount(e)===!1)return t;t.emit("beforeInit"),t.params.breakpoints&&t.setBreakpoint(),t.addClasses(),t.updateSize(),t.updateSlides(),t.params.watchOverflow&&t.checkOverflow(),t.params.grabCursor&&t.enabled&&t.setGrabCursor(),t.params.loop&&t.virtual&&t.params.virtual.enabled?t.slideTo(t.params.initialSlide+t.virtual.slidesBefore,0,t.params.runCallbacksOnInit,!1,!0):t.slideTo(t.params.initialSlide,0,t.params.runCallbacksOnInit,!1,!0),t.params.loop&&t.loopCreate(void 0,!0),t.attachEvents();const s=[...t.el.querySelectorAll('[loading="lazy"]')];return t.isElement&&s.push(...t.hostEl.querySelectorAll('[loading="lazy"]')),s.forEach(r=>{r.complete?ku(t,r):r.addEventListener("load",o=>{ku(t,o.target)})}),Hh(t),t.initialized=!0,Hh(t),t.emit("init"),t.emit("afterInit"),t}destroy(e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);const i=this,{params:s,el:r,wrapperEl:o,slides:u}=i;return typeof i.params>"u"||i.destroyed||(i.emit("beforeDestroy"),i.initialized=!1,i.detachEvents(),s.loop&&i.loopDestroy(),t&&(i.removeClasses(),r&&typeof r!="string"&&r.removeAttribute("style"),o&&o.removeAttribute("style"),u&&u.length&&u.forEach(d=>{d.classList.remove(s.slideVisibleClass,s.slideFullyVisibleClass,s.slideActiveClass,s.slideNextClass,s.slidePrevClass),d.removeAttribute("style"),d.removeAttribute("data-swiper-slide-index")})),i.emit("destroy"),Object.keys(i.eventsListeners).forEach(d=>{i.off(d)}),e!==!1&&(i.el&&typeof i.el!="string"&&(i.el.swiper=null),FI(i)),i.destroyed=!0),null}static extendDefaults(e){di(lh,e)}static get extendedDefaults(){return lh}static get defaults(){return Vh}static installModule(e){ws.prototype.__modules__||(ws.prototype.__modules__=[]);const t=ws.prototype.__modules__;typeof e=="function"&&t.indexOf(e)<0&&t.push(e)}static use(e){return Array.isArray(e)?(e.forEach(t=>ws.installModule(t)),ws):(ws.installModule(e),ws)}};Object.keys(ah).forEach(l=>{Object.keys(ah[l]).forEach(e=>{Mg.prototype[e]=ah[l][e]})});Mg.use([QI,WI]);const WE=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","swiperElementNodeName","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function rr(l){return typeof l=="object"&&l!==null&&l.constructor&&Object.prototype.toString.call(l).slice(8,-1)==="Object"&&!l.__swiper__}function ua(l,e){const t=["__proto__","constructor","prototype"];Object.keys(e).filter(i=>t.indexOf(i)<0).forEach(i=>{typeof l[i]>"u"?l[i]=e[i]:rr(e[i])&&rr(l[i])&&Object.keys(e[i]).length>0?e[i].__swiper__?l[i]=e[i]:ua(l[i],e[i]):l[i]=e[i]})}function ZE(l){return l===void 0&&(l={}),l.navigation&&typeof l.navigation.nextEl>"u"&&typeof l.navigation.prevEl>"u"}function JE(l){return l===void 0&&(l={}),l.pagination&&typeof l.pagination.el>"u"}function ex(l){return l===void 0&&(l={}),l.scrollbar&&typeof l.scrollbar.el>"u"}function tx(l){l===void 0&&(l="");const e=l.split(" ").map(i=>i.trim()).filter(i=>!!i),t=[];return e.forEach(i=>{t.indexOf(i)<0&&t.push(i)}),t.join(" ")}function iC(l){return l===void 0&&(l=""),l?l.includes("swiper-wrapper")?l:`swiper-wrapper ${l}`:"swiper-wrapper"}function sC(l){let{swiper:e,slides:t,passedParams:i,changedParams:s,nextEl:r,prevEl:o,scrollbarEl:u,paginationEl:d}=l;const f=s.filter(O=>O!=="children"&&O!=="direction"&&O!=="wrapperClass"),{params:h,pagination:m,navigation:v,scrollbar:y,virtual:S,thumbs:E}=e;let x,_,R,A,I,D,N,C;s.includes("thumbs")&&i.thumbs&&i.thumbs.swiper&&!i.thumbs.swiper.destroyed&&h.thumbs&&(!h.thumbs.swiper||h.thumbs.swiper.destroyed)&&(x=!0),s.includes("controller")&&i.controller&&i.controller.control&&h.controller&&!h.controller.control&&(_=!0),s.includes("pagination")&&i.pagination&&(i.pagination.el||d)&&(h.pagination||h.pagination===!1)&&m&&!m.el&&(R=!0),s.includes("scrollbar")&&i.scrollbar&&(i.scrollbar.el||u)&&(h.scrollbar||h.scrollbar===!1)&&y&&!y.el&&(A=!0),s.includes("navigation")&&i.navigation&&(i.navigation.prevEl||o)&&(i.navigation.nextEl||r)&&(h.navigation||h.navigation===!1)&&v&&!v.prevEl&&!v.nextEl&&(I=!0);const M=O=>{e[O]&&(e[O].destroy(),O==="navigation"?(e.isElement&&(e[O].prevEl.remove(),e[O].nextEl.remove()),h[O].prevEl=void 0,h[O].nextEl=void 0,e[O].prevEl=void 0,e[O].nextEl=void 0):(e.isElement&&e[O].el.remove(),h[O].el=void 0,e[O].el=void 0))};s.includes("loop")&&e.isElement&&(h.loop&&!i.loop?D=!0:!h.loop&&i.loop?N=!0:C=!0),f.forEach(O=>{if(rr(h[O])&&rr(i[O]))Object.assign(h[O],i[O]),(O==="navigation"||O==="pagination"||O==="scrollbar")&&"enabled"in i[O]&&!i[O].enabled&&M(O);else{const P=i[O];(P===!0||P===!1)&&(O==="navigation"||O==="pagination"||O==="scrollbar")?P===!1&&M(O):h[O]=i[O]}}),f.includes("controller")&&!_&&e.controller&&e.controller.control&&h.controller&&h.controller.control&&(e.controller.control=h.controller.control),s.includes("children")&&t&&S&&h.virtual.enabled?(S.slides=t,S.update(!0)):s.includes("virtual")&&S&&h.virtual.enabled&&(t&&(S.slides=t),S.update(!0)),s.includes("children")&&t&&h.loop&&(C=!0),x&&E.init()&&E.update(!0),_&&(e.controller.control=h.controller.control),R&&(e.isElement&&(!d||typeof d=="string")&&(d=document.createElement("div"),d.classList.add("swiper-pagination"),d.part.add("pagination"),e.el.appendChild(d)),d&&(h.pagination.el=d),m.init(),m.render(),m.update()),A&&(e.isElement&&(!u||typeof u=="string")&&(u=document.createElement("div"),u.classList.add("swiper-scrollbar"),u.part.add("scrollbar"),e.el.appendChild(u)),u&&(h.scrollbar.el=u),y.init(),y.updateSize(),y.setTranslate()),I&&(e.isElement&&((!r||typeof r=="string")&&(r=document.createElement("div"),r.classList.add("swiper-button-next"),pS(r,e.hostEl.constructor.nextButtonSvg),r.part.add("button-next"),e.el.appendChild(r)),(!o||typeof o=="string")&&(o=document.createElement("div"),o.classList.add("swiper-button-prev"),pS(o,e.hostEl.constructor.prevButtonSvg),o.part.add("button-prev"),e.el.appendChild(o))),r&&(h.navigation.nextEl=r),o&&(h.navigation.prevEl=o),v.init(),v.update()),s.includes("allowSlideNext")&&(e.allowSlideNext=i.allowSlideNext),s.includes("allowSlidePrev")&&(e.allowSlidePrev=i.allowSlidePrev),s.includes("direction")&&e.changeDirection(i.direction,!1),(D||C)&&e.loopDestroy(),(N||C)&&e.loopCreate(),e.update()}function nC(l,e){l===void 0&&(l={}),e===void 0&&(e=!0);const t={on:{}},i={},s={};ua(t,Vh),t._emitClasses=!0,t.init=!1;const r={},o=WE.map(d=>d.replace(/_/,"")),u=Object.assign({},l);return Object.keys(u).forEach(d=>{typeof l[d]>"u"||(o.indexOf(d)>=0?rr(l[d])?(t[d]={},s[d]={},ua(t[d],l[d]),ua(s[d],l[d])):(t[d]=l[d],s[d]=l[d]):d.search(/on[A-Z]/)===0&&typeof l[d]=="function"?e?i[`${d[2].toLowerCase()}${d.substr(3)}`]=l[d]:t.on[`${d[2].toLowerCase()}${d.substr(3)}`]=l[d]:r[d]=l[d])}),["navigation","pagination","scrollbar"].forEach(d=>{t[d]===!0&&(t[d]={}),t[d]===!1&&delete t[d]}),{params:t,passedParams:s,rest:r,events:i}}function rC(l,e){let{el:t,nextEl:i,prevEl:s,paginationEl:r,scrollbarEl:o,swiper:u}=l;ZE(e)&&i&&s&&(u.params.navigation.nextEl=i,u.originalParams.navigation.nextEl=i,u.params.navigation.prevEl=s,u.originalParams.navigation.prevEl=s),JE(e)&&r&&(u.params.pagination.el=r,u.originalParams.pagination.el=r),ex(e)&&o&&(u.params.scrollbar.el=o,u.originalParams.scrollbar.el=o),u.init(t)}function aC(l,e,t,i,s){const r=[];if(!e)return r;const o=d=>{r.indexOf(d)<0&&r.push(d)};if(t&&i){const d=i.map(s),f=t.map(s);d.join("")!==f.join("")&&o("children"),i.length!==t.length&&o("children")}return WE.filter(d=>d[0]==="_").map(d=>d.replace(/_/,"")).forEach(d=>{if(d in l&&d in e)if(rr(l[d])&&rr(e[d])){const f=Object.keys(l[d]),h=Object.keys(e[d]);f.length!==h.length?o(d):(f.forEach(m=>{l[d][m]!==e[d][m]&&o(d)}),h.forEach(m=>{l[d][m]!==e[d][m]&&o(d)}))}else l[d]!==e[d]&&o(d)}),r}const lC=l=>{!l||l.destroyed||!l.params.virtual||l.params.virtual&&!l.params.virtual.enabled||(l.updateSlides(),l.updateProgress(),l.updateSlidesClasses(),l.emit("_virtualUpdated"),l.parallax&&l.params.parallax&&l.params.parallax.enabled&&l.parallax.setTranslate())};function ec(){return ec=Object.assign?Object.assign.bind():function(l){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(l[i]=t[i])}return l},ec.apply(this,arguments)}function ix(l){return l.type&&l.type.displayName&&l.type.displayName.includes("SwiperSlide")}function sx(l){const e=[];return St.Children.toArray(l).forEach(t=>{ix(t)?e.push(t):t.props&&t.props.children&&sx(t.props.children).forEach(i=>e.push(i))}),e}function oC(l){const e=[],t={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]};return St.Children.toArray(l).forEach(i=>{if(ix(i))e.push(i);else if(i.props&&i.props.slot&&t[i.props.slot])t[i.props.slot].push(i);else if(i.props&&i.props.children){const s=sx(i.props.children);s.length>0?s.forEach(r=>e.push(r)):t["container-end"].push(i)}else t["container-end"].push(i)}),{slides:e,slots:t}}function uC(l,e,t){if(!t)return null;const i=h=>{let m=h;return h<0?m=e.length+h:m>=e.length&&(m=m-e.length),m},s=l.isHorizontal()?{[l.rtlTranslate?"right":"left"]:`${t.offset}px`}:{top:`${t.offset}px`},{from:r,to:o}=t,u=l.params.loop?-e.length:0,d=l.params.loop?e.length*2:e.length,f=[];for(let h=u;h<d;h+=1)h>=r&&h<=o&&f.push(e[i(h)]);return f.map((h,m)=>St.cloneElement(h,{swiper:l,style:s,key:h.props.virtualIndex||h.key||`slide-${m}`}))}function wl(l,e){return typeof window>"u"?he.useEffect(l,e):he.useLayoutEffect(l,e)}const ES=he.createContext(null),cC=he.createContext(null),nx=he.forwardRef(function(l,e){let{className:t,tag:i="div",wrapperTag:s="div",children:r,onSwiper:o,...u}=l===void 0?{}:l,d=!1;const[f,h]=he.useState("swiper"),[m,v]=he.useState(null),[y,S]=he.useState(!1),E=he.useRef(!1),x=he.useRef(null),_=he.useRef(null),R=he.useRef(null),A=he.useRef(null),I=he.useRef(null),D=he.useRef(null),N=he.useRef(null),C=he.useRef(null),{params:M,passedParams:O,rest:P,events:U}=nC(u),{slides:H,slots:se}=oC(r),ue=()=>{S(!y)};Object.assign(M.on,{_containerClasses(oe,k){h(k)}});const te=()=>{Object.assign(M.on,U),d=!0;const oe={...M};if(delete oe.wrapperClass,_.current=new Mg(oe),_.current.virtual&&_.current.params.virtual.enabled){_.current.virtual.slides=H;const k={cache:!1,slides:H,renderExternal:v,renderExternalUpdate:!1};ua(_.current.params.virtual,k),ua(_.current.originalParams.virtual,k)}};x.current||te(),_.current&&_.current.on("_beforeBreakpoint",ue);const B=()=>{d||!U||!_.current||Object.keys(U).forEach(oe=>{_.current.on(oe,U[oe])})},K=()=>{!U||!_.current||Object.keys(U).forEach(oe=>{_.current.off(oe,U[oe])})};he.useEffect(()=>()=>{_.current&&_.current.off("_beforeBreakpoint",ue)}),he.useEffect(()=>{!E.current&&_.current&&(_.current.emitSlidesClasses(),E.current=!0)}),wl(()=>{if(e&&(e.current=x.current),!!x.current)return _.current.destroyed&&te(),rC({el:x.current,nextEl:I.current,prevEl:D.current,paginationEl:N.current,scrollbarEl:C.current,swiper:_.current},M),o&&!_.current.destroyed&&o(_.current),()=>{_.current&&!_.current.destroyed&&_.current.destroy(!0,!1)}},[]),wl(()=>{B();const oe=aC(O,R.current,H,A.current,k=>k.key);return R.current=O,A.current=H,oe.length&&_.current&&!_.current.destroyed&&sC({swiper:_.current,slides:H,passedParams:O,changedParams:oe,nextEl:I.current,prevEl:D.current,scrollbarEl:C.current,paginationEl:N.current}),()=>{K()}}),wl(()=>{lC(_.current)},[m]);function j(){return M.virtual?uC(_.current,H,m):H.map((oe,k)=>St.cloneElement(oe,{swiper:_.current,swiperSlideIndex:k}))}return St.createElement(i,ec({ref:x,className:tx(`${f}${t?` ${t}`:""}`)},P),St.createElement(cC.Provider,{value:_.current},se["container-start"],St.createElement(s,{className:iC(M.wrapperClass)},se["wrapper-start"],j(),se["wrapper-end"]),ZE(M)&&St.createElement(St.Fragment,null,St.createElement("div",{ref:D,className:"swiper-button-prev"}),St.createElement("div",{ref:I,className:"swiper-button-next"})),ex(M)&&St.createElement("div",{ref:C,className:"swiper-scrollbar"}),JE(M)&&St.createElement("div",{ref:N,className:"swiper-pagination"}),se["container-end"]))});nx.displayName="Swiper";const rx=he.forwardRef(function(l,e){let{tag:t="div",children:i,className:s="",swiper:r,zoom:o,lazy:u,virtualIndex:d,swiperSlideIndex:f,...h}=l===void 0?{}:l;const m=he.useRef(null),[v,y]=he.useState("swiper-slide"),[S,E]=he.useState(!1);function x(I,D,N){D===m.current&&y(N)}wl(()=>{if(typeof f<"u"&&(m.current.swiperSlideIndex=f),e&&(e.current=m.current),!(!m.current||!r)){if(r.destroyed){v!=="swiper-slide"&&y("swiper-slide");return}return r.on("_slideClass",x),()=>{r&&r.off("_slideClass",x)}}}),wl(()=>{r&&m.current&&!r.destroyed&&y(r.getSlideClasses(m.current))},[r]);const _={isActive:v.indexOf("swiper-slide-active")>=0,isVisible:v.indexOf("swiper-slide-visible")>=0,isPrev:v.indexOf("swiper-slide-prev")>=0,isNext:v.indexOf("swiper-slide-next")>=0},R=()=>typeof i=="function"?i(_):i,A=()=>{E(!0)};return St.createElement(t,ec({ref:m,className:tx(`${v}${s?` ${s}`:""}`),"data-swiper-slide-index":d,onLoad:A},h),o&&St.createElement(ES.Provider,{value:_},St.createElement("div",{className:"swiper-zoom-container","data-swiper-zoom":typeof o=="number"?o:void 0},R(),u&&!S&&St.createElement("div",{className:"swiper-lazy-preloader"}))),!o&&St.createElement(ES.Provider,{value:_},R(),u&&!S&&St.createElement("div",{className:"swiper-lazy-preloader"})))});rx.displayName="SwiperSlide";function fC(l){let{swiper:e,extendParams:t,emit:i,once:s}=l;t({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function r(){if(e.params.cssMode)return;const d=e.getTranslate();e.setTranslate(d),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function o(){if(e.params.cssMode)return;const{touchEventsData:d,touches:f}=e;d.velocities.length===0&&d.velocities.push({position:f[e.isHorizontal()?"startX":"startY"],time:d.touchStartTime}),d.velocities.push({position:f[e.isHorizontal()?"currentX":"currentY"],time:ir()})}function u(d){let{currentPos:f}=d;if(e.params.cssMode)return;const{params:h,wrapperEl:m,rtlTranslate:v,snapGrid:y,touchEventsData:S}=e,x=ir()-S.touchStartTime;if(f<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(f>-e.maxTranslate()){e.slides.length<y.length?e.slideTo(y.length-1):e.slideTo(e.slides.length-1);return}if(h.freeMode.momentum){if(S.velocities.length>1){const M=S.velocities.pop(),O=S.velocities.pop(),P=M.position-O.position,U=M.time-O.time;e.velocity=P/U,e.velocity/=2,Math.abs(e.velocity)<h.freeMode.minimumVelocity&&(e.velocity=0),(U>150||ir()-M.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=h.freeMode.momentumVelocityRatio,S.velocities.length=0;let _=1e3*h.freeMode.momentumRatio;const R=e.velocity*_;let A=e.translate+R;v&&(A=-A);let I=!1,D;const N=Math.abs(e.velocity)*20*h.freeMode.momentumBounceRatio;let C;if(A<e.maxTranslate())h.freeMode.momentumBounce?(A+e.maxTranslate()<-N&&(A=e.maxTranslate()-N),D=e.maxTranslate(),I=!0,S.allowMomentumBounce=!0):A=e.maxTranslate(),h.loop&&h.centeredSlides&&(C=!0);else if(A>e.minTranslate())h.freeMode.momentumBounce?(A-e.minTranslate()>N&&(A=e.minTranslate()+N),D=e.minTranslate(),I=!0,S.allowMomentumBounce=!0):A=e.minTranslate(),h.loop&&h.centeredSlides&&(C=!0);else if(h.freeMode.sticky){let M;for(let O=0;O<y.length;O+=1)if(y[O]>-A){M=O;break}Math.abs(y[M]-A)<Math.abs(y[M-1]-A)||e.swipeDirection==="next"?A=y[M]:A=y[M-1],A=-A}if(C&&s("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(v?_=Math.abs((-A-e.translate)/e.velocity):_=Math.abs((A-e.translate)/e.velocity),h.freeMode.sticky){const M=Math.abs((v?-A:A)-e.translate),O=e.slidesSizesGrid[e.activeIndex];M<O?_=h.speed:M<2*O?_=h.speed*1.5:_=h.speed*2.5}}else if(h.freeMode.sticky){e.slideToClosest();return}h.freeMode.momentumBounce&&I?(e.updateProgress(D),e.setTransition(_),e.setTranslate(A),e.transitionStart(!0,e.swipeDirection),e.animating=!0,eh(m,()=>{!e||e.destroyed||!S.allowMomentumBounce||(i("momentumBounce"),e.setTransition(h.speed),setTimeout(()=>{e.setTranslate(D),eh(m,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(i("_freeModeNoMomentumRelease"),e.updateProgress(A),e.setTransition(_),e.setTranslate(A),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,eh(m,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(A),e.updateActiveIndex(),e.updateSlidesClasses()}else if(h.freeMode.sticky){e.slideToClosest();return}else h.freeMode&&i("_freeModeNoMomentumRelease");(!h.freeMode.momentum||x>=h.longSwipesMs)&&(i("_freeModeStaticRelease"),e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:r,onTouchMove:o,onTouchEnd:u}})}function dC({isActive:l}){const e=he.useRef(null),t=he.useRef([]),i=(r,o)=>{r&&(t.current[o]=r)};he.useEffect(()=>{const r=e.current;r&&(l?(Pi.set(r,{display:"block",pointerEvents:"auto"}),Pi.to(r,{opacity:1,duration:.2}),Pi.fromTo(t.current,{y:30,opacity:0},{y:0,opacity:1,duration:.3,stagger:.1,ease:"expo"})):Pi.to(r,{opacity:0,duration:.3,onComplete:()=>{Pi.set(r,{display:"none",pointerEvents:"none"})}}))},[l]);const s=[{text:"Facebook",url:"https://facebook.com"},{text:"X",url:"https://x.com"},{text:"Linkedin",url:"https://linkedin.com"},{text:"URL",url:"#"}];return J.jsx("div",{ref:e,className:"fixed top-0 right-0 w-full h-full z-40  ",children:J.jsx("div",{className:"Share__background__3rglzHoI w-full h-full text-white flex justify-end pt-18 pr-5",children:J.jsx("ul",{className:"flex flex-col gap-3",children:s.map(({text:r,url:o},u)=>J.jsx("li",{ref:d=>i(d,u),className:"text-right text-xs font-normal uppercase SansRegular",children:J.jsx("a",{href:o,target:"_blank",rel:"noopener noreferrer",children:r})},r))})})})}const xS=({src:l,isActiveVideo:e,setActiveVideoSrc:t})=>{const i=he.useRef(null),s=he.useRef(null),[r,o]=he.useState(!1),[u,d]=he.useState(0),[f,h]=he.useState(0),[m,v]=he.useState(!1),[y,S]=he.useState(0),[E,x]=he.useState(0),[_,R]=he.useState(!1),[A,I]=he.useState(!1),[D,N]=he.useState(!1),[C,M]=he.useState(!1),O=he.useRef(r),P=he.useRef(f),U=he.useRef(_),H=he.useRef(null);he.useEffect(()=>{O.current=r},[r]),he.useEffect(()=>{P.current=f},[f]),he.useEffect(()=>{U.current=_},[_]);const se=re=>{const ce=Math.floor(re/60),ve=Math.floor(re%60);return`${ce.toString().padStart(2,"0")}:${ve.toString().padStart(2,"0")}`},ue=he.useCallback(re=>{const ce=i.current;ce&&(H.current&&cancelAnimationFrame(H.current),H.current=requestAnimationFrame(()=>{ce.currentTime=re,d(re)}))},[]),te=he.useCallback(re=>{if(U.current&&s.current){const ce=s.current.getBoundingClientRect(),ve=Math.max(0,Math.min(1,(re.clientX-ce.left)/ce.width)),_e=ve*P.current;S(_e),x(ve*100),ue(_e)}},[ue]),B=he.useCallback(()=>{if(U.current){R(!1);const re=i.current;re&&A&&setTimeout(()=>{re.play().catch(()=>console.warn("Play blocked by browser"))},50)}},[A]);he.useEffect(()=>{const re=i.current;let ce=null;if(re){mi.isSupported()?(ce=new mi,ce.loadSource(l),ce.attachMedia(re),ce.on(mi.Events.MANIFEST_PARSED,()=>{ce.currentLevel=ce.levels.length-1})):re.canPlayType("application/vnd.apple.mpegurl")&&(re.src=l),re.addEventListener("loadedmetadata",()=>{h(re.duration)});const ve=()=>{U.current||requestAnimationFrame(()=>{d(re.currentTime)})};return re.addEventListener("timeupdate",ve),re.addEventListener("ended",()=>{o(!1),d(0),re.currentTime=0,t(null)}),()=>{re.removeEventListener("timeupdate",ve),H.current&&cancelAnimationFrame(H.current),ce&&ce.destroy()}}},[l,t]),he.useEffect(()=>{const re=i.current;re&&(e&&r?re.play().catch(()=>console.warn("Play blocked by browser")):(re.pause(),o(!1)))},[e,r]);const K=()=>{const re=i.current;re&&(r?(re.pause(),o(!1),t(null)):(t(l),o(!0)))},j=()=>{const re=i.current?.parentElement;m?document.exitFullscreen&&(document.exitFullscreen(),v(!1)):re?.requestFullscreen&&(re.requestFullscreen(),v(!0))};he.useEffect(()=>{const re=()=>{v(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",re),()=>{document.removeEventListener("fullscreenchange",re)}},[]);const oe=re=>{if(!_&&s.current){const ce=i.current;if(ce){const ve=s.current.getBoundingClientRect(),$e=Math.max(0,Math.min(1,(re.clientX-ve.left)/ve.width))*f;ce.currentTime=$e,d($e)}}},k=re=>{re.preventDefault(),re.stopPropagation();const ce=i.current,ve=O.current;I(ve),R(!0),ce&&ve&&ce.pause();const _e=re.currentTarget;_e.style.transform="scale(1.1)",_e.style.transition="transform 0.1s ease"},$=re=>{if(s.current&&!_){const ce=s.current.getBoundingClientRect(),ve=Math.max(0,Math.min(1,(re.clientX-ce.left)/ce.width));requestAnimationFrame(()=>{S(ve*f),x(ve*100)})}},q=()=>{N(!0)},ne=()=>{_||N(!1)};he.useEffect(()=>(_?(document.addEventListener("mousemove",te,{passive:!0}),document.addEventListener("mouseup",B),_||document.querySelectorAll(".progress-button").forEach(ve=>{ve.style.transform="",ve.style.transition=""})):(document.removeEventListener("mousemove",te),document.removeEventListener("mouseup",B),N(!1)),()=>{document.removeEventListener("mousemove",te),document.removeEventListener("mouseup",B)}),[_,te,B]);const fe=()=>{M(!0),t(l),o(!0),j()};return J.jsxs("div",{className:"relative w-full h-full flex items-center justify-center bg-black",children:[J.jsx("video",{ref:i,muted:!1,onClick:K,className:"w-full h-full object-contain"}),!C&&J.jsxs(J.Fragment,{children:[J.jsx("div",{className:"w-full h-screen absolute top-0 left-0 z-40"}),J.jsx("button",{onClick:fe,className:"cursor-pointer button w-25 h-25 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 flex items-center justify-center",children:J.jsx("img",{src:"/images/play.png",alt:"Play"})})]}),m&&J.jsx("button",{className:"cursor-pointer w-11 h-11 absolute top-5 left-5 z-50 flex items-center justify-center bg-black/50 rounded-full border border-white ",onClick:j,"aria-label":"Exit fullscreen",children:J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 12 12",x:"0px",y:"0px",width:12,hanging:12,xmlSpace:"preserve",children:J.jsx("path",{fill:"#ffffff",d:"M4.67417479 6L.34314575 1.05025253c-.19516147-.19516147-.19516147-.5119453 0-.70710678.19516147-.19516147.51194531-.19516147.70710678 0L6 4.6741748 10.94974747.34314575c.19516147-.19516147.5119453-.19516147.70710678 0 .19516147.19516147.19516147.51194531 0 .70710678L7.3258252 6l4.33102904 4.94974747c.19516147.19516147.19516147.5119453 0 .70710678-.19516147.19516147-.51194531.19516147-.70710678 0L6 7.3258252l-4.94974747 4.33102904c-.19516147.19516147-.5119453.19516147-.70710678 0-.19516147-.19516147-.19516147-.51194531 0-.70710678L4.6741748 6z"})})}),C&&J.jsxs(J.Fragment,{children:[J.jsx("button",{className:"cursor-pointer flex items-center justify-center absolute bottom-20 rounded-full left-2 md:left-5 z-20 w-14 h-14 border-2 border-[#969696]",onClick:K,"aria-label":r?"Pause video":"Play video",children:r?J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"white",viewBox:"0 0 8 11",children:J.jsx("path",{d:"M5.2 0v11H8V0H5.2zM0 11h2.8V0H0v11z"})}):J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"white",viewBox:"0 0 12.8 15",children:J.jsx("path",{d:"M.2 14V1C.2.4.8-.1 1.4.3c.5.3 9.9 6 10.8 6.5.6.3.5 1.1 0 1.4-.6.4-10.1 6.1-10.8 6.5-.5.3-1.2 0-1.2-.7z"})})}),J.jsxs("div",{className:"absolute bottom-20 right-2 md:right-5 z-20 flex items-end gap-2 md:gap-4 text-white",children:[J.jsx("p",{className:"md:text-3xl text-2xl font-normal leading-8 SansRegular",children:se(u)}),J.jsx("p",{className:"md:text-3xl text-2xl font-normal leading-8 SansRegular",children:se(f)}),J.jsx("button",{className:"cursor-pointer w-10 h-10 border-2 border-[#969696] rounded-full flex items-center justify-center mb-2",onClick:j,"aria-label":m?"Exit fullscreen":"Enter fullscreen",children:m?J.jsx("svg",{width:13,height:12,fill:"white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 17",children:J.jsx("path",{d:"M8.3 9.3V17l-3.1-2.9-3 2.9L0 14.9 3 12 .3 9.3h8zM18 2.1l-3.6 3.4L17.1 8h-8V.4l3.1 3L15.8 0 18 2.1z"})}):J.jsx("svg",{width:13,height:12,fill:"white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 19.1 18",children:J.jsx("path",{d:"M18.9.2v8.6l-3.3-3.3-3.3 3.3-2.4-2.4 3.3-3.3-3-3 8.7.1zm-9 11l-4 3.8 2.9 2.8H.1V9.2l3.4 3.4 3.9-3.9 2.5 2.5z"})})})]}),J.jsx("div",{className:"cursor-pointer absolute bottom-5 left-0 w-full h-7.5 px-2 md:px-5",ref:s,onMouseMove:$,onMouseEnter:q,onMouseLeave:ne,children:J.jsxs("div",{className:"relative h-full",onClick:oe,children:[J.jsx("div",{className:"w-full h-0.5 bg-white/30 absolute top-[50%] left-0 -translate-y-[-50%]"}),J.jsx("div",{className:`h-0.5 bg-[#eb2323] absolute top-[50%] left-0 -translate-y-[-50%] transition-all duration-75 ${_?"h-1":""}`,style:{width:`${u/f*100}%`}}),J.jsx("div",{className:`absolute  -top-5  text-white text-[10px] px-3 py-1.5 rounded-md transition-all duration-150 ${_?"scale-105":""} ${(D||_)&&f?"opacity-100":"opacity-0 pointer-events-none"}`,style:{left:`${E}%`,transform:"translateX(-50%)"},children:se(y)}),J.jsx("button",{className:`absolute top-[50%] -translate-y-[50%] w-5 h-5 rounded-[9px] bg-white flex items-center justify-center cursor-pointer progress-button transition-all duration-150 ${_?"scale-110 shadow-lg":"hover:scale-105"}`,style:{left:`${u/f*100}%`,filter:_?"drop-shadow(0 4px 8px rgba(0,0,0,0.3))":""},onMouseDown:k,children:J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:10,height:10,viewBox:"0 0 34 24",children:J.jsx("path",{d:"M32.9015186 14.3204391L22 24l6-12-6-12 10.9015186 9.6795609C33.5721317 10.2297651 34 11.0649526 34 12c0 .9350474-.4278683 1.7702349-1.0984814 2.3204391zM1.0984814 14.3204391L12 24 6 12l6-12L1.0984814 9.6795609C.4278683 10.2297651 0 11.0649526 0 12c0 .9350474.4278683 1.7702349 1.0984814 2.3204391z"})})})]})})]}),J.jsx("style",{children:`
                    @keyframes scale-in {
                        0% { transform: scale(0.8); opacity: 0; }
                        50% { transform: scale(1.1); opacity: 0.7; }
                        100% { transform: scale(1); opacity: 0.7; }
                    }
                    .fullscreen video {
                        object-fit: contain !important;
                        max-width: 100vw;
                        max-height: 100vh;
                        width: 100%;
                        height: 100%;
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%);
                    }
                    .fullscreen {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        width: 100vw;
                        height: 100vh;
                        background: black;
                    }
                `})]})},_S=[{index:1,category:"Powertrain",title:"The first hybrid",description:"The SF90 Stradale has a 90 V8 turbo engine capable of delivering 780 cv, the highest power output of any 8-cylinder in Ferrari history. The remaining 220 cv is delivered by three electric motors, one located between the engine and the new 8-speed dual-clutch transmission on the rear axle, and two on the front axle. This sophisticated system does not, however, make for a more complicated driving experience. Quite the opposite, in fact: the driver simply has to select one of the four power unit modes, and then just concentrate on driving. The sophisticated control logic takes care of the rest, managing the flow of power between the V8, the electric motors and the batteries.",videoSrc:"/video/rul.m3u8"},{index:null,category:null,title:"EDRIVE",description:"The SF90 Stradale is equipped with three electric motors capable of generating a total of 220 cv (162 kW). A high performance Li-ion battery provides power to all three motors and guarantees a 25-kilometre range in all-electric eDrive mode, using just the front axle. When the internal combustion engine is turned off, the two independent front motors deliver a maximum speed of 135 km/h with longitudinal acceleration of 0.4 g. Reverse can only be used in eDrive mode which means the car can be manoeuvred at low speeds without using the V8. This mode is ideal for city centre driving or any other situation in which the driver wishes to eliminate the sound of the Ferrari V8.",videoSrc:"/video/bottomExo.m3u8"},{index:null,category:null,title:"HYBRID",description:"This is the default setting when the car is turned on, in which the power flows are managed to optimise the overall efficiency of the system. The control logic autonomously decides whether to keep the internal combustion engine running or turn it off. If it is on, the internal combustion engine can run at maximum power thus guaranteeing powerful performance whenever the driver requires.",videoSrc:"/video/bgFerari.m3u8"},{index:null,category:null,title:"PERFORMANCE",description:'Unlike "Hybrid", this mode keeps the ICE running because the priority is more on charging the battery than on efficiency. This guarantees that power is instantly and fully available when required. This mode is best suited to situations in which driving pleasure and fun behind the wheel are the main focus.',videoSrc:"/video/quality.m3u8"},{index:null,category:null,title:"QUALIFY",description:"The internal combustion engine and electric motors work in synergy to generate an incredible 1,000 cv, which puts the SF90 Stradale at the very top of the range in performance terms. This mode allows the system to achieve maximum power output by allowing the electric motors to work at their maximum potential (162kW). The control logic prioritises performance over battery charging.",videoSrc:null}];function hC({isActive:l,setIsActive:e}){const t=he.useRef(null),i=he.useRef(null),[s,r]=he.useState(!1),[o,u]=he.useState(!0),[d,f]=he.useState(!1),[h,m]=he.useState(null);he.useEffect(()=>{const S=_=>{if(!l||!t.current||!i.current)return;_.preventDefault();const A=_.deltaY*1.2;if(t.current){const I=t.current.translate;t.current.translateTo(I-A,100)}},E=window.matchMedia("(min-width: 60.0625em)").matches,x=i.current;return E&&x&&l&&x.addEventListener("wheel",S,{passive:!1}),()=>{E&&x&&x.removeEventListener("wheel",S)}},[l]);const v=()=>{t.current&&t.current.slideNext(700)},y=()=>{t.current&&t.current.slidePrev(700)};return J.jsx("div",{ref:i,className:`absolute min-[60.0625em]:top-0 ${l?" min-[60.0625em]:right-0 bottom-0":"-bottom-full min-[60.0625em]:-right-full"} z-30 min-h-screen w-full bg-white transition-all duration-300 overflow-y-auto`,children:l&&J.jsxs("div",{className:"h-screen max-[60.0625em]:pt-14 relative bg-white w-auto",children:[J.jsx("button",{className:"w-[42px] h-[42px] min-[60.0625em]:absolute fixed min-[60.0625em]:top-[50%] top-5 min-[60.0625em]:translate-y-[-50%] left-5 group z-30","aria-label":"close discover more",onClick:()=>e(!1),children:J.jsxs("span",{className:"border border-[rgb(212,210,210)] cursor-pointer bg-[#969696] rounded-full text-white relative w-[42px] h-[42px] flex items-center justify-center overflow-hidden",children:[J.jsx("svg",{width:42,height:42,viewBox:"0 0 24 24",className:"absolute top-[-1px] left-[-1px] rotate-[-90deg] pointer-events-none",children:J.jsx("circle",{cx:12,cy:12,r:11,stroke:"#da291c",strokeWidth:1.5,fill:"none",className:"stroke-circle"})}),J.jsx("svg",{viewBox:"0 0 12 12",className:"z-10",style:{height:12,width:12},fill:"white",children:J.jsx("path",{d:"M4.674 6L.344 1.05A.5.5 0 0 1 1.05.343L6 4.674l4.95-4.33a.5.5 0 0 1 .707.706L7.326 6l4.33 4.95a.5.5 0 0 1-.706.707L6 7.326l-4.95 4.33a.5.5 0 0 1-.707-.706L4.674 6z"})})]})}),J.jsx("button",{onClick:()=>e(!1),className:"cursor-pointer text-left text-xs font-normal uppercase SansRegular text-[#969696] min-[60.0625em]:hidden fixed top-8 left-18 max-md:hidden",children:"Close"}),J.jsxs("button",{onClick:()=>f(!d),className:"cursor-pointer flex items-center justify-between max-w-26 w-full fixed top-5 right-5 z-50",children:[J.jsx("p",{className:"text-left text-xs font-normal uppercase SansRegular",children:"Share"}),J.jsx("div",{className:"w-[38px] h-[38px] group z-50","aria-label":"toggle menu",children:J.jsxs("span",{className:"cursor-pointer bg-white rounded-full text-white border border-[rgb(212,210,210)] relative w-[38px] h-[38px] flex items-center justify-center",children:[J.jsx("svg",{width:41,height:41,viewBox:"0 0 24 24",className:"absolute top-[-2px] left-[-2px] rotate-[-90deg] pointer-events-none",children:J.jsx("circle",{cx:12,cy:12,r:11,stroke:"#da291c",strokeWidth:1,fill:"none",className:"stroke-circle"})}),d?J.jsx("svg",{viewBox:"0 0 12 12",className:"z-10",style:{height:12,width:12},children:J.jsx("path",{d:"M4.674 6L.344 1.05A.5.5 0 0 1 1.05.343L6 4.674l4.95-4.33a.5.5 0 0 1 .707.706L7.326 6l4.33 4.95a.5.5 0 0 1-.706.707L6 7.326l-4.95 4.33a.5.5 0 0 1-.707-.706L4.674 6z"})}):J.jsx("svg",{viewBox:"0 0 12 14",className:"w-3 h-3",width:"12",height:"14",children:J.jsx("path",{d:"M3.37 8.457a2 2 0 1 1-.124-3.022l4.783-2.761a2 2 0 1 1 .652 1.163l-4.728 2.73a2.007 2.007 0 0 1 .029.704L8.81 10.06a2 2 0 1 1-.747 1.108L3.37 8.457z"})})]})})]}),J.jsx(dC,{isActive:d}),J.jsx("div",{className:"min-[60.0625em]:block hidden",children:J.jsx(nx,{slidesPerView:"auto",spaceBetween:120,freeMode:!0,modules:[fC],className:"mySwiper",onSwiper:S=>{t.current=S},onSlideChange:S=>{r(S.isEnd),u(S.activeIndex<=1)},onReachEnd:()=>{r(!0)},onReachBeginning:()=>{u(!0)},children:_S.map((S,E)=>J.jsx(rx,{className:"!w-auto",children:J.jsxs("div",{className:"select-none min-[60.0625em]:pl-30 flex items-center h-screen ",children:[J.jsxs("div",{className:"flex-shrink-0 HorizontalSlider__text-wrapper__2rGRUfhC",children:[S.index&&S.category&&J.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[J.jsx("span",{className:"text-xs font-normal text-[#da291c] SansRegular",children:S.index}),J.jsx("div",{className:"w-24 h-[1px] bg-[#da291c]"}),J.jsx("h2",{className:"text-xs font-medium text-[#da291c] uppercase SansRegular",children:S.category})]}),J.jsx("h3",{className:"SansRegular text-[26px] sm:text-[32px] font-medium text-[#181818] leading-12 tracking-tight overflow-hidden mb-5",children:S.title}),J.jsx("p",{className:"SansMedium text-[10.8px] leading-4 font-medium text-[#969696] max-w-[419px]",children:S.description})]}),S.videoSrc&&J.jsx("div",{className:"h-screen min-w-[441.25px] flex-shrink-0",children:J.jsx(xS,{src:S.videoSrc,isActiveVideo:h===S.videoSrc,setActiveVideoSrc:m})})]})},E))})}),J.jsx("div",{className:"min-[60.0625em]:hidden block max-md:px-5",children:_S.map((S,E)=>J.jsxs("div",{className:"flex flex-col items-center",children:[J.jsxs("div",{className:"flex-shrink-0 py-10",children:[S.index&&S.category&&J.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[J.jsx("span",{className:"text-xs font-normal text-[#da291c] SansRegular",children:S.index}),J.jsx("div",{className:"w-24 h-[1px] bg-[#da291c]"}),J.jsx("h2",{className:"text-xs font-medium text-[#da291c] uppercase SansRegular",children:S.category})]}),J.jsx("h3",{className:"SansRegular text-[26px] sm:text-4xl font-bold text-[#181818] leading-12 tracking-tight overflow-hidden mb-7.5 uppercase",children:S.title}),J.jsx("p",{className:"SansMedium text-[13px] font-medium text-[#969696] max-w-[499px]",children:S.description})]}),S.videoSrc&&J.jsx("div",{className:"flex-shrink-0",children:J.jsx(xS,{src:S.videoSrc,isActiveVideo:h===S.videoSrc,setActiveVideoSrc:m})})]},E))}),J.jsx("button",{type:"button",onClick:y,className:"cursor-pointer w-15 h-15 bg-white items-center justify-center rounded-full border border-[rgb(212,210,210)] min-[60.0625em]:flex hidden absolute bottom-30 left-20 z-30","aria-label":"Go to previous slide",disabled:t.current?.activeIndex===0,children:J.jsx("svg",{viewBox:"0 0 16 16",className:"w-4 h-4 transform rotate-180",xmlns:"http://www.w3.org/2000/svg",children:J.jsx("path",{d:"M16 8c0-.6-.2-1.1-.6-1.4L8 0l3.7 7.4-11.4.3c-.1 0-.3.1-.3.3s.2.3.3.3l11.3.3L8 16l7.4-6.5c.4-.4.6-.9.6-1.5z"})})}),J.jsxs("div",{className:`cursor-pointer min-[60.0625em]:flex hidden absolute bottom-30 right-20 items-center gap-3 z-30 transition-all duration-300 ${s?"opacity-0 translate-x-5":"opacity-100"}`,children:[o&&J.jsx("p",{className:"uppercase text-xs SansRegular",children:"SCROLL"}),J.jsx("button",{type:"button",onClick:v,className:"w-15 h-15 bg-white cursor-pointer flex items-center justify-center rounded-full border border-[rgb(212,210,210)]","aria-label":"Go to next slide",disabled:s,children:J.jsx("svg",{viewBox:"0 0 16 16",className:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",children:J.jsx("path",{d:"M16 8c0-.6-.2-1.1-.6-1.4L8 0l3.7 7.4-11.4.3c-.1 0-.3.1-.3.3s.2.3.3.3l11.3.3L8 16l7.4-6.5c.4-.4.6-.9.6-1.5z"})})})]})]})})}function gC(){const l=he.useRef(null),e=he.useRef(null),t=he.useRef(null),[i,s]=he.useState("/video/bgFerari.m3u8"),[r,o]=he.useState(!1);return he.useEffect(()=>{const u=()=>{window.innerWidth<=640?s("/video/mobile.m3u8"):s("/video/bgFerari.m3u8")};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),he.useEffect(()=>{if(Pi.set(".text",{opacity:0}),Pi.set(".line",{width:0}),Pi.set(".char",{y:28,opacity:0}),l.current){const u=l.current.querySelectorAll(".text");Pi.to(u,{opacity:1,duration:.8,stagger:.2})}if(e.current&&Pi.to(e.current,{width:"6rem",duration:1.2,ease:"power2.out"}),t.current){const u=t.current.querySelectorAll(".char");Pi.to(u,{y:0,opacity:1,duration:.8,stagger:.03})}},[]),he.useEffect(()=>{const u=()=>{document.documentElement.style.setProperty("--doc-height",`${window.innerHeight}px`)};return u(),window.addEventListener("resize",u),window.addEventListener("orientationchange",u),()=>{window.removeEventListener("resize",u),window.removeEventListener("orientationchange",u)}},[]),J.jsxs("div",{className:"relative w-full bg-[#181818] pt-20 sm:pt-25 overflow-hidden min-h-screen pb-5 flex flex-col  justify-between",children:[J.jsx("div",{className:"relative z-20 px-6 sm:px-12",children:J.jsxs("div",{ref:l,className:"flex flex-col gap-6 sm:gap-8",children:[J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("span",{className:"text-xs font-normal text-[#da291c] SansRegular text",children:"1"}),J.jsx("div",{ref:e,className:"w-24 h-[1px] bg-[#da291c] line"}),J.jsx("h2",{className:"text-xs font-medium text-[#da291c] uppercase SansRegular text",children:"Powertrain"})]}),J.jsxs("h3",{ref:t,className:"text-[26px] sm:text-[28px] font-bold text-white leading-none tracking-tight overflow-hidden SansRegular",children:["BEYOND".split("").map((u,d)=>J.jsx("span",{className:"char inline-block",children:u===" "?"":u},d))," PERFORMANCE".split("").map((u,d)=>J.jsx("span",{className:"char inline-block",children:u===" "?"":u},d+6))]})]})}),J.jsx("div",{className:"absolute top-0 left-0 w-full min-h-screen",children:J.jsx(PI,{src:i})}),J.jsx("div",{className:"static md:absolute bottom-5 sm:bottom-0 right-0 z-20 max-sm:px-6 w-full flex justify-end",children:J.jsx(kI,{setIsActive:o})}),J.jsx(hC,{setIsActive:o,isActive:r})]})}w1.createRoot(document.getElementById("root")).render(J.jsx(he.StrictMode,{children:J.jsx(gC,{})}));
